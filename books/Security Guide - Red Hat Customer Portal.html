<!DOCTYPE html>
<html dir="ltr" prefix="content: http://purl.org/rss/1.0/modules/content/ dc: http://purl.org/dc/terms/ foaf: http://xmlns.com/foaf/0.1/ og: http://ogp.me/ns# rdfs: http://www.w3.org/2000/01/rdf-schema# sioc: http://rdfs.org/sioc/ns# sioct: http://rdfs.org/sioc/types# skos: http://www.w3.org/2004/02/skos/core# xsd: http://www.w3.org/2001/XMLSchema#" style="" class="supports cssanimations flexbox csstransforms csstransforms3d js" lang="en"><head profile="http://www.w3.org/1999/xhtml/vocab">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	  <meta charset="utf-8">
<meta name="revision" title="e519212d-ea1b-4c4d-8f2d-82301376b5b0" product="9f2919b7-61d1-4cc8-ba63-3035d0d761aa" revision="108f945047d25d40b8e2eebbde6182b343f5620e:en-us" page="98a7ac74-5a00-4ac2-93a1-b4bce3bee3de">
<meta name="generator" content="Drupal 7 (http://drupal.org)">
<link rel="canonical" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide">
<link rel="shortlink" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide">
  <title>Security Guide - Red Hat Customer Portal</title>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!--[if IEMobile]><meta http-equiv="cleartype" content="on"><![endif]-->

<!-- metaInclude -->
<meta name="avalon-host-info" content="kcs06.web.prod.ext.phx2.redhat.com">
<meta name="avalon-version" content="a7b2585">
<meta name="cp-chrome-build-date" content="2018-05-23T15:48:13.713Z">

<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#000000">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#000000">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-status-bar-style" content="#000000">
<link rel="manifest" href="https://access.redhat.com/webassets/avalon/j/manifest.json">

 

<script type="text/javascript">
    window.portal = {
        analytics : {},
        host      : "https://access.redhat.com",
        idp_url   : "https://sso.redhat.com",
        lang      : "en",  
        version   : "a7b2585",
        builddate : "2018-05-23T15:48:13.713Z",
        nrid      : "14615289",
        nrlk      : "2a497fa56f"
    };
</script>
<script type="text/javascript">
    if (!/\/logout.*/.test(location.pathname) && portal.host === location.origin && document.cookie.indexOf('rh_sso_session') >= 0 && !(document.cookie.indexOf('rh_jwt') >= 0)) window.location = '/login?redirectTo=' + encodeURIComponent(window.location.href);
</script>
<!-- cssInclude -->

<link rel="shortcut icon" href="https://access.redhat.com/webassets/avalon/g/favicon.ico">

<link media="all" rel="stylesheet" type="text/css" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/bootstrap.css">
<link media="all" rel="stylesheet" type="text/css" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/main.css">
<link media="all" rel="stylesheet" type="text/css" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/components.css">
<link media="all" rel="stylesheet" type="text/css" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/pages.css">

<link href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/chosen.css" rel="stylesheet" type="text/css">

<!--[if lte IE 9]>
<link media="all" rel="stylesheet" type="text/css" href="https://access.redhat.com/chrome_themes/nimbus/css/ie.css" />
<![endif]-->

<noscript>
    <style type="text/css" media="screen"> .primary-nav { display: block; } </style>
</noscript>

<!-- /cssInclude -->
<script type="text/javascript" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/require.js" data-main="/webassets/avalon/j/"></script>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="https://access.redhat.com/chrome_themes/nimbus/js/ie8.js"></script>
<![endif]-->
  <link type="text/css" rel="stylesheet" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/css_UaBdVg87aQRN2fn0i_UfLp5kpr7BTshFYajrXzSLxUY.css" media="all">
<link type="text/css" rel="stylesheet" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/css_1D3M1YDGLyImQRFA3qWL1RYxRTihnYDmCyuvOxQ-TCQ.css" media="all">
<link type="text/css" rel="stylesheet" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/messages.css" media="all">
<link type="text/css" rel="stylesheet" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/css_v1ec-8ZW_hY3jXm8k7v1wNDEEu86AObBHQ5LZMFQmyo.css" media="all">
<link type="text/css" rel="stylesheet" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/css_EbIxi8kXycgOJT7BSzSNmquF5Y6pL1WPipqFT9EFF54.css" media="print">
  <link rel="stylesheet" type="text/css" media="all" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/list.css">
  <script src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/js_vSmhpx_T-AShyt_WMW5_TcwwxJP1imoVOa8jvwL_mxE.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="https://access.redhat.com/webassets/avalon/j/lib/require-css/require.css.min.js" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/require_002.js"></script>
<script src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/js_MQMBfIDQwTm3tPi1DaBlTCvqYlOOEc-88jiThkL-nGg.js"></script>
<script>chrometwo_require(["analytics/attributes"], function(attributes) {
attributes.set('ResourceID',       'e519212d-ea1b-4c4d-8f2d-82301376b5b0');
attributes.set('ResourceTitle',    'Security Guide');
attributes.set('Language',         'en-us');
attributes.set('RevisionId',       '108f945047d25d40b8e2eebbde6182b343f5620e:en-us');
attributes.set('PublicationState', ['active','published']);
attributes.set('Product',          'Red Hat Enterprise Linux');
attributes.set('ProductVersion',   '6');
attributes.set('ProductId',        'Red Hat Enterprise Linux 6');
});</script>
<script src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/js_-8vf8LkPxRkJ-o_lvpleocQOXhKeAjrWIHbr39eHffo.js"></script>
<script>breadcrumbs = [ ["Products &amp; Services", "/products/"], ["Product Documentation", "/documentation"], ["Red Hat Enterprise Linux", "/documentation/en/red-hat-enterprise-linux"], ["6", "/documentation/en/red-hat-enterprise-linux?version=6"], ["Security Guide", "/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/"] ];</script>
<script src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/js_2PRksiEo-fFt1MO8Yt4lwkqgcpisuCmSj5pyUkxRawc.js"></script>
<script src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/js_BAD1FthsXW017bJ_WOR6tFPUhqQsoEdWqspXP6FJXPw.js"></script>
<script>jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"kcs","theme_token":"pC8mXK82tCAzjqHY1VYyYCO4pZNao-wU7UqVuiQs-6Y","js":{"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.jquery.min.js":1,"modules\/chosen\/chosen.js":1,"0":1,"sites\/all\/themes\/cirrus\/js\/getting_started_toast.js":1,"1":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/prism.js":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/js\/underscore.js":1,"sites\/all\/themes\/kcs\/js\/kcs_base.js":1,"sites\/all\/themes\/kcs\/js\/showdown.js":1,"sites\/all\/themes\/kcs\/js\/case_links.js":1,"2":1,"3":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/book\/book.css":1,"modules\/comment\/comment.css":1,"modules\/date\/date_api\/date.css":1,"modules\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"modules\/views\/css\/views.css":1,"sites\/all\/libraries\/chosen\/chosen\/chosen.css":1,"modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/contrib\/panels\/css\/panels.css":1,"sites\/all\/modules\/custom\/rate\/rate.css":1,"sites\/all\/modules\/custom\/rh_doc_fetcher\/plugins\/layouts\/docs_page\/docs_page.css":1,"https:\/\/access.redhat.com\/webassets\/avalon\/s\/messages.css":1,"sites\/all\/themes\/zen\/system.base.css":1,"sites\/all\/themes\/zen\/system.menus.css":1,"sites\/all\/themes\/zen\/system.messages.css":1,"sites\/all\/themes\/zen\/system.theme.css":1,"sites\/all\/themes\/zen\/comment.css":1,"sites\/all\/themes\/zen\/node.css":1,"sites\/all\/themes\/kcs\/css\/html-reset.css":1,"sites\/all\/themes\/kcs\/css\/wireframes.css":1,"sites\/all\/themes\/kcs\/css\/layout-fixed.css":1,"sites\/all\/themes\/kcs\/css\/page-backgrounds.css":1,"sites\/all\/themes\/kcs\/css\/tabs.css":1,"sites\/all\/themes\/kcs\/css\/pages.css":1,"sites\/all\/themes\/kcs\/css\/blocks.css":1,"sites\/all\/themes\/kcs\/css\/navigation.css":1,"sites\/all\/themes\/kcs\/css\/views-styles.css":1,"sites\/all\/themes\/kcs\/css\/nodes.css":1,"sites\/all\/themes\/kcs\/css\/comments.css":1,"sites\/all\/themes\/kcs\/css\/forms.css":1,"sites\/all\/themes\/kcs\/css\/fields.css":1,"sites\/all\/themes\/kcs\/css\/kcs.css":1,"sites\/all\/themes\/kcs\/css\/print.css":1}},"chosen":{"selector":"#edit-field-kcs-component-select-und, #edit-field-kcs-sbr-select-und, #edit-field-kcs-product-select-und, #edit-field-kcs-type-select-und, #edit-language, #edit-field-kcs-a-category-select-und, #edit-field-kcs-state-select-und, #edit-field-kcs-tags-select-und, #edit-field-kcs-state-select-value, #edit-field-vid-reference-product-und, #edit-state, #edit-product, #edit-category, #edit-field-kcs-product-select-tid, #edit-field-kcs-type-select-tid, #edit-field-kcs-a-category-select-tid, #edit-sort-bef-combine, #edit-kcs-state, #edit-field-category-tid, #edit-field-product-tid, #edit-field-tags-tid, #edit-field-category-und, #edit-field-product-und, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-category, #edit-field-tags-und, #views-exposed-form-questions-list-questions-filter-block #edit-field-product, #views-exposed-form-questions-list-questions-filter-block #edit-field-tags, #edit-field-mega-menu-tab-und, #edit-field-internal-tags-tid, #edit-tags, #edit-field-kcs-tags-select-tid, #edit-subscriptions-and-choose-field-select, #edit-subscriptions-and-type, #edit-vid-13, #edit-vid-4, #edit-vid-5, #edit-vid-53, #edit-vid-1, #edit-vid-3, #edit-group-blog, #edit-group-group, #edit-subscriptions-and-choose-field-select-two, #edit-subscriptions-and-type-two, #edit-vid-13-two, #edit-vid-4-two, #edit-vid-5-two, #edit-vid-53-two, #edit-vid-1-two, #edit-vid-3-two, #edit-group-blog-two, #edit-group-group-two, #edit-subscriptions-and-edit-choose-field-select, #edit-subscriptions-and-type-edit, #edit-subscriptions-and-edit-type-two, #edit-vid-13-edit-two, #edit-vid-4-edit-two, #edit-vid-5-edit-two, #edit-vid-53-edit-two, #edit-vid-1-edit-two, #edit-vid-3-edit-two, #edit-group-group-edit-two, #edit-subscriptions-and-edit-choose-field-select-two, #edit-vid-13-edit, #edit-vid-4-edit, #edit-vid-5-edit, #edit-vid-53-edit, #edit-vid-1-edit, #edit-vid-3-edit, #edit-group-group-edit, #edit-group-blog-edit, #edit-field-supported-languages-tid, #edit-field-geography-und, #edit-field-supported-products-und, #edit-field-supported-languages-und, #edit-field-vendor-und, #edit-field-errata-type-text-und, #edit-field-errata-severity-text-und, #edit-field-software-partner-level-und, #edit-field-scert-product-category-und, #edit-field-certifications-und-0-field-product-und, #edit-kcs-article-type, #edit-field-eco-industry-tag-select-tid, #edit-field-eco-software-catego-select-tid, #edit-field-ecosystem-tag-select-und, #edit-field-eco-industry-tag-select-und, #edit-field-eco-software-catego-select-und, #edit-field-vendor-tsanet-member-ref-und, #edit-field-og-vendor-ref-und-0-default, #edit-field-eco-products-enabled-col-und-0-field-eco-subscription-model-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-support-level-ref-und, #edit-field-eco-products-enabled-col-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-select-und, #edit-field-eco-certifications-select-und-0-field-eco-product-archite-select-und, #edit-field-eco-certifications-select-und-0-field-eco-certificati-lvl-select-und, #edit-field-eco-certifications-select-und-0-field-eco-hypervisor-str-und, #edit-field-eco-supported-language-ref-und, #edit-field-eco-region-ref-und, #edit-field-cs-product-category-str-und, #edit-field-eco-certifications-select-und-0-field-eco-format-ref-und, #edit-field-eco-group-access-ref-und, #edit-field-hw-category-tag-ref-und, #edit-field-profile-industry-und, #edit-field-profile-tech-interests-und, #edit-field-product-page-features-ref-und, #edit-field-eco-product-select-und, #edit-field-base-product-ref-und, #edit-field-eco-product-archite-select-und, #edit-field-eco-format-ref-und, #edit-field-certification-status-ref-und, #edit-field-certification-result-ref-und, #edit-field-og-certified-product-ref-und-0-default, #edit-field-eco-subscription-model-ref-und, #edit-field-eco-support-level-ref-und, #edit-field-eco-certificati-lvl-select-und, #edit-field-eco-hypervisor-str-und, #edit-field-ccp-thirdparty-cert-select-und, .use_, #edit-field-eco-cert-product-tag-und, #edit-field-documentation-location-ref-und, #edit-field-documentation-title-und","minimum":"0"},"rh_doc_fetcher":{"page_type":"single"},"gettingStartedToast":{"currentUser":0},"urlIsAjaxTrusted":{"\/documentation\/en-us\/red_hat_enterprise_linux\/6\/html-single\/security_guide\/":true},"section":"","kcs":{"nodeType":null,"nodeId":null}});</script>
    <!--[if lt IE 9]>
  <script src="https://access.redhat.com/sites/all/themes/kcs/js/html5shiv.js"></script>
  <![endif]-->
  
      


    <!--kcs05-->
<script type="text/javascript">
  Drupal.portal = {"version":{"redhat_portal":"package drupal7-redhat_portal is not installed"}};
  Drupal.portal.currentUser = {};
  </script>

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="rhn-modal" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/rhn-modal.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="status-widget" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/status-widget.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="avatars" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/avatars.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="data-action" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/data-action.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="moment" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/moment.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="drupal-admin-drawer" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/drupal-admin-drawer.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="prism" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/prism.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="underscore" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/underscore.js"></script><link type="text/css" rel="stylesheet" href="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/jquery-ui-1.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nimbus/tour" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/tour.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="ieSVGfix" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/ieSVGfix.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="handlebars.runtime" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/handlebars.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="drupal-admin-drawer-templates" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/templates.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="jquery-ui" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/jquery-ui-1.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="introjs" src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/introjs.js"></script></head>

<body class="portal-page admin-bar  kcs_external en loggedOut">

  
  <div id="page-wrap" class="page-wrap">
    <div class="top-page-wrap">

        <!--googleoff: all-->
        <header class="masthead" id="masthead">

            <!-- Accessibility Nav & Header -->
<div class="accessibility-nav sr-only">
    <a href="https://access.redhat.com/">
        <h1>Red Hat <span>Customer </span><span>Portal</span></h1>
    </a>
    <p><a href="#cp-main">Skip to main content</a></p>
    <nav aria-labelledby="accessibility-nav-heading">
        <h2 id="accessibility-nav-heading">Main Navigation</h2>
        <ul>
    <li>
        <a href="#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&amp;">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-infrastructure/">Red Hat Cloud Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-application-runtimes/">Red Hat OpenShift Application Runtimes</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-container-native-storage">Red Hat Container-Native Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>JBoss Development and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-data-grid/">Red Hat JBoss Data Grid</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-operations-network/">Red Hat JBoss Operations Network</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-developer-studio/">Red Hat JBoss Developer Studio</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>JBoss Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-fuse/">Red Hat Fuse</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-amq/">Red Hat AMQ</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-bpm-suite/">Red Hat JBoss BPM Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-brms/">Red Hat Decision Manager</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management Platform</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>Mobile</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-mobile-application-platform/">Red Hat Mobile Application Platform</a></li>
                </ul>
            </li>
            <li class="heading">Enterprise-ready containers</li>
            <li><a class="cta-link cta-link-white-red" href="https://access.redhat.com/containers">Search the Red Hat Container Catalog</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://access.redhat.com/products/Consulting/">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://access.redhat.com/products/training-certifications/">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/search/#/ecosystem">Browse Certified Solutions</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
          </ul>
    </li>
    <li>
        <a href="#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li class="heading">Red Hat Insights</li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&amp;">Learn More</a></li>
            <li class="heading">Red Hat Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li class="heading">Additional Tools</li>
            <li><a href="https://access.redhat.com/products/red-hat-access/">Red Hat Access plug-ins</a></li>
            <li><a href="https://access.redhat.com/tools/satcert/">Red Hat Satellite Certificate Tool</a></li>
        </ul>
    </li>
    <li>
        <a href="#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&amp;name=&amp;product=All&amp;category=All&amp;tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://access.redhat.com/containers/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated" style="display: block;"><a href="https://access.redhat.com/login?redirectTo=https%3A%2F%2Faccess.redhat.com%2Fdocumentation%2Fen-us%2Fred_hat_enterprise_linux%2F6%2Fhtml-single%2Fsecurity_guide%2F" id="accessibility-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated" style="display: block;"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="accessibility-accountUser">
                    <div class="account-name"><strong id="accessibility-userFullName"></strong></div>
                    <div class="account-org"><span id="accessibility-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link" hidden="hidden">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="accessibility-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="accessibility-localesMenu">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-en">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=es&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-es">Español</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=de&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-de">Deutsch</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=it&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-it">Italiano</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=fr&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-fr">Français</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=pt&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-pt">Português</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-zh_CN">中文 (中国)</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ru&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="accessibility-ru">русский</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- Mobile Header -->
<nav class="mobile-nav-bar hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <button id="menu-btn" class="menu menu-white" type="button" aria-label="Toggle Navigation">
        <span class="lines"></span>
    </button>
    <a class="logo" href="https://access.redhat.com/">
        <span class="logo-crop"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/l_redhat-lg.png" alt="Red Hat Logo" title="Red Hat"></span>
        <span class="site-title"><span>Customer </span><span>Portal</span></span>
    </a>
    <button class="btn btn-search btn-utility" data-target="#site-search">
        <span class="web-icon-search"></span>
        <span class="link-text">Search</span>
    </button>
</nav>

<!-- Mobile Menu Drawer -->
<div class="nav-drawer-backdrop"></div><div class="nav-drawer mobile-nav-drawer hidden-sm hidden-md hidden-lg" aria-hidden="true">
    <nav class="nav-container">
        <ul>
    <li>
        <a href="#" class="has-subnav"><span>Products &amp; Services</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/products">View All Products</a></li>
            <li>
                <a href="#" class="has-subnav"><span>Infrastructure and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|p|im|rhaijan2016&amp;">Red Hat Insights</a></li>
                    <li><a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>Cloud Computing</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-infrastructure/">Red Hat Cloud Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a></li>
                    <li><a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-openshift-application-runtimes/">Red Hat OpenShift Application Runtimes</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>Storage</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-container-native-storage">Red Hat Container-Native Storage</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>JBoss Development and Management</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-data-grid/">Red Hat JBoss Data Grid</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-operations-network/">Red Hat JBoss Operations Network</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-developer-studio/">Red Hat JBoss Developer Studio</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>JBoss Integration and Automation</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-fuse/">Red Hat Fuse</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-amq/">Red Hat AMQ</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-bpm-suite/">Red Hat JBoss BPM Suite</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-jboss-brms/">Red Hat Decision Manager</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management Platform</a></li>
                </ul>
            </li>
            <li>
                <a href="#" class="has-subnav"><span>Mobile</span></a>
                <ul class="mm-hide">
                    <li aria-hidden="true"><a href="#" class="back">Back</a></li>
                    <li><a href="https://access.redhat.com/products/red-hat-mobile-application-platform/">Red Hat Mobile Application Platform</a></li>
                </ul>
            </li>
            <li class="heading">Enterprise-ready containers</li>
            <li><a class="cta-link cta-link-white-red" href="https://access.redhat.com/containers">Search the Red Hat Container Catalog</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/support/">Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
            <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
            <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/documentation/">Documentation</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
            <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>

            <li class="heading">Services</li>
            <li><a href="https://access.redhat.com/products/Consulting/">Consulting</a></li>
            <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
            <li><a href="https://access.redhat.com/products/training-certifications/">Training &amp; Certifications</a></li>

            <li class="heading"><a class="cta-link cta-link-darkbg" href="https://access.redhat.com/ecosystem/">Ecosystem</a></li>
            <li><a href="https://access.redhat.com/ecosystem/search/#/ecosystem">Browse Certified Solutions</a></li>
            <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
          </ul>
    </li>
    <li>
        <a href="#" class="has-subnav"><span>Tools</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li class="heading">Red Hat Insights</li>
            <li><a href="https://access.redhat.com/insights/info/?intcmp=mm|t|c1|rhaidec2015&amp;">Learn More</a></li>
            <li class="heading">Red Hat Customer Portal Labs</li>
            <li><a href="https://access.redhat.com/labs/">Explore Labs</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
            <li><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
            <li class="heading">Additional Tools</li>
            <li><a href="https://access.redhat.com/products/red-hat-access/">Red Hat Access plug-ins</a></li>
            <li><a href="https://access.redhat.com/tools/satcert/">Red Hat Satellite Certificate Tool</a></li>
        </ul>
    </li>
    <li>
        <a href="#" class="has-subnav"><span>Security</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/security/">Product Security Center</a></li>
            <li class="heading">Security Updates</li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
            <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
            <li class="heading">Resources</li>
            <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
            <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
            <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
            <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
            <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
            <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
        </ul>
    </li>
    <li>
        <a href="#" class="has-subnav"><span>Community</span></a>
        <ul class="mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li class="heading">Customer Portal Community</li>
            <li><a href="https://access.redhat.com/discussions?keyword=&amp;name=&amp;product=All&amp;category=All&amp;tags=All">Discussions</a></li>
            <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
            <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
            <li><a href="https://access.redhat.com/community/">Community Activity</a></li>
            <li class="heading">Customer Events</li>
            <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
            <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
            <li class="heading">Stories</li>
            <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
            <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
            <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
        </ul>
    </li>
    <li><a href="https://access.redhat.com/management/">Subscriptions</a></li>
    <li><a href="https://access.redhat.com/downloads/">Downloads</a></li>
    <li><a href="https://access.redhat.com/containers/">Containers</a></li>
    <li><a href="https://access.redhat.com/support/cases/">Support Cases</a></li>
    <li>
        <a href="#" class="has-subnav"><span>Account</span></a>
        <ul class="utility mm-hide">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated" style="display: block;"><a href="https://access.redhat.com/login?redirectTo=https%3A%2F%2Faccess.redhat.com%2Fdocumentation%2Fen-us%2Fred_hat_enterprise_linux%2F6%2Fhtml-single%2Fsecurity_guide%2F" id="mobile-accountLogin">Log In</a></li>
            <li class="mobile-accountLinksLoggedOut unauthenticated" style="display: block;"><a href="https://www.redhat.com/wapps/ugc/register.html">Register</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated">
                <div class="account-info" id="mobile-accountUser">
                    <div class="account-name"><strong id="mobile-userFullName"></strong></div>
                    <div class="account-org"><span id="mobile-userOrg"></span></div>
                    <div class="account-number mobile-accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                </div>
            </li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
            <!-- <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link" hidden="hidden">User Management</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user">My Profile</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/user" id="mobile-userNotificationsLink">Notifications</a></li>
            <li class="mobile-accountLinksLoggedIn authenticated"><a href="https://access.redhat.com/help/">Help</a></li>
            <li class="logout mobile-accountLinksLoggedIn authenticated"><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout">Log Out</a></li>
        </ul>
    </li>
    <li>
        <a href="#" class="has-subnav"><span>Language</span></a>
        <ul class="utility mm-hide" id="mobile-localesMenu">
            <li aria-hidden="true"><a href="#" class="back">Back</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=en&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-en" class="selected">English</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=es&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-es">Español</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=de&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-de">Deutsch</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=it&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-it">Italiano</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ko&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-ko">한국어</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=fr&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-fr">Français</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ja&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-ja">日本語</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=pt&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-pt">Português</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-zh_CN">中文 (中国)</a></li>
            <li><a href="https://access.redhat.com/changeLanguage?language=ru&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" id="mobile-ru">русский</a></li>
		</ul>
    </li>
</ul>
    </nav>
</div>

<!-- White Utility Menu for large screens -->
<div class="utility-wrap" aria-hidden="true">
    <div class="utility-container">
        <div class="utility-bar hidden-xs">
            <div role="navigation" class="top-nav">
                <ul>
                    <li id="nav-subscription" data-portal-tour-1="1"><a class="top-nav-subscriptions" href="https://access.redhat.com/management/">Subscriptions</a></li>
                    <li id="nav-downloads" data-portal-tour-1="2"><a class="top-nav-downloads" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li id="nav-containers"><a class="top-nav-containers" href="https://access.redhat.com/containers/">Containers</a></li>
                    <li id="nav-support" data-portal-tour-1="3"><a class="top-nav-support-cases" href="https://access.redhat.com/support/cases/">Support Cases</a></li>
                </ul>
            </div>

            <div role="navigation" class="utility-nav">
                <ul>
                    <li>
                        <a class="btn-search" data-target="#site-search" title="Search" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-search" aria-label="search"></span>
                            <span class="link-text">Search</span>
                        </a>
                    </li>
                    <li>
                        <a class="btn-profile" data-target="#account-info" data-portal-tour-1="4a" title="Account" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-user" aria-label="log in"></span>
                            <span class="link-text">Log In</span>
                            <span class="account-user" id="accountUserName"></span>
                        </a>
                    </li>
                    <li>
                        <a class="btn-language" data-target="#language" data-portal-tour-1="6" title="Language" data-toggle="tooltip" data-placement="bottom">
                            <span class="web-icon-globe" aria-label="language"></span>
                            <span class="link-text">Language</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <!-- Utility Tray -->
        <div class="utility-tray-container">
            <div class="utility-tray">
                <div id="site-search" class="utility-link site-search">
                    <div class="content">
                        <form class="ng-pristine ng-valid topSearchForm" id="topSearchForm" name="topSearchForm" action="/search/browse/search/" method="get" enctype="application/x-www-form-urlencoded">
                            <div class="input-group push-bottom">

                                <input class="form-control searchField" id="topSearchInput" name="keyword" placeholder="Enter Your Search Term" type="text">
                                <span class="input-group-btn">
                                    <button type="submit" class="btn btn-primary">Search</button>
                                </span>
                            </div>
                            <div>Troubleshooting an issue? Try <a href="https://access.redhat.com/solution-engine">Solution Engine</a>—our new support tool.</div>
                        </form>
                    </div>
                </div>
                <div id="account-info" class="utility-link account-info">
                    <div class="content">

                        <!-- Account Unauthenticated -->
                        <div id="accountLinksLoggedOut" class="unauthenticated" style="display: block;">
                            <h2 class="utility-header">Log in to Your Red Hat Account</h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border">
                                    <p><a href="https://access.redhat.com/login?redirectTo=https%3A%2F%2Faccess.redhat.com%2Fdocumentation%2Fen-us%2Fred_hat_enterprise_linux%2F6%2Fhtml-single%2Fsecurity_guide%2F" id="accountLogin" class="btn btn-primary">Log In</a></p>
                                    <p>Your Red Hat account gives you access to your profile, preferences, and services, depending on your status.</p>
                                </div>
                                <div class="col-sm-6 col-border col-border-left">
                                    <p><a href="https://www.redhat.com/wapps/ugc/register.html" class="btn btn-primary">Register</a></p>
                                    <p>If you are a new customer, register now for access to product evaluations and purchasing capabilities. </p>

                                    <strong>Need access to an account?</strong><p>If your company has an existing Red Hat account, your organization administrator can grant you access.</p>

                                    <p><a href="https://access.redhat.com/support/contact/customerService/">If you have any questions, please contact customer service.</a></p>
                                </div>
                            </div>
                        </div>

                        <!-- Account Authenticated -->
                        <div id="accountLinksLoggedIn" class="authenticated">
                            <h2 class="utility-header"><span id="userFirstName"></span></h2>
                            <div class="row col-border-row">
                                <div class="col-sm-6 col-border col-border-right">
                                    <div class="account-info" id="accountUser">
                                        <div class="avatar"><!-- placeholder--></div>
                                        <div class="account-name"><strong id="userFullName"></strong></div>
                                        <div class="account-org"><span id="userOrg"></span></div>
                                        <div class="account-number accountNumber"><span class="property">Red Hat Account Number:</span> <span class="value"></span></div>
                                    </div>

                                    <div class="row account-settings">
                                        <div class="col-md-6" data-portal-tour-1="4">
                                            <h3>Red Hat Account</h3>
                                            <ul class="reset">
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/personalInfo.html">Account Details</a></li>
                                                <!-- <li><a href="https://www.redhat.com/wapps/ugc/protected/prefs.html">Newsletter and Contact Preferences</a></li> -->
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/usermgt/userList.html" class="user-management-link" hidden="hidden">User Management</a></li>
                                                <li><a href="https://www.redhat.com/wapps/ugc/protected/account.html">Account Maintenance</a></li>
                                            </ul>
                                        </div>
                                        <div class="col-md-6" data-portal-tour-1="5">
                                            <h3>Customer Portal</h3>
                                            <ul class="reset">
                                                <li><a href="https://access.redhat.com/user">My Profile</a></li>
                                                <li><a href="https://access.redhat.com/user" id="userNotificationsLink">Notifications</a></li>
                                                <li><a href="https://access.redhat.com/help/">Help</a></li>
                                            </ul>
                                        </div>
                                    </div>

                                </div>
                                <div class="col-sm-6 col-border">
                                    <p>For your security, if you’re on a public computer and have finished using your Red Hat services, please be sure to log out.</p>
                                    <p><a href="https://sso.redhat.com/auth/realms/redhat-external/logout?redirectUrl=https%3A%2F%2Faccess.redhat.com%2Flogout" id="accountLogout" class="btn btn-primary">Log Out</a></p>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div id="language" class="utility-link language">
                    <div class="content">
                        <h2 class="utility-header">Select Your Language</h2>
                        <div class="row" id="localesMenu">
                            <div class="col-sm-3">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=en&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="en" id="en" class="selected">English</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=es&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="es" id="es">Español</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=de&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="de" id="de">Deutsch</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=it&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="it" id="it">Italiano</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ko&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="ko" id="ko">한국어</a></li>
                                </ul>
                            </div>
                            <div class="col-sm-3">
                                <ul class="reset">
                                    <li><a href="https://access.redhat.com/changeLanguage?language=fr&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="fr" id="fr">Français</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ja&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="ja" id="ja">日本語</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=pt&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="pt" id="pt">Português</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=zh_CN&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="zh_CN" id="zh_CN">中文 (中国)</a></li>
                                    <li><a href="https://access.redhat.com/changeLanguage?language=ru&amp;redirectTo=https%3A//access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html-single/security_guide/" data-lang="ru" id="ru">русский</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="scroll-anchor"></div>

<!-- Main Menu for large screens -->
<div class="header-nav visible-sm visible-md visible-lg" aria-hidden="true">
    <div id="header-nav">
        <div class="container">
            <div class="row">
                <div class="col-xs-12">

                    <a href="https://access.redhat.com/" class="logo">
                        <span class="logo-crop"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/l_redhat-lg.png" alt="Red Hat"></span>
                        <span class="site-title"><span>Customer </span><span>Portal</span></span>
                    </a>

                    <nav class="primary-nav" style="display: block;">
                        <ul>
                            <li id="nav-products"><a class="products" data-link="mega" data-target="products-menu" href="https://access.redhat.com/products/" id="products-menu">Products &amp; Services</a></li>
                            <li id="nav-tools"><a class="tools" data-link="mega" data-target="tools-menu" href="https://access.redhat.com/labs/" id="tools-menu">Tools</a></li>
                            <li id="nav-security"><a class="security" data-link="mega" data-target="security-menu" href="https://access.redhat.com/security/" id="security-menu">Security</a></li>
                            <li id="nav-community"><a class="community" data-link="mega" data-target="community-menu" href="https://access.redhat.com/community/" id="community-menu">Community</a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Mega Menu for large screens -->
<div class="mega-wrap visible-sm visible-md visible-lg" aria-hidden="true">
    <nav class="mega">
        <div class="container">
            <div class="mega-menu-wrap">

                <!-- Products Menu -->
                <div aria-labelledby="products-menu" class="products-menu mega-menu" role="navigation">
                    <div class="row">
                        <div class="col-md-6 col-sm-8">
                            <div class="root clearfix" data-portal-tour-1="7">
                                <ul class="subnav subnav-root">
                                    <li data-target="infrastructure-menu" class="active">
                                        <h3>Infrastructure and Management</h3>
                                    </li>
                                    <li data-target="cloud-menu">
                                        <h3>Cloud Computing</h3>
                                    </li>
                                    <li data-target="storage-menu">
                                        <h3>Storage</h3>
                                    </li>
                                    <li data-target="jboss-dev-menu">
                                        <h3>JBoss Development and Management</h3>
                                    </li>
                                    <li data-target="jboss-int-menu">
                                        <h3>JBoss Integration and Automation</h3>
                                    </li>
                                    <li data-target="mobile-products-menu">
                                        <h3>Mobile</h3>
                                    </li>
                                </ul>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="infrastructure-menu" style="display: block; height: 498px;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-enterprise-linux/">Red Hat Enterprise Linux</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-virtualization/">Red Hat Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/identity-management/">Red Hat Identity Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-directory-server/">Red Hat Directory Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-certificate-system/">Red Hat Certificate System</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-satellite/">Red Hat Satellite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-subscription-management/">Red Hat Subscription Management</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-update-infrastructure/">Red Hat Update Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-insights/">Red Hat Insights</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/ansible-tower-red-hat/">Red Hat Ansible Tower</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ansible-engine/">Red Hat Ansible Engine</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="cloud-menu" style="height: 498px;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloudforms/">Red Hat CloudForms</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openstack-platform/">Red Hat OpenStack Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloud-infrastructure/">Red Hat Cloud Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-cloud-suite/">Red Hat Cloud Suite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openshift-container-platform/">Red Hat OpenShift Container Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-online-red-hat/">Red Hat OpenShift Online</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/openshift-dedicated-red-hat/">Red Hat OpenShift Dedicated</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-openshift-application-runtimes/">Red Hat OpenShift Application Runtimes</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="storage-menu" style="height: 498px;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-storage/">Red Hat Gluster Storage</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/">Red Hat Hyperconverged Infrastructure</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-ceph-storage/">Red Hat Ceph Storage</a>
                                        </li>
                                        <li>
                                          <a href="https://access.redhat.com/products/red-hat-container-native-storage">Red Hat Container-Native Storage</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-dev-menu" style="height: 498px;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/">Red Hat JBoss Enterprise Application Platform</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-data-grid/">Red Hat JBoss Data Grid</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-web-server/">Red Hat JBoss Web Server</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-operations-network/">Red Hat JBoss Operations Network</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-developer-studio/">Red Hat JBoss Developer Studio</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="jboss-int-menu" style="height: 498px;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-data-virtualization/">Red Hat JBoss Data Virtualization</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-fuse/">Red Hat Fuse</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-amq/">Red Hat AMQ</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-bpm-suite/">Red Hat JBoss BPM Suite</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-jboss-brms/">Red Hat Decision Manager</a>
                                        </li>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-3scale/">Red Hat 3scale API Management Platform</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="subnav subnav-child" data-eh="subnav-child" data-menu-local="mobile-products-menu" style="height: 498px;">
                                    <ul>
                                        <li>
                                            <a href="https://access.redhat.com/products/red-hat-mobile-application-platform/">Red Hat Mobile Application Platform</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <a href="https://access.redhat.com/products" class="btn btn-primary">View All Products</a>
                        </div>

                        <div class="col-md-6 col-sm-4 pull-right" data-portal-tour-1="8">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/support" class="cta-link cta-link-darkbg">Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/production/">Production Support</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/developer/">Development Support</a></li>
                                        <li><a href="https://access.redhat.com/support/policy/update_policies/">Product Life Cycle &amp; Update Policies</a></li>
                                    </ul>
                                    <h4 class="nav-title">Services</h4>
                                    <ul>
                                        <li><a href="https://access.redhat.com/products/Consulting/">Consulting</a></li>
                                        <li><a href="https://access.redhat.com/support/offerings/tam/">Technical Account Management</a></li>
                                        <li><a href="https://access.redhat.com/products/training-certifications/">Training &amp; Certifications</a></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul>
                                        <li><a href="https://access.redhat.com/documentation" class="cta-link cta-link-darkbg">Documentation</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux">Red Hat Enterprise Linux</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform">Red Hat JBoss Enterprise Application Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en-us/red_hat_openstack_platform">Red Hat OpenStack Platform</a></li>
                                        <li><a href="https://access.redhat.com/documentation/en-us/openshift_container_platform">Red Hat OpenShift Container Platform</a></li>
                                    </ul>
                                    <ul>
                                        <li><a href="https://access.redhat.com/ecosystem" class="cta-link cta-link-darkbg">Ecosystem</a></li>
                                        <li><a href="https://access.redhat.com/ecosystem/search/#/ecosystem">Browse Certified Solutions</a></li>
                                        <li><a href="https://access.redhat.com/ecosystem/partner-resources">Partner Resources</a></li>
                                    </ul>
                                </div>
                            </div>

                            <a href="https://access.redhat.com/containers" class="containers-promo card card-sm card-tagged-left card-tagged-accent card-w-cta card-w-icon">
                              <section class="promo-left">
                                <h4 class="card-heading">Enterprise-ready containers</h4>
                                <p class="promo-desc">Secure, certified, and up-to-date container images.</p>
                                <span class="cta-link cta-link-white-red">Search the Red Hat Container Catalog</span>
                              </section>
                              <div class="promo-right hidden-xs hidden-sm">
                                <span aria-hidden="true" class="rh-icon-container-library lg-icon"></span>
                              </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Tools Menu -->
                <div aria-labelledby="tools-menu" class="tools-menu mega-menu" data-eh="mega-menu" role="navigation" style="height: 357px;">
                    <div class="row" data-portal-tour-1="9">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Red Hat Customer Portal Labs</h2>
                                    <p class="text-white">To help you 
use Red Hat products to their full potential, our engineers have 
developed a powerful set of tools to support your ongoing success.</p>
                                    <p class="push-top"><a href="https://access.redhat.com/labs/" class="btn btn-primary">Explore Labs</a></p>

                                    <ul class="list-flat">
                                        <li class="more-link"><a href="https://access.redhat.com/labs/#?type=config">Configuration</a></li>
                                        <li class="more-link"><a href="https://access.redhat.com/labs/#?type=deploy">Deployment</a></li>
                                        <li class="more-link"><a href="https://access.redhat.com/labs/#?type=troubleshoot">Troubleshooting</a></li>
                                        <li class="more-link"><a href="https://access.redhat.com/labs/#?type=security">Security</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h3 class="nav-title">Additional Tools</h3>
                                    <ul>
                                        <li><a href="https://access.redhat.com/products/red-hat-access/">Red Hat Access plug-ins</a></li>
                                        <li><a href="https://access.redhat.com/tools/satcert/">Red Hat Satellite Certificate Tool</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <div class="card card-dark-grey">
                                        <h3 class="nav-title text-white">Red Hat Insights</h3>
                                        <p class="text-white">Increase visibility into IT operations to detect and resolve technical issues before they impact your business.</p>
                                        <ul class="list-flat">
                                            <li class="more-link"><a href="https://access.redhat.com/insights/?intcmp=mm|t|c1|rhaidec2015&amp;">Learn More</a></li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>

                <!-- Security Menu -->
                <div aria-labelledby="security-menu" class="security-menu mega-menu" data-eh="mega-menu" role="navigation" style="height: 357px;">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="10">

                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Red Hat Product Security Center</h2>
                                    <p class="text-white">Engage with 
our Red Hat Product Security team, access security updates, and ensure 
your environments are not exposed to any known security vulnerabilities.</p>
                                    <p><a href="https://access.redhat.com/security/" class="btn btn-primary">Product Security Center</a></p>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Security Updates</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-advisories">Security Advisories</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/cve">Red Hat CVE Database</a></li>
                                        <li><a href="https://access.redhat.com/security/security-updates/#/security-labs">Security Labs</a></li>
                                    </ul>
                                    <p class="text-white">Keep your systems secure with Red Hat's specialized responses for high-priority security vulnerabilities.</p>
                                    <ul>
                                        <li class="more-link"><a href="https://access.redhat.com/security/vulnerability">View Responses</a></li>
                                    </ul>
                                </div>

                                <div class="col-sm-4">
                                    <h2 class="nav-title">Resources</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/security/overview/">Overview</a></li>
                                        <li><a href="https://access.redhat.com/blogs/product-security">Security Blog</a></li>
                                        <li><a href="https://www.redhat.com/security/data/metrics/">Security Measurement</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/classification/">Severity Ratings</a></li>
                                        <li><a href="https://access.redhat.com/security/updates/backporting/">Backporting Policies</a></li>
                                        <li><a href="https://access.redhat.com/security/team/key/">Product Signing (GPG) Keys</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Community Menu -->
                <div aria-labelledby="community-menu" class="community-menu mega-menu" data-eh="mega-menu" role="navigation" style="height: 357px;">
                    <div class="row">
                        <div class="col-sm-12 basic" data-portal-tour-1="11">
                            <div class="row">
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Portal Community</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/discussions?keyword=&amp;name=&amp;product=All&amp;category=All&amp;tags=All">Discussions</a></li>
                                        <li><a href="https://access.redhat.com/blogs/">Blogs</a></li>
                                        <li><a href="https://access.redhat.com/groups/">Private Groups</a></li>
                                        <p class="push-top"><a href="https://access.redhat.com/community/" class="btn btn-primary">Community Activity</a></p>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Customer Events</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/convergence/">Red Hat Convergence</a></li>
                                        <li><a href="http://www.redhat.com/summit/">Red Hat Summit</a></li>
                                    </ul>
                                </div>
                                <div class="col-sm-4">
                                    <h2 class="nav-title">Stories</h2>
                                    <ul>
                                        <li><a href="https://access.redhat.com/subscription-value/">Red Hat Subscription Value</a></li>
                                        <li><a href="https://access.redhat.com/you-asked-we-acted/">You Asked. We Acted.</a></li>
                                        <li><a href="http://www.redhat.com/en/open-source">Open Source Communities</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!--<a href="https://access.redhat.com/community/" class="btn btn-primary">Explore Community</a>-->
                    </div>
                </div>
            </div>
        </div>
    </nav>
</div>

            <!--[if IE 8]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    You are using an unsupported web browser. Update to a supported browser for the best experience. <a href="/announcements/2120951">Read the announcement</a>.
                </div>
            </div>
            <![endif]-->
            <!--[if IE 9]>
            <div class="portal-messages">
                <div class="alert alert-warning alert-portal alert-w-icon">
                    <span class="icon-warning alert-icon" aria-hidden="true"></span>
                    As of March 1, 2016, the Red Hat Customer Portal will no longer support Internet Explorer 9. See our new <a href="/help/browsers">browser support policy</a> for more information.
                </div>
            </div>
            <![endif]-->
            <div id="portal-messages" class="portal-messages"><div data-dismissable="" class="alert alert-danger alert-portal alert-w-icon"><span class="icon-warning alert-icon" aria-hidden="true"></span>For more information on the Kernel Side-Channel Attack using Speculative Store Bypass - CVE-2018-3639, please refer to this <a href="https://red.ht/ssbd">Vulnerability Page</a>.<button class="dismiss-button"></button></div></div><div id="site-section"></div>
        <div class="breadcrumbs"><div id="breadcrumbs" class="container"><a href="https://access.redhat.com/products/">Products &amp; Services</a><a href="https://access.redhat.com/documentation">Product Documentation</a><a href="https://access.redhat.com/documentation/en/red-hat-enterprise-linux">Red Hat Enterprise Linux</a><a href="https://access.redhat.com/documentation/en/red-hat-enterprise-linux?version=6">6</a>Security Guide</div></div></header>
        <!--googleon: all-->

        <main id="cp-main" class="portal-content-area">
            <div id="cp-content" class="main-content">
  <script type="text/javascript">
    chrometwo_require(['jquery-ui']);
  </script>


      <article class="rh_docs">
  <div class="container">
        <!-- Display: Book Page Content -->
    
  

<div class="row">
  <div itemscope="" itemtype="https://schema.org/TechArticle" itemref="techArticle-md1 techArticle-md2 techArticle-md3"></div>
  <div itemscope="" itemtype="https://schema.org/SoftwareApplication" itemref="softwareApplication-md1 softwareApplication-md2 softwareApplication-md3 softwareApplication-md4"></div>
  


<a class="toc-toggle toc-show affix-top" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
  <span class="sr-only">Show Table of Contents</span>
  <span class="web-icon-mobile-menu" aria-hidden="true"></span>
</a>
<nav id="toc-main" class="toc-main collapse in">
  <div class="toc-menu affix-top" style="height: 1072px;">
    <a class="toc-toggle toc-hide" data-toggle="collapse" data-target="#toc-main" aria-expanded="false" aria-controls="toc-main">
      <span class="sr-only">Hide Table of Contents</span>
      <span class="icon-remove" aria-hidden="true"></span>
    </a>
    <div class="doc-options">
      <div class="doc-language btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          English <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="https://access.redhat.com/documentation/pt-br/red_hat_enterprise_linux/6/html/security_guide/">Português</a></li>
                      <li><a href="https://access.redhat.com/documentation/ja-jp/red_hat_enterprise_linux/6/html/security_guide/">日本語</a></li>
                      <li><a href="https://access.redhat.com/documentation/es-es/red_hat_enterprise_linux/6/html/security_guide/">Español</a></li>
                      <li><a href="https://access.redhat.com/documentation/de-de/red_hat_enterprise_linux/6/html/security_guide/">Deutsch</a></li>
                      <li><a href="">English</a></li>
                  </ul>
      </div>
      <div class="doc-format btn-group">
        <button type="button" class="btn btn-app dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
          Single-page HTML <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/">Multi-page HTML</a></li>
                                <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/pdf/security_guide/Red_Hat_Enterprise_Linux-6-Security_Guide-en-US.pdf">PDF</a></li>
                      <li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/epub/security_guide/Red_Hat_Enterprise_Linux-6-Security_Guide-en-US.epub">ePub</a></li>
                  </ul>
      </div>
    </div>
</nav>


  <div class="doc-wrapper">
    <div class="panel-pane pane-page-title">
  
      
  
  <h1 class="title" itemprop="name">Security Guide</h1>
  
  </div>
<div class="panel-pane pane-page-body">
  
      
  
  <div class="body"><div xml:lang="en-US" class="book" id="idm140226885337200" lang="en-US"><div class="titlepage"><div><div class="producttitle"><span class="productname">Red&nbsp;Hat Enterprise&nbsp;Linux</span> <span class="productnumber">6</span></div><div><h2 class="subtitle">A Guide to Securing Red&nbsp;Hat Enterprise&nbsp;Linux</h2></div><div><h3 class="corpauthor">
		<span class="inlinemediaobject"><object data="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/title_logo.svg" type="image/svg+xml"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/title_logo.png" alt="Logo"></object></span>

	</h3></div><div><div xml:lang="en-US" class="authorgroup" lang="en-US"><div class="author"><h3 class="author"><span class="firstname">Mirek</span> <span class="surname">Jahoda</span></h3><div class="affiliation"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div><code class="email"><a class="email" href="mailto:mjahoda@redhat.com">mjahoda@redhat.com</a></code></div><div class="author"><h3 class="author"><span class="firstname">Robert</span> <span class="surname">Krátký</span></h3><div class="affiliation"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div class="author"><h3 class="author"><span class="firstname">Martin</span> <span class="surname">Prpič</span></h3><div class="affiliation"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div class="author"><h3 class="author"><span class="firstname">Tomáš</span> <span class="surname">Čapek</span></h3><div class="affiliation"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div class="author"><h3 class="author"><span class="firstname">Stephen</span> <span class="surname">Wadeley</span></h3><div class="affiliation"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div class="author"><h3 class="author"><span class="firstname">Yoana</span> <span class="surname">Ruseva</span></h3><div class="affiliation"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div><div class="author"><h3 class="author"><span class="firstname">Miroslav</span> <span class="surname">Svoboda</span></h3><div class="affiliation"><span class="orgname">Red Hat</span> <span class="orgdiv">Customer Content Services</span></div></div></div></div><div><a href="#idm140226881085568">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
			This book assists users and administrators in learning the processes 
and practices of securing workstations and servers against local and 
remote intrusion, exploitation and malicious activity.
		</div><div class="para">
			Focused on Red&nbsp;Hat Enterprise&nbsp;Linux but detailing concepts 
and techniques valid for all Linux systems, this guide details the 
planning and the tools involved in creating a secured computing 
environment for the data center, workplace, and home.
		</div><div class="para">
			With proper administrative knowledge, vigilance, and tools, systems 
running Linux can be both fully functional and secured from most common 
intrusion and exploit methods.
		</div></div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Guide-Security_Overview" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;1.&nbsp;Security Overview</h1></div></div></div><div class="para">
		Due to the increased reliance on powerful, networked computers to help
 run businesses and keep track of our personal information, entire 
industries have been formed around the practice of network and computer 
security. Enterprises have solicited the knowledge and skills of 
security experts to properly audit systems and tailor solutions to fit 
the operating requirements of their organization. Because most 
organizations are increasingly dynamic in nature, their workers are 
accessing critical company IT resources locally and remotely, hence the 
need for secure computing environments has become more pronounced.
	</div><div class="para">
		Unfortunately, many organizations (as well as individual users) regard
 security as more of an afterthought, a process that is overlooked in 
favor of increased power, productivity, convenience, ease of use, and 
budgetary concerns. Proper security implementation is often enacted 
postmortem — <span class="emphasis"><em>after</em></span> an 
unauthorized intrusion has already occurred. Taking the correct measures
 prior to connecting a site to an untrusted network, such as the 
Internet, is an effective means of thwarting many attempts at intrusion.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			This document makes several references to files in the <code class="filename">/lib</code> directory. When using 64-bit systems, some of the files mentioned may instead be located in <code class="filename">/lib64</code>.
		</div></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Introduction_to_Security" lang="en-US"><div class="titlepage"><div><div><h2 class="title">1.1.&nbsp;Introduction to Security</h2></div></div></div><div class="section" id="sect-Security_Guide-Introduction_to_Security-What_is_Computer_Security"><div class="titlepage"><div><div><h3 class="title">1.1.1.&nbsp;What is Computer Security?</h3></div></div></div><div class="para">
			Computer security is a general term that covers a wide area of 
computing and information processing. Industries that depend on computer
 systems and networks to conduct daily business transactions and access 
critical information regard their data as an important part of their 
overall assets. Several terms and metrics have entered our daily 
business vocabulary, such as total cost of ownership (TCO), return on 
investment (ROI), and quality of service (QoS). Using these metrics, 
industries can calculate aspects such as data integrity and 
high-availability (HA) as part of their planning and process management 
costs. In some industries, such as electronic commerce, the availability
 and trustworthiness of data can mean the difference between success and
 failure.
		</div><div class="section" id="sect-Security_Guide-What_is_Computer_Security-How_did_Computer_Security_Come_about"><div class="titlepage"><div><div><h4 class="title">1.1.1.1.&nbsp;How did Computer Security come about?</h4></div></div></div><div class="para">
				Information security has evolved over the years due to the 
increasing reliance on public networks not to disclose personal, 
financial, and other restricted information. There are numerous 
instances such as the Mitnick<a href="#ftn.idm140226876137024" class="footnote"><sup class="footnote" id="idm140226876137024">[1]</sup></a> and the Vladimir Levin<a href="#ftn.idm140226876137184" class="footnote"><sup class="footnote" id="idm140226876137184">[2]</sup></a>
 cases that prompted organizations across all industries to re-think the
 way they handle information, including its transmission and disclosure.
 The popularity of the Internet was one of the most important 
developments that prompted an intensified effort in data security.
			</div><div class="para">
				An ever-growing number of people are using their personal computers 
to gain access to the resources that the Internet has to offer. From 
research and information retrieval to electronic mail and commerce 
transactions, the Internet has been regarded as one of the most 
important developments of the 20th century.
			</div><div class="para">
				The Internet and its earlier protocols, however, were developed as a <em class="firstterm">trust-based</em>
 system. That is, the Internet Protocol (IP) was not designed to be 
secure in itself. There are no approved security standards built into 
the TCP/IP communications stack, leaving it open to potentially 
malicious users and processes across the network. Modern developments 
have made Internet communication more secure, but there are still 
several incidents that gain national attention and alert us to the fact 
that nothing is completely safe.
			</div></div><div class="section" id="sect-Security_Guide-What_is_Computer_Security-Security_Today"><div class="titlepage"><div><div><h4 class="title">1.1.1.2.&nbsp;Security Today</h4></div></div></div><div class="para">
				In February of 2000, a Distributed Denial of Service (DDoS) attack 
was unleashed on several of the most heavily-trafficked sites on the 
Internet. The attack rendered yahoo.com, cnn.com, amazon.com, fbi.gov, 
and several other sites completely unreachable to normal users, as it 
tied up routers for several hours with large-byte ICMP packet transfers,
 also called a <em class="firstterm">ping flood</em>. The attack was 
brought on by unknown attackers using specially created, widely 
available programs that scanned vulnerable network servers, installed 
client applications called <em class="firstterm">Trojans</em> on the 
servers. Then they timed an attack with every infected server flooding 
the victim sites and rendering them unavailable. Many blame the attack 
on fundamental flaws in the way routers and the protocols used are 
structured to accept all incoming data, regardless of the purpose of the
 packets or where they were sent to.<em><span class="remark">will possibly be removed</span></em>

			</div><div class="para">
				In 2007, a data breach exploiting the widely-known weaknesses of the
 Wired Equivalent Privacy (WEP) wireless encryption protocol resulted in
 the theft from a global financial institution of over 45 million credit
 card numbers.
			</div><div class="para">
				Unfortunately, system and network security can be a difficult 
proposition, requiring an intricate knowledge of how an organization 
regards, uses, manipulates, and transmits its information. Understanding
 the way an organization (and the people who make up the organization) 
conducts business is paramount to implementing a proper security plan.
			</div></div><div class="section" id="sect-Security_Guide-What_is_Computer_Security-Standardizing_Security"><div class="titlepage"><div><div><h4 class="title">1.1.1.3.&nbsp;Standardizing Security</h4></div></div></div><div class="para">
				Enterprises in every industry rely on regulations and rules that are
 set by standards-making bodies such as the American Medical Association
 (AMA) or the Institute of Electrical and Electronics Engineers (IEEE). 
The same ideals hold true for information security. Many security 
consultants and vendors agree upon the standard security model known as 
CIA, or <em class="firstterm">Confidentiality, Integrity, and Availability</em>.
 This three-tiered model is a generally accepted component to assessing 
risks of sensitive information and establishing security policy. The 
following describes the CIA model in further detail:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Confidentiality — Sensitive information must be available only to a
 set of pre-defined individuals. Unauthorized transmission and usage of 
information should be restricted. For example, confidentiality of 
information ensures that a customer's personal or financial information 
is not obtained by an unauthorized individual for malicious purposes 
such as identity theft or credit fraud.
					</div></li><li class="listitem"><div class="para">
						Integrity — Information should not be altered in ways that render 
it incomplete or incorrect. Unauthorized users should be restricted from
 the ability to modify or destroy sensitive information.
					</div></li><li class="listitem"><div class="para">
						Availability — Information should be accessible to authorized 
users any time that it is needed. Availability is a warranty that 
information can be obtained with an agreed-upon frequency and 
timeliness. This is often measured in terms of percentages and agreed to
 formally in Service Level Agreements (SLAs) used by network service 
providers and their enterprise clients.
					</div></li></ul></div></div></div><div class="section" id="sect-Security_Guide-Introduction_to_Security-SELinux"><div class="titlepage"><div><div><h3 class="title">1.1.2.&nbsp;SELinux</h3></div></div></div><div class="para">
			Red&nbsp;Hat Enterprise&nbsp;Linux includes an enhancement to the 
Linux kernel called SELinux, which implements a Mandatory Access Control
 (MAC) architecture that provides a fine-grained level of control over 
files, processes, users and applications in the system. Detailed 
discussion of SELinux is beyond the scope of this document; however, for
 more information on SELinux and its use in Red&nbsp;Hat 
Enterprise&nbsp;Linux, see the <em class="citetitle"> Red&nbsp;Hat Enterprise&nbsp;Linux SELinux User Guide.</em> For more information on configuring and running services that are protected by SELinux, see the <em class="citetitle">SELinux Managing Confined Services Guide</em>. Other available resources for SELinux are listed in <a class="xref" href="#chap-Security_Guide-References">Chapter&nbsp;11, <em>References</em></a>.
		</div></div><div class="section" id="sect-Security_Guide-Introduction_to_Security-Security_Controls"><div class="titlepage"><div><div><h3 class="title">1.1.3.&nbsp;Security Controls</h3></div></div></div><div class="para">
			Computer security is often divided into three distinct master categories, commonly referred to as <em class="wordasword">controls</em>:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Physical
				</div></li><li class="listitem"><div class="para">
					Technical
				</div></li><li class="listitem"><div class="para">
					Administrative
				</div></li></ul></div><div class="para">
			These three broad categories define the main objectives of proper 
security implementation. Within these controls are sub-categories that 
further detail the controls and how to implement them.
		</div><div class="section" id="sect-Security_Guide-Security_Controls-Physical_Controls"><div class="titlepage"><div><div><h4 class="title">1.1.3.1.&nbsp;Physical Controls</h4></div></div></div><div class="para">
				Physical control is the implementation of security measures in a 
defined structure used to deter or prevent unauthorized access to 
sensitive material. Examples of physical controls are:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Closed-circuit surveillance cameras
					</div></li><li class="listitem"><div class="para">
						Motion or thermal alarm systems
					</div></li><li class="listitem"><div class="para">
						Security guards
					</div></li><li class="listitem"><div class="para">
						Picture IDs
					</div></li><li class="listitem"><div class="para">
						Locked and dead-bolted steel doors
					</div></li><li class="listitem"><div class="para">
						Biometrics (includes fingerprint, voice, face, iris, handwriting, 
and other automated methods used to recognize individuals)
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Security_Controls-Technical_Controls"><div class="titlepage"><div><div><h4 class="title">1.1.3.2.&nbsp;Technical Controls</h4></div></div></div><div class="para">
				Technical controls use technology as a basis for controlling the 
access and usage of sensitive data throughout a physical structure and 
over a network. Technical controls are far-reaching in scope and 
encompass such technologies as:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Encryption
					</div></li><li class="listitem"><div class="para">
						Smart cards
					</div></li><li class="listitem"><div class="para">
						Network authentication
					</div></li><li class="listitem"><div class="para">
						Access control lists (ACLs)
					</div></li><li class="listitem"><div class="para">
						File integrity auditing software
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Security_Controls-Administrative_Controls"><div class="titlepage"><div><div><h4 class="title">1.1.3.3.&nbsp;Administrative Controls</h4></div></div></div><div class="para">
				Administrative controls define the human factors of security. They 
involve all levels of personnel within an organization and determine 
which users have access to what resources and information by such means 
as:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Training and awareness
					</div></li><li class="listitem"><div class="para">
						Disaster preparedness and recovery plans
					</div></li><li class="listitem"><div class="para">
						Personnel recruitment and separation strategies
					</div></li><li class="listitem"><div class="para">
						Personnel registration and accounting
					</div></li></ul></div></div></div><div class="section" id="sect-Security_Guide-Introduction_to_Security-Conclusion"><div class="titlepage"><div><div><h3 class="title">1.1.4.&nbsp;Conclusion</h3></div></div></div><div class="para">
			Now that you have learned about the origins, reasons, and aspects of 
security, you will find it easier to determine the appropriate course of
 action with regard to Red&nbsp;Hat Enterprise&nbsp;Linux. It is 
important to know what factors and conditions make up security in order 
to plan and implement a proper strategy. With this information in mind, 
the process can be formalized and the path becomes clearer as you delve 
deeper into the specifics of the security process.
		</div></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Vulnerability_Assessment" lang="en-US"><div class="titlepage"><div><div><h2 class="title">1.2.&nbsp;Vulnerability Assessment</h2></div></div></div><div class="para">
		Given time, resources, and motivation, an attacker can break into 
nearly any system. All of the security procedures and technologies 
currently available cannot guarantee that any systems are completely 
safe from intrusion. Routers help secure gateways to the Internet. 
Firewalls help secure the edge of the network. Virtual Private Networks 
safely pass data in an encrypted stream. Intrusion detection systems 
warn you of malicious activity. However, the success of each of these 
technologies is dependent upon a number of variables, including:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				The expertise of the staff responsible for configuring, monitoring, and maintaining the technologies.
			</div></li><li class="listitem"><div class="para">
				The ability to patch and update services and kernels quickly and efficiently.
			</div></li><li class="listitem"><div class="para">
				The ability of those responsible to keep constant vigilance over the network.
			</div></li></ul></div><div class="para">
		Given the dynamic state of data systems and technologies, securing 
corporate resources can be quite complex. Due to this complexity, it is 
often difficult to find expert resources for all of your systems. While 
it is possible to have personnel knowledgeable in many areas of 
information security at a high level, it is difficult to retain staff 
who are experts in more than a few subject areas. This is mainly because
 each subject area of information security requires constant attention 
and focus. Information security does not stand still.
	</div><div class="section" id="sect-Security_Guide-Vulnerability_Assessment-Thinking_Like_the_Enemy"><div class="titlepage"><div><div><h3 class="title">1.2.1.&nbsp;Thinking Like the Enemy</h3></div></div></div><div class="para">
			Suppose that you administer an enterprise network. Such networks 
commonly comprise operating systems, applications, servers, network 
monitors, firewalls, intrusion detection systems, and more. Now imagine 
trying to keep current with each of those. Given the complexity of 
today's software and networking environments, exploits and bugs are a 
certainty. Keeping current with patches and updates for an entire 
network can prove to be a daunting task in a large organization with 
heterogeneous systems.
		</div><div class="para">
			Combine the expertise requirements with the task of keeping current, 
and it is inevitable that adverse incidents occur, systems are breached,
 data is corrupted, and service is interrupted.
		</div><div class="para">
			To augment security technologies and aid in protecting systems, 
networks, and data, you must think like an attacker and gauge the 
security of your systems by checking for weaknesses. Preventative 
vulnerability assessments against your own systems and network resources
 can reveal potential issues that can be addressed before an attacker 
exploits it.
		</div><div class="para">
			A vulnerability assessment is an internal audit of your network and 
system security; the results of which indicate the confidentiality, 
integrity, and availability of your network (as explained in <a class="xref" href="#sect-Security_Guide-What_is_Computer_Security-Standardizing_Security">Section&nbsp;1.1.1.3, “Standardizing Security”</a>).
 Typically, vulnerability assessment starts with a reconnaissance phase,
 during which important data regarding the target systems and resources 
is gathered. This phase leads to the system readiness phase, whereby the
 target is essentially checked for all known vulnerabilities. The 
readiness phase culminates in the reporting phase, where the findings 
are classified into categories of high, medium, and low risk; and 
methods for improving the security (or mitigating the risk of 
vulnerability) of the target are discussed.
		</div><div class="para">
			If you were to perform a vulnerability assessment of your home, you 
would likely check each door to your home to see if they are closed and 
locked. You would also check every window, making sure that they closed 
completely and latch correctly. This same concept applies to systems, 
networks, and electronic data. Malicious users are the thieves and 
vandals of your data. Focus on their tools, mentality, and motivations, 
and you can then react swiftly to their actions.
		</div></div><div class="section" id="sect-Security_Guide-Vulnerability_Assessment-Defining_Assessment_and_Testing"><div class="titlepage"><div><div><h3 class="title">1.2.2.&nbsp;Defining Assessment and Testing</h3></div></div></div><div class="para">
			Vulnerability assessments may be broken down into one of two types: <em class="firstterm">outside looking in</em> and <em class="firstterm">inside looking around</em>.
		</div><div class="para">
			When performing an outside-looking-in vulnerability assessment, you 
are attempting to compromise your systems from the outside. Being 
external to your company provides you with the attacker's viewpoint. You
 see what an attacker sees — publicly-routable IP addresses, systems on 
your <em class="firstterm">DMZ</em>, external interfaces of your 
firewall, and more. DMZ stands for "demilitarized zone", which 
corresponds to a computer or small subnetwork that sits between a 
trusted internal network, such as a corporate private LAN, and an 
untrusted external network, such as the public Internet. Typically, the 
DMZ contains devices accessible to Internet traffic, such as Web (HTTP) 
servers, FTP servers, SMTP (e-mail) servers and DNS servers.
		</div><div class="para">
			When you perform an inside-looking-around vulnerability assessment, 
you are at an advantage since you are internal and your status is 
elevated to trusted. This is the viewpoint you and your co-workers have 
once logged on to your systems. You see print servers, file servers, 
databases, and other resources.
		</div><div class="para">
			There are striking distinctions between the two types of 
vulnerability assessments. Being internal to your company gives you more
 privileges than an outsider. In most organizations, security is 
configured to keep intruders out. Very little is done to secure the 
internals of the organization (such as departmental firewalls, 
user-level access controls, and authentication procedures for internal 
resources). Typically, there are many more resources when looking around
 inside as most systems are internal to a company. Once you are outside 
the company, your status is untrusted. The systems and resources 
available to you externally are usually very limited.
		</div><div class="para">
			Consider the difference between vulnerability assessments and <em class="firstterm">penetration tests</em>.
 Think of a vulnerability assessment as the first step to a penetration 
test. The information gleaned from the assessment is used for testing. 
Whereas the assessment is undertaken to check for holes and potential 
vulnerabilities, the penetration testing actually attempts to exploit 
the findings.
		</div><div class="para">
			Assessing network infrastructure is a dynamic process. Security, both
 information and physical, is dynamic. Performing an assessment on the 
system shows an overview, which can turn up false positives and false 
negatives. A false positive is a result, where the tool finds 
vulnerabilities which in reality do not exist. A false negative is when 
it omits actual vulnerabilities.
		</div><div class="para">
			Security administrators are only as good as the tools they use and 
the knowledge they retain. Take any of the assessment tools currently 
available, run them against your system, and it is almost a guarantee 
that there are some false positives. Whether by program fault or user 
error, the result is the same. The tool may find false positives, or, 
even worse, false negatives.
		</div><div class="para">
			Now that the difference between a vulnerability assessment and a 
penetration test is defined, take the findings of the assessment and 
review them carefully before conducting a penetration test as part of 
your new best practices approach.
		</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				Do not attempt to exploit vulnerabilities on production systems. 
Doing so can have adverse effects on productivity and efficiency of your
 systems and network.
			</div></div></div><div class="para">
			The following list examines some of the benefits to performing vulnerability assessments.
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Creates proactive focus on information security.
				</div></li><li class="listitem"><div class="para">
					Finds potential exploits before attackers find them.
				</div></li><li class="listitem"><div class="para">
					Results in systems being kept up to date and patched.
				</div></li><li class="listitem"><div class="para">
					Promotes growth and aids in developing staff expertise.
				</div></li><li class="listitem"><div class="para">
					Abates financial loss and negative publicity.
				</div></li></ul></div><div class="section" id="sect-Security_Guide-Defining_Assessment_and_Testing-Establishing_a_Methodology"><div class="titlepage"><div><div><h4 class="title">1.2.2.1.&nbsp;Establishing a Methodology</h4></div></div></div><div class="para">
				To aid in the selection of tools for a vulnerability assessment, it 
is helpful to establish a vulnerability assessment methodology. 
Unfortunately, there is no predefined or industry approved methodology 
at this time; however, common sense and best practices can act as a 
sufficient guide.
			</div><div class="para">
				<span class="emphasis"><em>What is the target? Are we looking at one
 server, or are we looking at our entire network and everything within 
the network? Are we external or internal to the company?</em></span> The
 answers to these questions are important as they help determine not 
only which tools to select but also the manner in which they are used.
			</div><div class="para">
				To learn more about establishing methodologies, see the following websites:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://www.owasp.org/">http://www.owasp.org/</a> <em class="citetitle">The Open Web Application Security Project</em>
					</div></li></ul></div></div></div><div class="section" id="sect-Security_Guide-Vulnerability_Assessment-Evaluating_the_Tools"><div class="titlepage"><div><div><h3 class="title">1.2.3.&nbsp;Evaluating the Tools</h3></div></div></div><div class="para">
			An assessment can start by using some form of an information 
gathering tool. When assessing the entire network, map the layout first 
to find the hosts that are running. Once located, examine each host 
individually. Focusing on these hosts requires another set of tools. 
Knowing which tools to use may be the most crucial step in finding 
vulnerabilities.
		</div><div class="para">
			Just as in any aspect of everyday life, there are many different 
tools that perform the same job. This concept applies to performing 
vulnerability assessments as well. There are tools specific to operating
 systems, applications, and even networks (based on the protocols used).
 Some tools are free; others are not. Some tools are intuitive and easy 
to use, while others are cryptic and poorly documented but have features
 that other tools do not.
		</div><div class="para">
			Finding the right tools may be a daunting task and in the end, 
experience counts. If possible, set up a test lab and try out as many 
tools as you can, noting the strengths and weaknesses of each. Read 
documentation that comes with the tool (for example, in a README file or
 a manual page). For more information, search articles, step-by-step 
guides, or even mailing lists specific to a tool on the Internet.
		</div><div class="para">
			The tools discussed below are just a small sampling of the available tools.
		</div><div class="section" id="sect-Security_Guide-Evaluating_the_Tools-Scanning_Hosts_with_Nmap"><div class="titlepage"><div><div><h4 class="title">1.2.3.1.&nbsp;Scanning Hosts with Nmap</h4></div></div></div><div class="para">
				Nmap is a popular tool that can be used to determine the layout of a
 network. Nmap has been available for many years and is probably the 
most often used tool when gathering information. An excellent manual 
page is included that provides detailed descriptions of its options and 
usage. Administrators can use Nmap on a network to find host systems and
 open ports on those systems.
			</div><div class="para">
				Nmap is a competent first step in vulnerability assessment. You can 
map out all the hosts within your network and even pass an option that 
allows Nmap to attempt to identify the operating system running on a 
particular host. Nmap is a good foundation for establishing a policy of 
using secure services and restricting unused services.
			</div><div class="para">
				To install Nmap, run the <code class="command">yum install nmap</code> command as the root user.
			</div><div class="section" id="sect-Security_Guide-Scanning_Hosts_with_Nmap-Using_Nmap"><div class="titlepage"><div><div><h5 class="title">1.2.3.1.1.&nbsp;Using Nmap</h5></div></div></div><div class="para">
					Nmap can be run from a shell prompt by typing the <code class="command">nmap</code> command followed by the host name or IP address of the machine to scan:
				</div><pre class="synopsis"><code class="command">nmap</code> <em class="replaceable">&lt;host name&gt;</em></pre><div class="para">
					For example, to scan a machine with host name <code class="systemitem">foo.example.com</code>, type the following at a shell prompt:
				</div><pre class="screen">~]$ <code class="command">nmap foo.example.com</code></pre><div class="para">
					The results of a basic scan (which could take up to a few minutes, 
depending on where the host is located and other network conditions) 
look similar to the following:
				</div><pre class="screen">Interesting ports on foo.example.com:
Not shown: 1710 filtered ports
PORT    STATE  SERVICE
22/tcp  open   ssh
53/tcp  open   domain
80/tcp  open   http
113/tcp closed auth</pre><div class="para">
					Nmap tests the most common network communication ports for 
listening or waiting services. This knowledge can be helpful to an 
administrator who wants to close down unnecessary or unused services.
				</div><div class="para">
					For more information about using Nmap, see the official homepage at the following URL:
				</div><div class="para">
					<a href="http://www.insecure.org/">http://www.insecure.org/</a>
				</div></div></div><div class="section" id="sect-Security_Guide-Evaluating_the_Tools-Nessus"><div class="titlepage"><div><div><h4 class="title">1.2.3.2.&nbsp;Nessus</h4></div></div></div><div class="para">
				Nessus is a full-service security scanner. The plug-in architecture 
of Nessus allows users to customize it for their systems and networks. 
As with any scanner, Nessus is only as good as the signature database it
 relies upon. Fortunately, Nessus is frequently updated and features 
full reporting, host scanning, and real-time vulnerability searches. 
Remember that there could be false positives and false negatives, even 
in a tool as powerful and as frequently updated as Nessus.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The Nessus client and server software requires a subscription to 
use. It has been included in this document as a reference to users who 
may be interested in using this popular application.
				</div></div></div><div class="para">
				For more information about Nessus, see the official website at the following URL:
			</div><div class="para">
				<a href="http://www.nessus.org/">http://www.nessus.org/</a>
			</div></div><div class="section" id="sect-Security_Guide-Evaluating_the_Tools-Nikto"><div class="titlepage"><div><div><h4 class="title">1.2.3.3.&nbsp;Nikto</h4></div></div></div><div class="para">
				Nikto is an excellent common gateway interface (CGI) script scanner.
 Nikto not only checks for CGI vulnerabilities but does so in an evasive
 manner, so as to elude intrusion detection systems. It comes with 
thorough documentation which should be carefully reviewed prior to 
running the program. If you have Web servers serving up CGI scripts, 
Nikto can be an excellent resource for checking the security of these 
servers.
			</div><div class="para">
				More information about Nikto can be found at the following URL:
			</div><div class="para">
				<a href="http://cirt.net/nikto2">http://cirt.net/nikto2</a>
			</div></div><div class="section" id="sect-Security_Guide-Evaluating_the_Tools-Anticipating_Your_Future_Needs"><div class="titlepage"><div><div><h4 class="title">1.2.3.4.&nbsp;Anticipating Your Future Needs</h4></div></div></div><div class="para">
				Depending upon your target and resources, there are many tools 
available. There are tools for wireless networks, Novell networks, 
Windows systems, Linux systems, and more. Another essential part of 
performing assessments may include reviewing physical security, 
personnel screening, or voice/PBX network assessment. Concepts such as <em class="firstterm">war walking</em> and <em class="firstterm">wardriving</em>,
 which involves scanning the perimeter of your enterprise's physical 
structures for wireless network vulnerabilities, are some concepts that 
you should investigate and, if needed, incorporate into your 
assessments. Imagination and exposure are the only limits of planning 
and conducting vulnerability assessments.
			</div></div></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Security_Threats" lang="en-US"><div class="titlepage"><div><div><h2 class="title">1.3.&nbsp;Security Threats</h2></div></div></div><div class="para">
		To plan and implement a good security strategy, first be aware of some
 of the issues which determined, motivated attackers exploit to 
compromise systems.
	</div><div class="section" id="sect-Security_Guide-Attackers_and_Vulnerabilities-Threats_to_Network_Security"><div class="titlepage"><div><div><h3 class="title">1.3.1.&nbsp;Threats to Network Security</h3></div></div></div><div class="para">
			Bad practices when configuring the following aspects of a network can increase the risk of attack.
		</div><div class="section" id="sect-Security_Guide-Threats_to_Network_Security-Insecure_Architectures"><div class="titlepage"><div><div><h4 class="title">1.3.1.1.&nbsp;Insecure Architectures</h4></div></div></div><div class="para">
				A misconfigured network is a primary entry point for unauthorized 
users. Leaving a trust-based, open local network vulnerable to the 
highly-insecure Internet is much like leaving a door ajar in a 
crime-ridden neighborhood — nothing may happen for an arbitrary amount 
of time, but <span class="emphasis"><em>eventually</em></span> someone exploits the opportunity.
			</div><div class="section" id="sect-Security_Guide-Insecure_Architectures-Broadcast_Networks"><div class="titlepage"><div><div><h5 class="title">1.3.1.1.1.&nbsp;Broadcast Networks</h5></div></div></div><div class="para">
					System administrators often fail to realize the importance of 
networking hardware in their security schemes. Simple hardware such as 
hubs and routers rely on the broadcast or non-switched principle; that 
is, whenever a node transmits data across the network to a recipient 
node, the hub or router sends a broadcast of the data packets until the 
recipient node receives and processes the data. This method is the most 
vulnerable to address resolution protocol (<em class="firstterm">ARP</em>) or media access control (<em class="firstterm">MAC</em>) address spoofing by both outside intruders and unauthorized users on local hosts.
				</div></div><div class="section" id="sect-Security_Guide-Insecure_Architectures-Centralized_Servers"><div class="titlepage"><div><div><h5 class="title">1.3.1.1.2.&nbsp;Centralized Servers</h5></div></div></div><div class="para">
					Another potential networking pitfall is the use of centralized 
computing. A common cost-cutting measure for many businesses is to 
consolidate all services to a single powerful machine. This can be 
convenient as it is easier to manage and costs considerably less than 
multiple-server configurations. However, a centralized server introduces
 a single point of failure on the network. If the central server is 
compromised, it may render the network completely useless or worse, 
prone to data manipulation or theft. In these situations, a central 
server becomes an open door which allows access to the entire network.
				</div></div></div></div><div class="section" id="sect-Security_Guide-Attackers_and_Vulnerabilities-Threats_to_Server_Security"><div class="titlepage"><div><div><h3 class="title">1.3.2.&nbsp;Threats to Server Security</h3></div></div></div><div class="para">
			Server security is as important as network security because servers 
often hold a great deal of an organization's vital information. If a 
server is compromised, all of its contents may become available for the 
attacker to steal or manipulate at will. The following sections detail 
some of the main issues.
		</div><div class="section" id="sect-Security_Guide-Threats_to_Server_Security-Unused_Services_and_Open_Ports"><div class="titlepage"><div><div><h4 class="title">1.3.2.1.&nbsp;Unused Services and Open Ports</h4></div></div></div><div class="para">
				A full installation of Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;7 
contains 1000+ application and library packages. However, most server 
administrators do not opt to install every single package in the 
distribution, preferring instead to install a base installation of 
packages, including several server applications.
			</div><div class="para">
				A common occurrence among system administrators is to install the 
operating system without paying attention to what programs are actually 
being installed. This can be problematic because unneeded services may 
be installed, configured with the default settings, and possibly turned 
on. This can cause unwanted services, such as Telnet, DHCP, or DNS, to 
run on a server or workstation without the administrator realizing it, 
which in turn can cause unwanted traffic to the server, or even, a 
potential pathway into the system for attackers. Refer To <a class="xref" href="#sect-Security_Guide-Server_Security">Section&nbsp;2.2, “Server Security”</a> for information on closing ports and disabling unused services.
			</div></div><div class="section" id="sect-Security_Guide-Threats_to_Server_Security-Inattentive_Administration"><div class="titlepage"><div><div><h4 class="title">1.3.2.2.&nbsp;Inattentive Administration</h4></div></div></div><div class="para">
				Administrators who fail to patch their systems are one of the greatest threats to server security. According to the <em class="firstterm">SysAdmin, Audit, Network, Security Institute</em> (<em class="firstterm">SANS</em>),
 the primary cause of computer security vulnerability is to "assign 
untrained people to maintain security and provide neither the training 
nor the time to make it possible to do the job. This applies as much to 
inexperienced administrators as it does to overconfident or amotivated 
administrators.
			</div><div class="para">
				Some administrators fail to patch their servers and workstations, 
while others fail to watch log messages from the system kernel or 
network traffic. Another common error is when default passwords or keys 
to services are left unchanged. For example, some databases have default
 administration passwords because the database developers assume that 
the system administrator changes these passwords immediately after 
installation. If a database administrator fails to change this password,
 even an inexperienced attacker can use a widely-known default password 
to gain administrative privileges to the database. These are only a few 
examples of how inattentive administration can lead to compromised 
servers.
			</div></div><div class="section" id="sect-Security_Guide-Threats_to_Server_Security-Inherently_Insecure_Services"><div class="titlepage"><div><div><h4 class="title">1.3.2.3.&nbsp;Inherently Insecure Services</h4></div></div></div><div class="para">
				Even the most vigilant organization can fall victim to 
vulnerabilities if the network services they choose are inherently 
insecure. For instance, there are many services developed under the 
assumption that they are used over trusted networks; however, this 
assumption fails as soon as the service becomes available over the 
Internet — which is itself inherently untrusted.
			</div><div class="para">
				One category of insecure network services are those that require 
unencrypted user names and passwords for authentication. Telnet and FTP 
are two such services. If packet sniffing software is monitoring traffic
 between the remote user and such a service user names and passwords can
 be easily intercepted.
			</div><div class="para">
				Inherently, such services can also more easily fall prey to what the security industry terms the <em class="firstterm">man-in-the-middle</em>
 attack. In this type of attack, an attacker redirects network traffic 
by tricking a cracked name server on the network to point to his machine
 instead of the intended server. Once someone opens a remote session to 
the server, the attacker's machine acts as an invisible conduit, sitting
 quietly between the remote service and the unsuspecting user capturing 
information. In this way an attacker can gather administrative passwords
 and raw data without the server or the user realizing it.
			</div><div class="para">
				Another category of insecure services include network file systems 
and information services such as NFS or NIS, which are developed 
explicitly for LAN usage but are, unfortunately, extended to include 
WANs (for remote users). NFS does not, by default, have any 
authentication or security mechanisms configured to prevent an attacker 
from mounting the NFS share and accessing anything contained therein. 
NIS, as well, has vital information that must be known by every computer
 on a network, including passwords and file permissions, within a plain 
text ASCII or DBM (ASCII-derived) database. An attacker who gains access
 to this database can then access every user account on a network, 
including the administrator's account.
			</div><div class="para">
				By default, Red&nbsp;Hat Enterprise&nbsp;Linux is released with all 
such services turned off. However, since administrators often find 
themselves forced to use these services, careful configuration is 
critical. Refer to <a class="xref" href="#sect-Security_Guide-Server_Security">Section&nbsp;2.2, “Server Security”</a> for more information about setting up services in a safe manner.
			</div></div></div><div class="section" id="sect-Security_Guide-Attackers_and_Vulnerabilities-Threats_to_Workstation_and_Home_PC_Security"><div class="titlepage"><div><div><h3 class="title">1.3.3.&nbsp;Threats to Workstation and Home PC Security</h3></div></div></div><div class="para">
			Workstations and home PCs may not be as prone to attack as networks 
or servers, but since they often contain sensitive data, such as credit 
card information, they are targeted by system attackers. Workstations 
can also be co-opted without the user's knowledge and used by attackers 
as "slave" machines in coordinated attacks. For these reasons, knowing 
the vulnerabilities of a workstation can save users the headache of 
reinstalling the operating system, or worse, recovering from data theft.
		</div><div class="section" id="sect-Security_Guide-Threats_to_Workstation_and_Home_PC_Security-Bad_Passwords"><div class="titlepage"><div><div><h4 class="title">1.3.3.1.&nbsp;Bad Passwords</h4></div></div></div><div class="para">
				Bad passwords are one of the easiest ways for an attacker to gain 
access to a system. For more on how to avoid common pitfalls when 
creating a password, see <a class="xref" href="#sect-Security_Guide-Workstation_Security-Password_Security">Section&nbsp;2.1.3, “Password Security”</a>.
			</div></div><div class="section" id="sect-Security_Guide-Threats_to_Workstation_and_Home_PC_Security-Vulnerable_Client_Applications"><div class="titlepage"><div><div><h4 class="title">1.3.3.2.&nbsp;Vulnerable Client Applications</h4></div></div></div><div class="para">
				Although an administrator may have a fully secure and patched 
server, that does not mean remote users are secure when accessing it. 
For instance, if the server offers Telnet or FTP services over a public 
network, an attacker can capture the plain text user names and passwords
 as they pass over the network, and then use the account information to 
access the remote user's workstation.
			</div><div class="para">
				Even when using secure protocols, such as SSH, a remote user may be 
vulnerable to certain attacks if they do not keep their client 
applications updated. For instance, v.1 SSH clients are vulnerable to an
 X-forwarding attack from malicious SSH servers. Once connected to the 
server, the attacker can quietly capture any keystrokes and mouse clicks
 made by the client over the network. This problem was fixed in the v.2 
SSH protocol, but it is up to the user to keep track of what 
applications have such vulnerabilities and update them as necessary.
			</div><div class="para">
				<a class="xref" href="#sect-Security_Guide-Workstation_Security">Section&nbsp;2.1, “Workstation Security”</a>
 discusses in more detail what steps administrators and home users 
should take to limit the vulnerability of computer workstations.
			</div></div></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Common_Exploits_and_Attacks" lang="en-US"><div class="titlepage"><div><div><h2 class="title">1.4.&nbsp;Common Exploits and Attacks</h2></div></div></div><div class="para">
		<a class="xref" href="#tabl-Security_Guide-Common_Exploits_and_Attacks-Common_Exploits">Table&nbsp;1.1, “Common Exploits”</a>
 details some of the most common exploits and entry points used by 
intruders to access organizational network resources. Key to these 
common exploits are the explanations of how they are performed and how 
administrators can properly safeguard their network against such 
attacks.
	</div><div class="table" id="tabl-Security_Guide-Common_Exploits_and_Attacks-Common_Exploits"><p class="title"><strong>Table&nbsp;1.1.&nbsp;Common Exploits</strong></p><div class="table-contents"><table class="lt-4-cols gt-7-rows" summary="Common Exploits"><colgroup><col class="Exploit" width="20%"><!--Empty--><col class="Description" width="40%"><!--Empty--><col class="Notes" width="40%"><!--Empty--></colgroup><thead><tr><th id="idm140226878037488" scope="col"> Exploit </th><th id="idm140226878037008" scope="col"> Description </th><th id="idm140226878036528" scope="col"> Notes </th></tr></thead><tbody><tr><td headers="idm140226878037488"> Null or Default Passwords </td><td headers="idm140226878037008">
 Leaving administrative passwords blank or using a default password set 
by the product vendor. This is most common in hardware such as routers 
and firewalls, but some services that run on Linux can contain default 
administrator passwords as well (though Red&nbsp;Hat 
Enterprise&nbsp;Linux does not ship with them). </td><td headers="idm140226878036528"> <div class="para">
						Commonly associated with networking hardware such as routers, 
firewalls, VPNs, and network attached storage (NAS) appliances.
					</div>
					 Common in many legacy operating systems, especially those that bundle services (such as UNIX and Windows.) 
					<div class="para">
						Administrators sometimes create privileged user accounts in a rush
 and leave the password null, creating a perfect entry point for 
malicious users who discover the account.
					</div>
					 </td></tr><tr><td headers="idm140226878037488"> Default Shared Keys </td><td headers="idm140226878037008">
 Secure services sometimes package default security keys for development
 or evaluation testing purposes. If these keys are left unchanged and 
are placed in a production environment on the Internet, <span class="emphasis"><em>all</em></span> users with the same default keys have access to that shared-key resource, and any sensitive information that it contains. </td><td headers="idm140226878036528"> Most common in wireless access points and preconfigured secure server appliances. </td></tr><tr><td headers="idm140226878037488"> IP Spoofing </td><td headers="idm140226878037008">
 A remote machine acts as a node on your local network, finds 
vulnerabilities with your servers, and installs a backdoor program or 
Trojan horse to gain control over your network resources. </td><td headers="idm140226878036528"> <div class="para">
						Spoofing is quite difficult as it involves the attacker predicting
 TCP/IP sequence numbers to coordinate a connection to target systems, 
but several tools are available to assist attackers in performing such a
 vulnerability.
					</div>
					 <div class="para">
						Depends on target system running services (such as <code class="command">rsh</code>, <code class="command">telnet</code>, FTP and others) that use <em class="firstterm">source-based</em> authentication techniques, which are not recommended when compared to PKI or other forms of encrypted authentication used in <code class="command">ssh</code> or SSL/TLS.
					</div>
					 </td></tr><tr><td headers="idm140226878037488"> Eavesdropping </td><td headers="idm140226878037008"> Collecting data that passes between two active nodes on a network by eavesdropping on the connection between the two nodes. </td><td headers="idm140226878036528"> <div class="para">
						This type of attack works mostly with plain text transmission protocols such as Telnet, FTP, and HTTP transfers.
					</div>
					 <div class="para">
						Remote attacker must have access to a compromised system on a LAN 
in order to perform such an attack; usually the attacker has used an 
active attack (such as IP spoofing or man-in-the-middle) to compromise a
 system on the LAN.
					</div>
					 <div class="para">
						Preventative measures include services with cryptographic key 
exchange, one-time passwords, or encrypted authentication to prevent 
password snooping; strong encryption during transmission is also 
advised.
					</div>
					 </td></tr><tr><td headers="idm140226878037488"> Service Vulnerabilities </td><td headers="idm140226878037008">
 An attacker finds a flaw or loophole in a service run over the 
Internet; through this vulnerability, the attacker compromises the 
entire system and any data that it may hold, and could possibly 
compromise other systems on the network. </td><td headers="idm140226878036528"> <div class="para">
						HTTP-based services such as CGI are vulnerable to remote command 
execution and even interactive shell access. Even if the HTTP service 
runs as a non-privileged user such as "nobody", information such as 
configuration files and network maps can be read, or the attacker can 
start a denial of service attack which drains system resources or 
renders it unavailable to other users.
					</div>
					 <div class="para">
						Services sometimes can have vulnerabilities that go unnoticed 
during development and testing; these vulnerabilities (such as <em class="firstterm">buffer overflows</em>,
 where attackers crash a service using arbitrary values that fill the 
memory buffer of an application, giving the attacker an interactive 
command prompt from which they may execute arbitrary commands) can give 
complete administrative control to an attacker.
					</div>
					 <div class="para">
						Administrators should make sure that services do not run as the 
root user, and should stay vigilant of patches and errata updates for 
applications from vendors or security organizations such as CERT and 
CVE.
					</div>
					 </td></tr><tr><td headers="idm140226878037488"> Application Vulnerabilities </td><td headers="idm140226878037008">
 Attackers find faults in desktop and workstation applications (such as 
e-mail clients) and execute arbitrary code, implant Trojan horses for 
future compromise, or crash systems. Further exploitation can occur if 
the compromised workstation has administrative privileges on the rest of
 the network. </td><td headers="idm140226878036528"> <div class="para">
						Workstations and desktops are more prone to exploitation as 
workers do not have the expertise or experience to prevent or detect a 
compromise; it is imperative to inform individuals of the risks they are
 taking when they install unauthorized software or open unsolicited 
email attachments.
					</div>
					 <div class="para">
						Safeguards can be implemented such that email client software does
 not automatically open or execute attachments. Additionally, the 
automatic update of workstation software using Red&nbsp;Hat Network or 
other system management services can alleviate the burdens of multi-seat
 security deployments.
					</div>
					 </td></tr><tr><td headers="idm140226878037488"> Denial of Service (DoS) Attacks </td><td headers="idm140226878037008">
 Attacker or group of attackers coordinate against an organization's 
network or server resources by sending unauthorized packets to the 
target host (either server, router, or workstation). This forces the 
resource to become unavailable to legitimate users. </td><td headers="idm140226878036528"> <div class="para">
						Source packets are usually forged (as well as rebroadcast), making
 investigation as to the true source of the attack difficult.
					</div>
					 <div class="para">
						Advances in ingress filtering (IETF rfc2267) using <code class="command">iptables</code> and Network Intrusion Detection Systems such as <code class="command">snort</code> assist administrators in tracking down and preventing distributed DoS attacks.
					</div>
					 </td></tr></tbody></table></div></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Security_Updates" lang="en-US"><div class="titlepage"><div><div><h2 class="title">1.5.&nbsp;Security Updates</h2></div></div></div><div class="para">
		As security vulnerabilities are discovered, the affected software must
 be updated in order to limit any potential security risks. If the 
software is part of a package within a Red&nbsp;Hat 
Enterprise&nbsp;Linux distribution that is currently supported, 
Red&nbsp;Hat is committed to releasing updated packages that fix the 
vulnerability as soon as is possible. Often, announcements about a given
 security exploit are accompanied with a patch (or source code that 
fixes the problem). This patch is then applied to the Red&nbsp;Hat 
Enterprise&nbsp;Linux package and tested and released as an errata 
update. However, if an announcement does not include a patch, a 
developer first works with the maintainer of the software to fix the 
problem. Once the problem is fixed, the package is tested and released 
as an errata update.
	</div><div class="para">
		If an errata update is released for software used on your system, it 
is highly recommended that you update the affected packages as soon as 
possible to minimize the amount of time the system is potentially 
vulnerable.
	</div><div class="section" id="sect-Security_Guide-Security_Updates-Updating_Packages"><div class="titlepage"><div><div><h3 class="title">1.5.1.&nbsp;Updating Packages</h3></div></div></div><div class="para">
			When updating software on a system, it is important to download the 
update from a trusted source. An attacker can easily rebuild a package 
with the same version number as the one that is supposed to fix the 
problem but with a different security exploit and release it on the 
Internet. If this happens, using security measures such as verifying 
files against the original RPM does not detect the exploit. Thus, it is 
very important to only download RPMs from trusted sources, such as from 
Red&nbsp;Hat and to check the signature of the package to verify its 
integrity.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Red&nbsp;Hat Enterprise&nbsp;Linux includes a convenient panel icon 
that displays visible alerts when there is an update available.
			</div></div></div></div><div class="section" id="sect-Security_Guide-Updating_Packages-Verifying_Signed_Packages"><div class="titlepage"><div><div><h3 class="title">1.5.2.&nbsp;Verifying Signed Packages</h3></div></div></div><div class="para">
			All Red&nbsp;Hat Enterprise&nbsp;Linux packages are signed with the Red&nbsp;Hat <em class="firstterm">GPG</em>
 key. GPG stands for GNU Privacy Guard, or GnuPG, a free software 
package used for ensuring the authenticity of distributed files. For 
example, a private key (secret key) locks the package while the public 
key unlocks and verifies the package. If the public key distributed by 
Red&nbsp;Hat Enterprise&nbsp;Linux does not match the private key during
 RPM verification, the package may have been altered and therefore 
cannot be trusted.
		</div><div class="para">
			The RPM utility within Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 
automatically tries to verify the GPG signature of an RPM package before
 installing it. If the Red&nbsp;Hat GPG key is not installed, install it
 from a secure, static location, such as a Red&nbsp;Hat installation 
CD-ROM or DVD.
		</div><div class="para">
			Assuming the disc is mounted in <code class="filename">/mnt/cdrom</code>, use the following command as the root user to import it into the <em class="firstterm">keyring</em> (a database of trusted keys on the system):
		</div><pre class="screen">~]# <code class="command">rpm --import /mnt/cdrom/RPM-GPG-KEY</code></pre><div class="para">
			Now, the Red&nbsp;Hat GPG key is located in the <code class="filename">/etc/pki/rpm-gpg/</code> directory.
		</div><div class="para">
			To display a list of all keys installed for RPM verification, execute the following command:
		</div><pre class="screen">~]# <code class="command">rpm -qa gpg-pubkey*</code>
gpg-pubkey-db42a60e-37ea5438</pre><div class="para">
			To display details about a specific key, use the <code class="command">rpm -qi</code> command followed by the output from the previous command, as in this example:
		</div><pre class="screen">~]# <code class="command">rpm -qi gpg-pubkey-db42a60e-37ea5438</code>
Name        : gpg-pubkey                   Relocations: (not relocatable)
Version     : 2fa658e0                          Vendor: (none)
Release     : 45700c69                      Build Date: Fri 07 Oct 2011 02:04:51 PM CEST
Install Date: Fri 07 Oct 2011 02:04:51 PM CEST      Build Host: localhost
Group       : Public Keys                   Source RPM: (none)
<em class="lineannotation"><span class="lineannotation">[output truncated]</span></em></pre><div class="para">
			It is extremely important to verify the signature of the RPM files 
before installing them to ensure that they have not been altered from 
the original source of the packages. To verify all the downloaded 
packages at once, issue the following command:
		</div><pre class="screen">~]# <code class="command">rpm -K /root/updates/*.rpm</code>
alsa-lib-1.0.22-3.el6.x86_64.rpm: rsa sha1 (md5) pgp md5 OK
alsa-utils-1.0.21-3.el6.x86_64.rpm: rsa sha1 (md5) pgp md5 OK
aspell-0.60.6-12.el6.x86_64.rpm: rsa sha1 (md5) pgp md5 OK</pre><div class="para">
			For each package, if the GPG key verifies successfully, the command returns <code class="computeroutput">gpg OK</code>.
 If it does not, make sure you are using the correct Red&nbsp;Hat public
 key, as well as verifying the source of the content. Packages that do 
not pass GPG verification should not be installed, as they may have been
 altered by a third party.
		</div><div class="para">
			After verifying the GPG key and downloading all the packages 
associated with the errata report, install the packages as root at a 
shell prompt.
		</div><div class="para">
			Alternatively, you may use the Yum utility to verify signed packages.
 Yum provides secure package management by enabling GPG signature 
verification on GPG-signed packages to be turned on for all package 
repositories (that is, package sources), or for individual repositories.
 When signature verification is enabled, Yum will refuse to install any 
packages not GPG-signed with the correct key for that repository. This 
means that you can trust that the RPM packages you download and install 
on your system are from a trusted source, such as Red&nbsp;Hat, and were
 not modified during transfer.
		</div><div class="para">
			In order to have automatic GPG signature verification enabled when 
installing or updating packages via Yum, ensure you have the following 
option defined under the <code class="literal">[main]</code> section of your <code class="filename">/etc/yum.conf</code> file:
		</div><pre class="screen">gpgcheck=1
</pre></div><div class="section" id="sect-Security_Guide-Updating_Packages-Installing_Signed_Packages"><div class="titlepage"><div><div><h3 class="title">1.5.3.&nbsp;Installing Signed Packages</h3></div></div></div><div class="para">
			Installation for most packages can be done safely (except kernel packages) by issuing the following command as root:
		</div><pre class="synopsis"><code class="command">rpm</code> <code class="option">-Uvh</code> <em class="replaceable">&lt;package&gt;</em>…</pre><div class="para">
			For example, to install all packages in a new directory, called <code class="filename">updates/</code>, under the <code class="filename">/tmp</code> directory, run:
		</div><pre class="screen">~]# <code class="command">rpm -Uvh /tmp/updates/*.rpm</code>
Preparing...                ########################################### [100%]
   1:alsa-lib               ########################################### [ 33%]
   2:alsa-utils             ########################################### [ 67%]
   3:aspell                 ########################################### [100%]</pre><div class="para">
			For kernel packages, as root use the command in the following form:
		</div><pre class="synopsis"><code class="command">rpm</code> <code class="option">-ivh</code> <em class="replaceable">&lt;kernel-package&gt;</em></pre><div class="para">
			For example, to install <span class="package">kernel-2.6.32-220.el6.x86_64.rpm</span>, type the following at a shell prompt:
		</div><pre class="screen">~]# <code class="command">rpm -ivh /tmp/updates/kernel-2.6.32-220.el6.x86_64.rpm</code>
Preparing...                ########################################### [100%]
   1:kernel                 ########################################### [100%]</pre><div class="para">
			Once the machine has been safely rebooted using the new kernel, the old kernel may be removed using the following command:
		</div><pre class="synopsis"><code class="command">rpm</code> <code class="option">-e</code> <em class="replaceable">&lt;old-kernel-package&gt;</em></pre><div class="para">
			For instance, to remove <span class="package">kernel-2.6.32-206.el6.x86_64</span>, type:
		</div><pre class="screen">~]# <code class="command">rpm -e kernel-2.6.32-206.el6.x86_64</code></pre><div class="para">
			Alternatively, to install packages with Yum, run, as root, the following command:
		</div><pre class="screen">~]#&nbsp;<code class="command">yum install kernel-2.6.32-220.el6.x86_64.rpm</code></pre><div class="para">
			To install local packages with Yum, run, as root, the following command:
		</div><pre class="screen">~]#&nbsp;<code class="command">yum localinstall /root/updates/emacs-23.1-21.el6_2.3.x86_64.rpm</code></pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				It is not a requirement that the old kernel be removed. The default 
boot loader, GRUB, allows for multiple kernels to be installed, then 
chosen from a menu at boot time.
			</div></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				Before installing any security errata, be sure to read any special 
instructions contained in the errata report and execute them 
accordingly. Refer to <a class="xref" href="#sect-Security_Guide-Updating_Packages-Applying_the_Changes">Section&nbsp;1.5.4, “Applying the Changes”</a> for general instructions about applying the changes made by an errata update.
			</div></div></div></div><div class="section" id="sect-Security_Guide-Updating_Packages-Applying_the_Changes"><div class="titlepage"><div><div><h3 class="title">1.5.4.&nbsp;Applying the Changes</h3></div></div></div><div class="para">
			After downloading and installing security errata and updates, it is 
important to halt usage of the older software and begin using the new 
software. How this is done depends on the type of software that has been
 updated. The following list itemizes the general categories of software
 and provides instructions for using the updated versions after a 
package upgrade.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				In general, rebooting the system is the surest way to ensure that 
the latest version of a software package is used; however, this option 
is not always required, or available to the system administrator.
			</div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Applications</span></dt><dd><div class="para">
						User-space applications are any programs that can be initiated by a
 system user. Typically, such applications are used only when a user, 
script, or automated task utility launches them and they do not persist 
for long periods of time.
					</div><div class="para">
						Once such a user-space application is updated, halt any instances 
of the application on the system and launch the program again to use the
 updated version.
					</div></dd><dt><span class="term">Kernel</span></dt><dd><div class="para">
						The kernel is the core software component for the Red&nbsp;Hat 
Enterprise&nbsp;Linux operating system. It manages access to memory, the
 processor, and peripherals as well as schedules all tasks.
					</div><div class="para">
						Because of its central role, the kernel cannot be restarted 
without also stopping the computer. Therefore, an updated version of the
 kernel cannot be used until the system is rebooted.
					</div></dd><dt><span class="term">Shared Libraries</span></dt><dd><div class="para">
						Shared libraries are units of code, such as <code class="filename">glibc</code>,
 which are used by a number of applications and services. Applications 
utilizing a shared library typically load the shared code when the 
application is initialized, so any applications using the updated 
library must be halted and relaunched.
					</div><div class="para">
						To determine which running applications link against a particular library, use the <code class="command">lsof</code> command:
					</div><pre class="synopsis"><code class="command">lsof</code> <em class="replaceable">&lt;path&gt;</em></pre><div class="para">
						For example, to determine which running applications link against the <code class="filename">libwrap.so</code> library, type:
					</div><pre class="screen">~]# <code class="command">lsof /lib64/libwrap.so*</code>
COMMAND     PID      USER  FD   TYPE DEVICE SIZE/OFF   NODE NAME
sshd      13600 root mem    REG  253,0    43256 400501 /lib64/libwrap.so.0.7.6
sshd      13603 juan mem    REG  253,0    43256 400501 /lib64/libwrap.so.0.7.6
gnome-set 14898 juan mem    REG  253,0    43256 400501 /lib64/libwrap.so.0.7.6
metacity  14925 juan mem    REG  253,0    43256 400501 /lib64/libwrap.so.0.7.6
<em class="lineannotation"><span class="lineannotation">[output truncated]</span></em></pre><div class="para">
						This command returns a list of all the running programs which use 
TCP wrappers for host access control. Therefore, any program listed must
 be halted and relaunched if the <code class="filename">tcp_wrappers</code> package is updated.
					</div></dd><dt><span class="term">SysV Services</span></dt><dd><div class="para">
						SysV services are persistent server programs launched during the boot process. Examples of SysV services include <code class="command">sshd</code>, <code class="command">vsftpd</code>, and <code class="command">xinetd</code>.
					</div><div class="para">
						Because these programs usually persist in memory as long as the 
machine is booted, each updated SysV service must be halted and 
relaunched after the package is upgraded. This can be done using the <span class="application"><strong>Services Configuration Tool</strong></span> or by logging into a root shell prompt and issuing the <code class="command">/sbin/service</code> command:
					</div><pre class="synopsis"><code class="command">/sbin/service</code> <em class="replaceable">&lt;service-name&gt;</em> <code class="option">restart</code></pre><div class="para">
						Replace <em class="replaceable">&lt;service-name&gt;</em> with the name of the service, such as <code class="command">sshd</code>.
					</div></dd><dt><span class="term"><code class="command">xinetd</code> Services</span></dt><dd><div class="para">
						Services controlled by the <code class="command">xinetd</code> super service only run when a there is an active connection. Examples of services controlled by <code class="command">xinetd</code> include Telnet, IMAP, and POP3.
					</div><div class="para">
						Because new instances of these services are launched by <code class="command">xinetd</code>
 each time a new request is received, connections that occur after an 
upgrade are handled by the updated software. However, if there are 
active connections at the time the <code class="command">xinetd</code> controlled service is upgraded, they are serviced by the older version of the software.
					</div><div class="para">
						To kill off older instances of a particular <code class="command">xinetd</code>
 controlled service, upgrade the package for the service then halt all 
processes currently running. To determine if the process is running, use
 the <code class="command">ps</code> or <code class="command">pgrep</code> command and then use the <code class="command">kill</code> or <code class="command">killall</code> command to halt current instances of the service.
					</div><div class="para">
						For example, if security errata <code class="filename">imap</code> packages are released, upgrade the packages, then type the following command as root into a shell prompt:
					</div><pre class="screen">~]# <code class="command">pgrep -l imap</code>
1439 imapd
1788 imapd
1793 imapd</pre><div class="para">
						This command returns all active IMAP sessions. Individual sessions
 can then be terminated by issuing the following command as root:
					</div><pre class="synopsis"><code class="command">kill</code> <em class="replaceable">&lt;PID&gt;</em></pre><div class="para">
						If this fails to terminate the session, use the following command instead:
					</div><pre class="synopsis"><code class="command">kill</code> <code class="option">-9</code> <em class="replaceable">&lt;PID&gt;</em></pre><div class="para">
						In the previous examples, replace <em class="replaceable">&lt;PID&gt;</em> with the process identification number (found in the second column of the <code class="command">pgrep -l</code> command) for an IMAP session.
					</div><div class="para">
						To kill all active IMAP sessions, issue the following command:
					</div><pre class="screen">~]# <code class="command">killall imapd</code></pre></dd></dl></div></div></div><div class="footnotes"><br><hr align="left" width="100"><div id="ftn.idm140226876137024" class="footnote"><div class="para"><a href="#idm140226876137024" class="para"><sup class="para">[1] </sup></a>
					http://law.jrank.org/pages/3791/Kevin-Mitnick-Case-1999.html
				</div></div><div id="ftn.idm140226876137184" class="footnote"><div class="para"><a href="#idm140226876137184" class="para"><sup class="para">[2] </sup></a>
					http://www.livinginternet.com/i/ia_hackers_levin.htm
				</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Guide-Securing_Your_Network" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;2.&nbsp;Securing Your Network</h1></div></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Workstation_Security" lang="en-US"><div class="titlepage"><div><div><h2 class="title">2.1.&nbsp;Workstation Security</h2></div></div></div><div class="para">
		Securing a Linux environment begins with the workstation. Whether 
locking down a personal machine or securing an enterprise system, sound 
security policy begins with the individual computer. A computer network 
is only as secure as its weakest node.
	</div><div class="section" id="sect-Security_Guide-Workstation_Security-Evaluating_Workstation_Security"><div class="titlepage"><div><div><h3 class="title">2.1.1.&nbsp;Evaluating Workstation Security</h3></div></div></div><div class="para">
			When evaluating the security of a Red&nbsp;Hat Enterprise&nbsp;Linux workstation, consider the following:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<span class="emphasis"><em>BIOS and Boot Loader Security</em></span> — Can an unauthorized user physically access the machine and boot into single user or rescue mode without a password?
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Password Security</em></span> — How secure are the user account passwords on the machine?
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Administrative Controls</em></span> — Who has an account on the system and how much administrative control do they have?
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Available Network Services</em></span> — What services are listening for requests from the network and should they be running at all?
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Personal Firewalls</em></span> — What type of firewall, if any, is necessary?
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Security Enhanced Communication Tools</em></span> — Which tools should be used to communicate between workstations and which should be avoided?
				</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-BIOS_and_Boot_Loader_Security"><div class="titlepage"><div><div><h3 class="title">2.1.2.&nbsp;BIOS and Boot Loader Security</h3></div></div></div><div class="para">
			Password protection for the BIOS (or BIOS equivalent) and the boot 
loader can prevent unauthorized users who have physical access to 
systems from booting using removable media or obtaining root privileges 
through single user mode. The security measures you should take to 
protect against such attacks depends both on the sensitivity of the 
information on the workstation and the location of the machine.
		</div><div class="para">
			For example, if a machine is used in a trade show and contains no 
sensitive information, then it may not be critical to prevent such 
attacks. However, if an employee's laptop with private, unencrypted SSH 
keys for the corporate network is left unattended at that same trade 
show, it could lead to a major security breach with ramifications for 
the entire company.
		</div><div class="para">
			If the workstation is located in a place where only authorized or 
trusted people have access, however, then securing the BIOS or the boot 
loader may not be necessary.
		</div><div class="section" id="sect-Security_Guide-BIOS_and_Boot_Loader_Security-BIOS_Passwords"><div class="titlepage"><div><div><h4 class="title">2.1.2.1.&nbsp;BIOS Passwords</h4></div></div></div><div class="para">
				The two primary reasons for password protecting the BIOS of a computer are<a href="#ftn.idm140226849288608" class="footnote"><sup class="footnote" id="idm140226849288608">[3]</sup></a>:
			</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
						<span class="emphasis"><em>Preventing Changes to BIOS Settings</em></span>
 — If an intruder has access to the BIOS, they can set it to boot from a
 CD-ROM or a flash drive. This makes it possible for an intruder to 
enter rescue mode or single user mode, which in turn allows them to 
start arbitrary processes on the system or copy sensitive data.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Preventing System Booting</em></span> —
 Some BIOSes allow password protection of the boot process. When 
activated, an attacker is forced to enter a password before the BIOS 
launches the boot loader.
					</div></li></ol></div><div class="para">
				Because the methods for setting a BIOS password vary between 
computer manufacturers, consult the computer's manual for specific 
instructions.
			</div><div class="para">
				If you forget the BIOS password, it can either be reset with jumpers
 on the motherboard or by disconnecting the CMOS battery. For this 
reason, it is good practice to lock the computer case if possible. 
However, consult the manual for the computer or motherboard before 
attempting to disconnect the CMOS battery.
			</div><div class="section" id="sect-Security_Guide-BIOS_Passwords-Securing_Non_x86_Platforms"><div class="titlepage"><div><div><h5 class="title">2.1.2.1.1.&nbsp;Securing Non-x86 Platforms</h5></div></div></div><div class="para">
					Other architectures use different programs to perform low-level 
tasks roughly equivalent to those of the BIOS on x86 systems. For 
instance, <span class="trademark">Intel</span>® <span class="trademark">Itanium</span>™ computers use the <em class="firstterm">Extensible Firmware Interface</em> (<em class="firstterm">EFI</em>) shell.
				</div><div class="para">
					For instructions on password protecting BIOS-like programs on other architectures, see the manufacturer's instructions.
				</div></div></div><div class="section" id="sect-Security_Guide-BIOS_and_Boot_Loader_Security-Boot_Loader_Passwords"><div class="titlepage"><div><div><h4 class="title">2.1.2.2.&nbsp;Boot Loader Passwords</h4></div></div></div><div class="para">
				The primary reasons for password protecting a Linux boot loader are as follows:
			</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
						<span class="emphasis"><em>Preventing Access to Single User Mode</em></span>
 — If attackers can boot the system into single user mode, they are 
logged in automatically as root without being prompted for the root 
password.
					</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
							Protecting access to single user mode with a password by editing the <em class="parameter"><code>SINGLE</code></em> parameter in the <code class="filename">/etc/sysconfig/init</code> file is not recommended. An attacker can bypass the password by specifying a custom initial command (using the <em class="parameter"><code>init=</code></em> parameter) on the kernel command line in GRUB. It is recommended to password-protect the GRUB boot loader as specified in <a class="xref" href="#sect-Security_Guide-Boot_Loader_Passwords-Password_Protecting_GRUB">Section&nbsp;2.1.2.2.1, “Password Protecting GRUB”</a>.
						</div></div></div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Preventing Access to the GRUB Console</em></span>
 — If the machine uses GRUB as its boot loader, an attacker can use the 
GRUB editor interface to change its configuration or to gather 
information using the <code class="command">cat</code> command.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Preventing Access to Insecure Operating Systems</em></span>
 — If it is a dual-boot system, an attacker can select an operating 
system at boot time (for example, DOS), which ignores access controls 
and file permissions.
					</div></li></ol></div><div class="para">
				Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 includes the GRUB boot 
loader on the x86 platform. For a detailed look at GRUB, see the <em class="citetitle">Red&nbsp;Hat Enterprise&nbsp;Linux Installation Guide</em>.
			</div><div class="section" id="sect-Security_Guide-Boot_Loader_Passwords-Password_Protecting_GRUB"><div class="titlepage"><div><div><h5 class="title">2.1.2.2.1.&nbsp;Password Protecting GRUB</h5></div></div></div><div class="para">
					You can configure GRUB to address the first two issues listed in <a class="xref" href="#sect-Security_Guide-BIOS_and_Boot_Loader_Security-Boot_Loader_Passwords">Section&nbsp;2.1.2.2, “Boot Loader Passwords”</a>
 by adding a password directive to its configuration file. To do this, 
first choose a strong password, open a shell, log in as root, and then 
type the following command:
				</div><pre class="synopsis"><code class="command">/sbin/grub-md5-crypt</code></pre><div class="para">
					When prompted, type the GRUB password and press <span class="keycap"><strong>Enter</strong></span>. This returns an MD5 hash of the password.
				</div><div class="para">
					Next, edit the GRUB configuration file <code class="filename">/boot/grub/grub.conf</code>. Open the file and below the <code class="command">timeout</code> line in the main section of the document, add the following line:
				</div><pre class="programlisting">password --md5 <em class="replaceable">&lt;password-hash&gt;</em></pre><div class="para">
					Replace <em class="replaceable">&lt;password-hash&gt;</em> with the value returned by <code class="command">/sbin/grub-md5-crypt</code><a href="#ftn.idm140226849314528" class="footnote"><sup class="footnote" id="idm140226849314528">[4]</sup></a>.
				</div><div class="para">
					The next time the system boots, the GRUB menu prevents access to the editor or command interface without first pressing <span class="keycap"><strong>p</strong></span> followed by the GRUB password.
				</div><div class="para">
					Unfortunately, this solution does not prevent an attacker from 
booting into an insecure operating system in a dual-boot environment. 
For this, a different part of the <code class="filename">/boot/grub/grub.conf</code> file must be edited.
				</div><div class="para">
					Look for the <code class="computeroutput">title</code> line of the operating system that you want to secure, and add a line with the <code class="command">lock</code> directive immediately beneath it.
				</div><div class="para">
					For a DOS system, the stanza should begin similar to the following:
				</div><pre class="programlisting">title DOS
	lock</pre><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
						A <code class="computeroutput">password</code> line must be present in the main section of the <code class="filename">/boot/grub/grub.conf</code> file for this method to work properly. Otherwise, an attacker can access the GRUB editor interface and remove the lock line.
					</div></div></div><div class="para">
					To create a different password for a particular kernel or operating system, add a <code class="command">lock</code> line to the stanza, followed by a password line.
				</div><div class="para">
					Each stanza protected with a unique password should begin with lines similar to the following example:
				</div><pre class="programlisting">title DOS
	lock
	password --md5 <em class="replaceable">&lt;password-hash&gt;</em></pre></div><div class="section" id="sect-Security_Guide-Disabling_Interactive_Startup"><div class="titlepage"><div><div><h5 class="title">2.1.2.2.2.&nbsp;Disabling Interactive Startup</h5></div></div></div><div class="para">
					Pressing the <span class="keycap"><strong>I</strong></span> key at 
the beginning of the boot sequence allows you to start up your system 
interactively. During an interactive startup, the system prompts you to 
start up each service one by one. However, this may allow an attacker 
who gains physical access to your system to disable the security-related
 services and gain access to the system.
				</div><div class="para">
					To prevent users from starting up the system interactively, as root, disable the <em class="parameter"><code>PROMPT</code></em> parameter in the <code class="filename">/etc/sysconfig/init</code> file:
				</div><pre class="screen">PROMPT=no</pre></div></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Password_Security"><div class="titlepage"><div><div><h3 class="title">2.1.3.&nbsp;Password Security</h3></div></div></div><div class="para">
			Passwords are the primary method that Red&nbsp;Hat 
Enterprise&nbsp;Linux uses to verify a user's identity. This is why 
password security is so important for protection of the user, the 
workstation, and the network.
		</div><div class="para">
			For security purposes, the installation program configures the system to use <em class="firstterm">Secure Hash Algorithm 512</em> (<span class="emphasis"><em>SHA512</em></span>) and shadow passwords. It is highly recommended that you do not alter these settings.
		</div><div class="para">
			If shadow passwords are deselected during installation, all passwords are stored as a one-way hash in the world-readable <code class="filename">/etc/passwd</code>
 file, which makes the system vulnerable to offline password cracking 
attacks. If an intruder can gain access to the machine as a regular 
user, he can copy the <code class="filename">/etc/passwd</code> file to 
his own machine and run any number of password cracking programs against
 it. If there is an insecure password in the file, it is only a matter 
of time before the password attacker discovers it.
		</div><div class="para">
			Shadow passwords eliminate this type of attack by storing the password hashes in the file <code class="filename">/etc/shadow</code>, which is readable only by the root user.
		</div><div class="para">
			This forces a potential attacker to attempt password cracking 
remotely by logging into a network service on the machine, such as SSH 
or FTP. This sort of brute-force attack is much slower and leaves an 
obvious trail as hundreds of failed login attempts are written to system
 files. Of course, if the attacker starts an attack in the middle of the
 night on a system with weak passwords, the cracker may have gained 
access before dawn and edited the log files to cover his tracks.
		</div><div class="para">
			In addition to format and storage considerations is the issue of 
content. The single most important thing a user can do to protect his 
account against a password cracking attack is create a strong password.
		</div><div class="section" id="sect-Security_Guide-Password_Security-Creating_Strong_Passwords"><div class="titlepage"><div><div><h4 class="title">2.1.3.1.&nbsp;Creating Strong Passwords</h4></div></div></div><div class="para">
				When creating a secure password, the user must remember that long 
passwords are stronger than short and complex ones. It is not a good 
idea to create a password of just eight characters, even if it contains 
digits, special characters and uppercase letters. Password cracking 
tools, such as John The Ripper, are optimized for breaking such 
passwords, which are also hard to remember by a person.
			</div><div class="para">
				In information theory, entropy is the level of uncertainty 
associated with a random variable and is presented in bits. The higher 
the entropy value, the more secure the password is. According to NIST SP
 800-63-1, passwords that are not present in a dictionary comprised of 
50000 commonly selected passwords should have at least 10 bits of 
entropy. As such, a password that consists of four random words contains
 around 40 bits of entropy. A long password consisting of multiple words
 for added security is also called a <em class="firstterm">passphrase</em>, for example:
			</div><pre class="screen"><em class="replaceable">randomword1</em> <em class="replaceable">randomword2</em> <em class="replaceable">randomword3</em> <em class="replaceable">randomword4</em></pre><div class="para">
				If the system enforces the use of uppercase letters, digits, or 
special characters, the passphrase that follows the above recommendation
 can be modified in a simple way, for example by changing the first 
character to uppercase and appending "<code class="literal">1!</code>". Note that such a modification <span class="emphasis"><em>does not</em></span> increase the security of the passphrase significantly.
			</div><div class="para">
				While there are different approaches to creating a secure password, always avoid the following bad practices:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Using a single dictionary word, a word in a foreign language, an inverted word, or only numbers.
					</div></li><li class="listitem"><div class="para">
						Using less than 10 characters for a password or passphrase.
					</div></li><li class="listitem"><div class="para">
						Using a sequence of keys from the keyboard layout.
					</div></li><li class="listitem"><div class="para">
						Writing down your passwords.
					</div></li><li class="listitem"><div class="para">
						Using personal information in a password, such as birth dates, anniversaries, family member names, or pet names.
					</div></li><li class="listitem"><div class="para">
						Using the same passphrase or password on multiple machines.
					</div></li></ul></div><div class="para">
				While creating secure passwords is imperative, managing them 
properly is also important, especially for system administrators within 
larger organizations. The following section details good practices for 
creating and managing user passwords within an organization.
			</div></div></div><div class="section" id="sect-Security_Guide-Password_Security-Creating_User_Passwords_Within_an_Organization"><div class="titlepage"><div><div><h3 class="title">2.1.4.&nbsp;Creating User Passwords Within an Organization</h3></div></div></div><div class="para">
			If an organization has a large number of users, the system 
administrators have two basic options available to force the use of good
 passwords. They can create passwords for the user, or they can let 
users create their own passwords, while verifying the passwords are of 
acceptable quality.
		</div><div class="para">
			Creating the passwords for the users ensures that the passwords are 
good, but it becomes a daunting task as the organization grows. It also 
increases the risk of users writing their passwords down.
		</div><div class="para">
			For these reasons, most system administrators prefer to have the 
users create their own passwords, but actively verify that the passwords
 are good and, in some cases, force users to change their passwords 
periodically through password aging.
		</div><div class="section" id="sect-Security_Guide-Creating_User_Passwords_Within_an_Organization-Forcing_Strong_Passwords"><div class="titlepage"><div><div><h4 class="title">2.1.4.1.&nbsp;Forcing Strong Passwords</h4></div></div></div><div class="para">
				To protect the network from intrusion it is a good idea for system 
administrators to verify that the passwords used within an organization 
are strong ones. When users are asked to create or change passwords, 
they can use the command line application <code class="command">passwd</code>, which is <em class="firstterm">Pluggable Authentication Modules</em> (<em class="firstterm">PAM</em>) aware and therefore checks to see if the password is too short or otherwise easy to crack. This check is performed using the <code class="filename">pam_cracklib.so</code> PAM module. In Red&nbsp;Hat Enterprise&nbsp;Linux, the <code class="filename">pam_cracklib</code>
 PAM module can be used to check a password's strength against a set of 
rules. It can be stacked alongside other PAM modules in the <code class="literal">password</code> component of the<code class="filename">/etc/pam.d/passwd</code> file to configure a custom set of rules for user login. The <code class="filename">pam_cracklib</code>'s
 routine consists of two parts: it checks whether the password provided 
is found in a dictionary, and, if that is not the case, it continues 
with a number of additional checks. For a complete list of these checks,
 see the <code class="command">pam_cracklib(8)</code> manual page.
			</div><div class="example" id="configuring_pam_cracklib"><p class="title"><strong>Example&nbsp;2.1.&nbsp;Configuring password strength-checking with <code class="filename">pam_cracklib</code></strong></p><div class="example-contents"><div class="para">
					To require a password with a minimum length of 8 characters, 
including all four classes of characters, add the following line to the <code class="literal">password</code> section of the <code class="filename">/etc/pam.d/passwd</code> file:
				</div><pre class="screen">password   required     pam_cracklib.so retry=3 minlen=8 minclass=4
</pre><div class="para">
					To set a password strength-check for consecutive or repetitive characters, add the following line to the <code class="literal">password</code> section of the <code class="filename">/etc/pam.d/passwd</code> file:
				</div><pre class="screen">password   required     pam_cracklib.so retry=3 maxsequence=3 maxrepeat=3
</pre><div class="para">
					In this example, the password entered cannot contain more than 3 
consecutive characters, such as "abcd" or "1234". Additionally, the 
number of identical consecutive characters is limited to 3.
				</div></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					As these checks are not performed for the root user, he can set any
 password for a regular user, despite the warning messages.
				</div></div></div><div class="para">
				Since PAM is customizable, it is possible to add more password integrity checkers, such as <code class="filename">pam_passwdqc</code> (available from <a href="http://www.openwall.com/passwdqc/">http://www.openwall.com/passwdqc/</a>) or to write a new module. For a list of available PAM modules, see <a href="http://uw714doc.sco.com/en/SEC_pam/pam-6.html">http://uw714doc.sco.com/en/SEC_pam/pam-6.html</a>. For more information about PAM, see the <em class="citetitle">Managing Single Sign-On and Smart Cards</em> guide.
			</div><div class="para">
				The password check that is performed at the time of their creation 
does not discover bad passwords as effectively as running a password 
cracking program against the passwords.
			</div><div class="para">
				Many password cracking programs are available that run under 
Red&nbsp;Hat Enterprise&nbsp;Linux, although none ship with the 
operating system. Below is a brief list of some of the more popular 
password cracking programs:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="emphasis"><em><span class="application"><strong>John The Ripper</strong></span></em></span>
 — A fast and flexible password cracking program. It allows the use of 
multiple word lists and is capable of brute-force password cracking. It 
is available online at <a href="http://www.openwall.com/john/">http://www.openwall.com/john/</a>.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em><span class="application"><strong>Crack</strong></span></em></span> — Perhaps the most well known password cracking software, <span class="application"><strong>Crack</strong></span> is also very fast, though not as easy to use as <span class="application"><strong>John The Ripper</strong></span>.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em><span class="application"><strong>Slurpie</strong></span></em></span> — <span class="application"><strong>Slurpie</strong></span> is similar to <span class="application"><strong>John The Ripper</strong></span> and <span class="application"><strong>Crack</strong></span>,
 but it is designed to run on multiple computers simultaneously, 
creating a distributed password cracking attack. It can be found along 
with a number of other distributed attack security evaluation tools 
online at <a href="http://www.ussrback.com/distributed.htm">http://www.ussrback.com/distributed.htm</a>.
					</div></li></ul></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
					Always get authorization in writing before attempting to crack passwords within an organization.
				</div></div></div></div><div class="section" id="sect-Security_Guide-Passphrases"><div class="titlepage"><div><div><h4 class="title">2.1.4.2.&nbsp;Passphrases</h4></div></div></div><div class="para">
				Passphrases and passwords are the cornerstone to security in most of
 today's systems. Unfortunately, techniques such as biometrics and 
two-factor authentication have not yet become mainstream in many 
systems. If passwords are going to be used to secure a system, then the 
use of passphrases should be considered. Passphrases are longer than 
passwords and provide better protection than a password even when 
implemented with non-standard characters such as numbers and symbols.
			</div></div><div class="section" id="sect-Security_Guide-Creating_User_Passwords_Within_an_Organization-Password_Aging"><div class="titlepage"><div><div><h4 class="title">2.1.4.3.&nbsp;Password Aging</h4></div></div></div><div class="para">
				Password aging is another technique used by system administrators to
 defend against bad passwords within an organization. Password aging 
means that after a specified period (usually 90 days), the user is 
prompted to create a new password. The theory behind this is that if a 
user is forced to change his password periodically, a cracked password 
is only useful to an intruder for a limited amount of time. The downside
 to password aging, however, is that users are more likely to write 
their passwords down.
			</div><div class="para">
				There are two primary programs used to specify password aging under Red&nbsp;Hat Enterprise&nbsp;Linux: the <code class="command">chage</code> command or the graphical <span class="application"><strong>User Manager</strong></span> (<code class="command">system-config-users</code>) application.
			</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
					Shadow passwords must be enabled to use the <code class="command">chage</code> command. For more information, see the <em class="citetitle">Red&nbsp;Hat Enterprise&nbsp;Linux 6 Deployment Guide</em>.
				</div></div></div><div class="para">
				The <code class="option">-M</code> option of the <code class="command">chage</code>
 command specifies the maximum number of days the password is valid. For
 example, to set a user's password to expire in 90 days, use the 
following command:
			</div><pre class="synopsis"><code class="command">chage</code> <code class="option">-M 90</code> <em class="replaceable">&lt;username&gt;</em></pre><div class="para">
				In the above command, replace <em class="replaceable">&lt;username&gt;</em> with the name of the user. To disable password expiration, it is traditional to use a value of <code class="command">99999</code> after the <code class="option">-M</code> option (this equates to a little over 273 years).
			</div><div class="para">
				For more information on the options available with the <code class="command">chage</code> command, see the table below.
			</div><div class="table" id="tabl-chage_options"><p class="title"><strong>Table&nbsp;2.1.&nbsp;chage command line options</strong></p><div class="table-contents"><table class="lt-4-cols gt-7-rows" summary="chage command line options"><colgroup><col class="option" width="30%"><!--Empty--><col class="description" width="70%"><!--Empty--></colgroup><thead><tr><th id="idm140226856205728" scope="col"> Option </th><th id="idm140226856206272" scope="col"> Description </th></tr></thead><tbody><tr><td headers="idm140226856205728"> <code class="option">-d</code>&nbsp;<em class="replaceable">days</em> </td><td headers="idm140226856206272"> Specifies the number of days since January 1, 1970 the password was changed. </td></tr><tr><td headers="idm140226856205728"> <code class="option">-E</code>&nbsp;<em class="replaceable">date</em> </td><td headers="idm140226856206272">
 Specifies the date on which the account is locked, in the format 
YYYY-MM-DD. Instead of the date, the number of days since January 1, 
1970 can also be used. </td></tr><tr><td headers="idm140226856205728"> <code class="option">-I</code>&nbsp;<em class="replaceable">days</em> </td><td headers="idm140226856206272"> Specifies the number of inactive days after the password expiration before locking the account. If the value is <code class="literal">0</code>, the account is not locked after the password expires. </td></tr><tr><td headers="idm140226856205728"> <code class="option">-l</code> </td><td headers="idm140226856206272"> Lists current account aging settings. </td></tr><tr><td headers="idm140226856205728"> <code class="option">-m</code>&nbsp;<em class="replaceable">days</em> </td><td headers="idm140226856206272"> Specify the minimum number of days after which the user must change passwords. If the value is <code class="literal">0</code>, the password does not expire. </td></tr><tr><td headers="idm140226856205728"> <code class="option">-M</code>&nbsp;<em class="replaceable">days</em> </td><td headers="idm140226856206272">
 Specify the maximum number of days for which the password is valid. 
When the number of days specified by this option plus the number of days
 specified with the <code class="option">-d</code> option is less than the current day, the user must change passwords before using the account. </td></tr><tr><td headers="idm140226856205728"> <code class="option">-W</code>&nbsp;<em class="replaceable">days</em> </td><td headers="idm140226856206272"> Specifies the number of days before the password expiration date to warn the user. </td></tr></tbody></table></div></div><div class="para">
				You can also use the <code class="command">chage</code> command in 
interactive mode to modify multiple password aging and account details. 
Use the following command to enter interactive mode:
			</div><pre class="synopsis"><code class="command">chage</code> <em class="replaceable">&lt;username&gt;</em></pre><div class="para">
				The following is a sample interactive session using this command:
			</div><pre class="screen">~]# <code class="command">chage juan</code>
Changing the aging information for juan
Enter the new value, or press ENTER for the default
Minimum Password Age [0]: <strong class="userinput"><code>10</code></strong>
Maximum Password Age [99999]: <strong class="userinput"><code>90</code></strong>
Last Password Change (YYYY-MM-DD) [2006-08-18]:
Password Expiration Warning [7]:
Password Inactive [-1]:
Account Expiration Date (YYYY-MM-DD) [1969-12-31]:</pre><div class="para">
				You can configure a password to expire the first time a user logs in. This forces users to change passwords immediately.
			</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
						Set up an initial password. There are two common approaches to 
this step: you can either assign a default password, or you can use a 
null password.
					</div><div class="para">
						To assign a default password, type the following at a shell prompt as <code class="systemitem">root</code>:
					</div><pre class="synopsis"><code class="command">passwd</code> <em class="replaceable">username</em></pre><div class="para">
						To assign a null password instead, use the following command:
					</div><pre class="synopsis"><code class="command">passwd</code> <code class="option">-d</code> <em class="replaceable">username</em></pre><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
							Using a null password, while convenient, is a highly insecure 
practice, as any third party can log in first and access the system 
using the insecure user name. Always make sure that the user is ready to
 log in before unlocking an account with a null password.
						</div></div></div></li><li class="step"><div class="para">
						Force immediate password expiration by running the following command as <code class="systemitem">root</code>:
					</div><pre class="synopsis"><code class="command">chage</code> <code class="option">-d</code> <code class="option">0</code> <em class="replaceable">username</em></pre><div class="para">
						This command sets the value for the date the password was last 
changed to the epoch (January 1, 1970). This value forces immediate 
password expiration no matter what password aging policy, if any, is in 
place.
					</div></li></ol></div><div class="para">
				Upon the initial log in, the user is now prompted for a new password.
			</div><div class="para">
				You can also use the graphical <span class="application"><strong>User Manager</strong></span> application to create password aging policies, as follows. Note: you need Administrator privileges to perform this procedure.
			</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
						Click the <span class="guimenu"><strong>System</strong></span> menu on the Panel, point to <span class="guisubmenu"><strong>Administration</strong></span> and then click <span class="guimenuitem"><strong>Users and Groups</strong></span> to display the User Manager. Alternatively, type the command <code class="command">system-config-users</code> at a shell prompt.
					</div></li><li class="step"><div class="para">
						Click the <span class="guilabel"><strong>Users</strong></span> tab, and select the required user in the list of users.
					</div></li><li class="step"><div class="para">
						Click <span class="guibutton"><strong>Properties</strong></span> on the toolbar to display the User Properties dialog box (or choose <span class="guimenuitem"><strong>Properties</strong></span> on the <span class="guimenu"><strong>File</strong></span> menu).
					</div></li><li class="step"><div class="para">
						Click the <span class="guilabel"><strong>Password Info</strong></span> tab, and select the check box for <span class="guilabel"><strong>Enable password expiration</strong></span>.
					</div></li><li class="step"><div class="para">
						Enter the required value in the <span class="guilabel"><strong>Days before change required</strong></span> field, and click <span class="guibutton"><strong>OK</strong></span>.
					</div></li></ol></div><div class="figure" id="figu-Security_Guide-Password_Aging-Specifying_password_aging_options"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/fed-user_pass_info.png" alt="Specifying password aging options"></div></div><p class="title"><strong>Figure&nbsp;2.1.&nbsp;Specifying password aging options</strong></p></div><p class="remark"><em><span class="remark">screenshot needs to be updated</span></em></p></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Locking_Inactive_Accounts"><div class="titlepage"><div><div><h3 class="title">2.1.5.&nbsp;Locking Inactive Accounts</h3></div></div></div><div class="para">
			The <code class="filename">pam_lastlog</code> PAM module is used to 
lock out users who have not logged in recently enough, or to display 
information about the last login attempt of a user. The module does not 
perform a check on the root account, so it is never locked out.
		</div><div class="para">
			The <code class="command">lastlog</code> command displays the last login of the user, аs opposed to the <code class="command">last</code> command, which displays all current and previous login sessions. The commands read respectively from the <code class="filename">/var/log/lastlog</code> and <code class="filename">/var/log/wtmp</code> files where the data is stored in binary format.
		</div><div class="procedure"><ul><li class="step"><div class="para">
					To display the number of failed login attempts prior to the last 
successful login of a user, add, as root, the following line to the <code class="literal">session</code> section in the <code class="filename">/etc/pam.d/login</code> file:
				</div><pre class="screen">session     optional      pam_lastlog.so silent noupdate showfailed
</pre></li></ul></div><div class="para">
			Account locking due to inactivity can be configured to work for the console, GUI, or both:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					To lock out an account after 10 days of inactivity, add, as root, the following line to the <code class="literal">auth</code> section of the <code class="filename">/etc/pam.d/login</code> file:
				</div><pre class="screen">auth  required  pam_lastlog.so inactive=10
</pre></li><li class="listitem"><div class="para">
					To lock out an account for the GNOME desktop environment, add, as root, the following line to the <code class="literal">auth</code> section of the <code class="filename">/etc/pam.d/gdm</code> file:
				</div><pre class="screen">auth  required  pam_lastlog.so inactive=10
</pre></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Note that for other desktop environments, the respective files of those environments should be edited.
			</div></div></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Customizing_Access_Control"><div class="titlepage"><div><div><h3 class="title">2.1.6.&nbsp;Customizing Access Control</h3></div></div></div><div class="para">
			The <code class="filename">pam_access</code> PAM module allows an 
administrator to customize access control based on login names, host or 
domain names, or IP addresses. By default, the module reads the access 
rules from the <code class="filename">/etc/security/access.conf</code> file if no other is specified. For a complete description of the format of these rules, see the <code class="systemitem">access.conf(5)</code> manual page. By default, in Red&nbsp;Hat Enterprise&nbsp;Linux, <code class="filename">pam_access</code> is included in the <code class="filename">/etc/pam.d/crond</code> and <code class="filename">/etc/pam.d/atd</code> files.
		</div><div class="para">
			To deny the user john from accessing system from the console and the graphic desktop environment, follow these steps:
		</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					Include the following line in the <code class="literal">account</code> section of both <code class="filename">/etc/pam.d/login</code> and <code class="filename">/etc/pam.d/gdm-*</code> files:
				</div><pre class="screen">account     required     pam_access.so
</pre></li><li class="step"><div class="para">
					Specify the following rule in the <code class="filename">/etc/security/access.conf</code> file:
				</div><pre class="screen">- : john : ALL
</pre><div class="para">
					This rule prohibits all logins from user john from any location.
				</div></li></ol></div><div class="para">
			To grant access to all users attempting to log in using SSH except 
the user john from the 1.2.3.4 IP address, follow these steps:
		</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					Include the following line in the <code class="literal">account</code> section of <code class="filename">/etc/pam.d/sshd</code>:
				</div><pre class="screen">account     required     pam_access.so
</pre></li><li class="step"><div class="para">
					Specify the following rule in the /etc/security/access.conf file:
				</div><pre class="screen">+ : ALL EXCEPT john : 1.2.3.4
</pre></li></ol></div><div class="para">
			In order to limit access from other services, the <code class="filename">pam_access</code> module should be required in the respective file in the <code class="filename">/etc/pam.d</code> directory.
		</div><div class="para">
			It is possible to call the <code class="filename">pam_access</code> module for all services that call the system wide PAM configuration files (<code class="filename">*-auth</code> files in the <code class="filename">/etc/pam.d</code> directory) using the following command:
		</div><pre class="screen"><code class="command">authconfig --enablepamaccess --update</code></pre><div class="para">
			Alternatively, you can enable the <code class="filename">pam_access</code> module using the Authentication Configuration utility. To start this utility, select <span class="guimenu"><strong>System</strong></span> → <span class="guisubmenu"><strong>Administration</strong></span> → <span class="guimenuitem"><strong> Authentication</strong></span> from the top menu. From the <span class="guimenu"><strong>Advanced Options</strong></span> tab, check the "enable local access control option". This will add the <code class="filename">pam_access</code> module to the systemwide PAM configuration.
		</div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Time-based_Restriction_of_Access"><div class="titlepage"><div><div><h3 class="title">2.1.7.&nbsp;Time-based Restriction of Access</h3></div></div></div><div class="para">
			The <code class="filename">pam_time</code> PAM module is used to 
restrict access during a certain time of the day. It can also be 
configured to control access based on specific days of a week, user 
name, usage of a system service, and more. By default, the module reads 
the access rules from the <code class="filename">/etc/security/time.conf</code> file. For a complete description of the format of these rules, see the <code class="systemitem">time.conf(5)</code> manual page.
		</div><div class="para">
			To restrict all users except the root user from logging in from 05:30
 PM to 08:00 AM on Monday till Friday and Saturday and Sunday, follow 
these steps:
		</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					Include the following line in the account section of the <code class="filename">/etc/pam.d/login</code> file:
				</div><pre class="screen">account     required     pam_time.so</pre></li><li class="step"><div class="para">
					Specify the following rule in the <code class="filename">/etc/security/time.conf</code> file:
				</div><pre class="screen">login ; tty* ; ALL ; !root ; !Wk1730-0800</pre></li></ol></div><div class="para">
			To allow user john to use the SSH service during working hours and 
working days only (starting with Monday), follow these steps:
		</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					Add the following line to the <code class="filename">/etc/pam.d/sshd file:</code>
				</div><pre class="screen">account     required     pam_time.so</pre></li><li class="step"><div class="para">
					Specify the following rule in the <code class="filename">/etc/security/time.conf</code> file:
				</div><pre class="screen">sshd ; tty* ; john ; Wk0800-1730</pre></li></ol></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				For these configurations to be applied to the desktop environment, the <code class="systemitem">pam_time</code> module should be included in the corresponding files in the <code class="filename">/etc/pam.d</code> directory.
			</div></div></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Applying_Account_Limits"><div class="titlepage"><div><div><h3 class="title">2.1.8.&nbsp;Applying Account Limits</h3></div></div></div><div class="para">
			The <code class="systemitem">pam_limits</code> PAM module is used to:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					apply limits to user login sessions, such as maximum simultaneous login sessions per user,
				</div></li><li class="listitem"><div class="para">
					specify limits to be set by the <span class="application"><strong>ulimit</strong></span> utility,
				</div></li><li class="listitem"><div class="para">
					and specify priority to be set by the <span class="application"><strong>nice</strong></span> utility.
				</div></li></ul></div><div class="para">
			By default, the rules are read from the<code class="filename">/etc/security/limits.conf</code> file. For a complete description of the format of these rules, see the <code class="systemitem">limits.conf(5)</code> manual page. Additionally, you can create individual configuration files in the <code class="filename">/etc/security/limits.d</code> directory specifically for certain applications or services. By default, the <code class="systemitem">pam_limits</code> module is included in a number of files in the<code class="filename">/etc/pam.d/</code> directory. A default limit of user processes is defined in the <code class="filename">/etc/security/limits.d/90-nproc.conf</code>
 file to prevent malicious denial of service attacks, such as fork 
bombs. To change the default limit of user processes to 50, change the 
value in the <code class="filename">/etc/security/limits.d/90-nproc.conf</code>, following the format in the file: 
<pre class="screen">* soft nproc 50</pre>

		</div><div class="example" id="specifying_a_maximum_number_of_logins_per_user"><p class="title"><strong>Example&nbsp;2.2.&nbsp;Specifying a maximum number of logins per user</strong></p><div class="example-contents"><div class="procedure"><ol class="1"><li class="step"><div class="para">
						To set a maximum number of simultaneous logins for each user in a group called <code class="literal">office</code>, specify the following rule in the <code class="filename">/etc/security/limits.conf</code> file: 
<pre class="screen">@office - maxlogins 4</pre>

					</div></li><li class="step"><div class="para">
						The following line should be present by default in <code class="filename">/etc/pam.d/system-auth</code>. If not, add it manually. 
<pre class="screen">session  required  pam_limits.so</pre>

					</div></li></ol></div></div></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Administrative_Controls"><div class="titlepage"><div><div><h3 class="title">2.1.9.&nbsp;Administrative Controls</h3></div></div></div><div class="para">
			When administering a home machine, the user must perform some tasks 
as the root user or by acquiring effective root privileges through a <em class="firstterm">setuid</em> program, such as <code class="command">sudo</code> or <code class="command">su</code>. A setuid program is one that operates with the user ID (<span class="emphasis"><em>UID</em></span>) of the program's owner rather than the user operating the program. Such programs are denoted by an <code class="computeroutput">s</code> in the owner section of a long format listing, as in the following example:
		</div><pre class="screen">~]$ <code class="command">ls -l /bin/su</code>
-rwsr-xr-x. 1 root root 34904 Mar 10  2011 /bin/su</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				The <code class="computeroutput">s</code> may be upper case or lower case. If it appears as upper case, it means that the underlying permission bit has not been set.
			</div></div></div><div class="para">
			For the system administrators of an organization, however, choices 
must be made as to how much administrative access users within the 
organization should have to their machine. Through a PAM module called <code class="filename">pam_console.so</code>,
 some activities normally reserved only for the root user, such as 
rebooting and mounting removable media are allowed for the first user 
that logs in at the physical console (see <em class="citetitle">Managing Single Sign-On and Smart Cards</em> for more information about the <code class="filename">pam_console.so</code>
 module.) However, other important system administration tasks, such as 
altering network settings, configuring a new mouse, or mounting network 
devices, are not possible without administrative privileges. As a 
result, system administrators must decide how much access the users on 
their network should receive.
		</div><div class="section" id="sect-Security_Guide-Administrative_Controls-Allowing_Root_Access"><div class="titlepage"><div><div><h4 class="title">2.1.9.1.&nbsp;Allowing Root Access</h4></div></div></div><div class="para">
				If the users within an organization are trusted and 
computer-literate, then allowing them root access may not be an issue. 
Allowing root access by users means that minor activities, like adding 
devices or configuring network interfaces, can be handled by the 
individual users, leaving system administrators free to deal with 
network security and other important issues.
			</div><div class="para">
				On the other hand, giving root access to individual users can lead to the following issues:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="emphasis"><em>Machine Misconfiguration</em></span> — 
Users with root access can misconfigure their machines and require 
assistance to resolve issues. Even worse, they might open up security 
holes without knowing it.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Running Insecure Services</em></span> —
 Users with root access might run insecure servers on their machine, 
such as FTP or Telnet, potentially putting user names and passwords at 
risk. These services transmit this information over the network in plain
 text.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Running Email Attachments As Root</em></span>
 — Although rare, email viruses that affect Linux do exist. The only 
time they are a threat, however, is when they are run by the root user.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Keeping the audit trail intact</em></span>
 — Because the root account is often shared by multiple users, so that 
multiple system administrators can maintain the system, it is impossible
 to figure out which of those users was root at a given time. When using
 separate logins, the account a user logs in with, as well as a unique 
number for session tracking purposes, is put into the task structure, 
which is inherited by every process that the user starts. When using 
concurrent logins, the unique number can be used to trace actions to 
specific logins. When an action generates an audit event, it is recorded
 with the login account and the session associated with that unique 
number. Use the <code class="command">aulast</code> command to view these logins and sessions. The <code class="option">--proof</code> option of the <code class="command">aulast</code> command can be used suggest a specific <code class="command">ausearch</code> query to isolate auditable events generated by a particular session.
					</div></li></ul></div></div><div class="section" id="s2-wstation-privileges-noroot"><div class="titlepage"><div><div><h4 class="title">2.1.9.2.&nbsp;Disallowing Root Access</h4></div></div></div><a id="idm140226856356768" class="indexterm"><!--Empty--></a><div class="para">
				If an administrator is uncomfortable allowing users to log in as 
root for these or other reasons, the root password should be kept 
secret, and access to runlevel one or single user mode should be 
disallowed through boot loader password protection (see <a class="xref" href="#sect-Security_Guide-BIOS_and_Boot_Loader_Security-Boot_Loader_Passwords">Section&nbsp;2.1.2.2, “Boot Loader Passwords”</a> for more information on this topic.)
			</div><div class="para">
				The following are four different ways that an administrator can further ensure that root logins are disallowed:
			</div><a id="idm140226856358592" class="indexterm"><!--Empty--></a><div class="variablelist"><dl class="variablelist"><dt><span class="term"> <a id="idm140226856361520" class="indexterm"><!--Empty--></a> Changing the root shell </span></dt><dd><div class="para">
							To prevent users from logging in directly as root, the system administrator can set the root account's shell to <code class="command">/sbin/nologin</code> in the <code class="filename">/etc/passwd</code> file.
						</div><div class="table" id="tabl-wstation-privileges-rshell"><p class="title"><strong>Table&nbsp;2.2.&nbsp;Disabling the Root Shell</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Disabling the Root Shell"><colgroup><col class="does" width="50%"><!--Empty--><col class="doesnt" width="50%"><!--Empty--></colgroup><thead><tr><th id="idm140226858085776" scope="col"> Effects </th><th id="idm140226858084112" scope="col"> Does Not Affect </th></tr></thead><tbody><tr><td headers="idm140226858085776"> <div class="para">
											Prevents access to the root shell and logs any such attempts.
 The following programs are prevented from accessing the root account:
										</div>
										 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
													<code class="command">login</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">gdm</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">kdm</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">xdm</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">su</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">ssh</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">scp</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">sftp</code>
												</div></li></ul></div>
										 </td><td headers="idm140226858084112"> <div class="para">
											Programs that do not require a shell, such as FTP clients, 
mail clients, and many setuid programs. The following programs are <span class="emphasis"><em>not</em></span> prevented from accessing the root account:
										</div>
										 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
													<code class="command">sudo</code>
												</div></li><li class="listitem"><div class="para">
													FTP clients
												</div></li><li class="listitem"><div class="para">
													Email clients
												</div></li></ul></div>
										 </td></tr></tbody></table></div></div></dd><dt><span class="term"> <a id="idm140226858107216" class="indexterm"><!--Empty--></a> Disabling root access through any console device (tty) </span></dt><dd><div class="para">
							To further limit access to the root account, administrators can disable root logins at the console by editing the <code class="filename">/etc/securetty</code>
 file. This file lists all devices the root user is allowed to log into.
 If the file does not exist at all, the root user can log in through any
 communication device on the system, whether through the console or a 
raw network interface. This is dangerous, because a user can log in to 
their machine as root through Telnet, which transmits the password in 
plain text over the network.
						</div><div class="para">
							By default, Red&nbsp;Hat Enterprise&nbsp;Linux's <code class="filename">/etc/securetty</code>
 file only allows the root user to log in at the console physically 
attached to the machine. To prevent the root user from logging in, 
remove the contents of this file by typing the following command at a 
shell prompt as root:
						</div><pre class="screen"><code class="command">echo &gt; /etc/securetty</code></pre><div class="para">
							To enable <code class="filename">securetty</code> support in the KDM, GDM, and XDM login managers, add the following line:
						</div><pre class="screen">auth [user_unknown=ignore success=ok ignore=ignore default=bad] pam_securetty.so</pre><div class="para">
							to the files listed below:
						</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="filename">/etc/pam.d/gdm</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">/etc/pam.d/gdm-autologin</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">/etc/pam.d/gdm-fingerprint</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">/etc/pam.d/gdm-password</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">/etc/pam.d/gdm-smartcard</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">/etc/pam.d/kdm</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">/etc/pam.d/kdm-np</code>
								</div></li><li class="listitem"><div class="para">
									<code class="filename">/etc/pam.d/xdm</code>
								</div></li></ul></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
								A blank <code class="filename">/etc/securetty</code> file does <span class="emphasis"><em>not</em></span>
 prevent the root user from logging in remotely using the OpenSSH suite 
of tools because the console is not opened until after authentication.
							</div></div></div><div class="table" id="tabl-wstation-privileges-tty"><p class="title"><strong>Table&nbsp;2.3.&nbsp;Disabling Root Logins</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Disabling Root Logins"><colgroup><col class="does" width="50%"><!--Empty--><col class="doesnt" width="50%"><!--Empty--></colgroup><thead><tr><th id="idm140226858132512" scope="col"> Effects </th><th id="idm140226858138096" scope="col"> Does Not Affect </th></tr></thead><tbody><tr><td headers="idm140226858132512"> <div class="para">
											Prevents access to the root account using the console or the 
network. The following programs are prevented from accessing the root 
account:
										</div>
										 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
													<code class="command">login</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">gdm</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">kdm</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">xdm</code>
												</div></li><li class="listitem"><div class="para">
													Other network services that open a tty
												</div></li></ul></div>
										 </td><td headers="idm140226858138096"> <div class="para">
											Programs that do not log in as root, but perform 
administrative tasks through setuid or other mechanisms. The following 
programs are <span class="emphasis"><em>not</em></span> prevented from accessing the root account:
										</div>
										 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
													<code class="command">su</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">sudo</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">ssh</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">scp</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">sftp</code>
												</div></li></ul></div>
										 </td></tr></tbody></table></div></div></dd><dt><span class="term"> <a id="idm140226858153808" class="indexterm"><!--Empty--></a> Disabling root SSH logins </span></dt><dd><div class="para">
							To prevent root logins using the SSH protocol, edit the SSH daemon's configuration file, <code class="filename">/etc/ssh/sshd_config</code>, and change the line that reads:
						</div><pre class="screen">#PermitRootLogin yes</pre><div class="para">
							to read as follows:
						</div><pre class="screen">PermitRootLogin no</pre><div class="table" id="tabl-wstation-privileges-ssh"><p class="title"><strong>Table&nbsp;2.4.&nbsp;Disabling Root SSH Logins</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Disabling Root SSH Logins"><colgroup><col class="does" width="50%"><!--Empty--><col class="doesnt" width="50%"><!--Empty--></colgroup><thead><tr><th id="idm140226858162096" scope="col"> Effects </th><th id="idm140226858162576" scope="col"> Does Not Affect </th></tr></thead><tbody><tr><td headers="idm140226858162096"> <div class="para">
											Prevents root access using the OpenSSH suite of tools. The 
following programs are prevented from accessing the root account:
										</div>
										 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
													<code class="command">ssh</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">scp</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">sftp</code>
												</div></li></ul></div>
										 </td><td headers="idm140226858162576"> <div class="para">
											Programs that are not part of the OpenSSH suite of tools.
										</div>
										 </td></tr></tbody></table></div></div></dd><dt><span class="term"> <a id="idm140226858175664" class="indexterm"><!--Empty--></a> Using PAM to limit root access to services </span></dt><dd><div class="para">
							PAM, through the <code class="filename">/lib/security/pam_listfile.so</code>
 module, allows great flexibility in denying specific accounts. The 
administrator can use this module to reference a list of users who are 
not allowed to log in. To limit root access to a system service, edit 
the file for the target service in the <code class="filename">/etc/pam.d/</code> directory and make sure the <code class="filename">pam_listfile.so</code> module is required for authentication.
						</div><div class="para">
							The following is an example of how the module is used for the <code class="command">vsftpd</code> FTP server in the <code class="filename">/etc/pam.d/vsftpd</code> PAM configuration file (the <code class="computeroutput">\</code> character at the end of the first line is <span class="emphasis"><em>not</em></span> necessary if the directive is on a single line):
						</div><pre class="screen">auth   required   /lib/security/pam_listfile.so   item=user \
 sense=deny file=/etc/vsftpd.ftpusers onerr=succeed</pre><div class="para">
							This instructs PAM to consult the <code class="filename">/etc/vsftpd.ftpusers</code>
 file and deny access to the service for any listed user. The 
administrator can change the name of this file, and can keep separate 
lists for each service or use one central list to deny access to 
multiple services.
						</div><div class="para">
							If the administrator wants to deny access to multiple services, a
 similar line can be added to the PAM configuration files, such as <code class="filename">/etc/pam.d/pop</code> and <code class="filename">/etc/pam.d/imap</code> for mail clients, or <code class="filename">/etc/pam.d/ssh</code> for SSH clients.
						</div><div class="para">
							For more information about PAM, see the chapter titled <em class="citetitle">Using Pluggable Authentication Modules (PAM)</em> in the <em class="citetitle">Red&nbsp;Hat Enterprise&nbsp;Linux Managing Single Sign-On and Smart Cards</em> guide.
						</div><div class="table" id="tabl-wstation-privileges-pam"><p class="title"><strong>Table&nbsp;2.5.&nbsp;Disabling Root Using PAM</strong></p><div class="table-contents"><table class="lt-4-cols lt-7-rows" summary="Disabling Root Using PAM"><colgroup><col class="does" width="50%"><!--Empty--><col class="doesnt" width="50%"><!--Empty--></colgroup><thead><tr><th id="idm140226858188864" scope="col"> Effects </th><th id="idm140226858189344" scope="col"> Does Not Affect </th></tr></thead><tbody><tr><td headers="idm140226858188864"> <div class="para">
											Prevents root access to network services that are PAM aware. 
The following services are prevented from accessing the root account:
										</div>
										 <div class="itemizedlist"><ul><li class="listitem"><div class="para">
													<code class="command">login</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">gdm</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">kdm</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">xdm</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">ssh</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">scp</code>
												</div></li><li class="listitem"><div class="para">
													<code class="command">sftp</code>
												</div></li><li class="listitem"><div class="para">
													FTP clients
												</div></li><li class="listitem"><div class="para">
													Email clients
												</div></li><li class="listitem"><div class="para">
													Any PAM aware services
												</div></li></ul></div>
										 </td><td headers="idm140226858189344"> <div class="para">
											Programs and services that are not PAM aware.
										</div>
										 </td></tr></tbody></table></div></div></dd></dl></div></div><div class="section" id="sect-Security_Guide-Administrative_Controls-Enabling_Automatic_Logouts"><div class="titlepage"><div><div><h4 class="title">2.1.9.3.&nbsp;Enabling Automatic Logouts</h4></div></div></div><div class="para">
				When the user is logged in as <code class="systemitem">root</code>, 
an unattended login session may pose a significant security risk. To 
reduce this risk, you can configure the system to automatically log out 
idle users after a fixed period of time:
			</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
						Make sure the <span class="package">screen</span> package is installed. You can do so by running the following command as <code class="systemitem">root</code>:
					</div><pre class="synopsis">~]# <code class="command">yum</code> <code class="option">install</code> <code class="option">screen</code></pre><div class="para">
						For more information on how to install packages in Red&nbsp;Hat Enterprise&nbsp;Linux, see the <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Deployment_Guide/sec-Installing.html">Installing Packages</a> section in the <em class="citetitle">Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 Deployment Guide</em>.
					</div></li><li class="step"><div class="para">
						As <code class="systemitem">root</code>, add the following line at the beginning of the <code class="filename">/etc/profile</code> file to make sure the processing of this file cannot be interrupted:
					</div><pre class="programlisting  language-bash"><span class="token function">trap</span> <span class="token string">""</span> 1 2 3 15</pre></li><li class="step"><div class="para">
						Add the following lines at the end of the <code class="filename">/etc/profile</code> file to start a <code class="command">screen</code> session each time a user logs in to a virtual console or remotely:
					</div><pre class="programlisting  language-bash">SCREENEXEC<span class="token operator">=</span><span class="token string">"screen"</span>
<span class="token keyword keyword-if">if</span> <span class="token punctuation">[</span> -w <span class="token variable"><span class="token variable">$(</span><span class="token function">tty</span><span class="token variable">)</span></span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword keyword-then">then</span>
  <span class="token function">trap</span> <span class="token string">"exec <span class="token variable">$SCREENEXEC</span>"</span> 1 2 3 15
  <span class="token keyword keyword-echo">echo</span> -n <span class="token string">'Starting session in 10 seconds'</span>
  <span class="token function">sleep</span> 10
  <span class="token function">exec</span> <span class="token variable">$SCREENEXEC</span>
<span class="token keyword keyword-fi">fi</span>
</pre><div class="para">
						Note that each time a new session starts, a message will be 
displayed and the user will have to wait ten seconds. To adjust the time
 to wait before starting a session, change the value after the <code class="command">sleep</code> command.
					</div></li><li class="step"><div class="para">
						Add the following lines to the <code class="filename">/etc/screenrc</code> configuration file to close the <code class="command">screen</code> session after a given period of inactivity:
					</div><pre class="programlisting  language-bash">idle 120 quit 
autodetach off
</pre><div class="para">
						This will set the time limit to 120 seconds. To adjust this limit, change the value after the <code class="option">idle</code> directive.
					</div><div class="para">
						Alternatively, you can configure the system to only lock the session by using the following lines instead:
					</div><pre class="programlisting  language-bash">idle 120 lockscreen
autodetach off
</pre><div class="para">
						This way, a password will be required to unlock the session.
					</div></li></ol></div><div class="para">
				The changes take effect the next time a user logs in to the system.
			</div></div><div class="section" id="sect-Security_Guide-Administrative_Controls-Limiting_Root_Access"><div class="titlepage"><div><div><h4 class="title">2.1.9.4.&nbsp;Limiting Root Access</h4></div></div></div><div class="para">
				Rather than completely denying access to the root user, the 
administrator may want to allow access only by setuid programs, such as <code class="command">su</code> or <code class="command">sudo</code>. For more information on <code class="command">su</code> and <code class="command">sudo</code>, see the <em class="citetitle">Red&nbsp;Hat Enterprise&nbsp;Linux 6 Deployment Guide</em> and the <code class="filename">su(1)</code> and <code class="filename">sudo(8)</code> man pages.
			</div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Account_Locking"><div class="titlepage"><div><div><h4 class="title">2.1.9.5.&nbsp;Account Locking</h4></div></div></div><div class="para">
				In Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6, the <code class="systemitem">pam_faillock</code>
 PAM module allows system administrators to lock out user accounts after
 a specified number of failed attempts. Limiting user login attempts 
serves mainly as a security measure that aims to prevent possible brute 
force attacks targeted to obtain a user's account password.
			</div><div class="para">
				With the <code class="systemitem">pam_faillock</code> module, failed login attempts are stored in a separate file for each user in the <code class="filename">/var/run/faillock</code> directory.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The order of lines in the failed attempt log files is important. 
Any change in this order can lock all user accounts, including the root 
user account when the <code class="option">even_deny_root</code> option is used.
				</div></div></div><div class="para">
				Follow these steps to configure account locking:
			</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
						To lock out any non-root user after three unsuccessful attempts 
and unlock that user after 10 minutes, add the following lines to the <code class="literal">auth</code> section of the <code class="filename">/etc/pam.d/system-auth</code> and <code class="filename">/etc/pam.d/password-auth</code> files:
					</div><pre class="screen">auth        required       pam_faillock.so preauth silent audit deny=3 unlock_time=600
auth        sufficient     pam_unix.so nullok try_first_pass
auth        [default=die]  pam_faillock.so authfail audit deny=3 unlock_time=600
</pre></li><li class="step"><div class="para">
						Add the following line to the <code class="literal">account</code> section of both files specified in the previous step:
					</div><pre class="screen">account     required      pam_faillock.so</pre></li><li class="step"><div class="para">
						To apply account locking for the root user as well, add the <code class="option">even_deny_root</code> option to the <code class="systemitem">pam_faillock</code> entries in the <code class="filename">/etc/pam.d/system-auth</code> and <code class="filename">/etc/pam.d/password-auth</code> files:
					</div><pre class="screen">auth        required      pam_faillock.so preauth silent audit deny=3 even_deny_root unlock_time=600
auth        sufficient    pam_unix.so nullok try_first_pass
auth        [default=die] pam_faillock.so authfail audit deny=3 even_deny_root unlock_time=600

account     required      pam_faillock.so
</pre></li></ol></div><div class="para">
				When user <code class="computeroutput">john</code> attempts to log 
in for the fourth time after failing to log in three times previously, 
his account is locked upon the fourth attempt:
			</div><pre class="screen">[user@localhost ~]$ su - john
Account locked due to 3 failed logins
su: incorrect password
</pre><div class="para">
				To prevent the system from locking users out even after multiple 
failed logins, add the following line just above the line where <code class="code">pam_faillock</code> is called for the first time in both <code class="filename">/etc/pam.d/system-auth</code> and <code class="filename">/etc/pam.d/password-auth</code>. Also replace <code class="computeroutput">user1</code>, <code class="computeroutput">user2</code>, <code class="computeroutput">user3 </code> with the actual user names.
			</div><pre class="screen">auth [success=1 default=ignore] pam_succeed_if.so user in user1:user2:user3
</pre><div class="para">
				To view the number of failed attempts per user, run, as root, the following command:
			</div><pre class="screen">[root@localhost ~]# <code class="command">faillock</code> 
john:
When                Type  Source                                           Valid
2013-03-05 11:44:14 TTY   pts/0                                                V
</pre><div class="para">
				To unlock a user's account, run, as root, the following command:
			</div><pre class="screen"><code class="command">faillock</code> --user <em class="replaceable">&lt;username&gt;</em> --reset
</pre><div class="para">
				When modifying authentication configuration using the <span class="application"><strong>authconfig</strong></span> utility, the <code class="filename">system-auth</code> and <code class="filename">password-auth</code> files are overwritten with the settings from the <span class="application"><strong>authconfig</strong></span> utility. This can be avoided by creating symbolic links in place of the configuration files, which <span class="application"><strong>authconfig</strong></span> recognizes and does not overwrite. In order to use custom settings in the configuration files and <span class="application"><strong>authconfig</strong></span> simultaneously, configure account locking using the following steps:
			</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
						Rename the configuration files:
					</div><pre class="screen">~]#&nbsp;<code class="command">mv /etc/pam.d/system-auth /etc/pam.d/system-auth-local</code>
~]#&nbsp;<code class="command">mv /etc/pam.d/password-auth /etc/pam.d/password-auth-local</code></pre></li><li class="step"><div class="para">
						Create the following symbolic links:
					</div><pre class="screen">~]#&nbsp;<code class="command">ln -s /etc/pam.d/system-auth-local /etc/pam.d/system-auth</code>
~]#&nbsp;<code class="command">ln -s /etc/pam.d/password-auth-local /etc/pam.d/password-auth</code></pre></li><li class="step"><div class="para">
						The <code class="filename">/etc/pam.d/system-auth-local</code> file should contain the following lines:
					</div><pre class="screen">auth        required       pam_faillock.so preauth silent audit deny=3 unlock_time=600
auth        include        system-auth-ac
auth        [default=die]  pam_faillock.so authfail silent audit deny=3 unlock_time=600

account     required       pam_faillock.so
account     include        system-auth-ac

password    include        system-auth-ac

session     include        system-auth-ac
</pre></li><li class="step"><div class="para">
						The <code class="filename">/etc/pam.d/password-auth-local</code> file should contain the following lines:
					</div><pre class="screen">auth        required       pam_faillock.so preauth silent audit deny=3 unlock_time=600
auth        include        password-auth-ac
auth        [default=die]  pam_faillock.so authfail silent audit deny=3 unlock_time=600

account     required       pam_faillock.so
account     include        password-auth-ac

password    include        system-auth-ac

session     include        system-auth-ac
</pre></li></ol></div><div class="para">
				For more information on various <code class="systemitem">pam_faillock</code> configuration options, see the <code class="systemitem">pam_faillock(8)</code> man page.
			</div></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Session_Locking"><div class="titlepage"><div><div><h3 class="title">2.1.10.&nbsp;Session Locking</h3></div></div></div><div class="para">
			Users may need to leave their workstation unattended for a number of 
reasons during everyday operation. This could present an opportunity for
 an attacker to physically access the machine, especially in 
environments with insufficient physical security measures (see <a class="xref" href="#sect-Security_Guide-Security_Controls-Physical_Controls">Section&nbsp;1.1.3.1, “Physical Controls”</a>).
 Laptops are especially exposed since their mobility interferes with 
physical security. You can alleviate these risks by using session 
locking features which prevent access to the system until a correct 
password is entered.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				The main advantage of locking the screen instead of logging out is 
that a lock allows the user's processes (such as file transfers) to 
continue running. Logging out would stop these processes.
			</div></div></div><div class="section" id="sect-Security_Guide-Session_Locking-Locking_GNOME_Using_gnome_screensaver_command"><div class="titlepage"><div><div><h4 class="title">2.1.10.1.&nbsp;Locking GNOME Using gnome-screensaver-command</h4></div></div></div><div class="para">
				The default desktop environment for Red&nbsp;Hat 
Enterprise&nbsp;Linux 6, GNOME, includes a feature which allows users to
 lock their screen at any time. There are several ways to activate the 
lock:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						Press the key combination specified in <span class="guimenu"><strong>System</strong></span> → <span class="guisubmenu"><strong>Preferences</strong></span> → <span class="guimenuitem"><strong>Keyboard Shortcuts</strong></span> → <span class="guimenuitem"><strong>Desktop</strong></span> → <span class="guimenuitem"><strong>Lock screen</strong></span>. The default combination is <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>Alt</strong></span>+<span class="keycap"><strong>L</strong></span>.
					</div></li><li class="listitem"><div class="para">
						Select <span class="guimenu"><strong>System</strong></span> → <span class="guimenuitem"><strong>Lock screen</strong></span> on the panel.
					</div></li><li class="listitem"><div class="para">
						Execute the following command from a command line interface:
					</div><pre class="screen"><code class="command">gnome-screensaver-command</code> <code class="option">-l</code></pre></li></ul></div><div class="para">
				All of the techniques described have the same result: the screen 
saver is activated and the screen is locked. Users can then press any 
key to deactivate the screen saver, enter their password and continue 
working.
			</div><div class="para">
				Keep in mind that this function requires the <code class="systemitem">gnome-screensaver</code>
 process to be running. You can check whether this is the case by using 
any command which provides information about processes. For example, 
execute the following command from the terminal:
			</div><pre class="screen"><code class="command">pidof gnome-screensaver</code></pre><div class="para">
				If the <code class="systemitem">gnome-screensaver</code> process is 
currently running, a number denoting its identification number (PID) 
will be displayed on the screen after executing the command. If the 
process is not currently running, the command will provide no output at 
all.
			</div><div class="para">
				Refer to the <code class="filename">gnome-screensaver-command(1)</code> man page for additional information.
			</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
					The means of locking the screen described above rely on manual 
activation. Administrators should therefore advise their users to lock 
their computers every time they leave them unattended, even if only for a
 short period of time.
				</div></div></div><div class="section" id="sect-Security_Guide-Locking_GNOME_Using_gnome_screensaver_command-Automatic_Lock_on_Screen_Saver_Activation"><div class="titlepage"><div><div><h5 class="title">2.1.10.1.1.&nbsp;Automatic Lock on Screen Saver Activation</h5></div></div></div><div class="para">
					As the name <code class="command">gnome-screensaver-command</code> 
suggests, the locking functionality is tied to GNOME's screen saver. It 
is possible to tie the lock to the screen saver's activation, locking 
the workstation every time it is left unattended for a set period of 
time. This function is activated by default with a five minute timeout.
				</div><div class="para">
					To change the automatic locking settings, select <span class="guimenu"><strong>System</strong></span> → <span class="guisubmenu"><strong>Preferences</strong></span> → <span class="guimenuitem"><strong>Screensaver</strong></span> on the main panel. This opens a window which allows setting the timeout period (the <span class="guilabel"><strong>Regard the computer as idle after</strong></span> slider) and activating or deactivating the automatic lock (the <span class="guilabel"><strong>Lock screen when screensaver is active</strong></span> check box).
				</div><div class="figure" id="figu-Security_Guide-Automatic_Lock-Changing_the_screensaver_preferences"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/gnome-screensaver_preferences.png" alt="Changing the screen saver preferences"></div></div><p class="title"><strong>Figure&nbsp;2.2.&nbsp;Changing the screen saver preferences</strong></p></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Disabling the <span class="guilabel"><strong>Activate screensaver when computer is idle</strong></span> option in the <span class="guilabel"><strong>Screensaver Preferences</strong></span>
 dialog prevents the screen saver from starting automatically. Automatic
 locking is therefore disabled as well, but it is still possible to lock
 the workstation manually using the techniques described in <a class="xref" href="#sect-Security_Guide-Session_Locking-Locking_GNOME_Using_gnome_screensaver_command">Section&nbsp;2.1.10.1, “Locking GNOME Using gnome-screensaver-command”</a>.
					</div></div></div></div><div class="section" id="sect-Security_Guide-Locking_GNOME_Using_gnome_screensaver_command-Remote_Session_Locking"><div class="titlepage"><div><div><h5 class="title">2.1.10.1.2.&nbsp;Remote Session Locking</h5></div></div></div><div class="para">
					You can also lock a GNOME session remotely using <code class="command">ssh</code>
 as long as the target workstation accepts connections over this 
protocol. To remotely lock the screen on a machine you have access to, 
execute the following command:
				</div><pre class="screen"><code class="command">ssh -X <em class="replaceable">&lt;username&gt;</em>@<em class="replaceable">&lt;server&gt;</em> "export DISPLAY=:0; gnome-screensaver-command -l"</code></pre><div class="para">
					Replace <em class="replaceable">&lt;username&gt;</em> with your user name and <em class="replaceable">&lt;server&gt;</em> with the IP address of the workstation you want to lock.
				</div><div class="para">
					Refer to <a class="xref" href="#sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell">Section&nbsp;3.2.2, “Secure Shell”</a> for more information regarding <code class="command">ssh</code>.
				</div></div></div><div class="section" id="sect-Security_Guide-Session_Locking-Locking_Virtual_Consoles_Using_vlock"><div class="titlepage"><div><div><h4 class="title">2.1.10.2.&nbsp;Locking Virtual Consoles Using vlock</h4></div></div></div><div class="para">
				Users may also need to lock a virtual console. This can be done using a utility called <code class="command">vlock</code>. To install this utility, execute the following command as root:
			</div><pre class="screen">~]# <code class="command">yum install vlock</code></pre><div class="para">
				After installation, any console session can be locked using the <code class="command">vlock</code>
 command without any additional parameters. This locks the currently 
active virtual console session while still allowing access to the 
others. To prevent access to all virtual consoles on the workstation, 
execute the following:
			</div><pre class="screen"><code class="command">vlock</code> <code class="option">-a</code></pre><div class="para">
				In this case, <code class="command">vlock</code> locks the currently active console and the <code class="option">-a</code> option prevents switching to other virtual consoles.
			</div><div class="para">
				Refer to the <code class="filename">vlock(1)</code> man page for additional information.
			</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
					There are several known issues relevant to the version of <code class="command">vlock</code> currently available for Red&nbsp;Hat Enterprise&nbsp;Linux 6:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							The program does not currently allow unlocking consoles using the
 root password. Additional information can be found in BZ#<a href="https://bugzilla.redhat.com/show_bug.cgi?id=895066">895066</a>.
						</div></li><li class="listitem"><div class="para">
							Locking a console does not clear the screen and scrollback 
buffer, allowing anyone with physical access to the workstation to view 
previously issued commands and any output displayed in the console. 
Refer to BZ#<a href="https://bugzilla.redhat.com/show_bug.cgi?id=807369">807369</a> for more information.
						</div></li></ul></div></div></div></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Available_Network_Services"><div class="titlepage"><div><div><h3 class="title">2.1.11.&nbsp;Available Network Services</h3></div></div></div><div class="para">
			While user access to administrative controls is an important issue 
for system administrators within an organization, monitoring which 
network services are active is of paramount importance to anyone who 
administers and operates a Linux system.
		</div><div class="para">
			Many services under Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 behave 
as network servers. If a network service is running on a machine, then a
 server application (called a <em class="firstterm">daemon</em>), is 
listening for connections on one or more network ports. Each of these 
servers should be treated as a potential avenue of attack.
		</div><div class="section" id="sect-Security_Guide-Available_Network_Services-Risks_To_Services"><div class="titlepage"><div><div><h4 class="title">2.1.11.1.&nbsp;Risks To Services</h4></div></div></div><div class="para">
				Network services can pose many risks for Linux systems. Below is a list of some of the primary issues:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="emphasis"><em>Denial of Service Attacks (DoS)</em></span>
 — By flooding a service with requests, a denial of service attack can 
render a system unusable as it tries to log and answer each request.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Distributed Denial of Service Attack (DDoS)</em></span>
 — A type of DoS attack which uses multiple compromised machines (often 
numbering in the thousands or more) to direct a coordinated attack on a 
service, flooding it with requests and making it unusable.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Script Vulnerability Attacks</em></span>
 — If a server is using scripts to execute server-side actions, as Web 
servers commonly do, an attacker can attack improperly written scripts. 
These script vulnerability attacks can lead to a buffer overflow 
condition or allow the attacker to alter files on the system.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Buffer Overflow Attacks</em></span> — 
Services that connect to ports numbered 0 through 1023 must run as an 
administrative user. If the application has an exploitable buffer 
overflow, an attacker could gain access to the system as the user 
running the daemon. Because exploitable buffer overflows exist, 
attackers use automated tools to identify systems with vulnerabilities, 
and once they have gained access, they use automated rootkits to 
maintain their access to the system.
					</div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The threat of buffer overflow vulnerabilities is mitigated in Red&nbsp;Hat Enterprise&nbsp;Linux by <em class="firstterm">ExecShield</em>,
 an executable memory segmentation and protection technology supported 
by x86-compatible uni- and multi-processor kernels. ExecShield reduces 
the risk of buffer overflow by separating virtual memory into executable
 and non-executable segments. Any program code that tries to execute 
outside of the executable segment (such as malicious code injected from a
 buffer overflow exploit) triggers a segmentation fault and terminates.
				</div><div class="para">
					Execshield also includes support for <em class="firstterm">No eXecute</em> (<acronym class="acronym">NX</acronym>) technology on AMD64 platforms and <em class="firstterm">eXecute Disable</em> (<acronym class="acronym">XD</acronym>) technology on Itanium and <span class="trademark">Intel</span>®
 64 systems. These technologies work in conjunction with ExecShield to 
prevent malicious code from running in the executable portion of virtual
 memory with a granularity of 4KB of executable code, lowering the risk 
of attack from buffer overflow exploits.
				</div></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
					To limit exposure to attacks over the network, disable all services that are unused.
				</div></div></div></div><div class="section" id="sect-Security_Guide-Available_Network_Services-Identifying_and_Configuring_Services"><div class="titlepage"><div><div><h4 class="title">2.1.11.2.&nbsp;Identifying and Configuring Services</h4></div></div></div><div class="para">
				To enhance security, most network services installed with 
Red&nbsp;Hat Enterprise&nbsp;Linux are turned off by default. There are,
 however, some notable exceptions:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="command">cupsd</code> — The default print server for Red&nbsp;Hat Enterprise&nbsp;Linux.
					</div></li><li class="listitem"><div class="para">
						<code class="command">lpd</code> — An alternative print server.
					</div></li><li class="listitem"><div class="para">
						<code class="command">xinetd</code> — A super server that controls connections to a range of subordinate servers, such as <code class="command">gssftp</code> and <code class="command">telnet</code>.
					</div></li><li class="listitem"><div class="para">
						<code class="command">sendmail</code> — The Sendmail <em class="firstterm">Mail Transport Agent</em> (<abbr class="abbrev">MTA</abbr>) is enabled by default, but only listens for connections from the <span class="interface">localhost</span>.
					</div></li><li class="listitem"><div class="para">
						<code class="command">sshd</code> — The OpenSSH server, which is a secure replacement for Telnet.
					</div></li></ul></div><div class="para">
				When determining whether to leave these services running, it is best
 to use common sense and avoid taking any risks. For example, if a 
printer is not available, do not leave <code class="command">cupsd</code> running. The same is true for <code class="command">portmap</code>. If you do not mount NFSv3 volumes or use NIS (the <code class="command">ypbind</code> service), then <code class="command">portmap</code> should be disabled.
			</div><div class="figure" id="figu-Security_Guide-Identifying_and_Configuring_Services-Services_Configuration_Tool"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/fed-service_config.png" alt="Services Configuration Tool"></div></div><p class="title"><strong>Figure&nbsp;2.3.&nbsp;Services Configuration Tool</strong></p></div><div class="para">
				If unsure of the purpose for a particular service, the <span class="application"><strong>Services Configuration Tool</strong></span> has a description field, illustrated in <a class="xref" href="#figu-Security_Guide-Identifying_and_Configuring_Services-Services_Configuration_Tool">Figure&nbsp;2.3, “Services Configuration Tool”</a>, that provides additional information.
			</div><div class="para">
				Checking which network services are available to start at boot time 
is not sufficient. It is recommended to also check which ports are open 
and listening. Refer to <a class="xref" href="#sect-Security_Guide-Server_Security-Verifying_Which_Ports_Are_Listening">Section&nbsp;2.2.9, “Verifying Which Ports Are Listening”</a> for more information.
			</div></div><div class="section" id="sect-Security_Guide-Available_Network_Services-Insecure_Services"><div class="titlepage"><div><div><h4 class="title">2.1.11.3.&nbsp;Insecure Services</h4></div></div></div><div class="para">
				Potentially, any network service is insecure. This is why turning 
off unused services is so important. Exploits for services are routinely
 revealed and patched, making it very important to regularly update 
packages associated with any network service. Refer to <a class="xref" href="#sect-Security_Guide-Security_Updates">Section&nbsp;1.5, “Security Updates”</a> for more information.
			</div><div class="para">
				Some network protocols are inherently more insecure than others. These include any services that:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="emphasis"><em>Transmit Usernames and Passwords Over a Network Unencrypted</em></span>
 — Many older protocols, such as Telnet and FTP, do not encrypt the 
authentication session and should be avoided whenever possible.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Transmit Sensitive Data Over a Network Unencrypted</em></span>
 — Many protocols transmit data over the network unencrypted. These 
protocols include Telnet, FTP, HTTP, and SMTP. Many network file 
systems, such as NFS and SMB, also transmit information over the network
 unencrypted. It is the user's responsibility when using these protocols
 to limit what type of data is transmitted.
					</div><div class="para">
						Remote memory dump services, like <code class="command">netdump</code>,
 transmit the contents of memory over the network unencrypted. Memory 
dumps can contain passwords or, even worse, database entries and other 
sensitive information.
					</div><div class="para">
						Other services like <code class="command">finger</code> and <code class="command">rwhod</code> reveal information about users of the system.
					</div></li></ul></div><div class="para">
				Examples of inherently insecure services include <code class="command">rlogin</code>, <code class="command">rsh</code>, <code class="command">telnet</code>, and <code class="command">vsftpd</code>.
			</div><div class="para">
				All remote login and shell programs (<code class="command">rlogin</code>, <code class="command">rsh</code>, and <code class="command">telnet</code>) should be avoided in favor of SSH. Refer to <a class="xref" href="#sect-Security_Guide-Workstation_Security-Security_Enhanced_Communication_Tools">Section&nbsp;2.1.13, “Security Enhanced Communication Tools”</a> for more information about <code class="command">sshd</code>.
			</div><div class="para">
				FTP is not as inherently dangerous to the security of the system as 
remote shells, but FTP servers must be carefully configured and 
monitored to avoid problems. Refer to <a class="xref" href="#sect-Security_Guide-Server_Security-Securing_FTP">Section&nbsp;2.2.6, “Securing FTP”</a> for more information about securing FTP servers.
			</div><div class="para">
				Services that should be carefully implemented and behind a firewall include:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="command">finger</code>
					</div></li><li class="listitem"><div class="para">
						<code class="command">authd</code> (this was called <code class="command">identd</code> in previous Red&nbsp;Hat Enterprise&nbsp;Linux releases.)
					</div></li><li class="listitem"><div class="para">
						<code class="command">netdump</code>
					</div></li><li class="listitem"><div class="para">
						<code class="command">netdump-server</code>
					</div></li><li class="listitem"><div class="para">
						<code class="command">nfs</code>
					</div></li><li class="listitem"><div class="para">
						<code class="command">rwhod</code>
					</div></li><li class="listitem"><div class="para">
						<code class="command">sendmail</code>
					</div></li><li class="listitem"><div class="para">
						<code class="command">smb</code> (Samba)
					</div></li><li class="listitem"><div class="para">
						<code class="command">yppasswdd</code>
					</div></li><li class="listitem"><div class="para">
						<code class="command">ypserv</code>
					</div></li><li class="listitem"><div class="para">
						<code class="command">ypxfrd</code>
					</div></li></ul></div><div class="para">
				More information on securing network services is available in <a class="xref" href="#sect-Security_Guide-Server_Security">Section&nbsp;2.2, “Server Security”</a>.
			</div><div class="para">
				The next section discusses tools available to set up a simple firewall.
			</div></div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Personal_Firewalls"><div class="titlepage"><div><div><h3 class="title">2.1.12.&nbsp;Personal Firewalls</h3></div></div></div><div class="para">
			After the <span class="emphasis"><em>necessary</em></span> network services are configured, it is important to implement a firewall.
		</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				Configure the necessary services and implement a firewall <span class="emphasis"><em>before</em></span> connecting to the Internet or any other network that you do not trust.
			</div></div></div><div class="para">
			Firewalls prevent network packets from accessing the system's network
 interface. If a request is made to a port that is blocked by a 
firewall, the request is ignored. If a service is listening on one of 
these blocked ports, it does not receive the packets and is effectively 
disabled. For this reason, ensure that you block access to ports not in 
use when configuring a firewall, while not blocking access to ports used
 by configured services.
		</div><div class="para">
			For most users, the best tool for configuring a simple firewall is 
the graphical firewall configuration tool which includes Red&nbsp;Hat 
Enterprise&nbsp;Linux: the <span class="application"><strong>Firewall Configuration Tool</strong></span> (<code class="command">system-config-firewall</code>). This tool creates broad <code class="command">iptables</code> rules for a general-purpose firewall using a control panel interface.
		</div><div class="para">
			Refer to <a class="xref" href="#sect-Security_Guide-Firewalls-Basic_Firewall_Configuration">Section&nbsp;2.8.2, “Basic Firewall Configuration”</a> for more information about using this application and its available options.
		</div><div class="para">
			For advanced users and server administrators, manually configuring a firewall with <code class="command">iptables</code> is preferable. Refer to <a class="xref" href="#sect-Security_Guide-Firewalls">Section&nbsp;2.8, “Firewalls”</a> for more information. Refer to <a class="xref" href="#sect-Security_Guide-IPTables">Section&nbsp;2.8.9, “IPTables”</a> for a comprehensive guide to the <code class="command">iptables</code> command.
		</div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Security_Enhanced_Communication_Tools"><div class="titlepage"><div><div><h3 class="title">2.1.13.&nbsp;Security Enhanced Communication Tools</h3></div></div></div><div class="para">
			As the size and popularity of the Internet has grown, so has the 
threat of communication interception. Over the years, tools have been 
developed to encrypt communications as they are transferred over the 
network.
		</div><div class="para">
			Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 includes two basic tools 
that use high-level, public-key-cryptography-based encryption algorithms
 to protect information as it travels over the network.
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<span class="emphasis"><em>OpenSSH</em></span> — A free implementation of the SSH protocol for encrypting network communication.
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Gnu Privacy Guard (GPG)</em></span> — A free implementation of the PGP (Pretty Good Privacy) encryption application for encrypting data.
				</div></li></ul></div><div class="para">
			OpenSSH is a safer way to access a remote machine and replaces older, unencrypted services like <code class="command">telnet</code> and <code class="command">rsh</code>. OpenSSH includes a network service called <code class="command">sshd</code> and three command line client applications:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="command">ssh</code> — A secure remote console access client.
				</div></li><li class="listitem"><div class="para">
					<code class="command">scp</code> — A secure remote copy command.
				</div></li><li class="listitem"><div class="para">
					<code class="command">sftp</code> — A secure pseudo-ftp client that allows interactive file transfer sessions.
				</div></li></ul></div><div class="para">
			Refer to <a class="xref" href="#sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell">Section&nbsp;3.2.2, “Secure Shell”</a> for more information regarding OpenSSH.
		</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				Although the <code class="command">sshd</code> service is inherently secure, the service <span class="emphasis"><em>must</em></span> be kept up-to-date to prevent security threats. Refer to <a class="xref" href="#sect-Security_Guide-Security_Updates">Section&nbsp;1.5, “Security Updates”</a> for more information.
			</div></div></div><div class="para">
			GPG is one way to ensure private email communication. It can be used 
both to email sensitive data over public networks and to protect 
sensitive data on hard drives.
		</div></div><div class="section" id="sect-Security_Guide-Workstation_Security-Enforcing_Read-Only_Mounting_of_Removable_Media"><div class="titlepage"><div><div><h3 class="title">2.1.14.&nbsp;Enforcing Read-Only Mounting of Removable Media</h3></div></div></div><div class="para">
			To enforce read-only mounting of removable media (such as USB flash disks), the administrator can use a <code class="systemitem">udev</code> rule to detect removable media and configure them to be mounted read-only using the <span class="application"><strong>blockdev</strong></span> utility. Starting with Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.7, a special parameter can be also passed to the <code class="systemitem">udisks</code> disk manager to force read-only mounting of file systems.
		</div><div class="para">
			While the <code class="systemitem">udev</code> rule that triggers the <span class="application"><strong>blockdev</strong></span> utility is sufficient for enforcing read-only mounting of physical media, the <code class="systemitem">udisks</code> parameter can be used to enforce read-only mounting of filesystems on read-write mounted media.
		</div><h4 id="brid-Security_Guide-Workstation_Security-Enforcing_Read-Only_Mounting_of_Removable_Media-udev">Using blockdev to Force Read-Only Mounting of Removable Media</h4><div class="para">
			To force all removable media to be mounted read-only, create a new <code class="systemitem">udev</code> configuration file named, for example, <code class="filename">80-readonly-removables.rules</code> in the <code class="filename">/etc/udev/rules.d/</code> directory with the following content:
		</div><pre class="programlisting">SUBSYSTEM=="block",ATTRS{removable}=="1",RUN{program}="/sbin/blockdev --setro %N"</pre><div class="para">
			The above <code class="systemitem">udev</code> rule ensures that any newly connected removable block (storage) device is automatically configured as read-only using the <code class="command">blockdev</code> utility.
		</div><h4 id="brid-Security_Guide-Workstation_Security-Enforcing_Read-Only_Mounting_of_Removable_Media-udisks">Using udisks to Force Read-Only Mounting of Filesystems</h4><div class="para">
			To force all file systems to be mounted read-only, a special <code class="systemitem">udisks</code> parameter needs to be set through <code class="systemitem">udev</code>. Create a new <code class="systemitem">udev</code> configuration file named, for example, <code class="filename">80-udisks.rules</code> in the <code class="filename">/etc/udev/rules.d/</code> directory with the following content (or add the following lines to this file if it already exists):
		</div><pre class="programlisting">ENV{UDISKS_MOUNT_OPTIONS}="ro,noexec"
ENV{UDISKS_MOUNT_OPTIONS_ALLOW}="noexec,nodev,nosuid,atime,noatime,nodiratime,ro,sync,dirsync"</pre><div class="para">
			Note that a default <code class="filename">80-udisks.rules</code> file is installed with the <span class="package">udisks</span> package in the <code class="filename">/lib/udev/rules.d/</code> directory. This file contains the above rules, but they are commented out.
		</div><div class="para">
			The above <code class="systemitem">udev</code> rules instruct the <code class="systemitem">udisks</code> disk manager to only allow read-only mounting of file systems. Also, the <code class="option">noexec</code>
 parameter forbids direct execution of any binaries on the mounted file 
systems. This policy is enforced regardless of the way the actual 
physical device is mounted. That is, file systems are mounted read-only 
even on read-write mounted devices.
		</div><h4 id="brid-Security_Guide-Workstation_Security-Enforcing_Read-Only_Mounting_of_Removable_Media-apply">Applying New udev and udisks Settings</h4><div class="para">
			For these settings to take effect, the new <code class="systemitem">udev</code> rules need to be applied. The <code class="systemitem">udev</code>
 service automatically detects changes to its configuration files, but 
new settings are not applied to already existing devices. Only newly 
connected devices are affected by the new settings. Therefore, you need 
to unmount and unplug all connected removable media to ensure that the 
new settings are applied to them when they are next plugged in.
		</div><div class="para">
			To force <code class="systemitem">udev</code> to re-apply all rules to already existing devices, enter the following command as <code class="systemitem">root</code>:
		</div><pre class="screen"><code class="prompt">~#</code> <code class="command">udevadm trigger</code></pre><div class="para">
			Note that forcing <code class="systemitem">udev</code> to re-apply all rules using the above command does not affect any storage devices that are already mounted.
		</div><div class="para">
			To force <code class="systemitem">udev</code> to reload all rules (in case the new rules are not automatically detected for some reason), use the following command:
		</div><pre class="screen"><code class="prompt">~#</code> <code class="command">udevadm control --reload</code></pre></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Server_Security" lang="en-US"><div class="titlepage"><div><div><h2 class="title">2.2.&nbsp;Server Security</h2></div></div></div><div class="para">
		When a system is used as a server on a public network, it becomes a 
target for attacks. Hardening the system and locking down services is 
therefore of paramount importance for the system administrator.
	</div><div class="para">
		Before delving into specific issues, review the following general tips for enhancing server security:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Keep all services current, to protect against the latest threats.
			</div></li><li class="listitem"><div class="para">
				Use secure protocols whenever possible.
			</div></li><li class="listitem"><div class="para">
				Serve only one type of network service per machine whenever possible.
			</div></li><li class="listitem"><div class="para">
				Monitor all servers carefully for suspicious activity.
			</div></li></ul></div><div class="section" id="sect-Security_Guide-Server_Security-Securing_Services_With_TCP_Wrappers_and_xinetd"><div class="titlepage"><div><div><h3 class="title">2.2.1.&nbsp;Securing Services With TCP Wrappers and xinetd</h3></div></div></div><div class="para">
			<em class="firstterm">TCP Wrappers</em> provide access control to a 
variety of services. Most modern network services, such as SSH, Telnet, 
and FTP, make use of TCP Wrappers, which stand guard between an incoming
 request and the requested service.
		</div><div class="para">
			The benefits offered by TCP Wrappers are enhanced when used in conjunction with <code class="command">xinetd</code>, a super server that provides additional access, logging, binding, redirection, and resource utilization control.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				It is a good idea to use iptables firewall rules in conjunction with TCP Wrappers and <code class="command">xinetd</code> to create redundancy within service access controls. Refer to <a class="xref" href="#sect-Security_Guide-Firewalls">Section&nbsp;2.8, “Firewalls”</a> for more information about implementing firewalls with iptables commands.
			</div></div></div><div class="para">
			The following subsections assume a basic knowledge of each topic and focus on specific security options.
		</div><div class="section" id="sect-Security_Guide-Securing_Services_With_TCP_Wrappers_and_xinetd-Enhancing_Security_With_TCP_Wrappers"><div class="titlepage"><div><div><h4 class="title">2.2.1.1.&nbsp;Enhancing Security With TCP Wrappers</h4></div></div></div><div class="para">
				TCP Wrappers are capable of much more than denying access to 
services. This section illustrates how they can be used to send 
connection banners, warn of attacks from particular hosts, and enhance 
logging functionality. Refer to the <code class="filename">hosts_options</code> man page for information about the TCP Wrapper functionality and control language. Refer to the <code class="filename">xinetd.conf</code> man page available online at <a href="http://linux.die.net/man/5/xinetd.conf">http://linux.die.net/man/5/xinetd.conf</a> for available flags, which act as options you can apply to a service.
			</div><div class="section" id="sect-Security_Guide-Enhancing_Security_With_TCP_Wrappers-TCP_Wrappers_and_Connection_Banners"><div class="titlepage"><div><div><h5 class="title">2.2.1.1.1.&nbsp;TCP Wrappers and Connection Banners</h5></div></div></div><div class="para">
					Displaying a suitable banner when users connect to a service is a 
good way to let potential attackers know that the system administrator 
is being vigilant. You can also control what information about the 
system is presented to users. To implement a TCP Wrappers banner for a 
service, use the <code class="option">banner</code> option.
				</div><div class="para">
					This example implements a banner for <code class="command">vsftpd</code>.
 To begin, create a banner file. It can be anywhere on the system, but 
it must have same name as the daemon. For this example, the file is 
called <code class="filename">/etc/banners/vsftpd</code> and contains the following lines:
				</div><pre class="programlisting">220-Hello, %c 
          220-All activity on ftp.example.com is logged.
          220-Inappropriate use will result in your access privileges being removed.</pre><div class="para">
					The <code class="command">%c</code> token supplies a variety of 
client information, such as the user name and hostname, or the user name
 and IP address to make the connection even more intimidating.
				</div><div class="para">
					For this banner to be displayed to incoming connections, add the following line to the <code class="filename">/etc/hosts.allow</code> file:
				</div><pre class="programlisting">vsftpd : ALL : banners /etc/banners/</pre></div><div class="section" id="sect-Security_Guide-Enhancing_Security_With_TCP_Wrappers-TCP_Wrappers_and_Attack_Warnings"><div class="titlepage"><div><div><h5 class="title">2.2.1.1.2.&nbsp;TCP Wrappers and Attack Warnings</h5></div></div></div><div class="para">
					If a particular host or network has been detected attacking the 
server, TCP Wrappers can be used to warn the administrator of subsequent
 attacks from that host or network using the <code class="command">spawn</code> directive.
				</div><div class="para">
					In this example, assume that an attacker from the 206.182.68.0/24 
network has been detected attempting to attack the server. Place the 
following line in the <code class="filename">/etc/hosts.deny</code> file to deny any connection attempts from that network, and to log the attempts to a special file:
				</div><pre class="programlisting">ALL : 206.182.68.0 : spawn /bin/echo `date` %c %d &gt;&gt; /var/log/intruder_alert</pre><div class="para">
					The <code class="command">%d</code> token supplies the name of the service that the attacker was trying to access.
				</div><div class="para">
					To allow the connection and log it, place the <code class="command">spawn</code> directive in the <code class="filename">/etc/hosts.allow</code> file.
				</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Because the <code class="command">spawn</code> directive executes 
any shell command, it is a good idea to create a special script to 
notify the administrator or execute a chain of commands in the event 
that a particular client attempts to connect to the server.
					</div></div></div></div><div class="section" id="sect-Security_Guide-Enhancing_Security_With_TCP_Wrappers-TCP_Wrappers_and_Enhanced_Logging"><div class="titlepage"><div><div><h5 class="title">2.2.1.1.3.&nbsp;TCP Wrappers and Enhanced Logging</h5></div></div></div><div class="para">
					If certain types of connections are of more concern than others, the log level can be elevated for that service using the <code class="command">severity</code> option.
				</div><div class="para">
					For this example, assume that anyone attempting to connect to port 
23 (the Telnet port) on an FTP server is an attacker. To denote this, 
place an <code class="command">emerg</code> flag in the log files instead of the default flag, <code class="command">info</code>, and deny the connection.
				</div><div class="para">
					To do this, place the following line in <code class="filename">/etc/hosts.deny</code>:
				</div><pre class="programlisting">in.telnetd : ALL : severity emerg</pre><div class="para">
					This uses the default <code class="command">authpriv</code> logging facility, but elevates the priority from the default value of <code class="command">info</code> to <code class="command">emerg</code>, which posts log messages directly to the console.
				</div></div></div><div class="section" id="sect-Security_Guide-Securing_Services_With_TCP_Wrappers_and_xinetd-Enhancing_Security_With_xinetd"><div class="titlepage"><div><div><h4 class="title">2.2.1.2.&nbsp;Enhancing Security With xinetd</h4></div></div></div><div class="para">
				This section focuses on using <code class="command">xinetd</code> to set a trap service and using it to control resource levels available to any given <code class="command">xinetd</code> service. Setting resource limits for services can help thwart <em class="firstterm">Denial of Service</em> (<acronym class="acronym">DoS</acronym>) attacks. Refer to the man pages for <code class="command">xinetd</code> and <code class="filename">xinetd.conf</code> for a list of available options.
			</div><div class="section" id="sect-Security_Guide-Enhancing_Security_With_xinetd-Setting_a_Trap"><div class="titlepage"><div><div><h5 class="title">2.2.1.2.1.&nbsp;Setting a Trap</h5></div></div></div><div class="para">
					One important feature of <code class="command">xinetd</code> is its ability to add hosts to a global <code class="filename">no_access</code> list. Hosts on this list are denied subsequent connections to services managed by <code class="command">xinetd</code> for a specified period or until <code class="command">xinetd</code> is restarted. You can do this using the <code class="command">SENSOR</code> attribute. This is an easy way to block hosts attempting to scan the ports on the server.
				</div><div class="para">
					The first step in setting up a <code class="command">SENSOR</code> is to choose a service you do not plan on using. For this example, Telnet is used.
				</div><div class="para">
					Edit the file <code class="filename">/etc/xinetd.d/telnet</code> and change the <code class="option">flags</code> line to read:
				</div><pre class="programlisting">flags           = SENSOR</pre><div class="para">
					Add the following line:
				</div><pre class="programlisting">deny_time       = 30</pre><div class="para">
					This denies any further connection attempts to that port by that host for 30 minutes. Other acceptable values for the <code class="command">deny_time</code> attribute are FOREVER, which keeps the ban in effect until <code class="command">xinetd</code> is restarted, and NEVER, which allows the connection and logs it.
				</div><div class="para">
					Finally, the last line should read:
				</div><pre class="programlisting">disable         = no</pre><div class="para">
					This enables the trap itself.
				</div><div class="para">
					While using <code class="option">SENSOR</code> is a good way to detect and stop connections from undesirable hosts, it has two drawbacks:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							It does not work against stealth scans.
						</div></li><li class="listitem"><div class="para">
							An attacker who knows that a <code class="option">SENSOR</code> 
is running can mount a Denial of Service attack against particular hosts
 by forging their IP addresses and connecting to the forbidden port.
						</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Enhancing_Security_With_xinetd-Controlling_Server_Resources"><div class="titlepage"><div><div><h5 class="title">2.2.1.2.2.&nbsp;Controlling Server Resources</h5></div></div></div><div class="para">
					Another important feature of <code class="command">xinetd</code> is its ability to set resource limits for services under its control.
				</div><div class="para">
					It does this using the following directives:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">cps = &lt;number_of_connections&gt; &lt;wait_period&gt;</code> — Limits the rate of incoming connections. This directive takes two arguments:
						</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="option">&lt;number_of_connections&gt;</code> — The
 number of connections per second to handle. If the rate of incoming 
connections is higher than this, the service is temporarily disabled. 
The default value is fifty (50).
								</div></li><li class="listitem"><div class="para">
									<code class="option">&lt;wait_period&gt;</code> — The number of
 seconds to wait before re-enabling the service after it has been 
disabled. The default interval is ten (10) seconds.
								</div></li></ul></div></li><li class="listitem"><div class="para">
							<code class="option">instances = &lt;number_of_connections&gt;</code> — Specifies the total number of connections allowed to a service. This directive accepts either an integer value or <code class="command">UNLIMITED</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="option">per_source = &lt;number_of_connections&gt;</code> — Specifies the number of connections allowed to a service by each host. This directive accepts either an integer value or <code class="command">UNLIMITED</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="option">rlimit_as = &lt;number[K|M]&gt;</code> — 
Specifies the amount of memory address space the service can occupy in 
kilobytes or megabytes. This directive accepts either an integer value 
or <code class="command">UNLIMITED</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="option">rlimit_cpu = &lt;number_of_seconds&gt;</code> — Specifies the amount of time in seconds that a service may occupy the CPU. This directive accepts either an integer value or <code class="command">UNLIMITED</code>.
						</div></li></ul></div><div class="para">
					Using these directives can help prevent any single <code class="command">xinetd</code> service from overwhelming the system, resulting in a denial of service.
				</div></div></div></div><div class="section" id="sect-Security_Guide-Server_Security-Securing_Portmap"><div class="titlepage"><div><div><h3 class="title">2.2.2.&nbsp;Securing Portmap</h3></div></div></div><div class="para">
			The <code class="command">portmap</code> service is a dynamic port 
assignment daemon for RPC services such as NIS and NFS. It has weak 
authentication mechanisms and has the ability to assign a wide range of 
ports for the services it controls. For these reasons, it is difficult 
to secure.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Securing <code class="command">portmap</code> only affects NFSv2 and
 NFSv3 implementations, since NFSv4 no longer requires it. If you plan 
to implement an NFSv2 or NFSv3 server, then <code class="command">portmap</code> is required, and the following section applies.
			</div></div></div><div class="para">
			If running RPC services, follow these basic rules.
		</div><div class="section" id="sect-Security_Guide-Securing_Portmap-Protect_portmap_With_TCP_Wrappers"><div class="titlepage"><div><div><h4 class="title">2.2.2.1.&nbsp;Protect portmap With TCP Wrappers</h4></div></div></div><div class="para">
				It is important to use TCP Wrappers to limit which networks or hosts have access to the <code class="command">portmap</code> service since it has no built-in form of authentication.
			</div><div class="para">
				Further, use <span class="emphasis"><em>only</em></span> IP 
addresses when limiting access to the service. Avoid using hostnames, as
 they can be forged by DNS poisoning and other methods.
			</div></div><div class="section" id="sect-Security_Guide-Securing_Portmap-Protect_portmap_With_iptables"><div class="titlepage"><div><div><h4 class="title">2.2.2.2.&nbsp;Protect portmap With iptables</h4></div></div></div><div class="para">
				To further restrict access to the <code class="command">portmap</code> service, it is a good idea to add iptables rules to the server and restrict access to specific networks.
			</div><div class="para">
				Below are two example iptables commands. The first allows TCP connections to the port 111 (used by the <code class="command">portmap</code>
 service) from the 192.168.0.0/24 network. The second allows TCP 
connections to the same port from the localhost. This is necessary for 
the <code class="command">sgi_fam</code> service used by <span class="application"><strong>Nautilus</strong></span>. All other packets are dropped.
			</div><pre class="screen">~]# <code class="command">iptables -A INPUT -p tcp -s ! 192.168.0.0/24 --dport 111 -j DROP</code>
~]# <code class="command">iptables -A INPUT -p tcp -s 127.0.0.1 --dport 111 -j ACCEPT</code></pre><div class="para">
				To similarly limit UDP traffic, use the following command:
			</div><pre class="screen">~]# <code class="command">iptables -A INPUT -p udp -s ! 192.168.0.0/24 --dport 111 -j DROP</code></pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Refer to <a class="xref" href="#sect-Security_Guide-Firewalls">Section&nbsp;2.8, “Firewalls”</a> for more information about implementing firewalls with iptables commands.
				</div></div></div></div></div><div class="section" id="sect-Security_Guide-Server_Security-Securing_NIS"><div class="titlepage"><div><div><h3 class="title">2.2.3.&nbsp;Securing NIS</h3></div></div></div><div class="para">
			The <em class="firstterm">Network Information Service</em> (<acronym class="acronym">NIS</acronym>) is an RPC service, called <code class="command">ypserv</code>, which is used in conjunction with <code class="command">portmap</code>
 and other related services to distribute maps of user names, passwords,
 and other sensitive information to any computer claiming to be within 
its domain.
		</div><div class="para">
			A NIS server is comprised of several applications. They include the following:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="command">/usr/sbin/rpc.yppasswdd</code> — Also called the <code class="command">yppasswdd</code> service, this daemon allows users to change their NIS passwords.
				</div></li><li class="listitem"><div class="para">
					<code class="command">/usr/sbin/rpc.ypxfrd</code> — Also called the <code class="command">ypxfrd</code> service, this daemon is responsible for NIS map transfers over the network.
				</div></li><li class="listitem"><div class="para">
					<code class="command">/usr/sbin/yppush</code> — This application propagates changed NIS databases to multiple NIS servers.
				</div></li><li class="listitem"><div class="para">
					<code class="command">/usr/sbin/ypserv</code> — This is the NIS server daemon.
				</div></li></ul></div><div class="para">
			NIS is somewhat insecure by today's standards. It has no host 
authentication mechanisms and transmits all of its information over the 
network unencrypted, including password hashes. As a result, extreme 
care must be taken when setting up a network that uses NIS. This is 
further complicated by the fact that the default configuration of NIS is
 inherently insecure.
		</div><div class="para">
			It is recommended that anyone planning to implement a NIS server first secure the <code class="command">portmap</code> service as outlined in <a class="xref" href="#sect-Security_Guide-Server_Security-Securing_Portmap">Section&nbsp;2.2.2, “Securing Portmap”</a>, then address the following issues, such as network planning.
		</div><div class="section" id="sect-Security_Guide-Securing_NIS-Carefully_Plan_the_Network"><div class="titlepage"><div><div><h4 class="title">2.2.3.1.&nbsp;Carefully Plan the Network</h4></div></div></div><div class="para">
				Because NIS transmits sensitive information unencrypted over the 
network, it is important the service be run behind a firewall and on a 
segmented and secure network. Whenever NIS information is transmitted 
over an insecure network, it risks being intercepted. Careful network 
design can help prevent severe security breaches.
			</div></div><div class="section" id="sect-Security_Guide-Securing_NIS-Use_a_Password_like_NIS_Domain_Name_and_Hostname"><div class="titlepage"><div><div><h4 class="title">2.2.3.2.&nbsp;Use a Password-like NIS Domain Name and Hostname</h4></div></div></div><div class="para">
				Any machine within a NIS domain can use commands to extract 
information from the server without authentication, as long as the user 
knows the NIS server's DNS hostname and NIS domain name.
			</div><div class="para">
				For instance, if someone either connects a laptop computer into the 
network or breaks into the network from outside (and manages to spoof an
 internal IP address), the following command reveals the <code class="command">/etc/passwd</code> map:
			</div><pre class="synopsis"><code class="command">ypcat</code> <code class="option">-d</code> <em class="replaceable">&lt;NIS_domain&gt;</em> <code class="option">-h</code> <em class="replaceable">&lt;DNS_hostname&gt;</em> <code class="option">passwd</code></pre><div class="para">
				If this attacker is a root user, they can obtain the <code class="command">/etc/shadow</code> file by typing the following command:
			</div><pre class="synopsis"><code class="command">ypcat</code> <code class="option">-d</code> <em class="replaceable">&lt;NIS_domain&gt;</em> <code class="option">-h</code> <em class="replaceable">&lt;DNS_hostname&gt;</em> <code class="option">shadow</code></pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					If Kerberos is used, the <code class="command">/etc/shadow</code> file is not stored within a NIS map.
				</div></div></div><div class="para">
				To make access to NIS maps harder for an attacker, create a random string for the DNS hostname, such as <code class="filename">o7hfawtgmhwg.domain.com</code>. Similarly, create a <span class="emphasis"><em>different</em></span> randomized NIS domain name. This makes it much more difficult for an attacker to access the NIS server.
			</div></div><div class="section" id="sect-Security_Guide-Securing_NIS-Edit_the_varypsecurenets_File"><div class="titlepage"><div><div><h4 class="title">2.2.3.3.&nbsp;Edit the <code class="filename">/var/yp/securenets</code> File</h4></div></div></div><div class="para">
				If the <code class="filename">/var/yp/securenets</code> file is 
blank or does not exist (as is the case after a default installation), 
NIS listens to all networks. One of the first things to do is to put 
netmask/network pairs in the file so that <code class="command">ypserv</code> only responds to requests from the appropriate network.
			</div><div class="para">
				Below is a sample entry from a <code class="filename">/var/yp/securenets</code> file:
			</div><pre class="programlisting">255.255.255.0     192.168.0.0</pre><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
					Never start a NIS server for the first time without creating the <code class="filename">/var/yp/securenets</code> file.
				</div></div></div><div class="para">
				This technique does not provide protection from an IP spoofing 
attack, but it does at least place limits on what networks the NIS 
server services.
			</div></div><div class="section" id="sect-Security_Guide-Securing_NIS-Assign_Static_Ports_and_Use_iptables_Rules"><div class="titlepage"><div><div><h4 class="title">2.2.3.4.&nbsp;Assign Static Ports and Use iptables Rules</h4></div></div></div><div class="para">
				All of the servers related to NIS can be assigned specific ports except for <code class="command">rpc.yppasswdd</code> — the daemon that allows users to change their login passwords. Assigning ports to the other two NIS server daemons, <code class="command">rpc.ypxfrd</code> and <code class="command">ypserv</code>, allows for the creation of firewall rules to further protect the NIS server daemons from intruders.
			</div><div class="para">
				To do this, add the following lines to <code class="filename">/etc/sysconfig/network</code>:
			</div><pre class="programlisting">YPSERV_ARGS="-p 834"
YPXFRD_ARGS="-p 835"</pre><div class="para">
				The following iptables rules can then be used to enforce which network the server listens to for these ports:
			</div><pre class="screen">~]# <code class="command">iptables -A INPUT -p ALL -s ! 192.168.0.0/24 --dport 834 -j DROP</code>
~]# <code class="command">iptables -A INPUT -p ALL -s ! 192.168.0.0/24 --dport 835 -j DROP</code></pre><div class="para">
				This means that the server only allows connections to ports 834 and 
835 if the requests come from the 192.168.0.0/24 network, regardless of 
the protocol.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Refer to <a class="xref" href="#sect-Security_Guide-Firewalls">Section&nbsp;2.8, “Firewalls”</a> for more information about implementing firewalls with iptables commands.
				</div></div></div></div><div class="section" id="sect-Security_Guide-Securing_NIS-Use_Kerberos_Authentication"><div class="titlepage"><div><div><h4 class="title">2.2.3.5.&nbsp;Use Kerberos Authentication</h4></div></div></div><div class="para">
				One of the issues to consider when NIS is used for authentication is
 that whenever a user logs into a machine, a password hash from the <code class="filename">/etc/shadow</code>
 map is sent over the network. If an intruder gains access to a NIS 
domain and sniffs network traffic, they can collect user names and 
password hashes. With enough time, a password cracking program can guess
 weak passwords, and an attacker can gain access to a valid account on 
the network.
			</div><div class="para">
				Since Kerberos uses secret-key cryptography, no password hashes are 
ever sent over the network, making the system far more secure. Refer to <em class="citetitle">Managing Single Sign-On and Smart Cards</em> for more information about Kerberos.
			</div></div></div><div class="section" id="sect-Security_Guide-Server_Security-Securing_NFS"><div class="titlepage"><div><div><h3 class="title">2.2.4.&nbsp;Securing NFS</h3></div></div></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				The version of NFS included in Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6, NFSv4, no longer requires the <code class="command">portmap</code> service as outlined in <a class="xref" href="#sect-Security_Guide-Server_Security-Securing_Portmap">Section&nbsp;2.2.2, “Securing Portmap”</a>.
 NFS traffic now utilizes TCP in all versions, rather than UDP, and 
requires it when using NFSv4. NFSv4 now includes Kerberos user and group
 authentication, as part of the <code class="filename">RPCSEC_GSS</code> kernel module. Information on <code class="command">portmap</code> is still included, since Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 supports NFSv2 and NFSv3, both of which utilize <code class="command">portmap</code>.
			</div></div></div><div class="section" id="sect-Security_Guide-Securing_NFS-Carefully_Plan_the_Network"><div class="titlepage"><div><div><h4 class="title">2.2.4.1.&nbsp;Carefully Plan the Network</h4></div></div></div><div class="para">
				NFSv2 and NFSv3 traditionally passed data insecurely. All versions 
of NFS now have the ability to authenticate (and optionally encrypt) 
ordinary file system operations using Kerberos. Under NFSv4 all 
operations can use Kerberos; under v2 or v3, file locking and mounting 
still do not use it. When using NFSv4.0, delegations may be turned off 
if the clients are behind NAT or a firewall. Refer to the section on 
pNFS in the <em class="citetitle">Storage Administration Guide</em> for information on the use of NFSv4.1 to allow delegations to operate through NAT and firewalls.
			</div></div><div class="section" id="sect-Security_Guide-Securing_NFS-Mount_Options"><div class="titlepage"><div><div><h4 class="title">2.2.4.2.&nbsp;Securing NFS Mount Options</h4></div></div></div><div class="para">
				The use of the <code class="command">mount</code> command in the <code class="filename">/etc/fstab</code>
 file is explained in the Storage Administration Guide. From a security 
administration point of view it is worthwhile to note that the NFS mount
 options can also be specified in <code class="filename">/etc/nfsmount.conf</code>, which can be used to set custom default options.
			</div><div class="section" id="sect-Security_Guide-Securing_NFS-Mount_Options-Review_the_NFS_Server"><div class="titlepage"><div><div><h5 class="title">2.2.4.2.1.&nbsp;Review the NFS Server</h5></div></div></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
						Only export entire file systems. Exporting a subdirectory of a 
file system can be a security issue. It is possible in some cases for a 
client to "break out" of the exported part of the file system and get to
 unexported parts (see the section on subtree checking in the <code class="filename">exports(5)</code> man page.
					</div></div></div><div class="para">
					Use the <code class="option">ro</code> option to export the file 
system as read-only whenever possible to reduce the number of users able
 to write to the mounted file system. Only use the <code class="option">rw</code> option when specifically required. Refer to the man <code class="filename">exports(5)</code>
 page for more information. Allowing write access increases the risk 
from symlink attacks for example. This includes temporary directories 
such as <code class="filename">/tmp</code> and <code class="filename">/usr/tmp</code>.
				</div><div class="para">
					Where directories must be mounted with the <code class="option">rw</code>
 option avoid making them world-writable whenever possible to reduce 
risk. Exporting home directories is also viewed as a risk as some 
applications store passwords in clear text or weakly encrypted. This 
risk is being reduced as application code is reviewed and improved. Some
 users do not set passwords on their SSH keys so this too means home 
directories present a risk. Enforcing the use of passwords or using 
Kerberos would mitigate that risk.
				</div><div class="para">
					Restrict exports only to clients that need access. Use the <code class="command">showmount&nbsp;-e</code> command on an NFS server to review what the server is exporting. Do not export anything that is not specifically required.
				</div><div class="para">
					Do not use the <code class="command">no_root_squash</code> option and review existing installations to make sure it is not used. Refer to <a class="xref" href="#sect-Security_Guide-Securing_NFS-Do_Not_Use_the_no_root_squash_Option">Section&nbsp;2.2.4.4, “Do Not Use the <code class="command">no_root_squash</code> Option”</a> for more information.
				</div><div class="para">
					The <code class="option">secure</code> option is the server-side export option used to restrict exports to <span class="quote">“<span class="quote">reserved</span>”</span> ports. By default, the server allows client communication only from <span class="quote">“<span class="quote">reserved</span>”</span> ports (ports numbered less than 1024), because traditionally clients have only allowed <span class="quote">“<span class="quote">trusted</span>”</span>
 code (such as in-kernel NFS clients) to use those ports. However, on 
many networks it is not difficult for anyone to become root on some 
client, so it is rarely safe for the server to assume that communication
 from a reserved port is privileged. Therefore the restriction to 
reserved ports is of limited value; it is better to rely on Kerberos, 
firewalls, and restriction of exports to particular clients.
				</div><div class="para">
					Most clients still do use reserved ports when possible. However, 
reserved ports are a limited resource, so clients (especially those with
 a large number of NFS mounts) may choose to use higher-numbered ports 
as well. Linux clients may do this using the <span class="quote">“<span class="quote">noresvport</span>”</span> mount option. If you want to allow this on an export, you may do so with the <span class="quote">“<span class="quote">insecure</span>”</span> export option.
				</div><div class="para">
					It is good practice not to allow users to login to a server. While 
reviewing the above settings on an NFS server conduct a review of who 
and what can access the server.
				</div></div><div class="section" id="sect-Security_Guide-Securing_NFS-Mount_Options-Review_the_NFS_Client"><div class="titlepage"><div><div><h5 class="title">2.2.4.2.2.&nbsp;Review the NFS Client</h5></div></div></div><div class="para">
					Use the <code class="option">nosuid</code> option to disallow the use of a <span class="application"><strong>setuid</strong></span> program. The <code class="option">nosuid</code> option disables the <code class="literal">set-user-identifier</code> or <code class="literal">set-group-identifier</code>
 bits. This prevents remote users from gaining higher privileges by 
running a setuid program. Use this option on the client and the server 
side.
				</div><div class="para">
					The <code class="option">noexec</code> option disables all 
executable files on the client. Use this to prevent users from 
inadvertently executing files placed in the file system being shared. 
The <code class="option">nosuid</code> and <code class="option">noexec</code> options are standard options for most, if not all, file systems.
				</div><div class="para">
					Use the <code class="option">nodev</code> option to prevent <span class="quote">“<span class="quote">device-files</span>”</span> from being processed as a hardware device by the client.
				</div><div class="para">
					The <code class="option">resvport</code> option is a client-side mount option and <code class="option">secure</code>
 is the corresponding server-side export option (see explanation above).
 It restricts communication to a "reserved port". The reserved or "well 
known" ports are reserved for privileged users and processes such as the
 root user. Setting this option causes the client to use a reserved 
source port to communicate with the server.
				</div><div class="para">
					All versions of NFS now support mounting with Kerberos authentication. The mount option to enable this is: <code class="option">sec=krb5</code>.
				</div><div class="para">
					NFSv4 supports mounting with Kerberos using <code class="option">krb5i</code> for integrity and <code class="option">krb5p</code> for privacy protection. These are used when mounting with <code class="option">sec=krb5</code>, but need to be configured on the NFS server. Refer to the man page on exports (<code class="filename">man 5 exports</code>) for more information.
				</div><div class="para">
					The NFS man page (<code class="filename">man 5 nfs</code>) has a <span class="quote">“<span class="quote">SECURITY CONSIDERATIONS</span>”</span> section which explains the security enhancements in NFSv4 and contains all the NFS specific mount options.
				</div></div></div><div class="section" id="sect-Security_Guide-Securing_NFS-Beware_of_Syntax_Errors"><div class="titlepage"><div><div><h4 class="title">2.2.4.3.&nbsp;Beware of Syntax Errors</h4></div></div></div><div class="para">
				The NFS server determines which file systems to export and which hosts to export these directories to by consulting the <code class="filename">/etc/exports</code> file. Be careful not to add extraneous spaces when editing this file.
			</div><div class="para">
				For instance, the following line in the <code class="filename">/etc/exports</code> file shares the directory <code class="command">/tmp/nfs/</code> to the host <code class="command">bob.example.com</code> with read/write permissions.
			</div><pre class="programlisting">/tmp/nfs/     bob.example.com(rw)</pre><div class="para">
				The following line in the <code class="filename">/etc/exports</code> file, on the other hand, shares the same directory to the host <code class="computeroutput">bob.example.com</code> with read-only permissions and shares it to the <span class="emphasis"><em>world</em></span> with read/write permissions due to a single space character after the hostname.
			</div><pre class="programlisting">/tmp/nfs/     bob.example.com (rw)</pre><div class="para">
				It is good practice to check any configured NFS shares by using the <code class="command">showmount</code> command to verify what is being shared:
			</div><pre class="synopsis"><code class="command">showmount</code> <code class="option">-e</code> <em class="replaceable">&lt;hostname&gt;</em></pre></div><div class="section" id="sect-Security_Guide-Securing_NFS-Do_Not_Use_the_no_root_squash_Option"><div class="titlepage"><div><div><h4 class="title">2.2.4.4.&nbsp;Do Not Use the <code class="command">no_root_squash</code> Option</h4></div></div></div><div class="para">
				By default, NFS shares change the root user to the <code class="command">nfsnobody</code> user, an unprivileged user account. This changes the owner of all root-created files to <code class="command">nfsnobody</code>, which prevents uploading of programs with the setuid bit set.
			</div><div class="para">
				If <code class="command">no_root_squash</code> is used, remote root 
users are able to change any file on the shared file system and leave 
applications infected by Trojans for other users to inadvertently 
execute.
			</div></div><div class="section" id="sect-Security_Guide-Securing_NFS-NFS_Firewall_Configuration"><div class="titlepage"><div><div><h4 class="title">2.2.4.5.&nbsp;NFS Firewall Configuration</h4></div></div></div><div class="para">
				The ports used for NFS are assigned dynamically by rpcbind, which 
can cause problems when creating firewall rules. To simplify this 
process, use the <span class="emphasis"><em>/etc/sysconfig/nfs</em></span> file to specify which ports are to be used:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="command">MOUNTD_PORT</code> — TCP and UDP port for mountd (rpc.mountd)
					</div></li><li class="listitem"><div class="para">
						<code class="command">STATD_PORT</code> — TCP and UDP port for status (rpc.statd)
					</div></li><li class="listitem"><div class="para">
						<code class="command">LOCKD_TCPPORT</code> — TCP port for nlockmgr (rpc.lockd)
					</div></li><li class="listitem"><div class="para">
						<code class="command">LOCKD_UDPPORT</code> — UDP port nlockmgr (rpc.lockd)
					</div></li></ul></div><div class="para">
				Port numbers specified must not be used by any other service. 
Configure your firewall to allow the port numbers specified, as well as 
TCP and UDP port 2049 (NFS).
			</div><div class="para">
				Run the <code class="command">rpcinfo -p</code> command on the NFS server to see which ports and RPC programs are being used.
			</div></div></div><div class="section" id="sect-Security_Guide-Server_Security-Securing_the_Apache_HTTP_Server"><div class="titlepage"><div><div><h3 class="title">2.2.5.&nbsp;Securing the Apache HTTP Server</h3></div></div></div><div class="para">
			The Apache HTTP Server is one of the most stable and secure services 
that ships with Red&nbsp;Hat Enterprise&nbsp;Linux. A large number of 
options and techniques are available to secure the Apache HTTP Server — 
too numerous to delve into deeply here. The following section briefly 
explains good practices when running the Apache HTTP Server.
		</div><div class="para">
			Always verify that any scripts running on the system work as intended <span class="emphasis"><em>before</em></span>
 putting them into production. Also, ensure that only the root user has 
write permissions to any directory containing scripts or CGIs. To do 
this, run the following commands as the root user:
		</div><pre class="synopsis"><code class="command">chown</code> <code class="option">root</code> <em class="replaceable">&lt;directory_name&gt;</em></pre><pre class="synopsis"><code class="command">chmod</code> <code class="option">755</code> <em class="replaceable">&lt;directory_name&gt;</em></pre><div class="para">
			System administrators should be careful when using the following configuration options (configured in <code class="filename">/etc/httpd/conf/httpd.conf</code>):
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">FollowSymLinks</code></span></dt><dd><div class="para">
						This directive is enabled by default, so be sure to use caution 
when creating symbolic links to the document root of the Web server. For
 instance, it is a bad idea to provide a symbolic link to <code class="filename">/</code>.
					</div></dd><dt><span class="term"><code class="option">Indexes</code></span></dt><dd><div class="para">
						This directive is enabled by default, but may not be desirable. To
 prevent visitors from browsing files on the server, remove this 
directive.
					</div></dd><dt><span class="term"><code class="option">UserDir</code></span></dt><dd><div class="para">
						The <code class="option">UserDir</code> directive is disabled by 
default because it can confirm the presence of a user account on the 
system. To enable user directory browsing on the server, use the 
following directives:
					</div><pre class="programlisting">UserDir enabled
UserDir disabled root</pre><div class="para">
						These directives activate user directory browsing for all user directories other than <code class="filename">/root/</code>. To add users to the list of disabled accounts, add a space-delimited list of users on the <code class="option">UserDir disabled</code> line.
					</div></dd><dt><span class="term"><code class="option">ServerTokens</code></span></dt><dd><div class="para">
						The <code class="option">ServerTokens</code> directive controls 
the server response header field which is sent back to clients. It 
includes various information which can be customized using the following
 parameters:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="option">ServerTokens Full</code> (default option) — provides all available information (OS type and used modules), for example:
							</div><pre class="screen">Apache/2.0.41 (Unix) PHP/4.2.2 MyMod/1.2</pre></li><li class="listitem"><div class="para">
								<code class="option">ServerTokens Prod</code> or <code class="option">ServerTokens ProductOnly</code> — provides the following information:
							</div><pre class="screen">Apache</pre></li><li class="listitem"><div class="para">
								<code class="option">ServerTokens Major</code> — provides the following information:
							</div><pre class="screen">Apache/2
</pre></li><li class="listitem"><div class="para">
								<code class="option">ServerTokens Minor</code> — provides the following information:
							</div><pre class="screen">Apache/2.0</pre></li><li class="listitem"><div class="para">
								<code class="option">ServerTokens Min</code> or <code class="option">ServerTokens Minimal</code> — provides the following information:
							</div><pre class="screen">Apache/2.0.41</pre></li><li class="listitem"><div class="para">
								<code class="option">ServerTokens OS</code> — provides the following information:
							</div><pre class="screen">Apache/2.0.41 (Unix)</pre></li></ul></div><div class="para">
						It is recommended to use the <code class="option">ServerTokens Prod</code> option so that a possible attacker does not gain any valuable information about your system.
					</div></dd></dl></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				Do not remove the <code class="option">IncludesNoExec</code> directive. By default, the <em class="firstterm">Server-Side Includes</em> (<abbr class="abbrev">SSI</abbr>)
 module cannot execute commands. It is recommended that you do not 
change this setting unless absolutely necessary, as it could, 
potentially, enable an attacker to execute commands on the system.
			</div></div></div><h4 id="idm140226861904304">Removing httpd Modules</h4><div class="para">
			In certain scenarios, it is beneficial to remove certain <code class="systemitem">httpd</code>
 modules to limit the functionality of the HTTP Server. To do so, simply
 comment out the entire line which loads the module you want to remove 
in the <code class="filename">/etc/httpd/conf/httpd.conf</code> file. For example, to remove the proxy module, comment out the following line by prepending it with a hash sign:
		</div><pre class="screen">#LoadModule proxy_module modules/mod_proxy.so</pre><div class="para">
			Note that the <code class="filename">/etc/httpd/conf.d/</code> directory contains configuration files which are used to load modules as well.
		</div><h4 id="idm140226874158288">httpd and SELinux</h4><div class="para">
			For information regarding the Apache HTTP Server and SELinux, see the <em class="citetitle">Managing Confined Services Guide</em>.
		</div></div><div class="section" id="sect-Security_Guide-Server_Security-Securing_FTP"><div class="titlepage"><div><div><h3 class="title">2.2.6.&nbsp;Securing FTP</h3></div></div></div><div class="para">
			The <em class="firstterm">File Transfer Protocol</em> (<abbr class="abbrev">FTP</abbr>)
 is an older TCP protocol designed to transfer files over a network. 
Because all transactions with the server, including user authentication,
 are unencrypted, it is considered an insecure protocol and should be 
carefully configured.
		</div><div class="para">
			Red&nbsp;Hat Enterprise&nbsp;Linux provides three FTP servers.
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="command">gssftpd</code> — A Kerberos-aware <code class="command">xinetd</code>-based FTP daemon that does not transmit authentication information over the network.
				</div></li><li class="listitem"><div class="para">
					<span class="application"><strong>Red&nbsp;Hat Content Accelerator</strong></span> (<code class="command">tux</code>) — A kernel-space Web server with FTP capabilities.
				</div></li><li class="listitem"><div class="para">
					<code class="command">vsftpd</code> — A standalone, security oriented implementation of the FTP service.
				</div></li></ul></div><div class="para">
			The following security guidelines are for setting up the <code class="command">vsftpd</code> FTP service.
		</div><div class="section" id="sect-Security_Guide-Securing_FTP-FTP_Greeting_Banner"><div class="titlepage"><div><div><h4 class="title">2.2.6.1.&nbsp;FTP Greeting Banner</h4></div></div></div><div class="para">
				Before submitting a user name and password, all users are presented 
with a greeting banner. By default, this banner includes version 
information useful to attackers trying to identify weaknesses in a 
system.
			</div><div class="para">
				To change the greeting banner for <code class="command">vsftpd</code>, add the following directive to the <code class="filename">/etc/vsftpd/vsftpd.conf</code> file:
			</div><pre class="programlisting">ftpd_banner=<em class="replaceable">&lt;insert_greeting_here&gt;</em></pre><div class="para">
				Replace <em class="replaceable">&lt;insert_greeting_here&gt;</em> in the above directive with the text of the greeting message.
			</div><div class="para">
				For mutli-line banners, it is best to use a banner file. To simplify
 management of multiple banners, place all banners in a new directory 
called <code class="filename">/etc/banners/</code>. The banner file for FTP connections in this example is <code class="filename">/etc/banners/ftp.msg</code>. Below is an example of what such a file may look like:
			</div><pre class="programlisting">######### Hello, all activity on ftp.example.com is logged. #########</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					It is not necessary to begin each line of the file with <code class="command">220</code> as specified in <a class="xref" href="#sect-Security_Guide-Enhancing_Security_With_TCP_Wrappers-TCP_Wrappers_and_Connection_Banners">Section&nbsp;2.2.1.1.1, “TCP Wrappers and Connection Banners”</a>.
				</div></div></div><div class="para">
				To reference this greeting banner file for <code class="command">vsftpd</code>, add the following directive to the <code class="filename">/etc/vsftpd/vsftpd.conf</code> file:
			</div><pre class="programlisting">banner_file=/etc/banners/ftp.msg</pre><div class="para">
				It also is possible to send additional banners to incoming connections using TCP Wrappers as described in <a class="xref" href="#sect-Security_Guide-Enhancing_Security_With_TCP_Wrappers-TCP_Wrappers_and_Connection_Banners">Section&nbsp;2.2.1.1.1, “TCP Wrappers and Connection Banners”</a>.
			</div></div><div class="section" id="sect-Security_Guide-Securing_FTP-Anonymous_Access"><div class="titlepage"><div><div><h4 class="title">2.2.6.2.&nbsp;Anonymous Access</h4></div></div></div><div class="para">
				The presence of the <code class="filename">/var/ftp/</code> directory activates the anonymous account.
			</div><div class="para">
				The easiest way to create this directory is to install the <code class="filename">vsftpd</code>
 package. This package establishes a directory tree for anonymous users 
and configures the permissions on directories to read-only for anonymous
 users.
			</div><div class="para">
				By default the anonymous user cannot write to any directories.
			</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
					If enabling anonymous access to an FTP server, be aware of where sensitive data is stored.
				</div></div></div><div class="procedure"><p class="title"><strong>Procedure&nbsp;2.1.&nbsp;Anonymous Upload</strong></p><ol class="1"><li class="step"><div class="para">
						To allow anonymous users to upload files, it is recommended to create a write-only directory within the <code class="filename">/var/ftp/pub/</code> directory. Run the following command as root to create such directory named <code class="filename">/upload/</code>:
					</div><pre class="screen">~]# <code class="command">mkdir /var/ftp/pub/upload</code></pre></li><li class="step"><div class="para">
						Next, change the permissions so that anonymous users cannot view the contents of the directory:
					</div><pre class="screen">~]# <code class="command">chmod 730 /var/ftp/pub/upload</code></pre><div class="para">
						A long format listing of the directory should look like this:
					</div><pre class="screen">~]# <code class="command">ls -ld /var/ftp/pub/upload</code>
drwx-wx---. 2 root ftp 4096 Nov 14 22:57 /var/ftp/pub/upload</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Administrators who allow anonymous users to read and write in 
directories often find that their servers become a repository of stolen 
software.
						</div></div></div></li><li class="step"><div class="para">
						Under <code class="command">vsftpd</code>, add the following line to the <code class="filename">/etc/vsftpd/vsftpd.conf</code> file:
					</div><pre class="screen">anon_upload_enable=YES</pre></li><li class="step"><div class="para">
						In Red&nbsp;Hat Enterprise&nbsp;Linux, the SELinux is running in Enforcing mode by default. Therefore, the <code class="systemitem">allow_ftpd_anon_write</code> Boolean must be enabled in order to allow <code class="systemitem">vsftpd</code> to upload files:
					</div><pre class="screen">~]# <code class="command">setsebool -P allow_ftpd_anon_write=1</code></pre></li><li class="step"><div class="para">
						Label the <code class="filename">/upload/</code> directory and its files with the <code class="systemitem">public_content_rw_t</code> SELinux context:
					</div><pre class="screen">~]# <code class="command">semanage fcontext -a -t public_content_rw_t '/var/ftp/pub/upload(/.*)'</code></pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							The <code class="systemitem">semanage</code> utility is provided by the <span class="package">policycoreutils-python</span> package, which is not installed by default. To install it, use the following command as root: 
<pre class="screen">~]# <code class="command">yum install policycoreutils-python</code></pre>

						</div></div></div></li><li class="step"><div class="para">
						Use the <code class="systemitem">restorecon</code> utility to change the type of <code class="filename">/upload/</code> and its files:
					</div><pre class="screen">~]# <code class="command">restorecon -R -v /var/ftp/pub/upload</code></pre><div class="para">
						The directory is now properly labeled with <code class="systemitem">public_content_rw_t</code> so that SELinux in Enforcing mode allows anonymous users to upload files to it:
					</div><pre class="screen">~]$ <code class="command">ls -dZ /var/ftp/pub/upload</code>
drwx-wx---. root root unconfined_u:object_r:public_content_t:s0 /var/ftp/pub/upload/
</pre><div class="para">
						For further information about using SELinux, see the <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/index.html">Security-Enhanced Linux User Guide</a> and <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Confined_Services/index.html">Managing Confined Services</a> guides.
					</div></li></ol></div></div><div class="section" id="sect-Security_Guide-Securing_FTP-User_Accounts"><div class="titlepage"><div><div><h4 class="title">2.2.6.3.&nbsp;User Accounts</h4></div></div></div><div class="para">
				Because FTP transmits unencrypted user names and passwords over 
insecure networks for authentication, it is a good idea to deny system 
users access to the server from their user accounts.
			</div><div class="para">
				To disable all user accounts in <code class="command">vsftpd</code>, add the following directive to <code class="filename">/etc/vsftpd/vsftpd.conf</code>:
			</div><pre class="programlisting">local_enable=NO</pre><div class="section" id="sect-Security_Guide-User_Accounts-Restricting_User_Accounts"><div class="titlepage"><div><div><h5 class="title">2.2.6.3.1.&nbsp;Restricting User Accounts</h5></div></div></div><div class="para">
					To disable FTP access for specific accounts or specific groups of accounts, such as the root user and those with <code class="command">sudo</code> privileges, the easiest way is to use a PAM list file as described in <a class="xref" href="#s2-wstation-privileges-noroot">Section&nbsp;2.1.9.2, “Disallowing Root Access”</a>. The PAM configuration file for <code class="command">vsftpd</code> is <code class="filename">/etc/pam.d/vsftpd</code>.
				</div><div class="para">
					It is also possible to disable user accounts within each service directly.
				</div><div class="para">
					To disable specific user accounts in <code class="command">vsftpd</code>, add the user name to <code class="filename">/etc/vsftpd/ftpusers</code>
				</div></div></div><div class="section" id="sect-Security_Guide-Securing_FTP-Use_TCP_Wrappers_To_Control_Access"><div class="titlepage"><div><div><h4 class="title">2.2.6.4.&nbsp;Use TCP Wrappers To Control Access</h4></div></div></div><div class="para">
				Use TCP Wrappers to control access to either FTP daemon as outlined in <a class="xref" href="#sect-Security_Guide-Securing_Services_With_TCP_Wrappers_and_xinetd-Enhancing_Security_With_TCP_Wrappers">Section&nbsp;2.2.1.1, “Enhancing Security With TCP Wrappers”</a>.
			</div></div></div><div class="section" id="sect-Security_Guide-Server_Security-Securing_Postfix"><div class="titlepage"><div><div><h3 class="title">2.2.7.&nbsp;Securing Postfix</h3></div></div></div><div class="para">
			Postfix is a Mail Transfer Agent (MTA) that uses the Simple Mail 
Transfer Protocol (SMTP) to deliver electronic messages between other 
MTAs and to email clients or delivery agents. Although many MTAs are 
capable of encrypting traffic between one another, most do not, so 
sending email over any public networks is considered an inherently 
insecure form of communication.
		</div><div class="para">
			It is recommended that anyone planning to implement a Postfix server address the following issues.
		</div><div class="section" id="sect-Security_Guide-Securing_Postfix-Limiting_a_Denial_of_Service_Attack"><div class="titlepage"><div><div><h4 class="title">2.2.7.1.&nbsp;Limiting a Denial of Service Attack</h4></div></div></div><div class="para">
				Because of the nature of email, a determined attacker can flood the 
server with mail fairly easily and cause a denial of service. The 
effectiveness of such attacks can be limited by setting limits of the 
directives in the <code class="filename">/etc/postfix/main.cf</code> 
file. You can change the value of the directives which are already there
 or you can add the directives you need with the value you want in the 
following format:
			</div><pre class="screen">&lt;directive&gt; = &lt;value&gt;</pre><div class="para">
				The following is a list of directives that can be used for limiting a denial of service attack:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="command">smtpd_client_connection_rate_limit</code> — 
The maximum number of connection attempts any client is allowed to make 
to this service per time unit (described below). The default value is 0,
 which means a client can make as many connections per time unit as 
Postfix can accept. By default, clients in trusted networks are 
excluded.
					</div></li><li class="listitem"><div class="para">
						<code class="command">anvil_rate_time_unit</code> — This time unit is used for rate limit calculations. The default value is 60 seconds.
					</div></li><li class="listitem"><div class="para">
						<code class="command">smtpd_client_event_limit_exceptions</code> — Clients that are excluded from the connection and rate limit commands. By default, clients in trusted networks are excluded.
					</div></li><li class="listitem"><div class="para">
						<code class="command">smtpd_client_message_rate_limit</code> — The
 maximum number of message deliveries a client is allowed to request per
 time unit (regardless of whether or not Postfix actually accepts those 
messages).
					</div></li><li class="listitem"><div class="para">
						<code class="command">default_process_limit</code> — The default 
maximum number of Postfix child processes that provide a given service. 
This limit can be overruled for specific services in the <code class="filename">master.cf</code> file. By default the value is 100.
					</div></li><li class="listitem"><div class="para">
						<code class="command">queue_minfree</code> — The minimum amount of
 free space in bytes in the queue file system that is needed to receive 
mail. This is currently used by the Postfix SMTP server to decide if it 
will accept any mail at all. By default, the Postfix SMTP server rejects
 <code class="command">MAIL FROM</code> commands when the amount of free
 space is less than 1.5 times the message_size_limit. To specify a 
higher minimum free space limit, specify a queue_minfree value that is 
at least 1.5 times the message_size_limit. By default the queue_minfree 
value is 0.
					</div></li><li class="listitem"><div class="para">
						<code class="command">header_size_limit</code> — The maximum 
amount of memory in bytes for storing a message header. If a header is 
larger, the excess is discarded. By default the value is 102400.
					</div></li><li class="listitem"><div class="para">
						<code class="command">message_size_limit</code> — The maximum size in bytes of a message, including envelope information. By default the value is 10240000.
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Securing_Postfix-NFS_and_Postfix"><div class="titlepage"><div><div><h4 class="title">2.2.7.2.&nbsp;NFS and Postfix</h4></div></div></div><div class="para">
				Never put the mail spool directory, <code class="filename">/var/spool/postfix/</code>, on an NFS shared volume.
			</div><div class="para">
				Because NFSv2 and NFSv3 do not maintain control over user and group 
IDs, two or more users can have the same UID, and receive and read each 
other's mail.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					With NFSv4 using Kerberos, this is not the case, since the <code class="filename">SECRPC_GSS</code> kernel module does not utilize UID-based authentication. However, it is still considered good practice <span class="emphasis"><em>not</em></span> to put the mail spool directory on NFS shared volumes.
				</div></div></div></div><div class="section" id="sect-Security_Guide-Securing_Postfix-Mail_only_Users"><div class="titlepage"><div><div><h4 class="title">2.2.7.3.&nbsp;Mail-only Users</h4></div></div></div><div class="para">
				To help prevent local user exploits on the Postfix server, it is 
best for mail users to only access the Postfix server using an email 
program. Shell accounts on the mail server should not be allowed and all
 user shells in the <code class="filename">/etc/passwd</code> file should be set to <code class="command">/sbin/nologin</code> (with the possible exception of the root user).
			</div></div><div class="section" id="sect-Security_Guide-Disable_Postfix_Network_Listening"><div class="titlepage"><div><div><h4 class="title">2.2.7.4.&nbsp;Disable Postfix Network Listening</h4></div></div></div><div class="para">
				By default, Postfix is set up to only listen to the local loopback address. You can verify this by viewing the file <code class="filename">/etc/postfix/main.cf</code>.
			</div><div class="para">
				View the file <code class="filename">/etc/postfix/main.cf</code> to ensure that only the following <em class="parameter"><code>inet_interfaces</code></em> line appears:
			</div><pre class="screen">inet_interfaces = localhost</pre><div class="para">
				This ensures that Postfix only accepts mail messages (such as cron 
job reports) from the local system and not from the network. This is the
 default setting and protects Postfix from a network attack.
			</div><div class="para">
				For removal of the localhost restriction and allowing Postfix to listen on all interfaces the <em class="parameter"><code>inet_interfaces&nbsp;=&nbsp;all</code></em> setting can be used.
			</div></div><div class="section" id="sect-Security_Guide-Securing_Postfix-Configuring_Postfix_to_Use_SASL"><div class="titlepage"><div><div><h4 class="title">2.2.7.5.&nbsp;Configuring Postfix to Use SASL</h4></div></div></div><div class="para">
				The Red&nbsp;Hat Enterprise&nbsp;Linux version of <span class="application"><strong>Postfix</strong></span> can use the <span class="application"><strong>Dovecot</strong></span> or <span class="application"><strong>Cyrus</strong></span> <code class="systemitem">SASL</code> implementations for <em class="firstterm">SMTP Authentication</em> (or <em class="firstterm">SMTP AUTH</em>). SMTP Authentication is an extension of the <code class="systemitem">Simple Mail Transfer Protocol</code>. When enabled, <code class="systemitem">SMTP</code> clients are required to authenticate to the <code class="systemitem">SMTP</code>
 server using an authentication method supported and accepted by both 
the server and the client. This section describes how to configure <span class="application"><strong>Postfix</strong></span> to make use of the <span class="application"><strong>Dovecot</strong></span> <code class="systemitem">SASL</code> implementation.
			</div><div class="para">
				To install the <span class="application"><strong>Dovecot</strong></span> <code class="systemitem">POP</code>/<code class="systemitem">IMAP</code> server, and thus make the <span class="application"><strong>Dovecot</strong></span> <code class="systemitem">SASL</code> implementation available on your system, issue the following command as the <code class="systemitem">root</code> user:
			</div><pre class="screen">~]# <code class="command">yum install dovecot</code></pre><div class="para">
				The <span class="application"><strong>Postfix</strong></span> <code class="systemitem">SMTP</code> server can communicate with the <span class="application"><strong>Dovecot</strong></span> <code class="systemitem">SASL</code> implementation using either a <em class="firstterm">UNIX-domain socket</em> or a <em class="firstterm">TCP socket</em>. The latter method is only needed in case the <span class="application"><strong>Postfix</strong></span> and <span class="application"><strong>Dovecot</strong></span>
 applications are running on separate machines. This guide gives 
preference to the UNIX-domain socket method, which affords better 
privacy.
			</div><div class="para">
				In order to instruct <span class="application"><strong>Postfix</strong></span> to use the <span class="application"><strong>Dovecot</strong></span> <code class="systemitem">SASL</code>
 implementation, a number of configuration changes need to be performed 
for both applications. Follow the procedures below to effect these 
changes.
			</div><h5 id="brid-Configuring_Postfix_to_Use_SASL-Setting_Up_Dovecot">Setting Up Dovecot</h5><div class="procedure"><ol class="1"><li class="step"><div class="para">
						Modify the main <span class="application"><strong>Dovecot</strong></span> configuration file, <code class="filename">/etc/dovecot/conf.d/10-master.conf</code>,
 to include the following lines (the default configuration file already 
includes most of the relevant section, and the lines just need to be 
uncommented):
					</div><pre class="screen">service auth {
  unix_listener /var/spool/postfix/private/auth {
    mode = 0660
    user = postfix
    group = postfix
  }
}</pre><div class="para">
						The above example assumes the use of UNIX-domain sockets for communication between <span class="application"><strong>Postfix</strong></span> and <span class="application"><strong>Dovecot</strong></span>. It also assumes default settings of the <span class="application"><strong>Postfix</strong></span> <code class="systemitem">SMTP</code> server, which include the mail queue located in the <code class="filename">/var/spool/postfix/</code> directory, and the application running under the <code class="systemitem">postfix</code> user and group. In this way, read and write permissions are limited to the <code class="systemitem">postfix</code> user and group.
					</div><div class="para">
						Alternatively, you can use the following configuration to set up <span class="application"><strong>Dovecot</strong></span> to listen for <span class="application"><strong>Postfix</strong></span> authentication requests via <code class="systemitem">TCP</code>:
					</div><pre class="screen">service auth {
  inet_listener {
    port = <em class="replaceable">12345</em>
  }
}</pre><div class="para">
						In the above example, replace <code class="literal">12345</code> with the number of the port you want to use.
					</div></li><li class="step"><div class="para">
						Edit the <code class="filename">/etc/dovecot/conf.d/10-auth.conf</code> configuration file to instruct <span class="application"><strong>Dovecot</strong></span> to provide the <span class="application"><strong>Postfix</strong></span> <code class="systemitem">SMTP</code> server with the <code class="literal">plain</code> and <code class="literal">login</code> authentication mechanisms:
					</div><pre class="screen">auth_mechanisms = plain login</pre></li></ol></div><h5 id="brid-Configuring_Postfix_to_Use_SASL-Setting_Up_Postfix">Setting Up Postfix</h5><div class="para">
				In the case of <span class="application"><strong>Postfix</strong></span>, only the main configuration file, <code class="filename">/etc/postfix/main.cf</code>, needs to be modified. Add or edit the following configuration directives:
			</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
						Enable SMTP Authentication in the <span class="application"><strong>Postfix</strong></span> <code class="systemitem">SMTP</code> server:
					</div><pre class="screen">smtpd_sasl_auth_enable = yes</pre></li><li class="step"><div class="para">
						Instruct <span class="application"><strong>Postfix</strong></span> to use the <span class="application"><strong>Dovecot</strong></span> <code class="systemitem">SASL</code> implementation for SMTP Authentication:
					</div><pre class="screen">smtpd_sasl_type = dovecot</pre></li><li class="step"><div class="para">
						Provide the authentication path relative to the <span class="application"><strong>Postfix</strong></span> queue directory (note that the use of a relative path ensures that the configuration works regardless of whether the <span class="application"><strong>Postfix</strong></span> server runs in a <span class="application"><strong>chroot</strong></span> or not):
					</div><pre class="screen">smtpd_sasl_path = private/auth</pre><div class="para">
						This step assumes that you want to use UNIX-domain sockets for communication between <span class="application"><strong>Postfix</strong></span> and <span class="application"><strong>Dovecot</strong></span>. To configure <span class="application"><strong>Postfix</strong></span> to look for <span class="application"><strong>Dovecot</strong></span> on a different machine in case you use <code class="systemitem">TCP</code> sockets for communication, use configuration values similar to the following:
					</div><pre class="screen">smtpd_sasl_path = inet:<em class="replaceable">127.0.0.1</em>:<em class="replaceable">12345</em></pre><div class="para">
						In the above example, <code class="literal">127.0.0.1</code> needs to be substituted by the <code class="systemitem">IP</code> address of the <span class="application"><strong>Dovecot</strong></span> machine and <code class="literal">12345</code> by the port specified in <span class="application"><strong>Dovecot</strong></span>'s <code class="filename">/etc/dovecot/conf.d/10-master.conf</code> configuration file.
					</div></li><li class="step"><div class="para">
						Specify <code class="systemitem">SASL</code> mechanisms that the <span class="application"><strong>Postfix</strong></span> <code class="systemitem">SMTP</code> server makes available to clients. Note that different mechanisms can be specified for encrypted and unencrypted sessions.
					</div><pre class="screen">smtpd_sasl_security_options = noanonymous, noplaintext
smtpd_sasl_tls_security_options = noanonymous</pre><div class="para">
						The above example specifies that during unencrypted sessions, no 
anonymous authentication is allowed and no mechanisms that transmit 
unencrypted usernames or passwords are allowed. For encrypted sessions 
(using <code class="systemitem">TLS</code>), only non-anonymous authentication mechanisms are allowed.
					</div><div class="para">
						See <a href="http://www.postfix.org/SASL_README.html#smtpd_sasl_security_options">http://www.postfix.org/SASL_README.html#smtpd_sasl_security_options</a> for a list of all supported policies for limiting allowed <code class="systemitem">SASL</code> mechanisms.
					</div></li></ol></div><h5 id="brid-Configuring_Postfix_to_Use_SASL-Additional_Resources">Additional Resources</h5><div class="para">
				The following online resources provide additional information useful for configuring <span class="application"><strong>Postfix</strong></span> SMTP Authentication through <code class="systemitem">SASL</code>.
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://wiki2.dovecot.org/HowTo/PostfixAndDovecotSASL">http://wiki2.dovecot.org/HowTo/PostfixAndDovecotSASL</a> — Contains information on how to set up <span class="application"><strong>Postfix</strong></span> to use the <span class="application"><strong>Dovecot</strong></span> <code class="systemitem">SASL</code> implementation for SMTP Authentication.
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.postfix.org/SASL_README.html#server_sasl">http://www.postfix.org/SASL_README.html#server_sasl</a> — Contains information on how to set up <span class="application"><strong>Postfix</strong></span> to use either the <span class="application"><strong>Dovecot</strong></span> or <span class="application"><strong>Cyrus</strong></span> <code class="systemitem">SASL</code> implementations for SMTP Authentication.
					</div></li></ul></div></div></div><div class="section" id="sect-Security_Guide-Server_Security-Securing_Sendmail"><div class="titlepage"><div><div><h3 class="title">2.2.8.&nbsp;Securing Sendmail</h3></div></div></div><div class="para">
			Sendmail is a Mail Transfer Agent (MTA) that uses the Simple Mail 
Transfer Protocol (SMTP) to deliver electronic messages between other 
MTAs and to email clients or delivery agents. Although many MTAs are 
capable of encrypting traffic between one another, most do not, so 
sending email over any public networks is considered an inherently 
insecure form of communication.
		</div><div class="para">
			It is recommended that anyone planning to implement a Sendmail server address the following issues.
		</div><div class="section" id="sect-Security_Guide-Securing_Sendmail-Limiting_a_Denial_of_Service_Attack"><div class="titlepage"><div><div><h4 class="title">2.2.8.1.&nbsp;Limiting a Denial of Service Attack</h4></div></div></div><div class="para">
				Because of the nature of email, a determined attacker can flood the 
server with mail fairly easily and cause a denial of service. By setting
 limits to the following directives in <code class="filename">/etc/mail/sendmail.mc</code>, the effectiveness of such attacks is limited.
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="command">confCONNECTION_RATE_THROTTLE</code> — The 
number of connections the server can receive per second. By default, 
Sendmail does not limit the number of connections. If a limit is set and
 reached, further connections are delayed.
					</div></li><li class="listitem"><div class="para">
						<code class="command">confMAX_DAEMON_CHILDREN</code> — The maximum
 number of child processes that can be spawned by the server. By 
default, Sendmail does not assign a limit to the number of child 
processes. If a limit is set and reached, further connections are 
delayed.
					</div></li><li class="listitem"><div class="para">
						<code class="command">confMIN_FREE_BLOCKS</code> — The minimum number of free blocks which must be available for the server to accept mail. The default is 100 blocks.
					</div></li><li class="listitem"><div class="para">
						<code class="command">confMAX_HEADERS_LENGTH</code> — The maximum acceptable size (in bytes) for a message header.
					</div></li><li class="listitem"><div class="para">
						<code class="command">confMAX_MESSAGE_SIZE</code> — The maximum acceptable size (in bytes) for a single message.
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Securing_Sendmail-NFS_and_Sendmail"><div class="titlepage"><div><div><h4 class="title">2.2.8.2.&nbsp;NFS and Sendmail</h4></div></div></div><div class="para">
				Never put the mail spool directory, <code class="filename">/var/spool/mail/</code>,
 on an NFS shared volume. Because NFSv2 and NFSv3 do not maintain 
control over user and group IDs, two or more users can have the same 
UID, and receive and read each other's mail.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					With NFSv4 using Kerberos, this is not the case, since the <code class="filename">SECRPC_GSS</code> kernel module does not utilize UID-based authentication. However, it is still considered good practice <span class="emphasis"><em>not</em></span> to put the mail spool directory on NFS shared volumes.
				</div></div></div></div><div class="section" id="sect-Security_Guide-Securing_Sendmail-Mail_only_Users"><div class="titlepage"><div><div><h4 class="title">2.2.8.3.&nbsp;Mail-only Users</h4></div></div></div><div class="para">
				To help prevent local user exploits on the Sendmail server, it is 
best for mail users to only access the Sendmail server using an email 
program. Shell accounts on the mail server should not be allowed and all
 user shells in the <code class="filename">/etc/passwd</code> file should be set to <code class="command">/sbin/nologin</code> (with the possible exception of the root user).
			</div></div><div class="section" id="sect-Security_Guide-Disable_Sendmail_Network_Listening"><div class="titlepage"><div><div><h4 class="title">2.2.8.4.&nbsp;Disable Sendmail Network Listening</h4></div></div></div><div class="para">
				By default, Sendmail is set up to only listen to the local loopback address. You can verify this by viewing the file <code class="filename">/etc/mail/sendmail.mc</code> to ensure that the following line appears: 
<pre class="screen">DAEMON_OPTIONS(`Port=smtp,Addr=127.0.0.1, Name=MTA')dnl</pre>

			</div><div class="para">
				This ensures that Sendmail only accepts mail messages (such as cron 
job reports) from the local system and not from the network. This is the
 default setting and protects Sendmail from a network attack.
			</div><div class="para">
				For removal of the localhost restriction, the Addr=127.0.0.1 string 
needs to be removed. Changing Sendmail's configuration requires 
installing the <span class="package">sendmail-cf</span> package, then editing the <code class="filename">.mc</code> file, running <code class="command">/etc/mail/make</code> and finally restarting <span class="application"><strong>sendmail</strong></span>. The <code class="filename">.cf</code>
 configuration file will be regenerated. Note that the system clock must
 be correct and working and that there must not be any system clock time
 shifts between these actions in order for the configuration file to be 
automatically regenerated.
			</div></div></div><div class="section" id="sect-Security_Guide-Server_Security-Verifying_Which_Ports_Are_Listening"><div class="titlepage"><div><div><h3 class="title">2.2.9.&nbsp;Verifying Which Ports Are Listening</h3></div></div></div><div class="para">
			Unnecessary open ports should be avoided because it increases the 
attack surface of your system. If after the system has been in service 
you find unexpected open ports in listening state, that might be signs 
of intrusion and it should be investigated.
		</div><div class="para">
			Issue the following command, as root, from the console to determine 
which ports are listening for connections from the network:
		</div><pre class="screen">~]# <code class="command">netstat -tanp | grep LISTEN</code>
tcp        0      0 0.0.0.0:45876               0.0.0.0:*                   LISTEN      1193/rpc.statd      
tcp        0      0 192.168.122.1:53            0.0.0.0:*                   LISTEN      1241/dnsmasq        
tcp        0      0 127.0.0.1:631               0.0.0.0:*                   LISTEN      1783/cupsd          
tcp        0      0 127.0.0.1:25                0.0.0.0:*                   LISTEN      7696/sendmail       
tcp        0      0 0.0.0.0:111                 0.0.0.0:*                   LISTEN      1167/rpcbind        
tcp        0      0 127.0.0.1:30003             0.0.0.0:*                   LISTEN      1118/tcsd           
tcp        0      0 :::631                      :::*                        LISTEN      1/init              
tcp        0      0 :::35018                    :::*                        LISTEN      1193/rpc.statd      
tcp        0      0 :::111                      :::*                        LISTEN      1167/rpcbind</pre><div class="para">
			Review the output of the command with the services needed on the 
system, turn off what is not specifically required or authorized, repeat
 the check. Proceed then to make external checks using <span class="application"><strong>nmap</strong></span> from another system connected via the network to the first system. This can be used verify the rules in <span class="application"><strong>iptables</strong></span>. Make a scan for every IP address shown in the <span class="application"><strong>netstat</strong></span> output (except for localhost 127.0.0.0 or ::1 range) from an external system. Use the <code class="literal">-6</code> option for scanning an IPv6 address. See <code class="filename">man nmap(1)</code> for more information.
		</div><div class="para">
			The following is an example of the command to be issued from the 
console of another system to determine which ports are listening for TCP
 connections from the network:
		</div><pre class="screen">~]# <code class="command">nmap -sT -O 192.168.122.1</code></pre><div class="para">
			See the <span class="citerefentry"><span class="refentrytitle">netstat</span>(8)</span>, <span class="citerefentry"><span class="refentrytitle">nmap</span>(1)</span>, and <span class="citerefentry"><span class="refentrytitle">services</span>(5)</span> manual pages for more information.
		</div></div><div class="section" id="sect-Security_Guide-Server_Security-Disable-Source-Routing"><div class="titlepage"><div><div><h3 class="title">2.2.10.&nbsp;Disable Source Routing</h3></div></div></div><div class="para">
			Source routing is an Internet Protocol mechanism that allows an IP 
packet to carry information, a list of addresses, that tells a router 
the path the packet must take. There is also an option to record the 
hops as the route is traversed. The list of hops taken, the "route 
record", provides the destination with a return path to the source. This
 allows the source (the sending host) to specify the route, loosely or 
strictly, ignoring the routing tables of some or all of the routers. It 
can allow a user to redirect network traffic for malicious purposes. 
Therefore, source-based routing should be disabled.
		</div><div class="para">
			The <code class="option">accept_source_route</code> option causes network interfaces to accept packets with the <em class="firstterm">Strict Source Route</em> (<acronym class="acronym">SSR</acronym>) or <em class="firstterm">Loose Source Routing</em> (<acronym class="acronym">LSR</acronym>) option set. The acceptance of source routed packets is controlled by <span class="application"><strong>sysctl</strong></span> settings. Issue the following command as root to drop packets with the SSR or LSR option set:
		</div><pre class="screen">~]# /sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0</pre><div class="para">
			Disabling the forwarding of packets should also be done in 
conjunction with the above when possible (disabling forwarding may 
interfere with virtualization). Issue the commands listed below as root:
		</div><div class="para">
			These commands disable forwarding of IPv4 and IPv6 packets on all interfaces.
		</div><pre class="screen">~]# /sbin/sysctl -w net.ipv4.conf.all.forwarding=0</pre><pre class="screen">~]# /sbin/sysctl -w net.ipv6.conf.all.forwarding=0</pre><div class="para">
			These commands disable forwarding of all multicast packets on all interfaces.
		</div><pre class="screen">~]# /sbin/sysctl -w net.ipv4.conf.all.mc_forwarding=0</pre><pre class="screen">~]# /sbin/sysctl -w net.ipv6.conf.all.mc_forwarding=0</pre><div class="para">
			Accepting ICMP redirects has few legitimate uses. Disable the 
acceptance and sending of ICMP redirected packets unless specifically 
required.
		</div><div class="para">
			These commands disable acceptance of all ICMP redirected packets on all interfaces.
		</div><pre class="screen">~]# /sbin/sysctl -w net.ipv4.conf.all.accept_redirects=0</pre><pre class="screen">~]# /sbin/sysctl -w net.ipv6.conf.all.accept_redirects=0</pre><div class="para">
			This command disables acceptance of secure ICMP redirected packets on all interfaces.
		</div><pre class="screen">~]# /sbin/sysctl -w net.ipv4.conf.all.secure_redirects=0</pre><div class="para">
			This command disables sending of all IPv4 ICMP redirected packets on all interfaces.
		</div><pre class="screen">~]# /sbin/sysctl -w net.ipv4.conf.all.send_redirects=0</pre><div class="para">
			There is only a directive to disable sending of IPv4 redirected packets. Refer to <a href="http://www.ietf.org/rfc/rfc4294.txt"><em class="citetitle">RFC4294</em></a> for an explanation of <span class="quote">“<span class="quote">IPv6 Node Requirements</span>”</span>, which resulted in this difference between IPv4 and IPv6.
		</div><div class="para">
			In order to make the settings permanent they must be added to <code class="filename">/etc/sysctl.conf</code>.
		</div><div class="para">
			See the <span class="citerefentry"><span class="refentrytitle">sysctl</span>(8)</span> manual page for more information. Refer to <a href="http://www.ietf.org/rfc/rfc791.txt"><em class="citetitle">RFC791</em></a> for an explanation of the Internet options related to source based routing and its variants.
		</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				Ethernet networks provide additional ways to redirect traffic, such 
as ARP or MAC address spoofing, unauthorized DHCP servers, and IPv6 
router or neighbor advertisements. In addition, unicast traffic is 
occasionally broadcast, causing information leaks. These weaknesses can 
only be addressed by specific countermeasures implemented by the network
 operator. Host-based countermeasures are not fully effective.
			</div></div></div></div><div class="section" id="sect-Security_Guide-Server_Security-Reverse_Path_Forwarding"><div class="titlepage"><div><div><h3 class="title">2.2.11.&nbsp;Reverse Path Forwarding</h3></div></div></div><div class="para">
			Reverse Path Forwarding is used to prevent packets that arrived via 
one interface from leaving via a different interface. When outgoing 
routes and incoming routes are different, it is sometimes referred to as
 <em class="firstterm">asymmetric routing</em>. Routers often route 
packets this way, but most hosts should not need to do this. Exceptions 
are such applications that involve sending traffic out over one link and
 receiving traffic over another link from a different service provider. 
For example, using leased lines in combination with <acronym class="acronym">xDSL</acronym> or satellite links with <acronym class="acronym">3G</acronym>
 modems. If such a scenario is applicable to you, then turning off 
reverse path forwarding on the incoming interface is necessary. In 
short, unless you know that it is required, it is best enabled as it 
prevents users spoofing <code class="systemitem">IP</code> addresses from local subnets and reduces the opportunity for <acronym class="acronym">DDoS</acronym> attacks.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 (unlike Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;5) defaults to using <em class="firstterm">Strict Reverse Path Forwarding</em>.
 Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 follows the Strict Reverse 
Path recommendation from RFC&nbsp;3704, Ingress Filtering for Multihomed
 Networks. This currently only applies to <code class="systemitem">IPv4</code> in Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.
			</div></div></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				If forwarding is enabled, then Reverse Path Forwarding should only 
be disabled if there are other means for source-address validation (such
 as <span class="application"><strong>iptables</strong></span> rules for example).
			</div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"> <a id="idm140226877559440" class="indexterm"><!--Empty--></a> <code class="option">rp_filter</code> </span></dt><dd><div class="para">
						Reverse Path Forwarding is enabled by means of the <code class="option">rp_filter</code> directive. The <code class="option">rp_filter</code> option is used to direct the kernel to select from one of three modes.
					</div><div class="para">
						It takes the following form when setting the default behavior:
					</div><pre class="screen">~]# /sbin/sysctl -w net.ipv4.conf.default.rp_filter=<em class="replaceable">INTEGER</em></pre><div class="para">
						where <em class="replaceable">INTEGER</em> is one of the following:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="literal">0</code> — No source validation.
							</div></li><li class="listitem"><div class="para">
								<code class="literal">1</code> — Strict mode as defined in RFC&nbsp;3704.
							</div></li><li class="listitem"><div class="para">
								<code class="literal">2</code> — Loose mode as defined in RFC&nbsp;3704.
							</div></li></ul></div><div class="para">
						The setting can be overridden per network interface using <code class="command">net.ipv4.<em class="replaceable">interface</em>.rp_filter</code>. To make these settings persistent across reboot, modify the <code class="filename">/etc/sysctl.conf</code> file.
					</div></dd></dl></div><div class="section" id="sect-Security_Guide-Server_Security-rp_filter-resources"><div class="titlepage"><div><div><h4 class="title">2.2.11.1.&nbsp;Additional Resources</h4></div></div></div><a id="idm140226878775328" class="indexterm"><!--Empty--></a><div class="para">
				The following are resources that explain more about Reverse Path Forwarding.
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="bold bold"><strong>Installed Documentation</strong></span>
					</div><div class="para">
						<code class="filename">usr/share/doc/kernel-doc-<em class="replaceable">version</em>/Documentation/networking/ip-sysctl.txt</code> — This file contains a complete list of files and options available in the <code class="filename">/proc/sys/net/ipv4/</code> directory.
					</div></li><li class="listitem"><div class="para">
						<span class="bold bold"><strong>Useful Websites</strong></span>
					</div><div class="para">
						<a href="https://access.redhat.com/knowledge/solutions/53031">https://access.redhat.com/knowledge/solutions/53031</a> — The Red&nbsp;Hat Knowledgebase article about <code class="option">rp_filter</code>.
					</div><div class="para">
						See <a href="http://www.ietf.org/rfc/rfc3704.txt">RFC 3704</a> for an explanation of Ingress Filtering for Multihomed Networks.
					</div></li></ul></div></div></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Single_Sign_on_SSO" lang="en-US"><div class="titlepage"><div><div><h2 class="title">2.3.&nbsp;Single Sign-on (SSO)</h2></div></div></div><div class="para">
		The Red&nbsp;Hat Enterprise&nbsp;Linux SSO functionality reduces the 
number of times Red&nbsp;Hat Enterprise&nbsp;Linux desktop users have to
 enter their passwords. Several major applications leverage the same 
underlying authentication and authorization mechanisms so that users can
 log in to Red&nbsp;Hat Enterprise&nbsp;Linux from the log-in screen, 
and then not need to re-enter their passwords. These applications are 
detailed below.
	</div><div class="para">
		For more information on Pluggable Authentication Modules, see the <a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Smart_Cards/index.html">Red&nbsp; Hat Enterprise&nbsp;Linux&nbsp;6 Managing Single Sign-On and Smart Cards</a> guide.
	</div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Pluggable_Authentication_Modules_PAM" lang="en-US"><div class="titlepage"><div><div><h2 class="title">2.4.&nbsp;Pluggable Authentication Modules (PAM)</h2></div></div></div><div class="para">
		Pluggable authentication modules are a common framework for 
authentication and security. Both of Red&nbsp;Hat 
Enterprise&nbsp;Linux's single sign-on methods — Kerberos and smart 
cards — depend on underlying PAM configuration.
	</div><div class="para">
		For more information on Pluggable Authentication Modules, see the corresponding chapter in the <a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Smart_Cards/index.html">Red&nbsp; Hat Enterprise&nbsp;Linux&nbsp;6 Managing Single Sign-On and Smart Cards</a> guide.
	</div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Kerberos" lang="en-US"><div class="titlepage"><div><div><h2 class="title">2.5.&nbsp;Kerberos</h2></div></div></div><div class="para">
		Maintaining system security and integrity within a network is 
critical, and it encompasses every user, application, service, and 
server within the network infrastructure. It requires an understanding 
of everything that is running on the network and the manner in which 
these services are used. At the core of maintaining this security is 
maintaining access to these applications and services and enforcing that
 access.
	</div><div class="para">
		Kerberos provides a mechanism that allows both users and machines to 
identify themselves to network and receive defined, limited access to 
the areas and services that the administrator configured. Kerberos 
authenticates entities by verifying their identity, and Kerberos also 
secures this authenticating data so that it cannot be accessed and used 
or tampered with by an outsider.
	</div><div class="para">
		For more information on Pluggable Authentication Modules, see the corresponding chapter in the <a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Managing_Smart_Cards/index.html">Red&nbsp; Hat Enterprise&nbsp;Linux&nbsp;6 Managing Single Sign-On and Smart Cards</a> guide.
	</div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-TCP_Wrappers_and_xinetd" lang="en-US"><div class="titlepage"><div><div><h2 class="title">2.6.&nbsp;TCP Wrappers and xinetd</h2></div></div></div><div class="para">
		Controlling access to network services is one of the most important 
security tasks facing a server administrator. Red&nbsp;Hat 
Enterprise&nbsp;Linux provides several tools for this purpose. For 
example, an <code class="command">iptables</code>-based firewall filters out unwelcome network packets within the kernel's network stack. For network services that utilize it, <em class="firstterm">TCP Wrappers</em> add an additional layer of protection by defining which hosts are or are not allowed to connect to "<span class="emphasis"><em>wrapped</em></span>" network services. One such wrapped network service is the <code class="systemitem">xinetd</code> <span class="emphasis"><em>super server</em></span>.
 This service is called a super server because it controls connections 
to a subset of network services and further refines access control.
	</div><div class="para">
		<a class="xref" href="#figu-Security_Guide-TCP_Wrappers_and_xinetd-Access_Control_to_Network_Services">Figure&nbsp;2.4, “Access Control to Network Services”</a> is a basic illustration of how these tools work together to protect network services.
	</div><div class="figure" id="figu-Security_Guide-TCP_Wrappers_and_xinetd-Access_Control_to_Network_Services"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/tcp_wrap_diagram.png" alt="Access Control to Network Services"></div></div><p class="title"><strong>Figure&nbsp;2.4.&nbsp;Access Control to Network Services</strong></p></div><div class="para">
		For more information about using firewalls with <code class="command">iptables</code>, see <a class="xref" href="#sect-Security_Guide-IPTables">Section&nbsp;2.8.9, “IPTables”</a>.
	</div><div class="section" id="sect-Security_Guide-TCP_Wrappers_and_xinetd-TCP_Wrappers"><div class="titlepage"><div><div><h3 class="title">2.6.1.&nbsp;TCP Wrappers</h3></div></div></div><div class="para">
			The TCP Wrappers packages (<span class="package">tcp_wrappers</span> and <span class="package">tcp_wrappers-libs</span>)
 are installed by default and provide host-based access control to 
network services. The most important component within the package is the
 <code class="filename">/lib/libwrap.so</code> or <code class="filename">/lib64/libwrap.so</code> library. In general terms, a TCP-wrapped service is one that has been compiled against the <code class="filename">libwrap.so</code> library.
		</div><div class="para">
			When a connection attempt is made to a TCP-wrapped service, the service first references the host's access files (<code class="filename">/etc/hosts.allow</code> and <code class="filename">/etc/hosts.deny</code>) to determine whether or not the client is allowed to connect. In most cases, it then uses the syslog daemon (<code class="systemitem">syslogd</code>) to write the name of the requesting client and the requested service to <code class="filename">/var/log/secure</code> or <code class="filename">/var/log/messages</code>.
		</div><div class="para">
			If a client is allowed to connect, TCP Wrappers release control of 
the connection to the requested service and take no further part in the 
communication between the client and the server.
		</div><div class="para">
			In addition to access control and logging, TCP Wrappers can execute 
commands to interact with the client before denying or releasing control
 of the connection to the requested network service.
		</div><div class="para">
			Because TCP Wrappers are a valuable addition to any server 
administrator's arsenal of security tools, most network services within 
Red&nbsp;Hat Enterprise&nbsp;Linux are linked to the <code class="filename">libwrap.so</code> library. Such applications include <code class="systemitem">/usr/sbin/sshd</code>, <code class="command">/usr/sbin/sendmail</code>, and <code class="systemitem">/usr/sbin/xinetd</code>.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				To determine if a network service binary is linked to <code class="filename">libwrap.so</code>, type the following command as the root user:
			</div><pre class="synopsis"><code class="command">ldd</code> <em class="replaceable">&lt;binary-name&gt;</em> | <code class="command">grep</code> <code class="option">libwrap</code></pre><div class="para">
				Replace <em class="replaceable">&lt;binary-name&gt;</em> with the 
name of the network service binary. If the command returns straight to 
the prompt with no output, then the network service is <span class="emphasis"><em>not</em></span> linked to <code class="filename">libwrap.so</code>.
			</div><div class="para">
				The following example indicates that <code class="systemitem">/usr/sbin/sshd</code> is linked to <code class="filename">libwrap.so</code>:
			</div><pre class="screen">~]# <code class="command">ldd /usr/sbin/sshd | grep libwrap</code>
        libwrap.so.0 =&gt; /lib/libwrap.so.0 (0x00655000)</pre></div></div><div class="section" id="sect-Security_Guide-TCP_Wrappers-Advantages_of_TCP_Wrappers"><div class="titlepage"><div><div><h4 class="title">2.6.1.1.&nbsp;Advantages of TCP Wrappers</h4></div></div></div><div class="para">
				TCP Wrappers provide the following advantages over other network service control techniques:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="emphasis"><em>Transparency to both the client and the wrapped network service</em></span>
 — Both the connecting client and the wrapped network service are 
unaware that TCP Wrappers are in use. Legitimate users are logged and 
connected to the requested service while connections from banned clients
 fail.
					</div></li><li class="listitem"><div class="para">
						<span class="emphasis"><em>Centralized management of multiple protocols</em></span>
 — TCP Wrappers operate separately from the network services they 
protect, allowing many server applications to share a common set of 
access control configuration files, making for simpler management.
					</div></li></ul></div></div></div><div class="section" id="sect-Security_Guide-TCP_Wrappers_and_xinetd-TCP_Wrappers_Configuration_Files"><div class="titlepage"><div><div><h3 class="title">2.6.2.&nbsp;TCP Wrappers Configuration Files</h3></div></div></div><div class="para">
			To determine if a client is allowed to connect to a service, TCP 
Wrappers reference the following two files, which are commonly referred 
to as <em class="firstterm">hosts access</em> files:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="filename">/etc/hosts.allow</code>
				</div></li><li class="listitem"><div class="para">
					<code class="filename">/etc/hosts.deny</code>
				</div></li></ul></div><div class="para">
			When a TCP-wrapped service receives a client request, it performs the following steps:
		</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
					<span class="emphasis"><em>It references <code class="filename">/etc/hosts.allow</code></em></span> — The TCP-wrapped service sequentially parses the <code class="filename">/etc/hosts.allow</code>
 file and applies the first rule specified for that service. If it finds
 a matching rule, it allows the connection. If not, it moves on to the 
next step.
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>It references <code class="filename">/etc/hosts.deny</code></em></span> — The TCP-wrapped service sequentially parses the <code class="filename">/etc/hosts.deny</code> file. If it finds a matching rule, it denies the connection. If not, it grants access to the service.
				</div></li></ol></div><div class="para">
			The following are important points to consider when using TCP Wrappers to protect network services:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Because access rules in <code class="filename">hosts.allow</code> are applied first, they take precedence over rules specified in <code class="filename">hosts.deny</code>. Therefore, if access to a service is allowed in <code class="filename">hosts.allow</code>, a rule denying access to that same service in <code class="filename">hosts.deny</code> is ignored.
				</div></li><li class="listitem"><div class="para">
					The rules in each file are read from the top down and the first 
matching rule for a given service is the only one applied. The order of 
the rules is extremely important.
				</div></li><li class="listitem"><div class="para">
					If no rules for the service are found in either file, or if neither file exists, access to the service is granted.
				</div></li><li class="listitem"><div class="para">
					TCP-wrapped services do not cache the rules from the hosts access files, so any changes to <code class="filename">hosts.allow</code> or <code class="filename">hosts.deny</code> take effect immediately, without restarting network services.
				</div></li></ul></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				If the last line of a hosts access file is not a newline character (created by pressing the <span class="keycap"><strong>Enter</strong></span> key), the last rule in the file fails and an error is logged to either <code class="filename">/var/log/messages</code> or <code class="filename">/var/log/secure</code>.
 This is also the case for a rule that spans multiple lines without 
using the backslash character. The following example illustrates the 
relevant portion of a log message for a rule failure due to either of 
these circumstances:
			</div><pre class="screen">warning: /etc/hosts.allow, line 20: missing newline or line too long</pre></div></div><div class="section" id="sect-Security_Guide-TCP_Wrappers_Configuration_Files-Formatting_Access_Rules"><div class="titlepage"><div><div><h4 class="title">2.6.2.1.&nbsp;Formatting Access Rules</h4></div></div></div><div class="para">
				The format for both <code class="filename">/etc/hosts.allow</code> and <code class="filename">/etc/hosts.deny</code> is identical. Each rule must be on its own line. Blank lines or lines that start with a hash (#) are ignored.
			</div><div class="para">
				Each rule uses the following basic format to control access to network services:
			</div><pre class="synopsis"><em class="replaceable">&lt;daemon list&gt;</em> : <em class="replaceable">&lt;client list&gt;</em> [<span class="optional">: <em class="replaceable">&lt;option&gt;</em> : <em class="replaceable">&lt;option&gt;</em> : …</span>]</pre><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<em class="replaceable">&lt;daemon list&gt;</em> — A comma-separated list of process names (<span class="emphasis"><em>not</em></span> service names) or the <code class="option">ALL</code> wildcard. The daemon list also accepts operators (refer to <a class="xref" href="#sect-Security_Guide-Formatting_Access_Rules-Operators">Section&nbsp;2.6.2.1.4, “Operators”</a>) to allow greater flexibility.
					</div></li><li class="listitem"><div class="para">
						<em class="replaceable">&lt;client list&gt;</em> — A 
comma-separated list of hostnames, host IP addresses, special patterns, 
or wildcards which identify the hosts affected by the rule. The client 
list also accepts operators listed in <a class="xref" href="#sect-Security_Guide-Formatting_Access_Rules-Operators">Section&nbsp;2.6.2.1.4, “Operators”</a> to allow greater flexibility.
					</div></li><li class="listitem"><div class="para">
						<em class="replaceable">&lt;option&gt;</em> — An optional action 
or colon-separated list of actions performed when the rule is triggered.
 Option fields support expansions, launch shell commands, allow or deny 
access, and alter logging behavior.
					</div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					More information on some of the terms above can be found elsewhere in this guide:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<a class="xref" href="#sect-Security_Guide-Formatting_Access_Rules-Wildcards">Section&nbsp;2.6.2.1.1, “Wildcards”</a>
						</div></li><li class="listitem"><div class="para">
							<a class="xref" href="#sect-Security_Guide-Formatting_Access_Rules-Patterns">Section&nbsp;2.6.2.1.2, “Patterns”</a>
						</div></li><li class="listitem"><div class="para">
							<a class="xref" href="#sect-Security_Guide-Option_Fields-Expansions">Section&nbsp;2.6.2.2.4, “Expansions”</a>
						</div></li><li class="listitem"><div class="para">
							<a class="xref" href="#sect-Security_Guide-TCP_Wrappers_Configuration_Files-Option_Fields">Section&nbsp;2.6.2.2, “Option Fields”</a>
						</div></li></ul></div></div></div><div class="para">
				The following is a basic sample hosts access rule:
			</div><pre class="programlisting">vsftpd : .example.com</pre><div class="para">
				This rule instructs TCP Wrappers to watch for connections to the FTP daemon (<code class="systemitem">vsftpd</code>) from any host in the <code class="systemitem">example.com</code> domain. If this rule appears in <code class="filename">hosts.allow</code>, the connection is accepted. If this rule appears in <code class="filename">hosts.deny</code>, the connection is rejected.
			</div><div class="para">
				The next sample hosts access rule is more complex and uses two option fields:
			</div><pre class="programlisting">sshd : .example.com  \
	: spawn /bin/echo `/bin/date` access denied&gt;&gt;/var/log/sshd.log \
	: deny</pre><div class="para">
				Note that each option field is preceded by the backslash (\). Use of
 the backslash prevents failure of the rule due to length.
			</div><div class="para">
				This sample rule states that if a connection to the SSH daemon (<code class="systemitem">sshd</code>) is attempted from a host in the <code class="systemitem">example.com</code> domain, execute the <code class="command">echo</code> command to append the attempt to a special log file, and deny the connection. Because the optional <code class="command">deny</code> directive is used, this line denies access even if it appears in the <code class="filename">hosts.allow</code> file. Refer to <a class="xref" href="#sect-Security_Guide-TCP_Wrappers_Configuration_Files-Option_Fields">Section&nbsp;2.6.2.2, “Option Fields”</a> for a more detailed look at available options.
			</div><div class="section" id="sect-Security_Guide-Formatting_Access_Rules-Wildcards"><div class="titlepage"><div><div><h5 class="title">2.6.2.1.1.&nbsp;Wildcards</h5></div></div></div><div class="para">
					Wildcards allow TCP Wrappers to more easily match groups of daemons
 or hosts. They are used most frequently in the client list field of 
access rules.
				</div><div class="para">
					The following wildcards are available:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">ALL</code> — Matches everything. It can be used for both the daemon list and the client list.
						</div></li><li class="listitem"><div class="para">
							<code class="option">LOCAL</code> — Matches any host that does not contain a period (.), such as localhost.
						</div></li><li class="listitem"><div class="para">
							<code class="option">KNOWN</code> — Matches any host where the hostname and host address are known or where the user is known.
						</div></li><li class="listitem"><div class="para">
							<code class="option">UNKNOWN</code> — Matches any host where the hostname or host address are unknown or where the user is unknown.
						</div></li><li class="listitem"><div class="para">
							<code class="option">PARANOID</code> — A reverse DNS lookup is 
done on the source IP address to obtain the host name. Then a DNS lookup
 is performed to resolve the IP address. If the two IP addresses do not 
match the connection is dropped and the logs are updated
						</div></li></ul></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
						The <code class="option">KNOWN</code>, <code class="option">UNKNOWN</code>, and <code class="option">PARANOID</code>
 wildcards should be used with care, because they rely on a functioning 
DNS server for correct operation. Any disruption to name resolution may 
prevent legitimate users from gaining access to a service.
					</div></div></div></div><div class="section" id="sect-Security_Guide-Formatting_Access_Rules-Patterns"><div class="titlepage"><div><div><h5 class="title">2.6.2.1.2.&nbsp;Patterns</h5></div></div></div><div class="para">
					Patterns can be used in the client field of access rules to more precisely specify groups of client hosts.
				</div><div class="para">
					The following is a list of common patterns for entries in the client field:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<span class="emphasis"><em>Hostname beginning with a period (.)</em></span>
 — Placing a period at the beginning of a hostname matches all hosts 
sharing the listed components of the name. The following example applies
 to any host within the <code class="systemitem">example.com</code> domain:
						</div><pre class="programlisting">ALL : .example.com</pre></li><li class="listitem"><div class="para">
							<span class="emphasis"><em>IP address ending with a period (.)</em></span>
 — Placing a period at the end of an IP address matches all hosts 
sharing the initial numeric groups of an IP address. The following 
example applies to any host within the <code class="systemitem">192.168.x.x</code> network:
						</div><pre class="programlisting">ALL : 192.168.</pre></li><li class="listitem"><div class="para">
							<span class="emphasis"><em>IP address/netmask pair</em></span> — 
Netmask expressions can also be used as a pattern to control access to a
 particular group of IP addresses. The following example applies to any 
host with an address range of <code class="systemitem">192.168.0.0</code> through <code class="systemitem">192.168.1.255</code>:
						</div><pre class="programlisting">ALL : 192.168.0.0/255.255.254.0</pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
								When working in the IPv4 address space, the address/prefix length (<em class="firstterm">prefixlen</em>) pair declarations (<abbr class="abbrev">CIDR</abbr> notation) are not supported. Only IPv6 rules can use this format.
							</div></div></div></li><li class="listitem"><div class="para">
							<span class="emphasis"><em>[IPv6 address]/prefixlen pair</em></span>
 — [net]/prefixlen pairs can also be used as a pattern to control access
 to a particular group of IPv6 addresses. The following example would 
apply to any host with an address range of <code class="systemitem">3ffe:505:2:1::</code> through <code class="systemitem">3ffe:505:2:1:ffff:ffff:ffff:ffff</code>:
						</div><pre class="programlisting">ALL : [3ffe:505:2:1::]/64</pre></li><li class="listitem"><div class="para">
							<span class="emphasis"><em>The asterisk (*)</em></span> — 
Asterisks can be used to match entire groups of hostnames or IP 
addresses, as long as they are not mixed in a client list containing 
other types of patterns. The following example would apply to any host 
within the <code class="systemitem">example.com</code> domain:
						</div><pre class="programlisting">ALL : *.example.com</pre></li><li class="listitem"><div class="para">
							<span class="emphasis"><em>The slash (/)</em></span> — If a 
client list begins with a slash, it is treated as a file name. This is 
useful if rules specifying large numbers of hosts are necessary. The 
following example refers TCP Wrappers to the <code class="filename">/etc/telnet.hosts</code> file for all Telnet connections:
						</div><pre class="programlisting">in.telnetd : /etc/telnet.hosts</pre></li></ul></div><div class="para">
					Other, less used patterns are also accepted by TCP Wrappers. Refer to the <code class="filename">hosts_access</code> man 5 page for more information.
				</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
						Be very careful when using hostnames and domain names. Attackers 
can use a variety of tricks to circumvent accurate name resolution. In 
addition, disruption to DNS service prevents even authorized users from 
using network services. It is, therefore, best to use IP addresses 
whenever possible.
					</div></div></div></div><div class="section" id="sect-Security_Guide-Formatting_Access_Rules-Portmap_and_TCP_Wrappers"><div class="titlepage"><div><div><h5 class="title">2.6.2.1.3.&nbsp;Portmap and TCP Wrappers</h5></div></div></div><div class="para">
					<code class="command">Portmap</code>'s implementation of TCP Wrappers does not support host look-ups, which means <code class="command">portmap</code> can not use hostnames to identify hosts. Consequently, access control rules for portmap in <code class="filename">hosts.allow</code> or <code class="filename">hosts.deny</code> must use IP addresses, or the keyword <code class="option">ALL</code>, for specifying hosts.
				</div><div class="para">
					Changes to <code class="command">portmap</code> access control rules may not take effect immediately. You may need to restart the <code class="command">portmap</code> service.
				</div><div class="para">
					Widely used services, such as NIS and NFS, depend on <code class="command">portmap</code> to operate, so be aware of these limitations.
				</div></div><div class="section" id="sect-Security_Guide-Formatting_Access_Rules-Operators"><div class="titlepage"><div><div><h5 class="title">2.6.2.1.4.&nbsp;Operators</h5></div></div></div><div class="para">
					At present, access control rules accept one operator, <code class="option">EXCEPT</code>. It can be used in both the daemon list and the client list of a rule.
				</div><div class="para">
					The <code class="option">EXCEPT</code> operator allows specific exceptions to broader matches within the same rule.
				</div><div class="para">
					In the following example from a <code class="filename">hosts.allow</code> file, all <code class="systemitem">example.com</code> hosts are allowed to connect to all services except <code class="systemitem">attacker.example.com</code>:
				</div><pre class="programlisting">ALL : .example.com EXCEPT attacker.example.com</pre><div class="para">
					In another example from a <code class="filename">hosts.allow</code> file, clients from the <code class="systemitem">192.168.0.<em class="replaceable">x</em></code> network can use all services except for FTP:
				</div><pre class="programlisting">ALL EXCEPT vsftpd : 192.168.0.</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Organizationally, it is often easier to avoid using <code class="option">EXCEPT</code>
 operators. This allows other administrators to quickly scan the 
appropriate files to see what hosts are allowed or denied access to 
services, without having to sort through <code class="option">EXCEPT</code> operators.
					</div></div></div></div></div><div class="section" id="sect-Security_Guide-TCP_Wrappers_Configuration_Files-Option_Fields"><div class="titlepage"><div><div><h4 class="title">2.6.2.2.&nbsp;Option Fields</h4></div></div></div><div class="para">
				In addition to basic rules that allow and deny access, the 
Red&nbsp;Hat Enterprise&nbsp;Linux implementation of TCP Wrappers 
supports extensions to the access control language through <em class="firstterm">option fields</em>.
 By using option fields in hosts access rules, administrators can 
accomplish a variety of tasks such as altering log behavior, 
consolidating access control, and launching shell commands.
			</div><div class="section" id="sect-Security_Guide-Option_Fields-Logging"><div class="titlepage"><div><div><h5 class="title">2.6.2.2.1.&nbsp;Logging</h5></div></div></div><div class="para">
					Option fields let administrators easily change the log facility and priority level for a rule by using the <code class="option">severity</code> directive.
				</div><div class="para">
					In the following example, connections to the SSH daemon from any host in the <code class="systemitem">example.com</code> domain are logged to the default <code class="option">authpriv</code> <code class="option">syslog</code> facility (because no facility value is specified) with a priority of <code class="option">emerg</code>:
				</div><pre class="programlisting">sshd : .example.com : severity emerg</pre><div class="para">
					It is also possible to specify a facility using the <code class="option">severity</code> option. The following example logs any SSH connection attempts by hosts from the <code class="systemitem">example.com</code> domain to the <code class="option">local0</code> facility with a priority of <code class="option">alert</code>:
				</div><pre class="programlisting">sshd : .example.com : severity local0.alert</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						In practice, this example does not work until the syslog daemon (<code class="systemitem">syslogd</code>) is configured to log to the <code class="command">local0</code> facility. Refer to the <code class="filename">syslog.conf</code> man page for information about configuring custom log facilities.
					</div></div></div></div><div class="section" id="sect-Security_Guide-Option_Fields-Access_Control"><div class="titlepage"><div><div><h5 class="title">2.6.2.2.2.&nbsp;Access Control</h5></div></div></div><div class="para">
					Option fields also allow administrators to explicitly allow or deny hosts in a single rule by adding the <code class="option">allow</code> or <code class="option">deny</code> directive as the final option.
				</div><div class="para">
					For example, the following two rules allow SSH connections from <code class="systemitem">client-1.example.com</code>, but deny connections from <code class="systemitem">client-2.example.com</code>:
				</div><pre class="programlisting">sshd : client-1.example.com : allow
sshd : client-2.example.com : deny</pre><div class="para">
					By allowing access control on a per-rule basis, the option field 
allows administrators to consolidate all access rules into a single 
file: either <code class="filename">hosts.allow</code> or <code class="filename">hosts.deny</code>. Some administrators consider this an easier way of organizing access rules.
				</div></div><div class="section" id="sect-Security_Guide-Option_Fields-Shell_Commands"><div class="titlepage"><div><div><h5 class="title">2.6.2.2.3.&nbsp;Shell Commands</h5></div></div></div><div class="para">
					Option fields allow access rules to launch shell commands through the following two directives:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="command">spawn</code> — Launches a shell command as a child process. This directive can perform tasks like using <code class="command">/usr/sbin/safe_finger</code> to get more information about the requesting client or create special log files using the <code class="command">echo</code> command.
						</div><div class="para">
							In the following example, clients attempting to access Telnet services from the <code class="systemitem">example.com</code> domain are quietly logged to a special file:
						</div><pre class="programlisting">in.telnetd : .example.com \
	: spawn /bin/echo `/bin/date` from %h&gt;&gt;/var/log/telnet.log \
	: allow</pre></li><li class="listitem"><div class="para">
							<code class="command">twist</code> — Replaces the requested 
service with the specified command. This directive is often used to set 
up traps for intruders (also called "honey pots"). It can also be used 
to send messages to connecting clients. The <code class="command">twist</code> directive must occur at the end of the rule line.
						</div><div class="para">
							In the following example, clients attempting to access FTP services from the <code class="systemitem">example.com</code> domain are sent a message using the <code class="command">echo</code> command:
						</div><pre class="programlisting">vsftpd : .example.com \
	: twist /bin/echo "421 This domain has been black-listed. Access denied!"</pre></li></ul></div><div class="para">
					For more information about shell command options, see the <code class="filename">hosts_options</code> man page.
				</div></div><div class="section" id="sect-Security_Guide-Option_Fields-Expansions"><div class="titlepage"><div><div><h5 class="title">2.6.2.2.4.&nbsp;Expansions</h5></div></div></div><div class="para">
					Expansions, when used in conjunction with the <code class="command">spawn</code> and <code class="command">twist</code> directives, provide information about the client, server, and processes involved.
				</div><div class="para">
					The following is a list of supported expansions:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">%a</code> — Returns the client's IP address.
						</div></li><li class="listitem"><div class="para">
							<code class="option">%A</code> — Returns the server's IP address.
						</div></li><li class="listitem"><div class="para">
							<code class="option">%c</code> — Returns a variety of client information, such as the user name and hostname, or the user name and IP address.
						</div></li><li class="listitem"><div class="para">
							<code class="option">%d</code> — Returns the daemon process name.
						</div></li><li class="listitem"><div class="para">
							<code class="option">%h</code> — Returns the client's hostname (or IP address, if the hostname is unavailable).
						</div></li><li class="listitem"><div class="para">
							<code class="option">%H</code> — Returns the server's hostname (or IP address, if the hostname is unavailable).
						</div></li><li class="listitem"><div class="para">
							<code class="option">%n</code> — Returns the client's hostname. If unavailable, <code class="computeroutput">unknown</code> is printed. If the client's hostname and host address do not match, <code class="computeroutput">paranoid</code> is printed.
						</div></li><li class="listitem"><div class="para">
							<code class="option">%N</code> — Returns the server's hostname. If unavailable, <code class="computeroutput">unknown</code> is printed. If the server's hostname and host address do not match, <code class="computeroutput">paranoid</code> is printed.
						</div></li><li class="listitem"><div class="para">
							<code class="option">%p</code> — Returns the daemon's process ID.
						</div></li><li class="listitem"><div class="para">
							<code class="option">%s</code> —Returns various types of server information, such as the daemon process and the host or IP address of the server.
						</div></li><li class="listitem"><div class="para">
							<code class="option">%u</code> — Returns the client's user name. If unavailable, <code class="computeroutput">unknown</code> is printed.
						</div></li></ul></div><div class="para">
					The following sample rule uses an expansion in conjunction with the <code class="command">spawn</code> command to identify the client host in a customized log file.
				</div><div class="para">
					When connections to the SSH daemon (<code class="systemitem">sshd</code>) are attempted from a host in the <code class="systemitem">example.com</code> domain, execute the <code class="command">echo</code> command to log the attempt, including the client hostname (by using the <code class="option">%h</code> expansion), to a special file:
				</div><pre class="programlisting">sshd : .example.com  \
	: spawn /bin/echo `/bin/date` access denied to %h&gt;&gt;/var/log/sshd.log \
	: deny</pre><div class="para">
					Similarly, expansions can be used to personalize messages back to 
the client. In the following example, clients attempting to access FTP 
services from the <code class="systemitem">example.com</code> domain are informed that they have been banned from the server:
				</div><pre class="programlisting">vsftpd : .example.com \
: twist /bin/echo "421 %h has been banned from this server!"</pre><div class="para">
					For a full explanation of available expansions, as well as 
additional access control options, see section 5 of the man pages for <code class="filename">hosts_access</code> (<code class="command">man 5 hosts_access</code>) and the man page for <code class="filename">hosts_options</code>.
				</div><div class="para">
					Refer to <a class="xref" href="#sect-Security_Guide-TCP_Wrappers_and_xinetd-Additional_Resources">Section&nbsp;2.6.5, “Additional Resources”</a> for more information about TCP Wrappers.
				</div></div></div></div><div class="section" id="sect-Security_Guide-TCP_Wrappers_and_xinetd-xinetd"><div class="titlepage"><div><div><h3 class="title">2.6.3.&nbsp;xinetd</h3></div></div></div><div class="para">
			The <code class="systemitem">xinetd</code> daemon is a TCP-wrapped <em class="firstterm">super service</em>
 which controls access to a subset of popular network services, 
including FTP, IMAP, and Telnet. It also provides service-specific 
configuration options for access control, enhanced logging, binding, 
redirection, and resource utilization control.
		</div><div class="para">
			When a client attempts to connect to a network service controlled by <code class="systemitem">xinetd</code>, the super service receives the request and checks for any TCP Wrappers access control rules.
		</div><div class="para">
			If access is allowed, <code class="systemitem">xinetd</code> verifies
 that the connection is allowed under its own access rules for that 
service. It also checks that the service is able to have more resources 
assigned to it and that it is not in breach of any defined rules.
		</div><div class="para">
			If all these conditions are met (that is, access is allowed to the 
service; the service has not reached its resource limit; and the service
 is not in breach of any defined rule), <code class="systemitem">xinetd</code>
 then starts an instance of the requested service and passes control of 
the connection to it. After the connection has been established, <code class="systemitem">xinetd</code> takes no further part in the communication between the client and the server.
		</div></div><div class="section" id="sect-Security_Guide-TCP_Wrappers_and_xinetd-xinetd_Configuration_Files"><div class="titlepage"><div><div><h3 class="title">2.6.4.&nbsp;xinetd Configuration Files</h3></div></div></div><div class="para">
			The configuration files for <code class="systemitem">xinetd</code> are as follows:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="filename">/etc/xinetd.conf</code> — The global <code class="systemitem">xinetd</code> configuration file.
				</div></li><li class="listitem"><div class="para">
					<code class="filename">/etc/xinetd.d/</code> — The directory containing all service-specific files.
				</div></li></ul></div><div class="section" id="sect-Security_Guide-xinetd_Configuration_Files-The_etcxinetd.conf_File"><div class="titlepage"><div><div><h4 class="title">2.6.4.1.&nbsp;The /etc/xinetd.conf File</h4></div></div></div><div class="para">
				The <code class="filename">/etc/xinetd.conf</code> file contains general configuration settings which affect every service under <code class="systemitem">xinetd</code>'s control. It is read when the <code class="systemitem">xinetd</code> service is first started, so for configuration changes to take effect, you need to restart the <code class="systemitem">xinetd</code> service. The following is a sample <code class="filename">/etc/xinetd.conf</code> file:
			</div><pre class="programlisting">defaults
{
	 instances               = 60        
	 log_type                = SYSLOG	authpriv
	 log_on_success          = HOST PID
	 log_on_failure          = HOST
	 cps                     = 25 30
}
includedir /etc/xinetd.d</pre><div class="para">
				These lines control the following aspects of <code class="systemitem">xinetd</code>:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="option">instances</code> — Specifies the maximum number of simultaneous requests that <code class="systemitem">xinetd</code> can process.
					</div></li><li class="listitem"><div class="para">
						<code class="option">log_type</code> — Configures <code class="systemitem">xinetd</code> to use the <code class="command">authpriv</code> log facility, which writes log entries to the <code class="filename">/var/log/secure</code> file. Adding a directive such as <code class="option">FILE /var/log/xinetdlog</code> would create a custom log file called <code class="filename">xinetdlog</code> in the <code class="filename">/var/log/</code> directory.
					</div></li><li class="listitem"><div class="para">
						<code class="option">log_on_success</code> — Configures <code class="systemitem">xinetd</code>
 to log successful connection attempts. By default, the remote host's IP
 address and the process ID of the server processing the request are 
recorded.
					</div></li><li class="listitem"><div class="para">
						<code class="option">log_on_failure</code> — Configures <code class="systemitem">xinetd</code> to log failed connection attempts or if the connection was denied.
					</div></li><li class="listitem"><div class="para">
						<code class="option">cps</code> — Configures <code class="systemitem">xinetd</code>
 to allow no more than 25 connections per second to any given service. 
If this limit is exceeded, the service is retired for 30 seconds.
					</div></li><li class="listitem"><div class="para">
						<code class="option">includedir</code> <code class="filename">/etc/xinetd.d/</code> — Includes options declared in the service-specific configuration files located in the <code class="filename">/etc/xinetd.d/</code> directory. Refer to <a class="xref" href="#sect-Security_Guide-xinetd_Configuration_Files-The_etcxinetd.d_Directory">Section&nbsp;2.6.4.2, “The /etc/xinetd.d/ Directory”</a> for more information.
					</div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Often, both the <code class="option">log_on_success</code> and <code class="option">log_on_failure</code> settings in <code class="filename">/etc/xinetd.conf</code>
 are further modified in the service-specific configuration files. More 
information may therefore appear in a given service's log file than the <code class="filename">/etc/xinetd.conf</code> file may indicate. Refer to <a class="xref" href="#sect-Security_Guide-Altering_xinetd_Configuration_Files-Logging_Options">Section&nbsp;2.6.4.3.1, “Logging Options”</a> for further information.
				</div></div></div></div><div class="section" id="sect-Security_Guide-xinetd_Configuration_Files-The_etcxinetd.d_Directory"><div class="titlepage"><div><div><h4 class="title">2.6.4.2.&nbsp;The /etc/xinetd.d/ Directory</h4></div></div></div><div class="para">
				The <code class="filename">/etc/xinetd.d/</code> directory contains the configuration files for each service managed by <code class="systemitem">xinetd</code> and the names of the files are correlated to the service. As with <code class="filename">xinetd.conf</code>, this directory is read only when the <code class="systemitem">xinetd</code> service is started. For any changes to take effect, the administrator must restart the <code class="systemitem">xinetd</code> service.
			</div><div class="para">
				The format of files in the <code class="filename">/etc/xinetd.d/</code> directory use the same conventions as <code class="filename">/etc/xinetd.conf</code>.
 The primary reason the configuration for each service is stored in a 
separate file is to make customization easier and less likely to affect 
other services.
			</div><div class="para">
				To gain an understanding of how these files are structured, consider the <code class="filename">/etc/xinetd.d/krb5-telnet</code> file:
			</div><pre class="programlisting">service telnet
{
	 flags           = REUSE
	 socket_type     = stream
	 wait            = no
	 user            = root
	 server          = /usr/kerberos/sbin/telnetd
	 log_on_failure  += USERID
	 disable         = yes
}</pre><div class="para">
				These lines control various aspects of the <code class="command">telnet</code> service:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="option">service</code> — Specifies the service name, usually one of those listed in the <code class="filename">/etc/services</code> file.
					</div></li><li class="listitem"><div class="para">
						<code class="option">flags</code> — Sets any of a number of attributes for the connection. <code class="option">REUSE</code> instructs <code class="systemitem">xinetd</code> to reuse the socket for a Telnet connection.
					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							The <code class="option">REUSE</code> flag is deprecated. All services now implicitly use the <code class="option">REUSE</code> flag.
						</div></div></div></li><li class="listitem"><div class="para">
						<code class="option">socket_type</code> — Sets the network socket type to <code class="option">stream</code>.
					</div></li><li class="listitem"><div class="para">
						<code class="option">wait</code> — Specifies whether the service is single-threaded (<code class="option">yes</code>) or multi-threaded (<code class="option">no</code>).
					</div></li><li class="listitem"><div class="para">
						<code class="option">user</code> — Specifies which user ID the process runs under.
					</div></li><li class="listitem"><div class="para">
						<code class="option">server</code> — Specifies which binary executable to launch.
					</div></li><li class="listitem"><div class="para">
						<code class="option">log_on_failure</code> — Specifies logging parameters for <code class="option">log_on_failure</code> in addition to those already defined in <code class="filename">xinetd.conf</code>.
					</div></li><li class="listitem"><div class="para">
						<code class="option">disable</code> — Specifies whether the service is disabled (<code class="option">yes</code>) or enabled (<code class="option">no</code>).
					</div></li></ul></div><div class="para">
				Refer to the <code class="filename">xinetd.conf</code> man page for more information about these options and their usage.
			</div></div><div class="section" id="sect-Security_Guide-xinetd_Configuration_Files-Altering_xinetd_Configuration_Files"><div class="titlepage"><div><div><h4 class="title">2.6.4.3.&nbsp;Altering xinetd Configuration Files</h4></div></div></div><div class="para">
				A range of directives are available for services protected by <code class="systemitem">xinetd</code>. This section highlights some of the more commonly used options.
			</div><div class="section" id="sect-Security_Guide-Altering_xinetd_Configuration_Files-Logging_Options"><div class="titlepage"><div><div><h5 class="title">2.6.4.3.1.&nbsp;Logging Options</h5></div></div></div><div class="para">
					The following logging options are available for both <code class="filename">/etc/xinetd.conf</code> and the service-specific configuration files within the <code class="filename">/etc/xinetd.d/</code> directory.
				</div><div class="para">
					The following is a list of some of the more commonly used logging options:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">ATTEMPT</code> — Logs the fact that a failed attempt was made (<code class="option">log_on_failure</code>).
						</div></li><li class="listitem"><div class="para">
							<code class="option">DURATION</code> — Logs the length of time the service is used by a remote system (<code class="option">log_on_success</code>).
						</div></li><li class="listitem"><div class="para">
							<code class="option">EXIT</code> — Logs the exit status or termination signal of the service (<code class="option">log_on_success</code>).
						</div></li><li class="listitem"><div class="para">
							<code class="option">HOST</code> — Logs the remote host's IP address (<code class="option">log_on_failure</code> and <code class="option">log_on_success</code>).
						</div></li><li class="listitem"><div class="para">
							<code class="option">PID</code> — Logs the process ID of the server receiving the request (<code class="option">log_on_success</code>).
						</div></li><li class="listitem"><div class="para">
							<code class="option">USERID</code> — Logs the remote user using the method defined in RFC 1413 for all multi-threaded stream services (<code class="option">log_on_failure</code> and <code class="option">log_on_success</code>).
						</div></li></ul></div><div class="para">
					For a complete list of logging options, see the <code class="filename">xinetd.conf</code> man page.
				</div></div><div class="section" id="sect-Security_Guide-Altering_xinetd_Configuration_Files-Access_Control_Options"><div class="titlepage"><div><div><h5 class="title">2.6.4.3.2.&nbsp;Access Control Options</h5></div></div></div><div class="para">
					Users of <code class="systemitem">xinetd</code> services can choose to use the TCP Wrappers hosts access rules, provide access control via the <code class="systemitem">xinetd</code> configuration files, or a mixture of both. Refer to <a class="xref" href="#sect-Security_Guide-TCP_Wrappers_and_xinetd-TCP_Wrappers_Configuration_Files">Section&nbsp;2.6.2, “TCP Wrappers Configuration Files”</a> for more information about TCP Wrappers hosts access control files.
				</div><div class="para">
					This section discusses using <code class="systemitem">xinetd</code> to control access to services.
				</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
						Unlike TCP Wrappers, changes to access control only take effect if the <code class="systemitem">xinetd</code> administrator restarts the <code class="systemitem">xinetd</code> service.
					</div><div class="para">
						Also, unlike TCP Wrappers, access control through <code class="systemitem">xinetd</code> only affects services controlled by <code class="systemitem">xinetd</code>.
					</div></div></div><div class="para">
					The <code class="systemitem">xinetd</code> hosts access control 
differs from the method used by TCP Wrappers. While TCP Wrappers places 
all of the access configuration within two files, <code class="filename">/etc/hosts.allow</code> and <code class="filename">/etc/hosts.deny</code>, <code class="systemitem">xinetd</code>'s access control is found in each service's configuration file in the <code class="filename">/etc/xinetd.d/</code> directory.
				</div><div class="para">
					The following hosts access options are supported by <code class="systemitem">xinetd</code>:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">only_from</code> — Allows only the specified hosts to use the service.
						</div></li><li class="listitem"><div class="para">
							<code class="option">no_access</code> — Blocks listed hosts from using the service.
						</div></li><li class="listitem"><div class="para">
							<code class="option">access_times</code> — Specifies the time 
range when a particular service may be used. The time range must be 
stated in 24-hour format notation, HH:MM-HH:MM.
						</div></li></ul></div><div class="para">
					The <code class="option">only_from</code> and <code class="option">no_access</code> options can use a list of IP addresses or host names, or can specify an entire network. Like TCP Wrappers, combining <code class="systemitem">xinetd</code>
 access control with the enhanced logging configuration can increase 
security by blocking requests from banned hosts while verbosely 
recording each connection attempt.
				</div><div class="para">
					For example, the following <code class="filename">/etc/xinetd.d/telnet</code>
 file can be used to block Telnet access from a particular network group
 and restrict the overall time range that even allowed users can log in:
				</div><pre class="programlisting">service telnet
{
	 disable         = no
	 flags           = REUSE
	 socket_type     = stream
	 wait            = no
	 user            = root
	 server          = /usr/kerberos/sbin/telnetd
	 log_on_failure  += USERID
	 no_access       = 172.16.45.0/24
	 log_on_success  += PID HOST EXIT
	 access_times    = 09:45-16:15
}</pre><div class="para">
					In this example, when a client system from the <code class="systemitem">172.16.45.0/24</code> network, such as <code class="systemitem">172.16.45.2</code>, tries to access the Telnet service, it receives the following message:
				</div><pre class="screen">Connection closed by foreign host.</pre><div class="para">
					In addition, their login attempts are logged in <code class="filename">/var/log/messages</code> as follows:
				</div><pre class="programlisting">Sep  7 14:58:33 localhost xinetd[5285]: FAIL: telnet address from=172.16.45.107
Sep  7 14:58:33 localhost xinetd[5283]: START: telnet pid=5285 from=172.16.45.107
Sep  7 14:58:33 localhost xinetd[5283]: EXIT: telnet status=0 pid=5285 duration=0(sec)</pre><div class="para">
					When using TCP Wrappers in conjunction with <code class="systemitem">xinetd</code> access controls, it is important to understand the relationship between the two access control mechanisms.
				</div><div class="para">
					The following is the sequence of events followed by <code class="systemitem">xinetd</code> when a client requests a connection:
				</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
							The <code class="systemitem">xinetd</code> daemon accesses the TCP Wrappers hosts access rules using a <code class="filename">libwrap.so</code>
 library call. If a deny rule matches the client, the connection is 
dropped. If an allow rule matches the client, the connection is passed 
to <code class="systemitem">xinetd</code>.
						</div></li><li class="listitem"><div class="para">
							The <code class="systemitem">xinetd</code> daemon checks its own access control rules both for the <code class="systemitem">xinetd</code> service and the requested service. If a deny rule matches the client, the connection is dropped. Otherwise, <code class="systemitem">xinetd</code> starts an instance of the requested service and passes control of the connection to that service.
						</div></li></ol></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
						Care should be taken when using TCP Wrappers access controls in conjunction with <code class="systemitem">xinetd</code> access controls. Misconfiguration can cause undesirable effects.
					</div></div></div></div><div class="section" id="sect-Security_Guide-Altering_xinetd_Configuration_Files-Binding_and_Redirection_Options"><div class="titlepage"><div><div><h5 class="title">2.6.4.3.3.&nbsp;Binding and Redirection Options</h5></div></div></div><div class="para">
					The service configuration files for <code class="systemitem">xinetd</code>
 support binding the service to an IP address and redirecting incoming 
requests for that service to another IP address, hostname, or port.
				</div><div class="para">
					Binding is controlled with the <code class="option">bind</code> 
option in the service-specific configuration files and links the service
 to one IP address on the system. When this is configured, the <code class="option">bind</code>
 option only allows requests to the correct IP address to access the 
service. You can use this method to bind different services to different
 network interfaces based on requirements.
				</div><div class="para">
					This is particularly useful for systems with multiple network 
adapters or with multiple IP addresses. On such a system, insecure 
services (for example, Telnet), can be configured to listen only on the 
interface connected to a private network and not to the interface 
connected to the Internet.
				</div><div class="para">
					The <code class="option">redirect</code> option accepts an IP 
address or hostname followed by a port number. It configures the service
 to redirect any requests for this service to the specified host and 
port number. This feature can be used to point to another port number on
 the same system, redirect the request to a different IP address on the 
same machine, shift the request to a totally different system and port 
number, or any combination of these options. A user connecting to a 
certain service on a system may therefore be rerouted to another system 
without disruption.
				</div><div class="para">
					The <code class="systemitem">xinetd</code> daemon is able to 
accomplish this redirection by spawning a process that stays alive for 
the duration of the connection between the requesting client machine and
 the host actually providing the service, transferring data between the 
two systems.
				</div><div class="para">
					The advantages of the <code class="option">bind</code> and <code class="option">redirect</code>
 options are most clearly evident when they are used together. By 
binding a service to a particular IP address on a system and then 
redirecting requests for this service to a second machine that only the 
first machine can see, an internal system can be used to provide 
services for a totally different network. Alternatively, these options 
can be used to limit the exposure of a particular service on a 
multi-homed machine to a known IP address, as well as redirect any 
requests for that service to another machine especially configured for 
that purpose.
				</div><div class="para">
					For example, consider a system that is used as a firewall with this setting for its Telnet service:
				</div><pre class="programlisting">service telnet
{
	 socket_type		= stream
	 wait			= no
	 server			= /usr/kerberos/sbin/telnetd
	 log_on_success		+= DURATION USERID
	 log_on_failure		+= USERID
	 bind                    = 123.123.123.123
	 redirect                = 10.0.1.13 23
}</pre><div class="para">
					The <code class="option">bind</code> and <code class="option">redirect</code> options in this file ensure that the Telnet service on the machine is bound to the external IP address (<code class="systemitem">123.123.123.123</code>), the one facing the Internet. In addition, any requests for Telnet service sent to <code class="systemitem">123.123.123.123</code> are redirected via a second network adapter to an internal IP address (<code class="systemitem">10.0.1.13</code>)
 that only the firewall and internal systems can access. The firewall 
then sends the communication between the two systems, and the connecting
 system thinks it is connected to <code class="systemitem">123.123.123.123</code> when it is actually connected to a different machine.
				</div><div class="para">
					This feature is particularly useful for users with broadband 
connections and only one fixed IP address. When using Network Address 
Translation (NAT), the systems behind the gateway machine, which are 
using internal-only IP addresses, are not available from outside the 
gateway system. However, when certain services controlled by <code class="systemitem">xinetd</code> are configured with the <code class="option">bind</code> and <code class="option">redirect</code>
 options, the gateway machine can act as a proxy between outside systems
 and a particular internal machine configured to provide the service. In
 addition, the various <code class="systemitem">xinetd</code> access control and logging options are also available for additional protection.
				</div></div><div class="section" id="sect-Security_Guide-Altering_xinetd_Configuration_Files-Resource_Management_Options"><div class="titlepage"><div><div><h5 class="title">2.6.4.3.4.&nbsp;Resource Management Options</h5></div></div></div><div class="para">
					The <code class="systemitem">xinetd</code> daemon can add a basic 
level of protection from Denial of Service (DoS) attacks. The following 
is a list of directives which can aid in limiting the effectiveness of 
such attacks:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">per_source</code> — Defines the maximum 
number of instances for a service per source IP address. It accepts only
 integers as an argument and can be used in both <code class="filename">xinetd.conf</code> and in the service-specific configuration files in the <code class="filename">xinetd.d/</code> directory.
						</div></li><li class="listitem"><div class="para">
							<code class="option">cps</code> — Defines the maximum number of 
connections per second. This directive takes two integer arguments 
separated by white space. The first argument is the maximum number of 
connections allowed to the service per second. The second argument is 
the number of seconds that <code class="systemitem">xinetd</code> must wait before re-enabling the service. It accepts only integers as arguments and can be used in either the <code class="filename">xinetd.conf</code> file or the service-specific configuration files in the <code class="filename">xinetd.d/</code> directory.
						</div></li><li class="listitem"><div class="para">
							<code class="option">max_load</code> — Defines the CPU usage or load average threshold for a service. It accepts a floating point number argument.
						</div><div class="para">
							The load average is a rough measure of how many processes are active at a given time. See the <code class="command">uptime</code>, <code class="command">who</code>, and <code class="command">procinfo</code> commands for more information about load average.
						</div></li></ul></div><div class="para">
					There are more resource management options available for <code class="systemitem">xinetd</code>. Refer to the <code class="filename">xinetd.conf</code> man page for more information.
				</div></div></div></div><div class="section" id="sect-Security_Guide-TCP_Wrappers_and_xinetd-Additional_Resources"><div class="titlepage"><div><div><h3 class="title">2.6.5.&nbsp;Additional Resources</h3></div></div></div><div class="para">
			More information about TCP Wrappers and <code class="systemitem">xinetd</code> is available from system documentation and on the Internet.
		</div><div class="section" id="sect-Security_Guide-Additional_Resources-Installed_TCP_Wrappers_Documentation"><div class="titlepage"><div><div><h4 class="title">2.6.5.1.&nbsp;Installed TCP Wrappers Documentation</h4></div></div></div><div class="para">
				The documentation on your system is a good place to start looking for additional configuration options for TCP Wrappers, <code class="systemitem">xinetd</code>, and access control.
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="filename">/usr/share/doc/tcp_wrappers-<em class="replaceable">&lt;version&gt;</em>/</code> — This directory contains a <code class="filename">README</code> file that discusses how TCP Wrappers work and the various hostname and host address spoofing risks that exist.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">/usr/share/doc/xinetd-<em class="replaceable">&lt;version&gt;</em>/</code> — This directory contains a <code class="filename">README</code> file that discusses aspects of access control and a <code class="filename">sample.conf</code> file with various ideas for modifying service-specific configuration files in the <code class="filename">/etc/xinetd.d/</code> directory.
					</div></li><li class="listitem"><div class="para">
						TCP Wrappers and <code class="systemitem">xinetd</code>-related 
man pages — A number of man pages exist for the various applications and
 configuration files involved with TCP Wrappers and <code class="systemitem">xinetd</code>. The following are some of the more important man pages:
					</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">Server Applications</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para">
											<code class="command">man xinetd</code> — The man page for <code class="systemitem">xinetd</code>.
										</div></li></ul></div></dd><dt><span class="term">Configuration Files</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para">
											<code class="command">man 5 hosts_access</code> — The man page for the TCP Wrappers hosts access control files.
										</div></li><li class="listitem"><div class="para">
											<code class="command">man hosts_options</code> — The man page for the TCP Wrappers options fields.
										</div></li><li class="listitem"><div class="para">
											<code class="command">man xinetd.conf</code> — The man page listing <code class="systemitem">xinetd</code> configuration options.
										</div></li></ul></div></dd></dl></div></li></ul></div></div><div class="section" id="sect-Security_Guide-Additional_Resources-Related_Books"><div class="titlepage"><div><div><h4 class="title">2.6.5.2.&nbsp;Related Books</h4></div></div></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<em class="citetitle">Hacking Linux Exposed</em> by Brian Hatch, 
James Lee, and George Kurtz; Osbourne/McGraw-Hill — An excellent 
security resource with information about TCP Wrappers and <code class="systemitem">xinetd</code>.
					</div></li></ul></div></div></div></div><div xml:lang="en-US" class="section" id="sec-Securing_Virtual_Private_Networks" lang="en-US"><div class="titlepage"><div><div><h2 class="title">2.7.&nbsp;Securing Virtual Private Networks (VPNs)</h2></div></div></div><div class="para">
		In Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6, a <em class="firstterm">Virtual Private Network</em> (<acronym class="acronym">VPN</acronym>) can be configured using the <code class="systemitem">IPsec</code> tunneling protocol which is supported by the <span class="application"><strong>Libreswan</strong></span> application. <span class="application"><strong>Libreswan</strong></span> is a fork of the <span class="application"><strong>Openswan</strong></span> application and examples in documentation should be interchangeable. The <span class="application"><strong>NetworkManager</strong></span> <code class="systemitem">IPsec</code> plug-in is called <span class="package">NetworkManager-openswan</span>.
	</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			<span class="application"><strong>Libreswan</strong></span> replaced <span class="application"><strong>Openswan</strong></span>
 as the preferred implementation of IPsec in Red&nbsp;Hat 
Enterprise&nbsp;Linux&nbsp;6.8. Performing an upgrade from a version 
earlier than 6.8 replaces the <span class="package">openswan</span> package with <span class="package">libreswan</span>.
		</div></div></div><div class="para">
		<span class="application"><strong>Libreswan</strong></span> is an open-source, user-space <code class="systemitem">IPsec</code> implementation available in Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6. It uses the <em class="firstterm">Internet key exchange</em> (<acronym class="acronym">IKE</acronym>) protocol. <code class="systemitem">IKE</code> version 1 and 2 are implemented as a user-level daemon. Manual key establishment is also possible via <code class="command">ip xfrm</code> commands, however this is not recommended. <span class="application"><strong>Libreswan</strong></span>
 interfaces with the Linux kernel using netlink to transfer the 
encryption keys. Packet encryption and decryption happen in the Linux 
kernel.
	</div><div class="para">
		<span class="application"><strong>Libreswan</strong></span> uses the <em class="firstterm">network security services</em> (<acronym class="acronym">NSS</acronym>) cryptographic library, which is required for <em class="firstterm">Federal Information Processing Standard</em> (<acronym class="acronym">FIPS</acronym>) security compliance.
	</div><div class="section" id="sec-IPsec_VPN_Using_Libreswan"><div class="titlepage"><div><div><h3 class="title">2.7.1.&nbsp;IPsec VPN Using Libreswan</h3></div></div></div><div class="para">
			To install <span class="application"><strong>Libreswan</strong></span>, issue the following command as <code class="systemitem">root</code>. Note that the <span class="package">libreswan</span> package is available from the <span class="emphasis"><em>Extras</em></span> repository, which needs to be enabled for the installation to succeed. See <a href="https://access.redhat.com/solutions/265523">How to enable/disable a repository using Red Hat Subscription Manager?</a> (The ID of the <span class="emphasis"><em>Extras</em></span> repository is <code class="literal">rhel-6-server-extras-rpms</code>.)
		</div><pre class="screen">~]# <code class="command">yum install libreswan</code></pre><div class="para">
			To check that <span class="application"><strong>Libreswan</strong></span> is installed, issue the following command:
		</div><pre class="screen">~]$ <code class="command">yum info libreswan</code></pre><div class="para">
			After a new installation of <span class="application"><strong>Libreswan</strong></span>
 the NSS database should be initialized as part of the install process. 
However, should you need to start a new database, first remove the old 
database as follows:
		</div><pre class="screen">~]# <code class="command">rm /etc/ipsec.d/*db</code></pre><div class="para">
			Then, to initialize a new NSS database, issue the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]# <code class="command">ipsec initnss</code>
Initializing NSS database
See 'man pluto' if you want to protect the NSS database with a password</pre><div class="para">
			To start the <code class="systemitem">ipsec</code> daemon provided by <span class="application"><strong>Libreswan</strong></span>, issue the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]# <code class="command">service ipsec start</code></pre><div class="para">
			To confirm that the daemon is now running:
		</div><pre class="screen">~]$ <code class="command">service ipsec status</code>
pluto (pid  3496) is running...</pre><div class="para">
			To ensure that <span class="application"><strong>Libreswan</strong></span> will start when the system starts, issue the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]# <code class="command">chkconfig ipsec on</code></pre><div class="para">
			Configure any intermediate as well as host-based firewalls to permit the <code class="systemitem">ipsec</code> service. See <a class="xref" href="#sect-Security_Guide-Firewalls">Section&nbsp;2.8, “Firewalls”</a> for information on firewalls and allowing specific services to pass through. <span class="application"><strong>Libreswan</strong></span> requires the firewall to allow the following packets:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="systemitem">UDP</code> port 500 for the <code class="systemitem">Internet Key Exchange</code> (<acronym class="acronym">IKE</acronym>) protocol
				</div></li><li class="listitem"><div class="para">
					<code class="systemitem">UDP</code> port 4500 for <code class="systemitem">IKE NAT-Traversal</code>
				</div></li><li class="listitem"><div class="para">
					Protocol 50 for <code class="systemitem">Encapsulated Security Payload</code> (<acronym class="acronym">ESP</acronym>) <code class="systemitem">IPsec</code> packets
				</div></li><li class="listitem"><div class="para">
					Protocol 51 for <code class="systemitem">Authenticated Header</code> (<acronym class="acronym">AH</acronym>) <code class="systemitem">IPsec</code> packets (uncommon)
				</div></li></ul></div><div class="para">
			We present three examples of using <span class="application"><strong>Libreswan</strong></span> to set up an <code class="systemitem">IPsec</code>
 VPN. The first example is for connecting two hosts together so that 
they may communicate securely. The second example is connecting two 
sites together to form one network. The third example is supporting 
roaming users, known as <em class="firstterm">road warriors</em> in this context.
		</div></div><div class="section" id="VPN_Configurations_Using_Libreswan"><div class="titlepage"><div><div><h3 class="title">2.7.2.&nbsp;VPN Configurations Using Libreswan</h3></div></div></div><div class="para">
			<span class="application"><strong>Libreswan</strong></span> does not use the terms <span class="quote">“<span class="quote">source</span>”</span> or <span class="quote">“<span class="quote">destination</span>”</span>. Instead, it uses the terms <span class="quote">“<span class="quote">left</span>”</span> and <span class="quote">“<span class="quote">right</span>”</span>
 to refer to end points (the hosts). This allows the same configuration 
to be used on both end points in most cases, although most 
administrators use <span class="quote">“<span class="quote">left</span>”</span> for the local host and <span class="quote">“<span class="quote">right</span>”</span> for the remote host.
		</div><div class="para">
			There are three commonly used methods for authentication of endpoints:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Raw RSA keys are commonly used for static host-to-host or subnet-to-subnet <code class="systemitem">IPsec</code>
 configurations. The hosts are manually configured with each other's 
public RSA key. This method does not scale well when dozens or more 
hosts all need to setup <code class="systemitem">IPsec</code> tunnels to each other.
				</div></li><li class="listitem"><div class="para">
					X.509 certificates are commonly used for large scale deployments 
where there are many hosts that need to connect to a common <code class="systemitem">IPsec</code> gateway. A central <em class="firstterm">certificate authority</em> (<acronym class="acronym">CA</acronym>)
 is used to sign RSA certificates for hosts or users. This central CA is
 responsible for relaying trust, including the revocations of individual
 hosts or users.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">Pre-Shared Keys</em> (<acronym class="acronym">PSK</acronym>)
 is the simplest authentication method. PSK's should consist of random 
characters and have a length of at least 20 characters. Due to the 
dangers of non-random and short PSKs, this is the least secure form of 
authentication and it is recommended to use either raw RSA keys or 
certificate based authentication instead.
				</div></li></ul></div></div><div class="section" id="sec-Host-To-Host_VPN_Using_Libreswan"><div class="titlepage"><div><div><h3 class="title">2.7.3.&nbsp;Host-To-Host VPN Using Libreswan</h3></div></div></div><div class="para">
			To configure <span class="application"><strong>Libreswan</strong></span> to create a host-to-host <code class="systemitem">IPsec</code> VPN, between two hosts referred to as <span class="quote">“<span class="quote">left</span>”</span> and <span class="quote">“<span class="quote">right</span>”</span>, enter the following commands as <code class="systemitem">root</code> on both of the hosts (<span class="quote">“<span class="quote">left</span>”</span> and <span class="quote">“<span class="quote">right</span>”</span>) to create new raw RSA key pairs:
		</div><pre class="screen">~]# <code class="command">ipsec newhostkey --configdir /etc/ipsec.d \</code>
<code class="command">--output /etc/ipsec.d/www.example.com.secrets</code>
Generated RSA key pair using the NSS database</pre><div class="para">
			This generates an RSA key pair for the host. The process of 
generating RSA keys can take many minutes, especially on virtual 
machines with low entropy.
		</div><div class="para">
			To view the public key, issue the following command as <code class="systemitem">root</code> on either of the hosts. For example, to view the public key on the <span class="quote">“<span class="quote">left</span>”</span> host, run:
		</div><pre class="screen">~]# <code class="command">ipsec showhostkey --left</code>
ipsec showhostkey loading secrets from "/etc/ipsec.secrets"
ipsec showhostkey loading secrets from "/etc/ipsec.d/www.example.com.secrets"
ipsec showhostkey loaded private key for keyid: PPK_RSA:AQOjAKLlL
	# rsakey AQOjAKLlL
	leftrsasigkey=0sAQOjAKLlL4a7YBv [...]</pre><div class="para">
			You will need this key to add to the configuration file as explained below.
		</div><div class="para">
			The secret part is stored in <code class="filename">/etc/ipsec.d/*.db</code> files, also called the <span class="quote">“<span class="quote">NSS database</span>”</span>.
		</div><div class="para">
			To make a configuration file for this host-to-host tunnel, the lines <code class="literal">leftrsasigkey=</code> and <code class="literal">rightrsasigkey=</code> from above, are added to a custom configuration file placed in the <code class="filename">/etc/ipsec.d/</code> directory. 
		</div><div class="para">
			Using an editor running as <code class="systemitem">root</code>, create a file with a suitable name in the following format:
		</div><pre class="synopsis">/etc/ipsec.d/my_host-to-host.conf</pre><div class="para">
			Edit the file as follows:
		</div><pre class="screen">conn mytunnel
    leftid=@west.example.com
    left=192.1.2.23
    leftrsasigkey=0sAQOrlo+hOafUZDlCQmXFrje/oZm [...] W2n417C/4urYHQkCvuIQ==
    rightid=@east.example.com
    right=192.1.2.45
    rightrsasigkey=0sAQO3fwC6nSSGgt64DWiYZzuHbc4 [...] D/v8t5YTQ==
    authby=rsasig
    # load and initiate automatically
    auto=start</pre><div class="para">
			You can use the identical configuration file on both left and right hosts. They will auto-detect if they are <span class="quote">“<span class="quote">left</span>”</span> or <span class="quote">“<span class="quote">right</span>”</span>. If one of the hosts is a mobile host, which implies the <code class="systemitem">IP</code> address is not known in advance, then on the mobile host use <code class="literal">%defaultroute</code> as its <code class="systemitem">IP</code> address. This will pick up the dynamic <code class="systemitem">IP</code> address automatically. On the static host that accepts connections from incoming mobile hosts, specify the mobile host using <code class="literal">%any</code> for its <code class="systemitem">IP</code> address.
		</div><div class="para">
			Ensure the <code class="option">leftrsasigkey</code> value is obtained from the <span class="quote">“<span class="quote">left</span>”</span> host and the <code class="option">rightrsasigkey</code> value is obtained from the <span class="quote">“<span class="quote">right</span>”</span> host.
		</div><div class="para">
			Restart <code class="systemitem">ipsec</code> to ensure it reads the new configuration:
		</div><pre class="screen">~]# service ipsec --full-restart</pre><div class="para">
			To check the tunnel is succesfully established, enter the following command:
		</div><pre class="screen">~]# ipsec whack --trafficstatus</pre><div class="para">
			Alternatively, if not using the <code class="option">auto=start</code> option in the <code class="filename">/etc/ipsec.d/*.conf</code> file or if a tunnel is not succesfully established, use the following command as <code class="systemitem">root</code> to load the <code class="systemitem">IPsec</code> tunnel:
		</div><pre class="screen">~]# <code class="command">ipsec auto --add mytunnel</code></pre><div class="para">
			To bring up the tunnel, issue the following command as <code class="systemitem">root</code>, on the left or the right side:
		</div><pre class="screen">~]# <code class="command">ipsec auto --up mytunnel</code></pre><div class="section" id="Verify_Host-To-Host_VPN_Using_Libreswan"><div class="titlepage"><div><div><h4 class="title">2.7.3.1.&nbsp;Verify Host-To-Host VPN Using Libreswan</h4></div></div></div><div class="para">
				The <code class="systemitem">IKE</code> negotiation takes place on <code class="systemitem">UDP</code> port 500. <code class="systemitem">IPsec</code> packets show up as <code class="systemitem">Encapsulated Security Payload</code> (ESP) packets. When the VPN connection needs to pass through a NAT router, the <code class="systemitem">ESP</code> packets are encapsulated in <code class="systemitem">UDP</code> packets on port 4500.
			</div><div class="para">
				To verify that packets are being sent via the VPN tunnel, issue a command as <code class="systemitem">root</code> in the following format:
			</div><pre class="screen">~]# <code class="command">tcpdump -n -i <em class="replaceable">interface</em> esp or udp port 500 or udp port 4500</code>
00:32:32.632165 IP 192.1.2.45 &gt; 192.1.2.23: ESP(spi=0x63ad7e17,seq=0x1a), length 132
00:32:32.632592 IP 192.1.2.23 &gt; 192.1.2.45: ESP(spi=0x4841b647,seq=0x1a), length 132
00:32:32.632592 IP 192.0.2.254 &gt; 192.0.1.254: ICMP echo reply, id 2489, seq 7, length 64
00:32:33.632221 IP 192.1.2.45 &gt; 192.1.2.23: ESP(spi=0x63ad7e17,seq=0x1b), length 132
00:32:33.632731 IP 192.1.2.23 &gt; 192.1.2.45: ESP(spi=0x4841b647,seq=0x1b), length 132
00:32:33.632731 IP 192.0.2.254 &gt; 192.0.1.254: ICMP echo reply, id 2489, seq 8, length 64
00:32:34.632183 IP 192.1.2.45 &gt; 192.1.2.23: ESP(spi=0x63ad7e17,seq=0x1c), length 132
00:32:34.632607 IP 192.1.2.23 &gt; 192.1.2.45: ESP(spi=0x4841b647,seq=0x1c), length 132
00:32:34.632607 IP 192.0.2.254 &gt; 192.0.1.254: ICMP echo reply, id 2489, seq 9, length 64
00:32:35.632233 IP 192.1.2.45 &gt; 192.1.2.23: ESP(spi=0x63ad7e17,seq=0x1d), length 132
00:32:35.632685 IP 192.1.2.23 &gt; 192.1.2.45: ESP(spi=0x4841b647,seq=0x1d), length 132
00:32:35.632685 IP 192.0.2.254 &gt; 192.0.1.254: ICMP echo reply, id 2489, seq 10, length 64</pre><div class="para">
				Where <em class="replaceable">interface</em> is the interface known to carry the traffic. To end the capture with <span class="application"><strong>tcpdump</strong></span>, press <span class="keycap"><strong>Ctrl</strong></span>+<span class="keycap"><strong>C</strong></span>.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The <span class="application"><strong>tcpdump</strong></span> commands interacts a little unexpectedly with <code class="systemitem">IPsec</code>.
 It only sees the outgoing encrypted packet, not the outgoing plaintext 
packet. It does see the encrypted incoming packet, as well as the 
decrypted incoming packet. If possible, run <span class="application"><strong>tcpdump</strong></span> on a router between the two machines and not on one of the endpoints itself.
				</div></div></div></div></div><div class="section" id="Site-To-Site_VPN_Using_Libreswan"><div class="titlepage"><div><div><h3 class="title">2.7.4.&nbsp;Site-to-Site VPN Using Libreswan</h3></div></div></div><div class="para">
			To create a site-to-site <code class="systemitem">IPsec</code> VPN, joining together two networks, an <code class="systemitem">IPsec</code>
 tunnel is created between two hosts, endpoints, which are configured to
 permit traffic from one or more subnets to pass through. They can 
therefore be thought of as gateways to the remote portion of the 
network. The configuration of the site-to-site VPN only differs from the
 host-to-host VPN in that one or more networks or subnets must be 
specified in the configuration file.
		</div><div class="para">
			To configure <span class="application"><strong>Libreswan</strong></span> to create a site-to-site <code class="systemitem">IPsec</code> VPN, first configure a host-to-host <code class="systemitem">IPsec</code> VPN as described in <a class="xref" href="#sec-Host-To-Host_VPN_Using_Libreswan">Section&nbsp;2.7.3, “Host-To-Host VPN Using Libreswan”</a> and then copy or move the file to a file with a suitable name, such as <code class="filename">/etc/ipsec.d/my_site-to-site.conf</code>. Using an editor running as <code class="systemitem">root</code>, edit the custom configuration file <code class="filename">/etc/ipsec.d/my_site-to-site.conf</code> as follows:
		</div><pre class="screen">conn mysubnet
     also=mytunnel
     leftsubnet=192.0.1.0/24
     rightsubnet=192.0.2.0/24

conn mysubnet6
     also=mytunnel
     connaddrfamily=ipv6
     leftsubnet=2001:db8:0:1::/64
     rightsubnet=2001:db8:0:2::/64

conn mytunnel
    leftid=@west.example.com
    left=192.1.2.23
    leftrsasigkey=0sAQOrlo+hOafUZDlCQmXFrje/oZm [...] W2n417C/4urYHQkCvuIQ==
    rightid=@east.example.com
    right=192.1.2.45
    rightrsasigkey=0sAQO3fwC6nSSGgt64DWiYZzuHbc4 [...] D/v8t5YTQ==
    authby=rsasig</pre><div class="para">
			To bring the tunnels up, restart <span class="application"><strong>Libreswan</strong></span> or manually load and initiate all the connections using the following commands as <code class="systemitem">root</code>:
		</div><pre class="screen">~]# <code class="command">ipsec auto --add mysubnet</code></pre><pre class="screen">~]# <code class="command">ipsec auto --add mysubnet6</code></pre><pre class="screen">~]# <code class="command">ipsec auto --add mytunnel</code></pre><pre class="screen">~]# <code class="command">ipsec auto --up mysubnet</code>
104 "mysubnet" #1: STATE_MAIN_I1: initiate
003 "mysubnet" #1: received Vendor ID payload [Dead Peer Detection]
003 "mytunnel" #1: received Vendor ID payload [FRAGMENTATION]
106 "mysubnet" #1: STATE_MAIN_I2: sent MI2, expecting MR2
108 "mysubnet" #1: STATE_MAIN_I3: sent MI3, expecting MR3
003 "mysubnet" #1: received Vendor ID payload [CAN-IKEv2]
004 "mysubnet" #1: STATE_MAIN_I4: ISAKMP SA established {auth=OAKLEY_RSA_SIG cipher=aes_128 prf=oakley_sha group=modp2048}
117 "mysubnet" #2: STATE_QUICK_I1: initiate
004 "mysubnet" #2: STATE_QUICK_I2: sent QI2, IPsec SA established tunnel mode {ESP=&gt;0x9414a615 &lt;0x1a8eb4ef xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}</pre><pre class="screen">~]# <code class="command">ipsec auto --up mysubnet6</code>
003 "mytunnel" #1: received Vendor ID payload [FRAGMENTATION]
117 "mysubnet" #2: STATE_QUICK_I1: initiate
004 "mysubnet" #2: STATE_QUICK_I2: sent QI2, IPsec SA established tunnel mode {ESP=&gt;0x06fe2099 &lt;0x75eaa862 xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}</pre><pre class="screen">~]# <code class="command">ipsec auto --up mytunnel</code>
104 "mytunnel" #1: STATE_MAIN_I1: initiate
003 "mytunnel" #1: received Vendor ID payload [Dead Peer Detection]
003 "mytunnel" #1: received Vendor ID payload [FRAGMENTATION]
106 "mytunnel" #1: STATE_MAIN_I2: sent MI2, expecting MR2
108 "mytunnel" #1: STATE_MAIN_I3: sent MI3, expecting MR3
003 "mytunnel" #1: received Vendor ID payload [CAN-IKEv2]
004 "mytunnel" #1: STATE_MAIN_I4: ISAKMP SA established {auth=OAKLEY_RSA_SIG cipher=aes_128 prf=oakley_sha group=modp2048}
117 "mytunnel" #2: STATE_QUICK_I1: initiate
004 "mytunnel" #2: STATE_QUICK_I2: sent QI2, IPsec SA established tunnel mode {ESP=&gt;0x16bca4f7 &gt;0x9c2ae273 xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}</pre><div class="section" id="Verify_Site-To-Site_VPN_Using_Libreswan"><div class="titlepage"><div><div><h4 class="title">2.7.4.1.&nbsp;Verify Site-to-Site VPN Using Libreswan</h4></div></div></div><div class="para">
				Verifying that packets are being sent via the VPN tunnel is the same procedure as explained in <a class="xref" href="#Verify_Host-To-Host_VPN_Using_Libreswan">Section&nbsp;2.7.3.1, “Verify Host-To-Host VPN Using Libreswan”</a>.
			</div></div></div><div class="section" id="Site-To-Site_Single_Tunnel_VPN_Using_Libreswan"><div class="titlepage"><div><div><h3 class="title">2.7.5.&nbsp;Site-to-Site Single Tunnel VPN Using Libreswan</h3></div></div></div><div class="para">
			Often, when a site-to-site tunnel is built, the gateways need to communicate with each other using their internal <code class="systemitem">IP</code> addresses instead of their public <code class="systemitem">IP</code> addresses. This can be accomplished using a single tunnel. If the left host, with host name <code class="systemitem">west</code>, has internal <code class="systemitem">IP</code> address <code class="systemitem">192.0.1.254</code> and the right host, with host name <code class="systemitem">east</code>, has internal <code class="systemitem">IP</code> address <code class="systemitem">192.0.2.254</code>, the following configuration using a single tunnel can be used:
		</div><pre class="screen">conn mysubnet
    leftid=@west.example.com
    leftrsasigkey=0sAQOrlo+hOafUZDlCQmXFrje/oZm [...] W2n417C/4urYHQkCvuIQ==
    left=192.1.2.23
    leftsourceip=192.0.1.254
    leftsubnet=192.0.1.0/24
    rightid=@east.example.com
    rightrsasigkey=0sAQO3fwC6nSSGgt64DWiYZzuHbc4 [...] D/v8t5YTQ==
    right=192.1.2.45
    rightsourceip=192.0.2.254
    rightsubnet=192.0.2.0/24
    auto=start
    authby=rsasig</pre></div><div class="section" id="Subnet_Extrusion_Using_Libreswan"><div class="titlepage"><div><div><h3 class="title">2.7.6.&nbsp;Subnet Extrusion Using Libreswan</h3></div></div></div><div class="para">
			<code class="systemitem">IPsec</code> is often deployed in a hub-and-spoke architecture. Each leaf node has an <code class="systemitem">IP</code> range that is part of a larger range. Leaves communicate with each other via the hub. This is called <em class="firstterm">subnet extrusion</em>. In the example below, we configure the head office with <code class="systemitem">10.0.0.0/8</code> and two branches that use a smaller <code class="systemitem">/24</code> subnet.
		</div><div class="para">
			At the head office:
		</div><pre class="screen">conn branch1
    left=1.2.3.4
    leftid=@headoffice
    leftsubnet=0.0.0.0/0
    leftrsasigkey=0sA[...]
    #
    right=5.6.7.8
    rightid=@branch1
    rightsubnet=10.0.1.0/24
    rightrsasigkey=0sAXXXX[...]
    #
    auto=start
    authby=rsasig

conn branch2
    left=1.2.3.4
    leftid=@headoffice
    leftsubnet=0.0.0.0/0
    leftrsasigkey=0sA[...]
    #
    right=10.11.12.13
    rightid=@branch2
    rightsubnet=10.0.2.0/24
    rightrsasigkey=0sAYYYY[...]
    #
    auto=start
    authby=rsasig</pre><div class="para">
			At the <span class="quote">“<span class="quote">branch1</span>”</span>
 office, we use the same connection. Additionally, we use a pass-through
 connection to exclude our local LAN traffic from being sent through the
 tunnel:
		</div><pre class="screen">conn branch1
    left=1.2.3.4
    leftid=@headoffice
    leftsubnet=0.0.0.0/0
    leftrsasigkey=0sA[...]
    #
    right=10.11.12.13
    rightid=@branch2
    rightsubnet=10.0.1.0/24
    rightrsasigkey=0sAYYYY[...]
    #
    auto=start
    authby=rsasig

conn passthrough
    left=1.2.3.4
    right=0.0.0.0
    leftsubnet=10.0.1.0/24
    rightsubnet=10.0.1.0/24
    authby=never
    type=passthrough
    auto=route</pre></div><div class="section" id="Road_Warrior_Application_Using_Libreswan"><div class="titlepage"><div><div><h3 class="title">2.7.7.&nbsp;Road Warrior Access VPN Using Libreswan</h3></div></div></div><div class="para">
			Road Warriors are traveling users with mobile clients with a dynamically assigned <code class="systemitem">IP</code> address, such as laptops. These are authenticated using certificates.
		</div><div class="para">
			On the server:
		</div><pre class="screen">conn roadwarriors
    left=1.2.3.4
    # if access to the LAN is given, enable this
    #leftsubnet=10.10.0.0/16
    leftcert=gw.example.com
    leftid=%fromcert
    right=%any
    # trust our own Certificate Agency
    rightca=%same
    # allow clients to be behind a NAT router
    rightsubnet=vhost:%priv,%no
    authby=rsasig
    # load connection, don't initiate
    auto=add
    # kill vanished roadwarriors
    dpddelay=30
    dpdtimeout=120
    dpdaction=%clear</pre><div class="para">
			On the mobile client, the Road Warrior's device, we need to use a slight variation of the above configuration:
		</div><pre class="screen">conn roadwarriors
    # pick up our dynamic IP
    left=%defaultroute
    leftcert=myname.example.com
    leftid=%fromcert
    # right can also be a DNS hostname
    right=1.2.3.4
    # if access to the remote LAN is required, enable this
    #rightsubnet=10.10.0.0/16
    # trust our own Certificate Agency
    rightca=%same
    authby=rsasig
    # Initiate connection
    auto=start</pre></div><div class="section" id="Road_Warrior_Application_Using_Libreswan_and_XAUTH_with_X.509"><div class="titlepage"><div><div><h3 class="title">2.7.8.&nbsp;Road Warrior Access VPN Using Libreswan and XAUTH with X.509</h3></div></div></div><div class="para">
			<span class="application"><strong>Libreswan</strong></span> offers a method to natively assign <code class="systemitem">IP</code> address and DNS information to roaming VPN clients as the connection is established by using the XAUTH <code class="systemitem">IPsec</code>
 extension. XAUTH can be deployed using PSK or X.509 certificates. 
Deploying using X.509 is more secure. Client certificates can be revoked
 by a certificate revocation list or by <em class="firstterm">Online Certificate Status Protocol</em> (<acronym class="acronym">OCSP</acronym>).
 With X.509 certificates, individual clients cannot impersonate the 
server. With a PSK, also called Group Password, this is theoretically 
possible.
		</div><div class="para">
			XAUTH requires the VPN client to additionally identify itself with a 
user name and password. For One time Passwords (OTP), such as Google 
Authenticator or RSA SecureID tokens, the one-time token is appended to 
the user password.
		</div><div class="para">
			There are three possible backends for XAUTH:
		</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">xauthby=pam</code></span></dt><dd><div class="para">
						This uses the configuration in <code class="filename">/etc/pam.d/pluto</code> to authenticate the user. <span class="application"><strong>Pam</strong></span>
 can be configured to use various backends by itself. It can use the 
system account user-password scheme, an LDAP directory, a RADIUS server 
or a custom password authentication module.
					</div></dd><dt><span class="term"><code class="option">xauthby=file</code></span></dt><dd><div class="para">
						This uses the configuration file <code class="filename">/etc/ipsec.d/passwd</code> (not to be confused with <code class="filename">/etc/ipsec.d/nsspassword</code>). The format of this file is similar to the <span class="application"><strong>Apache</strong></span> <code class="filename">.htpasswd</code> file and the <span class="application"><strong>Apache</strong></span> <code class="command">htpasswd</code>
 command can be used to create entries in this file. However, after the 
user name and password, a third column is required with the connection 
name of the <code class="systemitem">IPsec</code> connection used, for example when using a <code class="literal">conn&nbsp;remoteusers</code> to offer VPN to remove users, a password file entry should look as follows:
					</div><pre class="synopsis">user1:$apr1$MIwQ3DHb$1I69LzTnZhnCT2DPQmAOK.:remoteusers</pre><div class="para">
						NOTE: when using the <code class="command">htpasswd</code> command, the connection name has to be manually added after the <em class="replaceable">user:password</em> part on each line.
					</div></dd><dt><span class="term"><code class="option">xauthby=alwaysok</code></span></dt><dd><div class="para">
						The server will always pretend the XAUTH user and password 
combination was correct. The client still has to specify a user name and
 a password, although the server ignores these. This should only be used
 when users are already identified by X.509 certificates, or when 
testing the VPN without needing an XAUTH backend.
					</div></dd></dl></div><div class="para">
			An example configuration with X.509 certificates:
		</div><pre class="screen">conn xauth-rsa
    auto=add
    authby=rsasig
    pfs=no
    rekey=no
    left=ServerIP
    leftcert=vpn.example.com
    #leftid=%fromcert
    leftid=vpn.example.com
    leftsendcert=always
    leftsubnet=0.0.0.0/0
    rightaddresspool=10.234.123.2-10.234.123.254
    right=%any
    rightrsasigkey=%cert
    modecfgdns1=1.2.3.4
    modecfgdns2=8.8.8.8
    modecfgdomain=example.com
    modecfgbanner="Authorized Access is allowed"
    leftxauthserver=yes
    rightxauthclient=yes
    leftmodecfgserver=yes
    rightmodecfgclient=yes
    modecfgpull=yes
    xauthby=pam
    dpddelay=30
    dpdtimeout=120
    dpdaction=clear
    ike_frag=yes
    # for walled-garden on xauth failure
    # xauthfail=soft
    #leftupdown=/custom/_updown</pre><div class="para">
			When <code class="option">xauthfail</code> is set to soft, instead of
 hard, authentication failures are ignored, and the VPN is setup as if 
the user authenticated properly. A custom updown script can be used to 
check for the environment variable <code class="option">XAUTH_FAILED</code>. Such users can then be redirected, for example, using <span class="application"><strong>iptables</strong></span> DNAT, to a <span class="quote">“<span class="quote">walled garden</span>”</span> where they can contact the administrator or renew a paid subscription to the service.
		</div><div class="para">
			VPN clients use the <code class="option">modecfgdomain</code> value 
and the DNS entries to redirect queries for the specified domain to 
these specified nameservers. This allows roaming users to access 
internal-only resources using the internal DNS names.
		</div><div class="para">
			If <code class="option">leftsubnet</code> is not <code class="systemitem">0.0.0.0/0</code>, split tunneling configuration requests are sent automatically to the client. For example, when using <code class="computeroutput">leftsubnet=10.0.0.0/8</code>, the VPN client would only send traffic for <code class="systemitem">10.0.0.0/8</code> through the VPN.
		</div></div><div class="section" id="sec-Libreswan-additional_resources"><div class="titlepage"><div><div><h3 class="title">2.7.9.&nbsp;Additional Resources</h3></div></div></div><div class="para">
			The following sources of information provide additional resources regarding <span class="application"><strong>Libreswan</strong></span> and the <code class="systemitem">ipsec</code> daemon.
		</div><div class="section" id="sec-Libreswan-docs-inst"><div class="titlepage"><div><div><h4 class="title">2.7.9.1.&nbsp;Installed Documentation</h4></div></div></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="filename">ipsec(8)</code> man page — Describes command options for <code class="systemitem">ipsec</code>.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">ipsec.conf(5)</code> man page — Contains information on configuring <code class="systemitem">ipsec</code>.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">ipsec.secrets(5)</code> man page — Describes the format of the <code class="filename">ipsec.secrets</code> file.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">ipsec_auto(8)</code> man page — Describes the use of the <span class="application"><strong>auto</strong></span> command line client for manipulating <span class="application"><strong>Libreswan</strong></span> <code class="systemitem">IPsec</code> connections established using automatic exchanges of keys.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">ipsec_rsasigkey(8)</code> man page — Describes the tool used to generate RSA signature keys.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">/usr/share/doc/libreswan-<em class="replaceable">version</em>/README.nss</code> — Describes the commands for using raw RSA keys and certificates with the NSS crypto library used with the <span class="application"><strong>Libreswan</strong></span> <code class="systemitem">pluto</code> daemon.
					</div></li></ul></div></div><div class="section" id="sec-Libreswan-docs-Online_Documentation"><div class="titlepage"><div><div><h4 class="title">2.7.9.2.&nbsp;Online Documentation</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><a href="https://libreswan.org/">https://libreswan.org</a></span></dt><dd><div class="para">
							The website of the upstream project.
						</div></dd><dt><span class="term"><a href="http://www.mozilla.org/projects/security/pki/nss/">http://www.mozilla.org/projects/security/pki/nss/</a></span></dt><dd><div class="para">
							Network Security Services (NSS) project.
						</div></dd></dl></div></div></div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Firewalls" lang="en-US"><div class="titlepage"><div><div><h2 class="title">2.8.&nbsp;Firewalls</h2></div></div></div><div class="para">
		Information security is commonly thought of as a process and not a 
product. However, standard security implementations usually employ some 
form of dedicated mechanism to control access privileges and restrict 
network resources to users who are authorized, identifiable, and 
traceable. Red&nbsp;Hat Enterprise&nbsp;Linux includes several tools to 
assist administrators and security engineers with network-level access 
control issues.
	</div><div class="para">
		Firewalls are one of the core components of a network security 
implementation. Several vendors market firewall solutions catering to 
all levels of the marketplace: from home users protecting one PC to data
 center solutions safeguarding vital enterprise information. Firewalls 
can be stand-alone hardware solutions, such as firewall appliances by 
Cisco, Nokia, and Sonicwall. Vendors such as Checkpoint, McAfee, and 
Symantec have also developed proprietary software firewall solutions for
 home and business markets.
	</div><div class="para">
		Apart from the differences between hardware and software firewalls, 
there are also differences in the way firewalls function that separate 
one solution from another. <a class="xref" href="#tabl-Security_Guide-Firewalls-Firewall_Types">Table&nbsp;2.6, “Firewall Types”</a> details three common types of firewalls and how they function:
	</div><div class="table" id="tabl-Security_Guide-Firewalls-Firewall_Types"><p class="title"><strong>Table&nbsp;2.6.&nbsp;Firewall Types</strong></p><div class="table-contents"><table class="gt-4-cols lt-7-rows" summary="Firewall Types"><colgroup><col class="method" width="10%"><!--Empty--><col class="description" width="30%"><!--Empty--><col class="advantages" width="30%"><!--Empty--><col class="disadvantages" width="30%"><!--Empty--></colgroup><thead><tr><th id="idm140226855507440" scope="col"> Method </th><th id="idm140226862205408" scope="col"> Description </th><th id="idm140226862204928" scope="col"> Advantages </th><th id="idm140226862204448" scope="col"> Disadvantages </th></tr></thead><tbody><tr><td headers="idm140226855507440"> NAT </td><td headers="idm140226862205408"> <em class="firstterm">Network Address Translation</em>
 (NAT) places private IP subnetworks behind one or a small pool of 
public IP addresses, masquerading all requests to one source rather than
 several. The Linux kernel has built-in NAT functionality through the 
Netfilter kernel subsystem. </td><td headers="idm140226862204928"> <div class="para">
						Can be configured transparently to machines on a LAN.
					</div>
					 <div class="para">
						Protection of many machines and services behind one or more external IP addresses simplifies administration duties.
					</div>
					 <div class="para">
						Restriction of user access to and from the LAN can be configured by opening and closing ports on the NAT firewall/gateway.
					</div>
					 </td><td headers="idm140226862204448"> <div class="para">
						Cannot prevent malicious activity once users connect to a service outside of the firewall.
					</div>
					 </td></tr><tr><td headers="idm140226855507440"> Packet Filter </td><td headers="idm140226862205408">
 A packet filtering firewall reads each data packet that passes through a
 LAN. It can read and process packets by header information and filters 
the packet based on sets of programmable rules implemented by the 
firewall administrator. The Linux kernel has built-in packet filtering 
functionality through the Netfilter kernel subsystem. </td><td headers="idm140226862204928"> <div class="para">
						Customizable through the <code class="command">iptables</code> front-end utility.
					</div>
					 <div class="para">
						Does not require any customization on the client side, as all 
network activity is filtered at the router level rather than the 
application level.
					</div>
					 <div class="para">
						Since packets are not transmitted through a proxy, network 
performance is faster due to direct connection from client to remote 
host.
					</div>
					 </td><td headers="idm140226862204448"> <div class="para">
						Cannot filter packets for content like proxy firewalls.
					</div>
					 <div class="para">
						Processes packets at the protocol layer, but cannot filter packets at an application layer.
					</div>
					 <div class="para">
						Complex network architectures can make establishing packet filtering rules difficult, especially if coupled with <em class="firstterm">IP masquerading</em> or local subnets and DMZ networks.
					</div>
					 </td></tr><tr><td headers="idm140226855507440"> Proxy </td><td headers="idm140226862205408">
 Proxy firewalls filter all requests of a certain protocol or type from 
LAN clients to a proxy machine, which then makes those requests to the 
Internet on behalf of the local client. A proxy machine acts as a buffer
 between malicious remote users and the internal network client 
machines. </td><td headers="idm140226862204928"> <div class="para">
						Gives administrators control over what applications and protocols function outside of the LAN.
					</div>
					 <div class="para">
						Some proxy servers can cache frequently-accessed data locally 
rather than having to use the Internet connection to request it. This 
helps to reduce bandwidth consumption.
					</div>
					 <div class="para">
						Proxy services can be logged and monitored closely, allowing tighter control over resource utilization on the network.
					</div>
					 </td><td headers="idm140226862204448"> <div class="para">
						Proxies are often application-specific (HTTP, Telnet, etc.), or 
protocol-restricted (most proxies work with TCP-connected services 
only).
					</div>
					 <div class="para">
						Application services cannot run behind a proxy, so your application servers must use a separate form of network security.
					</div>
					 <div class="para">
						Proxies can become a network bottleneck, as all requests and 
transmissions are passed through one source rather than directly from a 
client to a remote service.
					</div>
					 </td></tr></tbody></table></div></div><div class="section" id="sect-Security_Guide-Firewalls-Netfilter_and_IPTables"><div class="titlepage"><div><div><h3 class="title">2.8.1.&nbsp;Netfilter and IPTables</h3></div></div></div><div class="para">
			The Linux kernel features a powerful networking subsystem called <em class="firstterm">Netfilter</em>.
 The Netfilter subsystem provides stateful or stateless packet filtering
 as well as NAT and IP masquerading services. Netfilter also has the 
ability to <em class="firstterm">mangle</em> IP header information for advanced routing and connection state management. Netfilter is controlled using the <code class="command">iptables</code> tool.
		</div><div class="section" id="sect-Security_Guide-Netfilter_and_IPTables-IPTables_Overview"><div class="titlepage"><div><div><h4 class="title">2.8.1.1.&nbsp;IPTables Overview</h4></div></div></div><div class="para">
				The power and flexibility of Netfilter is implemented using the <code class="command">iptables</code> administration tool, a command line tool similar in syntax to its predecessor, <code class="command">ipchains</code>, which Netfilter/iptables replaced in the Linux kernel 2.4 and above.
			</div><div class="para">
				<code class="command">iptables</code> uses the Netfilter subsystem to enhance network connection, inspection, and processing. <code class="command">iptables</code>
 features advanced logging, pre- and post-routing actions, network 
address translation, and port forwarding, all in one command line 
interface.
			</div><div class="para">
				This section provides an overview of <code class="command">iptables</code>. For more detailed information, see <a class="xref" href="#sect-Security_Guide-IPTables">Section&nbsp;2.8.9, “IPTables”</a>.
			</div></div></div><div class="section" id="sect-Security_Guide-Firewalls-Basic_Firewall_Configuration"><div class="titlepage"><div><div><h3 class="title">2.8.2.&nbsp;Basic Firewall Configuration</h3></div></div></div><div class="para">
			Just as a firewall in a building attempts to prevent a fire from 
spreading, a computer firewall attempts to prevent malicious software 
from spreading to your computer. It also helps to prevent unauthorized 
users from accessing your computer.
		</div><div class="para">
			In a default Red&nbsp;Hat Enterprise&nbsp;Linux installation, a 
firewall exists between your computer or network and any untrusted 
networks, for example the Internet. It determines which services on your
 computer remote users can access. A properly configured firewall can 
greatly increase the security of your system. It is recommended that you
 configure a firewall for any Red&nbsp;Hat Enterprise&nbsp;Linux system 
with an Internet connection.
		</div><div class="section" id="sect-Security_Guide-Basic_Firewall_Configuration-RHSECLEVELTOOL"><div class="titlepage"><div><div><h4 class="title">2.8.2.1.&nbsp;<span class="application"><strong>Firewall Configuration Tool</strong></span></h4></div></div></div><div class="para">
				During the <span class="guilabel"><strong>Firewall Configuration</strong></span>
 screen of the Red&nbsp;Hat Enterprise&nbsp;Linux installation, you were
 given the option to enable a basic firewall as well as to allow 
specific devices, incoming services, and ports.
			</div><div class="para">
				After installation, you can change this preference by using the <span class="application"><strong>Firewall Configuration Tool</strong></span>.
			</div><div class="para">
				To start this application, either select <span class="guimenu"><strong>System</strong></span> → <span class="guisubmenu"><strong>Administration</strong></span> → <span class="guimenuitem"><strong>Firewall</strong></span> from the panel, or type <code class="command">system-config-firewall</code> at a shell prompt.
			</div><div class="figure" id="figu-Security_Guide-RHSECLEVELTOOL-RHSECLEVELTOOL"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/fed-firewall_config.png" alt="Firewall Configuration Tool"></div></div><p class="title"><strong>Figure&nbsp;2.5.&nbsp;<span class="application">Firewall Configuration Tool</span></strong></p></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The <span class="application"><strong>Firewall Configuration Tool</strong></span> only configures a basic firewall. If the system needs more complex rules, see <a class="xref" href="#sect-Security_Guide-IPTables">Section&nbsp;2.8.9, “IPTables”</a> for details on configuring specific <code class="command">iptables</code> rules.
				</div><div class="para">
					As of <span class="application"><strong>Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.5</strong></span>, the <code class="systemitem">iptables</code> and <code class="systemitem">ip6tables</code>
 services now provide the ability to assign a fallback firewall 
configuration if the default configuration cannot be applied. If 
application of the firewall rules from <code class="filename">/etc/sysconfig/iptables</code> fails, the fallback file is applied if it exists. The fallback file is named <code class="filename">/etc/sysconfig/iptables.fallback</code> and uses the same file format as <code class="filename">/etc/sysconfig/iptables</code>.
 If application of the fallback file also fails, there is no further 
fallback. To create a fallback file, use the standard firewall 
configuration tool and rename or copy the file to the fallback file.
				</div><div class="para">
					For the <code class="systemitem">ip6tables</code> service, replace all occurrences of <code class="literal">iptables</code> with <code class="literal">ip6tables</code> in the above examples.
				</div></div></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
					If you have previously set up some custom packet-filtering rules by directly using the <code class="systemitem">iptables</code> utility (as described in <a class="xref" href="#sect-Security_Guide-IPTables">Section&nbsp;2.8.9, “IPTables”</a>), running the <code class="systemitem">system-config-firewall</code> utility will erase these custom rules immediately.
				</div></div></div></div><div class="section" id="sect-Security_Guide-Basic_Firewall_Configuration-Enabling_and_Disabling_the_Firewall"><div class="titlepage"><div><div><h4 class="title">2.8.2.2.&nbsp;Enabling and Disabling the Firewall</h4></div></div></div><div class="para">
				Select one of the following options for the firewall:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<span class="guilabel"><strong>Disabled</strong></span> — 
Disabling the firewall provides complete access to your system and does 
no security checking. This should only be selected if you are running on
 a trusted network (not the Internet) or need to configure a custom 
firewall using the <code class="command">iptables</code> command line tool.
					</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
							Firewall configurations and any customized firewall rules are stored in the <code class="filename">/etc/sysconfig/iptables</code> file. If you choose <span class="guilabel"><strong>Disabled</strong></span> and click <span class="guibutton"><strong>OK</strong></span>, these configurations and firewall rules will be lost.
						</div></div></div></li><li class="listitem"><div class="para">
						<span class="guilabel"><strong>Enabled</strong></span> — This 
option configures the system to reject incoming connections that are not
 in response to outbound requests, such as DNS replies or DHCP requests.
 If access to services running on this machine is needed, you can choose
 to allow specific services through the firewall.
					</div><div class="para">
						If you are connecting your system to the Internet, but do not plan to run a server, this is the safest choice.
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Basic_Firewall_Configuration-Trusted_Services"><div class="titlepage"><div><div><h4 class="title">2.8.2.3.&nbsp;Trusted Services</h4></div></div></div><div class="para">
				Enabling options in the <span class="guilabel"><strong>Trusted services</strong></span> list allows the specified service to pass through the firewall.
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="guilabel"><strong>WWW (HTTP)</strong></span></span></dt><dd><div class="para">
							The HTTP protocol is used by Apache (and by other Web servers) to
 serve web pages. If you plan on making your Web server publicly 
available, select this check box. This option is not required for 
viewing pages locally or for developing web pages. This service requires
 that the <code class="filename">httpd</code> package be installed.
						</div><div class="para">
							Enabling <span class="guilabel"><strong>WWW (HTTP)</strong></span> will not open a port for HTTPS, the SSL version of HTTP. If this service is required, select the <span class="guilabel"><strong>Secure WWW (HTTPS)</strong></span> check box.
						</div></dd><dt><span class="term"><span class="guilabel"><strong>FTP</strong></span></span></dt><dd><div class="para">
							The FTP protocol is used to transfer files between machines on a 
network. If you plan on making your FTP server publicly available, 
select this check box. This service requires that the <code class="filename">vsftpd</code> package be installed.
						</div></dd><dt><span class="term"><span class="guilabel"><strong>SSH</strong></span></span></dt><dd><div class="para">
							Secure Shell (SSH) is a suite of tools for logging into and 
executing commands on a remote machine. To allow remote access to the 
machine via SSH, select this check box. This service requires that the <code class="filename">openssh-server</code> package be installed.
						</div></dd><dt><span class="term"><span class="guilabel"><strong>Telnet</strong></span></span></dt><dd><div class="para">
							Telnet is a protocol for logging into remote machines. Telnet 
communications are unencrypted and provide no security from network 
snooping. Allowing incoming Telnet access is not recommended. To allow 
remote access to the machine via telnet, select this check box. This 
service requires that the <code class="filename">telnet-server</code> package be installed.
						</div></dd><dt><span class="term"><span class="guilabel"><strong>Mail (SMTP)</strong></span></span></dt><dd><div class="para">
							SMTP is a protocol that allows remote hosts to connect directly 
to your machine to deliver mail. You do not need to enable this service 
if you collect your mail from your ISP's server using POP3 or IMAP, or 
if you use a tool such as <code class="command">fetchmail</code>. To 
allow delivery of mail to your machine, select this check box. Note that
 an improperly configured SMTP server can allow remote machines to use 
your server to send spam.
						</div></dd><dt><span class="term"><span class="guilabel"><strong>NFS4</strong></span></span></dt><dd><div class="para">
							The Network File System (NFS) is a file sharing protocol commonly
 used on *NIX systems. Version 4 of this protocol is more secure than 
its predecessors. If you want to share files or directories on your 
system with other network users, select this check box.
						</div></dd><dt><span class="term"><span class="guilabel"><strong>Samba</strong></span></span></dt><dd><div class="para">
							Samba is an implementation of Microsoft's proprietary SMB 
networking protocol. If you need to share files, directories, or 
locally-connected printers with Microsoft Windows machines, select this 
check box.
						</div></dd></dl></div></div><div class="section" id="sect-Security_Guide-Basic_Firewall_Configuration-Other_Ports"><div class="titlepage"><div><div><h4 class="title">2.8.2.4.&nbsp;Other Ports</h4></div></div></div><div class="para">
				The <span class="application"><strong>Firewall Configuration Tool</strong></span> includes an <span class="guilabel"><strong>Other ports</strong></span> section for specifying custom IP ports as being trusted by <code class="command">iptables</code>. For example, to allow IRC and Internet printing protocol (IPP) to pass through the firewall, add the following to the <span class="guilabel"><strong>Other ports</strong></span> section:
			</div><div class="para">
				<code class="computeroutput">194:tcp,631:tcp</code>
			</div></div><div class="section" id="sect-Security_Guide-Basic_Firewall_Configuration-Saving_the_Settings"><div class="titlepage"><div><div><h4 class="title">2.8.2.5.&nbsp;Saving the Settings</h4></div></div></div><div class="para">
				Click <span class="guibutton"><strong>OK</strong></span> to save the changes and enable or disable the firewall. If <span class="guilabel"><strong>Enable firewall</strong></span> was selected, the options selected are translated to <code class="command">iptables</code> commands and written to the <code class="filename">/etc/sysconfig/iptables</code> file. The <code class="command">iptables</code> service is also started so that the firewall is activated immediately after saving the selected options. If <span class="guilabel"><strong>Disable firewall</strong></span> was selected, the <code class="filename">/etc/sysconfig/iptables</code> file is removed and the <code class="command">iptables</code> service is stopped immediately.
			</div><div class="para">
				The selected options are also written to the <code class="filename">/etc/sysconfig/system-config-firewall</code> file so that the settings can be restored the next time the application is started. Do not edit this file manually.
			</div><div class="para">
				Even though the firewall is activated immediately, the <code class="command">iptables</code> service is not configured to start automatically at boot time. Refer to <a class="xref" href="#sect-Security_Guide-Basic_Firewall_Configuration-Activating_the_IPTables_Service">Section&nbsp;2.8.2.6, “Activating the IPTables Service”</a> for more information.
			</div></div><div class="section" id="sect-Security_Guide-Basic_Firewall_Configuration-Activating_the_IPTables_Service"><div class="titlepage"><div><div><h4 class="title">2.8.2.6.&nbsp;Activating the IPTables Service</h4></div></div></div><div class="para">
				The firewall rules are only active if the <code class="command">iptables</code> service is running. To manually start the service, use the following command as the root user:
			</div><pre class="screen">~]# <code class="command">service iptables restart</code>
iptables: Applying firewall rules:                         [  OK  ]</pre><div class="para">
				To ensure that <code class="command">iptables</code> starts when the system is booted, use the following command:
			</div><pre class="screen">~]# <code class="command">chkconfig --level 345 iptables on</code></pre></div></div><div class="section" id="sect-Security_Guide-Firewalls-Using_IPTables"><div class="titlepage"><div><div><h3 class="title">2.8.3.&nbsp;Using IPTables</h3></div></div></div><div class="para">
			The first step in using <code class="command">iptables</code> is to start the <code class="command">iptables</code> service. Use the following command as the root user to start the <code class="command">iptables</code> service:
		</div><pre class="screen">~]# <code class="command">service iptables restart</code>
iptables: Applying firewall rules:                         [  OK  ]</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				The <code class="command">ip6tables</code> service can be turned off if you intend to use the <code class="command">iptables</code> service only. If you deactivate the <code class="command">ip6tables</code> service, remember to deactivate the IPv6 network also. Never leave a network device active without the matching firewall.
			</div></div></div><div class="para">
			To force <code class="command">iptables</code> to start by default when the system is booted, use the following command as the root user:
		</div><pre class="screen">~]# <code class="command">chkconfig --level 345 iptables on</code></pre><div class="para">
			This forces <code class="command">iptables</code> to start whenever the system is booted into runlevel 3, 4, or 5.
		</div><div class="section" id="sect-Security_Guide-Using_IPTables-IPTables_Command_Syntax"><div class="titlepage"><div><div><h4 class="title">2.8.3.1.&nbsp;IPTables Command Syntax</h4></div></div></div><div class="para">
				The following sample <code class="command">iptables</code> command illustrates the basic command syntax:
			</div><pre class="synopsis"><code class="command">iptables</code> <code class="option">-A</code> <em class="replaceable">&lt;chain&gt;</em> <code class="option">-j</code> <em class="replaceable">&lt;target&gt;</em></pre><div class="para">
				The <code class="option">-A</code> option specifies that the rule be appended to <em class="firstterm">&lt;chain&gt;</em>. Each chain is comprised of one or more <em class="firstterm">rules</em>, and is therefore also known as a <em class="firstterm">ruleset</em>.
			</div><div class="para">
				The three built-in chains are INPUT, OUTPUT, and FORWARD. These 
chains are permanent and cannot be deleted. The chain specifies the 
point at which a packet is manipulated.
			</div><div class="para">
				The <code class="option">-j <em class="replaceable">&lt;target&gt;</em></code>
 option specifies the target of the rule; i.e., what to do if the packet
 matches the rule. Examples of built-in targets are ACCEPT, DROP, and 
REJECT.
			</div><div class="para">
				Refer to the <code class="command">iptables</code> man page for more information on the available chains, options, and targets.
			</div></div><div class="section" id="sect-Security_Guide-Using_IPTables-Basic_Firewall_Policies"><div class="titlepage"><div><div><h4 class="title">2.8.3.2.&nbsp;Basic Firewall Policies</h4></div></div></div><div class="para">
				Establishing basic firewall policies creates a foundation for building more detailed, user-defined rules.
			</div><div class="para">
				Each <code class="command">iptables</code> chain is comprised of a 
default policy, and zero or more rules which work in concert with the 
default policy to define the overall ruleset for the firewall.
			</div><div class="para">
				The default policy for a chain can be either DROP or ACCEPT. 
Security-minded administrators typically implement a default policy of 
DROP, and only allow specific packets on a case-by-case basis. For 
example, the following policies block all incoming and outgoing packets 
on a network gateway:
			</div><pre class="screen">~]# <code class="command">iptables -P INPUT DROP</code>
~]# <code class="command">iptables -P OUTPUT DROP</code></pre><div class="para">
				It is also recommended that any <em class="firstterm">forwarded packets</em>
 — network traffic that is to be routed from the firewall to its 
destination node — be denied as well, to restrict internal clients from 
inadvertent exposure to the Internet. To do this, use the following 
rule:
			</div><pre class="screen">~]# <code class="command">iptables -P FORWARD DROP</code></pre><div class="para">
				When you have established the default policies for each chain, you 
can create and save further rules for your particular network and 
security requirements.
			</div><div class="para">
				The following sections describe how to save <code class="command">iptables</code> rules and outline some of the rules you might implement in the course of building your <code class="command">iptables</code> firewall.
			</div></div><div class="section" id="sect-Security_Guide-Using_IPTables-Saving_and_Restoring_IPTables_Rules"><div class="titlepage"><div><div><h4 class="title">2.8.3.3.&nbsp;Saving and Restoring IPTables Rules</h4></div></div></div><div class="para">
				Changes to <code class="command">iptables</code> are transitory; if the system is rebooted or if the <code class="command">iptables</code> service is restarted, the rules are automatically flushed and reset. To save the rules so that they are loaded when the <code class="command">iptables</code> service is started, use the following command as the root user:
			</div><pre class="screen">~]# <code class="command">service iptables save</code>
iptables: Saving firewall rules to /etc/sysconfig/iptables:[  OK  ]</pre><div class="para">
				The rules are stored in the file <code class="filename">/etc/sysconfig/iptables</code> and are applied whenever the service is started or the machine is rebooted.
			</div></div></div><div class="section" id="sect-Security_Guide-Firewalls-Common_IPTables_Filtering"><div class="titlepage"><div><div><h3 class="title">2.8.4.&nbsp;Common IPTables Filtering</h3></div></div></div><div class="para">
			Preventing remote attackers from accessing a LAN is one of the most 
important aspects of network security. The integrity of a LAN should be 
protected from malicious remote users through the use of stringent 
firewall rules.
		</div><div class="para">
			However, with a default policy set to block all incoming, outgoing, 
and forwarded packets, it is impossible for the firewall/gateway and 
internal LAN users to communicate with each other or with external 
resources.
		</div><div class="para">
			To allow users to perform network-related functions and to use 
networking applications, administrators must open certain ports for 
communication.
		</div><div class="para">
			For example, to allow access to port 80 <span class="emphasis"><em>on the firewall</em></span>, append the following rule:
		</div><pre class="screen">~]# <code class="command">iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT</code></pre><div class="para">
			This allows users to browse websites that communicate using the 
standard port 80. To allow access to secure websites (for example, 
https://www.example.com/), you also need to provide access to port 443, 
as follows:
		</div><pre class="screen">~]# <code class="command">iptables -A INPUT -p tcp -m tcp --dport 443 -j ACCEPT</code></pre><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				When creating an <code class="command">iptables</code> ruleset, order is important.
			</div><div class="para">
				If a rule specifies that any packets from the 192.168.100.0/24 
subnet be dropped, and this is followed by a rule that allows packets 
from 192.168.100.13 (which is within the dropped subnet), then the 
second rule is ignored.
			</div><div class="para">
				The rule to allow packets from 192.168.100.13 must precede the rule that drops the remainder of the subnet.
			</div><div class="para">
				To insert a rule in a specific location in an existing chain, use the <code class="option">-I</code> option. For example:
			</div><pre class="screen">~]# <code class="command">iptables -I INPUT 1 -i lo -p all -j ACCEPT</code></pre><div class="para">
				This rule is inserted as the first rule in the INPUT chain to allow local loopback device traffic.
			</div></div></div><div class="para">
			There may be times when you require remote access to the LAN. Secure 
services, for example SSH, can be used for encrypted remote connection 
to LAN services.
		</div><div class="para">
			Administrators with PPP-based resources (such as modem banks or bulk 
ISP accounts), dial-up access can be used to securely circumvent 
firewall barriers. Because they are direct connections, modem 
connections are typically behind a firewall/gateway.
		</div><div class="para">
			For remote users with broadband connections, however, special cases can be made. You can configure <code class="command">iptables</code> to accept connections from remote SSH clients. For example, the following rules allow remote SSH access:
		</div><pre class="screen">~]# <code class="command">iptables -A INPUT -p tcp --dport 22 -j ACCEPT</code>
~]# <code class="command">iptables -A OUTPUT -p tcp --sport 22 -j ACCEPT</code></pre><div class="para">
			These rules allow incoming and outbound access for an individual 
system, such as a single PC directly connected to the Internet or a 
firewall/gateway. However, they do not allow nodes behind the 
firewall/gateway to access these services. To allow LAN access to these 
services, you can use <em class="firstterm">Network Address Translation</em> (<acronym class="acronym">NAT</acronym>) with <code class="command">iptables</code> filtering rules.
		</div></div><div class="section" id="sect-Security_Guide-Firewalls-FORWARD_and_NAT_Rules"><div class="titlepage"><div><div><h3 class="title">2.8.5.&nbsp;<code class="computeroutput">FORWARD</code> and <acronym class="acronym">NAT</acronym> Rules</h3></div></div></div><div class="para">
			Most ISPs provide only a limited number of publicly routable IP addresses to the organizations they serve.
		</div><div class="para">
			Administrators must, therefore, find alternative ways to share access
 to Internet services without giving public IP addresses to every node 
on the LAN. Using private IP addresses is the most common way of 
allowing all nodes on a LAN to properly access internal and external 
network services.
		</div><div class="para">
			Edge routers (such as firewalls) can receive incoming transmissions 
from the Internet and route the packets to the intended LAN node. At the
 same time, firewalls/gateways can also route outgoing requests from a 
LAN node to the remote Internet service.
		</div><div class="para">
			This forwarding of network traffic can become dangerous at times, 
especially with the availability of modern cracking tools that can spoof
 <span class="emphasis"><em>internal</em></span> IP addresses and make the remote attacker's machine act as a node on your LAN.
		</div><div class="para">
			To prevent this, <code class="command">iptables</code> provides routing and forwarding policies that can be implemented to prevent abnormal usage of network resources.
		</div><div class="para">
			The <code class="computeroutput">FORWARD</code> chain allows an 
administrator to control where packets can be routed within a LAN. For 
example, to allow forwarding for the entire LAN (assuming the 
firewall/gateway is assigned an internal IP address on eth1), use the 
following rules:
		</div><pre class="screen">~]# <code class="command">iptables -A FORWARD -i eth1 -j ACCEPT</code>
~]# <code class="command">iptables -A FORWARD -o eth1 -j ACCEPT</code></pre><div class="para">
			This rule gives systems behind the firewall/gateway access to the 
internal network. The gateway routes packets from one LAN node to its 
intended destination node, passing all packets through its <code class="filename">eth1</code> device.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				By default, the IPv4 policy in Red&nbsp;Hat Enterprise&nbsp;Linux 
kernels disables support for IP forwarding. This prevents machines that 
run Red&nbsp;Hat Enterprise&nbsp;Linux from functioning as dedicated 
edge routers. To enable IP forwarding, use the following command as the 
root user:
			</div><pre class="screen">~]# <code class="command">sysctl -w net.ipv4.ip_forward=1</code>
net.ipv4.ip_forward = 1</pre><div class="para">
				This configuration change is only valid for the current session; it 
does not persist beyond a reboot or network service restart. To 
permanently set IP forwarding, edit the <code class="filename">/etc/sysctl.conf</code> file as follows:
			</div><div class="para">
				Locate the following line:
			</div><pre class="programlisting">net.ipv4.ip_forward = 0</pre><div class="para">
				Edit it to read as follows:
			</div><pre class="programlisting">net.ipv4.ip_forward = 1</pre><div class="para">
				As the root user, run the following command to enable the change to the <code class="filename">sysctl.conf</code> file:
			</div><pre class="screen">~]# <code class="command">sysctl -p /etc/sysctl.conf</code>
net.ipv4.ip_forward = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.default.accept_source_route = 0
<em class="lineannotation"><span class="lineannotation">[output truncated]</span></em></pre></div></div><div class="section" id="sect-Security_Guide-FORWARD_and_NAT_Rules-Postrouting_and_IP_Masquerading"><div class="titlepage"><div><div><h4 class="title">2.8.5.1.&nbsp;Postrouting and IP Masquerading</h4></div></div></div><div class="para">
				Accepting forwarded packets via the firewall's internal IP device 
allows LAN nodes to communicate with each other; however they still 
cannot communicate externally to the Internet.
			</div><div class="para">
				To allow LAN nodes with private IP addresses to communicate with external public networks, configure the firewall for <em class="firstterm">IP masquerading</em>, which masks requests from LAN nodes with the IP address of the firewall's external device (in this case, eth0):
			</div><pre class="screen">~]# <code class="command">iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</code></pre><div class="para">
				This rule uses the NAT packet matching table (<code class="option">-t nat</code>) and specifies the built-in POSTROUTING chain for NAT (<code class="option">-A POSTROUTING</code>) on the firewall's external networking device (<code class="option">-o eth0</code>).
			</div><div class="para">
				POSTROUTING allows packets to be altered as they are leaving the firewall's external device.
			</div><div class="para">
				The <code class="option">-j MASQUERADE</code> target is specified to mask the private IP address of a node with the external IP address of the firewall/gateway.
			</div></div><div class="section" id="sect-Security_Guide-FORWARD_and_NAT_Rules-Prerouting"><div class="titlepage"><div><div><h4 class="title">2.8.5.2.&nbsp;Prerouting</h4></div></div></div><div class="para">
				If you have a server on your internal network that you want make available externally, you can use the <code class="option">-j DNAT</code>
 target of the PREROUTING chain in NAT to specify a destination IP 
address and port where incoming packets requesting a connection to your 
internal service can be forwarded.
			</div><div class="para">
				For example, if you want to forward incoming HTTP requests to your 
dedicated Apache HTTP Server at 172.31.0.23, use the following command 
as the root user:
			</div><pre class="screen">~]# <code class="command">iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT --to 172.31.0.23:80</code></pre><div class="para">
				This rule specifies that the <acronym class="acronym">NAT</acronym> 
table use the built-in PREROUTING chain to forward incoming HTTP 
requests exclusively to the listed destination IP address of 
172.31.0.23.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					If you have a default policy of DROP in your FORWARD chain, you 
must append a rule to forward all incoming HTTP requests so that 
destination NAT routing is possible. To do this, use the following 
command as the root user:
				</div><pre class="screen">~]# <code class="command">iptables -A FORWARD -i eth0 -p tcp --dport 80 -d 172.31.0.23 -j ACCEPT</code></pre><div class="para">
					This rule forwards all incoming HTTP requests from the firewall to 
the intended destination; the Apache HTTP Server behind the firewall.
				</div></div></div></div><div class="section" id="sect-Security_Guide-FORWARD_and_NAT_Rules-DMZs_and_IPTables"><div class="titlepage"><div><div><h4 class="title">2.8.5.3.&nbsp;DMZs and IPTables</h4></div></div></div><div class="para">
				You can create <code class="command">iptables</code> rules to route traffic to certain machines, such as a dedicated HTTP or FTP server, in a <em class="firstterm">demilitarized zone</em> (<acronym class="acronym">DMZ</acronym>). A <acronym class="acronym">DMZ</acronym> is a special local subnetwork dedicated to providing services on a public carrier, such as the Internet.
			</div><div class="para">
				For example, to set a rule for routing incoming HTTP requests to a 
dedicated HTTP server at 10.0.4.2 (outside of the 192.168.1.0/24 range 
of the LAN), NAT uses the <code class="computeroutput">PREROUTING</code> table to forward the packets to the appropriate destination:
			</div><pre class="screen">~]# <code class="command">iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j DNAT \</code>
  <code class="command">--to-destination 10.0.4.2:80</code></pre><div class="para">
				With this command, all HTTP connections to port 80 from outside of 
the LAN are routed to the HTTP server on a network separate from the 
rest of the internal network. This form of network segmentation can 
prove safer than allowing HTTP connections to a machine on the network.
			</div><div class="para">
				If the HTTP server is configured to accept secure connections, then port 443 must be forwarded as well.
			</div></div></div><div class="section" id="sect-Security_Guide-Firewalls-Malicious_Software_and_Spoofed_IP_Addresses"><div class="titlepage"><div><div><h3 class="title">2.8.6.&nbsp;Malicious Software and Spoofed IP Addresses</h3></div></div></div><div class="para">
			More elaborate rules can be created that control access to specific 
subnets, or even specific nodes, within a LAN. You can also restrict 
certain dubious applications or programs such as Trojans, worms, and 
other client/server viruses from contacting their server.
		</div><div class="para">
			For example, some Trojans scan networks for services on ports from 31337 to 31340 (called the <span class="emphasis"><em>elite</em></span> ports in cracking terminology).
		</div><div class="para">
			Since there are no legitimate services that communicate via these 
non-standard ports, blocking them can effectively diminish the chances 
that potentially infected nodes on your network independently 
communicate with their remote master servers.
		</div><div class="para">
			The following rules drop all TCP traffic that attempts to use port 31337:
		</div><pre class="screen">~]# <code class="command">iptables -A OUTPUT -o eth0 -p tcp --dport 31337 --sport 31337 -j DROP</code>
~]# <code class="command">iptables -A FORWARD -o eth0 -p tcp --dport 31337 --sport 31337 -j DROP</code></pre><div class="para">
			You can also block outside connections that attempt to spoof private IP address ranges to infiltrate your LAN.
		</div><div class="para">
			For example, if your LAN uses the 192.168.1.0/24 range, you can 
design a rule that instructs the Internet-facing network device (for 
example, eth0) to drop any packets to that device with an address in 
your LAN IP range.
		</div><div class="para">
			Because it is recommended to reject forwarded packets as a default 
policy, any other spoofed IP address to the external-facing device 
(eth0) is rejected automatically.
		</div><pre class="screen">~]# <code class="command">iptables -A FORWARD -s 192.168.1.0/24 -i eth0 -j DROP</code></pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				There is a distinction between the <code class="computeroutput">DROP</code> and <code class="computeroutput">REJECT</code> targets when dealing with <span class="emphasis"><em>appended</em></span> rules.
			</div><div class="para">
				The <code class="computeroutput">REJECT</code> target denies access and returns a <code class="computeroutput">connection refused</code> error to users who attempt to connect to the service. The <code class="computeroutput">DROP</code> target, as the name implies, drops the packet without any warning.
			</div><div class="para">
				Administrators can use their own discretion when using these targets. 
			</div></div></div></div><div class="section" id="sect-Security_Guide-Firewalls-IPTables_and_Connection_Tracking"><div class="titlepage"><div><div><h3 class="title">2.8.7.&nbsp;IPTables and Connection Tracking</h3></div></div></div><div class="para">
			You can inspect and restrict connections to services based on their <em class="firstterm">connection state.</em> A module within <code class="command">iptables</code> uses a method called <em class="firstterm">connection tracking</em> to store information about incoming connections. You can allow or deny access based on the following connection states:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="option">NEW</code> — A packet requesting a new connection, such as an HTTP request.
				</div></li><li class="listitem"><div class="para">
					<code class="option">ESTABLISHED</code> — A packet that is part of an existing connection.
				</div></li><li class="listitem"><div class="para">
					<code class="option">RELATED</code> — A packet that is requesting a
 new connection but is part of an existing connection. For example, FTP 
uses port 21 to establish a connection, but data is transferred on a 
different port (typically port 20).
				</div></li><li class="listitem"><div class="para">
					<code class="option">INVALID</code> — A packet that is not part of any connections in the connection tracking table.
				</div></li></ul></div><div class="para">
			You can use the stateful functionality of <code class="command">iptables</code>
 connection tracking with any network protocol, even if the protocol 
itself is stateless (such as UDP). The following example shows a rule 
that uses connection tracking to forward only the packets that are 
associated with an established connection:
		</div><pre class="screen">~]# <code class="command">iptables -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT</code></pre></div><div class="section" id="sect-Security_Guide-Firewalls-IPv6"><div class="titlepage"><div><div><h3 class="title">2.8.8.&nbsp;IPv6</h3></div></div></div><div class="para">
			The introduction of the next-generation Internet Protocol, called 
IPv6, expands beyond the 32-bit address limit of IPv4 (or IP). IPv6 
supports 128-bit addresses, and carrier networks that are IPv6 aware are
 therefore able to address a larger number of routable addresses than 
IPv4.
		</div><div class="para">
			Red&nbsp;Hat Enterprise&nbsp;Linux supports IPv6 firewall rules using the Netfilter 6 subsystem and the <code class="command">ip6tables</code> command. In Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6, both IPv4 and IPv6 services are enabled by default.
		</div><div class="para">
			The <code class="command">ip6tables</code> command syntax is identical to <code class="command">iptables</code>
 in every aspect except that it supports 128-bit addresses. For example,
 use the following command to enable SSH connections on an IPv6-aware 
network server:
		</div><pre class="screen">~]# <code class="command">ip6tables -A INPUT -i eth0 -p tcp -s 3ffe:ffff:100::1/128 --dport 22 -j ACCEPT</code></pre><div class="para">
			For more information about IPv6 networking, see the IPv6 Information Page at <a href="http://www.ipv6.org/">http://www.ipv6.org/</a>.
		</div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-IPTables" lang="en-US"><div class="titlepage"><div><div><h3 class="title">2.8.9.&nbsp;IPTables</h3></div></div></div><div class="para">
		Included with Red&nbsp;Hat Enterprise&nbsp;Linux are advanced tools for network <em class="firstterm">packet filtering</em>
 — the process of controlling network packets as they enter, move 
through, and exit the network stack within the kernel. Kernel versions 
prior to 2.4 relied on <code class="command">ipchains</code> for packet 
filtering and used lists of rules applied to packets at each step of the
 filtering process. The 2.4 kernel introduced <code class="command">iptables</code> (also called <em class="firstterm">netfilter</em>), which is similar to <code class="command">ipchains</code> but greatly expands the scope and control available for filtering network packets.
	</div><div class="para">
		This chapter focuses on packet filtering basics, explains various options available with <code class="command">iptables</code> commands, and explains how filtering rules can be preserved between system reboots.
	</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
			The default firewall mechanism in the 2.4 and later kernels is <code class="command">iptables</code>, but <code class="command">iptables</code> cannot be used if <code class="command">ipchains</code> is already running. If <code class="command">ipchains</code> is present at boot time, the kernel issues an error and fails to start <code class="command">iptables</code>.
		</div><div class="para">
			The functionality of <code class="command">ipchains</code> is not affected by these errors.
		</div></div></div><div class="section" id="sect-Security_Guide-IPTables-Packet_Filtering"><div class="titlepage"><div><div><h4 class="title">2.8.9.1.&nbsp;Packet Filtering</h4></div></div></div><div class="para">
			The Linux kernel uses the <span class="application"><strong>Netfilter</strong></span>
 facility to filter packets, allowing some of them to be received by or 
pass through the system while stopping others. This facility is built in
 to the Linux kernel, and has five built-in <em class="firstterm">tables</em> or <em class="firstterm">rules lists</em>, as follows:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="option">filter</code> — The default table for handling network packets.
				</div></li><li class="listitem"><div class="para">
					<code class="option">nat</code> — Used to alter packets that create a new connection and used for <em class="firstterm">Network Address Translation</em> (<em class="firstterm">NAT</em>).
				</div></li><li class="listitem"><div class="para">
					<code class="option">mangle</code> — Used for specific types of packet alteration.
				</div></li><li class="listitem"><div class="para">
					<code class="option">raw</code> — Used mainly for configuring exemptions from connection tracking in combination with the NOTRACK target.
				</div></li><li class="listitem"><div class="para">
					<code class="option">security</code> — Used for Mandatory Access Control (MAC) networking rules, such as those enabled by the SECMARK and CONNSECMARK targets.
				</div></li></ul></div><div class="para">
			Each table has a group of built-in <em class="firstterm">chains</em>, which correspond to the actions performed on the packet by <code class="command">netfilter</code>.
		</div><div class="para">
			The built-in chains for the <code class="option">filter</code> table are as follows:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<em class="firstterm">INPUT</em> — Applies to network packets that are targeted for the host.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">OUTPUT</em> — Applies to locally-generated network packets.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">FORWARD</em> — Applies to network packets routed through the host.
				</div></li></ul></div><div class="para">
			The built-in chains for the <code class="option">nat</code> table are as follows:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<em class="firstterm">PREROUTING</em> — Applies to network packets when they arrive.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">OUTPUT</em> — Applies to locally-generated network packets before they are sent out.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">POSTROUTING</em> — Applies to network packets before they are sent out.
				</div></li></ul></div><div class="para">
			The built-in chains for the <code class="option">mangle</code> table are as follows:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<em class="firstterm">INPUT</em> — Applies to network packets targeted for the host.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">OUTPUT</em> — Applies to locally-generated network packets before they are sent out.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">FORWARD</em> — Applies to network packets routed through the host.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">PREROUTING</em> — Applies to incoming network packets before they are routed.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">POSTROUTING</em> — Applies to network packets before they are sent out.
				</div></li></ul></div><div class="para">
			The built-in chains for the <code class="option">raw</code> table are as follows:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<em class="firstterm">OUTPUT</em> — Applies to locally-generated network packets before they are sent out.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">PREROUTING</em> — Applies to incoming network packets before they are routed.
				</div></li></ul></div><div class="para">
			The built-in chains for the <code class="option">security</code> table are as follows:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<em class="firstterm">INPUT</em> — Applies to network packets targeted for the host.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">OUTPUT</em> — Applies to locally-generated network packets before they are sent out.
				</div></li><li class="listitem"><div class="para">
					<em class="firstterm">FORWARD</em> — Applies to network packets routed through the host.
				</div></li></ul></div><div class="para">
			Every network packet received by or sent from a Linux system is 
subject to at least one table. However, a packet may be subjected to 
multiple rules within each table before emerging at the end of the 
chain. The structure and purpose of these rules may vary, but they 
usually seek to identify a packet coming from or going to a particular 
IP address, or set of addresses, when using a particular protocol and 
network service. The following image outlines how the flow of packets is
 examined by the <code class="command">iptables</code> subsystem:
		</div><div class="figure" id="fig-Security_Guide-Packet_Filtering"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/iptables_small.html" alt="Packet filtering in IPTables"></div></div><p class="title"><strong>Figure&nbsp;2.6.&nbsp;Packet filtering in IPTables</strong></p></div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				By default, firewall rules are saved in the <code class="filename">/etc/sysconfig/iptables</code> or <code class="filename">/etc/sysconfig/ip6tables</code> files.
			</div><div class="para">
				The <code class="command">iptables</code> service starts before any 
DNS-related services when a Linux system is booted. This means that 
firewall rules can only reference numeric IP addresses (for example, 
192.168.0.1). Domain names (for example, host.example.com) in such rules
 produce errors.
			</div></div></div><div class="para">
			Regardless of their destination, when packets match a particular rule in one of the tables, a <em class="firstterm">target</em> or action is applied to them. If the rule specifies an <code class="command">ACCEPT</code>
 target for a matching packet, the packet skips the rest of the rule 
checks and is allowed to continue to its destination. If a rule 
specifies a <code class="command">DROP</code> target, that packet is 
refused access to the system and nothing is sent back to the host that 
sent the packet. If a rule specifies a <code class="command">QUEUE</code> target, the packet is passed to user-space. If a rule specifies the optional <code class="command">REJECT</code> target, the packet is dropped, but an error packet is sent to the packet's originator.
		</div><div class="para">
			Every chain has a default policy to <code class="command">ACCEPT</code>, <code class="command">DROP</code>, <code class="command">REJECT</code>, or <code class="command">QUEUE</code>. If none of the rules in the chain apply to the packet, then the packet is dealt with in accordance with the default policy.
		</div><div class="para">
			The <code class="command">iptables</code> command configures these tables, as well as sets up new tables if necessary.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				The netfilter modules are not loaded by default. Therefore a user will not see all of them by looking in the <code class="filename">/proc/</code>
 directory as it only shows what is being used or has been loaded 
already. This means that there is no way to see what features of 
netfilter are available before you attempt to use it.
			</div></div></div></div><div class="section" id="sect-Security_Guide-IPTables-Command_Options_for_IPTables"><div class="titlepage"><div><div><h4 class="title">2.8.9.2.&nbsp;Command Options for IPTables</h4></div></div></div><div class="para">
			Rules for filtering packets are created using the <code class="command">iptables</code> command. The following aspects of the packet are most often used as criteria:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<span class="emphasis"><em>Packet Type</em></span> — Specifies the type of packets the command filters.
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Packet Source/Destination</em></span> — Specifies which packets the command filters based on the source or destination of the packet.
				</div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Target</em></span> — Specifies what action is taken on packets matching the above criteria.
				</div></li></ul></div><div class="para">
			Refer to <a class="xref" href="#sect-Security_Guide-Command_Options_for_IPTables-IPTables_Match_Options">Section&nbsp;2.8.9.2.4, “IPTables Match Options”</a> and <a class="xref" href="#sect-Security_Guide-Command_Options_for_IPTables-Target_Options">Section&nbsp;2.8.9.2.5, “Target Options”</a> for more information about specific options that address these aspects of a packet.
		</div><div class="para">
			The options used with specific <code class="command">iptables</code> 
rules must be grouped logically, based on the purpose and conditions of 
the overall rule, for the rule to be valid. The remainder of this 
section explains commonly-used options for the <code class="command">iptables</code> command.
		</div><div class="section" id="sect-Security_Guide-Command_Options_for_IPTables-Structure_of_IPTables_Command_Options"><div class="titlepage"><div><div><h5 class="title">2.8.9.2.1.&nbsp;Structure of IPTables Command Options</h5></div></div></div><div class="para">
				Many <code class="command">iptables</code> commands have the following structure:
			</div><pre class="screen"><code class="command">iptables</code> [<span class="optional"><code class="option">-t</code> <em class="replaceable">&lt;table-name&gt;</em></span>] <em class="replaceable">&lt;command&gt;</em> <em class="replaceable">&lt;chain-name&gt;</em> \
  <em class="replaceable">&lt;parameter-1&gt;</em> <em class="replaceable">&lt;option-1&gt;</em> \
  <em class="replaceable">&lt;parameter-n&gt;</em> <em class="replaceable">&lt;option-n&gt;</em></pre><div class="para">
				<em class="replaceable">&lt;table-name&gt;</em> — Specifies which table the rule applies to. If omitted, the <code class="option">filter</code> table is used.
			</div><div class="para">
				<em class="replaceable">&lt;command&gt;</em> — Specifies the action to perform, such as appending or deleting a rule.
			</div><div class="para">
				<em class="replaceable">&lt;chain-name&gt;</em> — Specifies the chain to edit, create, or delete.
			</div><div class="para">
				<em class="replaceable">&lt;parameter&gt;-&lt;option&gt;</em> pairs — Parameters and associated options that specify how to process a packet that matches the rule.
			</div><div class="para">
				The length and complexity of an <code class="command">iptables</code> command can change significantly, based on its purpose.
			</div><div class="para">
				For example, a command to remove a rule from a chain can be very short:
			</div><pre class="synopsis"><code class="command">iptables</code> <code class="option">-D</code> <em class="replaceable">&lt;chain-name&gt; &lt;line-number&gt;</em></pre><div class="para">
				In contrast, a command that adds a rule which filters packets from a
 particular subnet using a variety of specific parameters and options 
can be rather long. When constructing <code class="command">iptables</code>
 commands, it is important to remember that some parameters and options 
require further parameters and options to construct a valid rule. This 
can produce a cascading effect, with the further parameters requiring 
yet more parameters. Until every parameter and option that requires 
another set of options is satisfied, the rule is not valid.
			</div><div class="para">
				Type <code class="command">iptables -h</code> to view a comprehensive list of <code class="command">iptables</code> command structures.
			</div></div><div class="section" id="sect-Security_Guide-Command_Options_for_IPTables-Command_Options"><div class="titlepage"><div><div><h5 class="title">2.8.9.2.2.&nbsp;Command Options</h5></div></div></div><div class="para">
				Command options instruct <code class="command">iptables</code> to perform a specific action. Only one command option is allowed per <code class="command">iptables</code> command. With the exception of the help command, all commands are written in upper-case characters.
			</div><div class="para">
				The <code class="command">iptables</code> command options are as follows:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="option">-A</code> — Appends the rule to the end of the specified chain. Unlike the <code class="option">-I</code> option described below, it does not take an integer argument. It always appends the rule to the end of the specified chain.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-D &lt;integer&gt; | &lt;rule&gt;</code> — Deletes a rule in a particular chain by number (such as <code class="option">5</code> for the fifth rule in a chain), or by rule specification. The rule specification must exactly match an existing rule.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-E</code> — Renames a user-defined chain. A user-defined chain is any chain other than the default, pre-existing chains. (Refer to the <code class="option">-N</code>
 option, below, for information on creating user-defined chains.) This 
is a cosmetic change and does not affect the structure of the table.
					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							If you attempt to rename one of the default chains, the system reports a <code class="computeroutput">Match not found</code> error. You cannot rename the default chains.
						</div></div></div></li><li class="listitem"><div class="para">
						<code class="option">-F</code> — Flushes the selected chain, which
 effectively deletes every rule in the chain. If no chain is specified, 
this command flushes every rule from every chain.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-h</code> — Provides a list of command structures, as well as a quick summary of command parameters and options.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-I [&lt;integer&gt;]</code> — Inserts the 
rule in the specified chain at a point specified by a user-defined 
integer argument. If no argument is specified, the rule is inserted at 
the top of the chain.
					</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
							As noted above, the order of rules in a chain determines which 
rules apply to which packets. This is important to remember when adding 
rules using either the <code class="option">-A</code> or <code class="option">-I</code> option.
						</div><div class="para">
							This is especially important when adding rules using the <code class="option">-I</code> with an integer argument. If you specify an existing number when adding a rule to a chain, <code class="command">iptables</code> adds the new rule <span class="emphasis"><em>before</em></span> (or above) the existing rule.
						</div></div></div></li><li class="listitem"><div class="para">
						<code class="option">-L</code> — Lists all of the rules in the chain specified after the command. To list all rules in all chains in the default <code class="option">filter</code>
 table, do not specify a chain or table. Otherwise, the following syntax
 should be used to list the rules in a specific chain in a particular 
table:
					</div><pre class="synopsis"><code class="command">iptables</code> <code class="option">-L</code> <em class="replaceable">&lt;chain-name&gt;</em> <code class="option">-t</code> <em class="replaceable">&lt;table-name&gt;</em></pre><div class="para">
						Additional options for the <code class="option">-L</code> command option, which provide rule numbers and allow more verbose rule descriptions, are described in <a class="xref" href="#sect-Security_Guide-Command_Options_for_IPTables-Listing_Options">Section&nbsp;2.8.9.2.6, “Listing Options”</a>.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-N</code> — Creates a new chain with a user-specified name. The chain name must be unique, otherwise an error message is displayed.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-P</code> — Sets the default policy for the 
specified chain, so that when packets traverse an entire chain without 
matching a rule, they are sent to the specified target, such as ACCEPT 
or DROP.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-R</code> — Replaces a rule in the specified 
chain. The rule's number must be specified after the chain's name. The 
first rule in a chain corresponds to rule number one.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-X</code> — Deletes a user-specified chain. You cannot delete a built-in chain.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-Z</code> — Sets the byte and packet counters in all chains for a table to zero.
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Command_Options_for_IPTables-IPTables_Parameter_Options"><div class="titlepage"><div><div><h5 class="title">2.8.9.2.3.&nbsp;IPTables Parameter Options</h5></div></div></div><div class="para">
				Certain <code class="command">iptables</code> commands, including 
those used to add, append, delete, insert, or replace rules within a 
particular chain, require various parameters to construct a packet 
filtering rule.
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="option">-c</code> — Resets the counters for a particular rule. This parameter accepts the <code class="option">PKTS</code> and <code class="option">BYTES</code> options to specify which counter to reset.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-d</code> — Sets the destination hostname, IP
 address, or network of a packet that matches the rule. When matching a 
network, the following IP address/netmask formats are supported:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="option"><em class="replaceable">N.N.N.N</em>/<em class="replaceable">M.M.M.M</em></code> — Where <em class="replaceable">N.N.N.N</em> is the IP address range and <em class="replaceable">M.M.M.M</em> is the netmask.
							</div></li><li class="listitem"><div class="para">
								<code class="option"><em class="replaceable">N.N.N.N</em>/<em class="replaceable">M</em></code> — Where <em class="replaceable">N.N.N.N</em> is the IP address range and <em class="replaceable">M</em> is the bitmask.
							</div></li></ul></div></li><li class="listitem"><div class="para">
						<code class="option">-f</code> — Applies this rule only to fragmented packets.
					</div><div class="para">
						You can use the exclamation point character (<code class="option">!</code>) option before this parameter to specify that only unfragmented packets are matched.
					</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							Distinguishing between fragmented and unfragmented packets is 
desirable, despite fragmented packets being a standard part of the IP 
protocol.
						</div><div class="para">
							Originally designed to allow IP packets to travel over networks 
with differing frame sizes, these days fragmentation is more commonly 
used to generate DoS attacks using malformed packets. It's also worth 
noting that IPv6 disallows fragmentation entirely.
						</div></div></div></li><li class="listitem"><div class="para">
						<code class="option">-i</code> — Sets the incoming network interface, such as <code class="option">eth0</code> or <code class="option">ppp0</code>. With <code class="command">iptables</code>, this optional parameter may only be used with the INPUT and FORWARD chains when used with the <code class="option">filter</code> table and the PREROUTING chain with the <code class="option">nat</code> and <code class="option">mangle</code> tables.
					</div><div class="para">
						This parameter also supports the following special options:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								Exclamation point character (<code class="option">!</code>) — Reverses the directive, meaning any specified interfaces are excluded from this rule.
							</div></li><li class="listitem"><div class="para">
								Plus character (<code class="option">+</code>) — A wildcard character used to match all interfaces that match the specified string. For example, the parameter <code class="option">-i eth+</code> would apply this rule to any Ethernet interfaces but exclude any other interfaces, such as <code class="option">ppp0</code>.
							</div></li></ul></div><div class="para">
						If the <code class="option">-i</code> parameter is used but no interface is specified, then every interface is affected by the rule.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-j</code> — Jumps to the specified target when a packet matches a particular rule.
					</div><div class="para">
						The standard targets are <code class="option">ACCEPT</code>, <code class="option">DROP</code>, <code class="option">QUEUE</code>, and <code class="option">RETURN</code>.
					</div><div class="para">
						Extended options are also available through modules loaded by default with the Red&nbsp;Hat Enterprise&nbsp;Linux <code class="command">iptables</code> RPM package. Valid targets in these modules include <code class="option">LOG</code>, <code class="option">MARK</code>, and <code class="option">REJECT</code>, among others. Refer to the <code class="command">iptables</code> man page for more information about these and other targets.
					</div><div class="para">
						This option can also be used to direct a packet matching a 
particular rule to a user-defined chain outside of the current chain so 
that other rules can be applied to the packet.
					</div><div class="para">
						If no target is specified, the packet moves past the rule with no 
action taken. The counter for this rule, however, increases by one.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-o</code> — Sets the outgoing network interface for a rule. This option is only valid for the OUTPUT and FORWARD chains in the <code class="option">filter</code> table, and the POSTROUTING chain in the <code class="option">nat</code> and <code class="option">mangle</code> tables. This parameter accepts the same options as the incoming network interface parameter (<code class="option">-i</code>).
					</div></li><li class="listitem"><div class="para">
						<code class="option">-p &lt;protocol&gt;</code> — Sets the IP protocol affected by the rule. This can be either <code class="option">icmp</code>, <code class="option">tcp</code>, <code class="option">udp</code>, or <code class="option">all</code>, or it can be a numeric value, representing one of these or a different protocol. You can also use any protocols listed in the <code class="filename">/etc/protocols</code> file.
					</div><div class="para">
						The "<code class="option">all</code>" protocol means the rule applies to every supported protocol. If no protocol is listed with this rule, it defaults to "<code class="option">all</code>".
					</div></li><li class="listitem"><div class="para">
						<code class="option">-s</code> — Sets the source for a particular packet using the same syntax as the destination (<code class="option">-d</code>) parameter.
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Command_Options_for_IPTables-IPTables_Match_Options"><div class="titlepage"><div><div><h5 class="title">2.8.9.2.4.&nbsp;IPTables Match Options</h5></div></div></div><div class="para">
				Different network protocols provide specialized matching options 
which can be configured to match a particular packet using that 
protocol. However, the protocol must first be specified in the <code class="command">iptables</code> command. For example, <code class="option">-p <em class="replaceable">&lt;protocol-name&gt;</em></code>
 enables options for the specified protocol. Note that you can also use 
the protocol ID, instead of the protocol name. Refer to the following 
examples, each of which have the same effect:
			</div><pre class="screen">~]# <code class="command">iptables -A INPUT -p icmp --icmp-type any -j ACCEPT</code>
~]# <code class="command">iptables -A INPUT -p 5813 --icmp-type any -j ACCEPT</code></pre><div class="para">
				Service definitions are provided in the <code class="filename">/etc/services</code> file. For readability, it is recommended that you use the service names rather than the port numbers.
			</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
					Secure the <code class="filename">/etc/services</code> file to 
prevent unauthorized editing. If this file is editable, attackers can 
use it to enable ports on your machine you have otherwise closed. To 
secure this file, run the following commands as root:
				</div><pre class="screen">~]# <code class="command">chown root.root /etc/services</code>
~]# <code class="command">chmod 0644 /etc/services</code>
~]# <code class="command">chattr +i /etc/services</code></pre><div class="para">
					This prevents the file from being renamed, deleted or having links made to it.
				</div></div></div><div class="section" id="sect-Security_Guide-IPTables_Match_Options-TCP_Protocol"><div class="titlepage"><div><div><h6 class="title">2.8.9.2.4.1.&nbsp;TCP Protocol</h6></div></div></div><div class="para">
					These match options are available for the TCP protocol (<code class="option">-p tcp</code>):
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">--dport</code> — Sets the destination port for the packet.
						</div><div class="para">
							To configure this option, use a network service name (such as www or smtp); a port number; or a range of port numbers.
						</div><div class="para">
							To specify a range of port numbers, separate the two numbers with a colon (<code class="option">:</code>). For example: <code class="option">-p tcp --dport 3000:3200</code>. The largest acceptable valid range is <code class="option">0:65535</code>.
						</div><div class="para">
							Use an exclamation point character (<code class="option">!</code>) after the <code class="option">--dport</code> option to match all packets that <span class="emphasis"><em>do not</em></span> use that network service or port.
						</div><div class="para">
							To browse the names and aliases of network services and the port numbers they use, view the <code class="filename">/etc/services</code> file.
						</div><div class="para">
							The <code class="option">--destination-port</code> match option is synonymous with <code class="option">--dport</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="option">--sport</code> — Sets the source port of the packet using the same options as <code class="option">--dport</code>. The <code class="option">--source-port</code> match option is synonymous with <code class="option">--sport</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="option">--syn</code> — Applies to all TCP packets designed to initiate communication, commonly called <em class="firstterm">SYN packets</em>. Any packets that carry a data payload are not touched.
						</div><div class="para">
							Use an exclamation point character (<code class="option">!</code>) before the <code class="option">--syn</code> option to match all non-SYN packets.
						</div></li><li class="listitem"><div class="para">
							<code class="option">--tcp-flags &lt;tested flag list&gt; &lt;set flag list&gt;</code> — Allows TCP packets that have specific bits (flags) set, to match a rule.
						</div><div class="para">
							The <code class="option">--tcp-flags</code> match option accepts 
two parameters. The first parameter is the mask; a comma-separated list 
of flags to be examined in the packet. The second parameter is a 
comma-separated list of flags that must be set for the rule to match.
						</div><div class="para">
							The possible flags are:
						</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="option">ACK</code>
								</div></li><li class="listitem"><div class="para">
									<code class="option">FIN</code>
								</div></li><li class="listitem"><div class="para">
									<code class="option">PSH</code>
								</div></li><li class="listitem"><div class="para">
									<code class="option">RST</code>
								</div></li><li class="listitem"><div class="para">
									<code class="option">SYN</code>
								</div></li><li class="listitem"><div class="para">
									<code class="option">URG</code>
								</div></li><li class="listitem"><div class="para">
									<code class="option">ALL</code>
								</div></li><li class="listitem"><div class="para">
									<code class="option">NONE</code>
								</div></li></ul></div><div class="para">
							For example, an <code class="command">iptables</code> rule that 
contains the following specification only matches TCP packets that have 
the SYN flag set and the ACK and FIN flags not set:
						</div><div class="para">
							<code class="command">--tcp-flags ACK,FIN,SYN SYN</code>
						</div><div class="para">
							Use the exclamation point character (<code class="option">!</code>) after the <code class="option">--tcp-flags</code> to reverse the effect of the match option.
						</div></li><li class="listitem"><div class="para">
							<code class="option">--tcp-option</code> — Attempts to match with
 TCP-specific options that can be set within a particular packet. This 
match option can also be reversed by using the exclamation point 
character (<code class="option">!</code>) after the option.
						</div></li></ul></div></div><div class="section" id="sect-Security_Guide-IPTables_Match_Options-UDP_Protocol"><div class="titlepage"><div><div><h6 class="title">2.8.9.2.4.2.&nbsp;UDP Protocol</h6></div></div></div><div class="para">
					These match options are available for the UDP protocol (<code class="option">-p udp</code>):
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">--dport</code> — Specifies the destination port of the UDP packet, using the service name, port number, or range of port numbers. The <code class="option">--destination-port</code> match option is synonymous with <code class="option">--dport</code>.
						</div></li><li class="listitem"><div class="para">
							<code class="option">--sport</code> — Specifies the source port of the UDP packet, using the service name, port number, or range of port numbers. The <code class="option">--source-port</code> match option is synonymous with <code class="option">--sport</code>.
						</div></li></ul></div><div class="para">
					For the <code class="option">--dport</code> and <code class="option">--sport</code> options, to specify a range of port numbers, separate the two numbers with a colon (:). For example: <code class="option">-p tcp --dport 3000:3200</code>. The largest acceptable valid range is <code class="option">0:65535</code>.
				</div></div><div class="section" id="sect-Security_Guide-IPTables_Match_Options-ICMP_Protocol"><div class="titlepage"><div><div><h6 class="title">2.8.9.2.4.3.&nbsp;ICMP Protocol</h6></div></div></div><div class="para">
					The following match option is available for the Internet Control Message Protocol (ICMP) (<code class="option">-p icmp</code>):
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">--icmp-type</code> — Sets the name or number of the ICMP type to match with the rule. A list of valid ICMP names can be retrieved by typing the <code class="command">iptables -p icmp -h</code> command.
						</div></li></ul></div></div><div class="section" id="sect-Security_Guide-IPTables_Match_Options-Additional_Match_Option_Modules"><div class="titlepage"><div><div><h6 class="title">2.8.9.2.4.4.&nbsp;Additional Match Option Modules</h6></div></div></div><div class="para">
					Additional match options are available through modules loaded by the <code class="command">iptables</code> command.
				</div><div class="para">
					To use a match option module, load the module by name using the <code class="option">-m <em class="replaceable">&lt;module-name&gt;</em></code>, where <em class="replaceable">&lt;module-name&gt;</em> is the name of the module.
				</div><div class="para">
					Many modules are available by default. You can also create modules to provide additional functionality.
				</div><div class="para">
					The following is a partial list of the most commonly used modules:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="option">limit</code> module — Places limits on how many packets are matched to a particular rule.
						</div><div class="para">
							When used in conjunction with the <code class="command">LOG</code> target, the <code class="option">limit</code>
 module can prevent a flood of matching packets from filling up the 
system log with repetitive messages or using up system resources.
						</div><div class="para">
							Refer to <a class="xref" href="#sect-Security_Guide-Command_Options_for_IPTables-Target_Options">Section&nbsp;2.8.9.2.5, “Target Options”</a> for more information about the <code class="command">LOG</code> target.
						</div><div class="para">
							The <code class="option">limit</code> module enables the following options:
						</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="option">--limit</code> — Sets the maximum number of matches for a particular time period, specified as a <code class="option"><em class="replaceable">&lt;value&gt;/&lt;period&gt;</em></code> pair. For example, using <code class="option">--limit 5/hour</code> allows five rule matches per hour.
								</div><div class="para">
									Periods can be specified in seconds, minutes, hours, or days.
								</div><div class="para">
									If a number and time modifier are not used, the default value of <code class="option">3/hour</code> is assumed.
								</div></li><li class="listitem"><div class="para">
									<code class="option">--limit-burst</code> — Sets a limit on the number of packets able to match a rule at one time.
								</div><div class="para">
									This option is specified as an integer and should be used in conjunction with the <code class="option">--limit</code> option.
								</div><div class="para">
									If no value is specified, the default value of five (5) is assumed.
								</div></li></ul></div></li><li class="listitem"><div class="para">
							<code class="option">state</code> module — Enables state matching.
						</div><div class="para">
							The <code class="option">state</code> module enables the following options:
						</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="option">--state</code> — match a packet with the following connection states:
								</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
											<code class="option">ESTABLISHED</code> — The matching packet
 is associated with other packets in an established connection. You need
 to accept this state if you want to maintain a connection between a 
client and a server.
										</div></li><li class="listitem"><div class="para">
											<code class="option">INVALID</code> — The matching packet cannot be tied to a known connection.
										</div></li><li class="listitem"><div class="para">
											<code class="option">NEW</code> — The matching packet is 
either creating a new connection or is part of a two-way connection not 
previously seen. You need to accept this state if you want to allow new 
connections to a service.
										</div></li><li class="listitem"><div class="para">
											<code class="option">RELATED</code> — The matching packet is 
starting a new connection related in some way to an existing connection.
 An example of this is FTP, which uses one connection for control 
traffic (port 21), and a separate connection for data transfer (port 
20).
										</div></li></ul></div><div class="para">
									These connection states can be used in combination with one another by separating them with commas, such as <code class="option">-m state --state INVALID,NEW</code>.
								</div></li></ul></div></li><li class="listitem"><div class="para">
							<code class="option">mac</code> module — Enables hardware MAC address matching.
						</div><div class="para">
							The <code class="option">mac</code> module enables the following option:
						</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
									<code class="option">--mac-source</code> — Matches a MAC 
address of the network interface card that sent the packet. To exclude a
 MAC address from a rule, place an exclamation point character (<code class="option">!</code>) after the <code class="option">--mac-source</code> match option.
								</div></li></ul></div></li></ul></div><div class="para">
					Refer to the <code class="command">iptables</code> man page for more match options available through modules.
				</div></div></div><div class="section" id="sect-Security_Guide-Command_Options_for_IPTables-Target_Options"><div class="titlepage"><div><div><h5 class="title">2.8.9.2.5.&nbsp;Target Options</h5></div></div></div><div class="para">
				When a packet has matched a particular rule, the rule can direct the
 packet to a number of different targets which determine the appropriate
 action. Each chain has a default target, which is used if none of the 
rules on that chain match a packet or if none of the rules which match 
the packet specify a target.
			</div><div class="para">
				The following are the standard targets:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="option"><em class="replaceable">&lt;user-defined-chain&gt;</em></code>
 — A user-defined chain within the table. User-defined chain names must 
be unique. This target passes the packet to the specified chain.
					</div></li><li class="listitem"><div class="para">
						<code class="option">ACCEPT</code> — Allows the packet through to its destination or to another chain.
					</div></li><li class="listitem"><div class="para">
						<code class="option">DROP</code> — Drops the packet without responding to the requester. The system that sent the packet is not notified of the failure.
					</div></li><li class="listitem"><div class="para">
						<code class="option">QUEUE</code> — The packet is queued for handling by a user-space application.
					</div></li><li class="listitem"><div class="para">
						<code class="option">RETURN</code> — Stops checking the packet against rules in the current chain. If the packet with a <code class="option">RETURN</code>
 target matches a rule in a chain called from another chain, the packet 
is returned to the first chain to resume rule checking where it left 
off. If the <code class="option">RETURN</code> rule is used on a 
built-in chain and the packet cannot move up to its previous chain, the 
default target for the current chain is used.
					</div></li></ul></div><div class="para">
				In addition, extensions are available which allow other targets to 
be specified. These extensions are called target modules or match option
 modules and most only apply to specific tables and situations. Refer to
 <a class="xref" href="#sect-Security_Guide-IPTables_Match_Options-Additional_Match_Option_Modules">Section&nbsp;2.8.9.2.4.4, “Additional Match Option Modules”</a> for more information about match option modules.
			</div><div class="para">
				Many extended target modules exist, most of which only apply to 
specific tables or situations. Some of the most popular target modules 
included by default in Red&nbsp;Hat Enterprise&nbsp;Linux are:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="option">LOG</code> — Logs all packets that match this rule. Because the packets are logged by the kernel, the <code class="filename">/etc/syslog.conf</code> file determines where these log entries are written. By default, they are placed in the <code class="filename">/var/log/messages</code> file.
					</div><div class="para">
						Additional options can be used after the <code class="option">LOG</code> target to specify the way in which logging occurs:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="option">--log-level</code> — Sets the priority level of a logging event. Refer to the <code class="filename">syslog.conf</code> man page for a list of priority levels.
							</div></li><li class="listitem"><div class="para">
								<code class="option">--log-ip-options</code> — Logs any options set in the header of an IP packet.
							</div></li><li class="listitem"><div class="para">
								<code class="option">--log-prefix</code> — Places a string of up
 to 29 characters before the log line when it is written. This is useful
 for writing syslog filters for use in conjunction with packet logging.
							</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
									Due to an issue with this option, you should add a trailing space to the <em class="replaceable">log-prefix</em> value.
								</div></div></div></li><li class="listitem"><div class="para">
								<code class="option">--log-tcp-options</code> — Logs any options set in the header of a TCP packet.
							</div></li><li class="listitem"><div class="para">
								<code class="option">--log-tcp-sequence</code> — Writes the TCP sequence number for the packet in the log.
							</div></li></ul></div></li><li class="listitem"><div class="para">
						<code class="option">REJECT</code> — Sends an error packet back to the remote system and drops the packet.
					</div><div class="para">
						The <code class="option">REJECT</code> target accepts <code class="option">--reject-with <em class="replaceable">&lt;type&gt;</em></code> (where <em class="replaceable">&lt;type&gt;</em> is the rejection type) allowing more detailed information to be returned with the error packet. The message <code class="computeroutput">port-unreachable</code> is the default error type given if no other option is used. Refer to the <code class="command">iptables</code> man page for a full list of <code class="option"><em class="replaceable">&lt;type&gt;</em></code> options.
					</div></li></ul></div><div class="para">
				Other target extensions, including several that are useful for IP masquerading using the <code class="option">nat</code> table, or with packet alteration using the <code class="option">mangle</code> table, can be found in the <code class="command">iptables</code> man page.
			</div></div><div class="section" id="sect-Security_Guide-Command_Options_for_IPTables-Listing_Options"><div class="titlepage"><div><div><h5 class="title">2.8.9.2.6.&nbsp;Listing Options</h5></div></div></div><div class="para">
				The default list command, <code class="command">iptables -L [&lt;chain-name&gt;]</code>, provides a very basic overview of the default filter table's current chains. Additional options provide more information:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="option">-v</code> — Displays verbose output, such as 
the number of packets and bytes each chain has processed, the number of 
packets and bytes each rule has matched, and which interfaces apply to a
 particular rule.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-x</code> — Expands numbers into their exact 
values. On a busy system, the number of packets and bytes processed by a
 particular chain or rule may be abbreviated to <code class="computeroutput">Kilobytes</code>, <code class="computeroutput">Megabytes</code>, or <code class="computeroutput">Gigabytes</code>. This option forces the full number to be displayed.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-n</code> — Displays IP addresses and port numbers in numeric format, rather than the default hostname and network service format.
					</div></li><li class="listitem"><div class="para">
						<code class="option">--line-numbers</code> — Lists rules in each 
chain next to their numeric order in the chain. This option is useful 
when attempting to delete the specific rule in a chain or to locate 
where to insert a rule within a chain.
					</div></li><li class="listitem"><div class="para">
						<code class="option">-t &lt;table-name&gt;</code> — Specifies a table name. If omitted, defaults to the filter table.
					</div></li></ul></div></div></div><div class="section" id="sect-Security_Guide-IPTables-Saving_IPTables_Rules"><div class="titlepage"><div><div><h4 class="title">2.8.9.3.&nbsp;Saving IPTables Rules</h4></div></div></div><div class="para">
			Rules created with the <code class="command">iptables</code> command are stored in memory. If the system is restarted before saving the <code class="command">iptables</code>
 rule set, all rules are lost. For netfilter rules to persist through a 
system reboot, they need to be saved. To save netfilter rules, type the 
following command as root:
		</div><pre class="screen">~]# <code class="command">/sbin/service iptables save</code>
iptables: Saving firewall rules to /etc/sysconfig/iptables:[  OK  ]</pre><div class="para">
			This executes the <code class="command">iptables</code> init script, which runs the <code class="command">/sbin/iptables-save</code> program and writes the current <code class="command">iptables</code> configuration to <code class="filename">/etc/sysconfig/iptables</code>. The existing <code class="filename">/etc/sysconfig/iptables</code> file is saved as <code class="filename">/etc/sysconfig/iptables.save</code>.
		</div><div class="para">
			The next time the system boots, the <code class="command">iptables</code> init script reapplies the rules saved in <code class="filename">/etc/sysconfig/iptables</code> by using the <code class="command">/sbin/iptables-restore</code> command.
		</div><div class="para">
			While it is always a good idea to test a new <code class="command">iptables</code> rule before committing it to the <code class="filename">/etc/sysconfig/iptables</code> file, it is possible to copy <code class="command">iptables</code> rules into this file from another system's version of this file. This provides a quick way to distribute sets of <code class="command">iptables</code> rules to multiple machines.
		</div><div class="para">
			You can also save the <code class="command">iptables</code> rules to a separate file for distribution, backup, or other purposes. To do so, run the following command as root:
		</div><pre class="synopsis"><code class="command">iptables-save</code> &gt; <em class="replaceable">&lt;filename&gt;</em></pre><div class="para">
			… where <em class="replaceable">&lt;filename&gt;</em> is a user-defined name for your ruleset.
		</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				If distributing the <code class="filename">/etc/sysconfig/iptables</code> file to other machines, type <code class="command">/sbin/service iptables reload</code> or <code class="command">/sbin/service iptables restart</code> for the new rules to take effect. It is better to use the <code class="command">reload</code> command because there is no period of time without a firewall in place. See the description of the <code class="command">reload</code> command in <a class="xref" href="#sect-Security_Guide-IPTables-IPTables_Control_Scripts">Section&nbsp;2.8.9.4, “IPTables Control Scripts”</a>. For <code class="systemitem">IPv6</code>, substitute <code class="command">ip6tables</code> for <code class="command">iptables</code> in the <code class="command">/sbin/service</code> commands listed in this section. For more information about <code class="systemitem">IPv6</code> and netfilter, see <a class="xref" href="#sect-Security_Guide-IPTables-IPTables_and_IPv6">Section&nbsp;2.8.9.6, “IPTables and IPv6”</a>.
			</div></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Note the difference between the <code class="command">iptables</code> <span class="emphasis"><em>command</em></span> (<code class="command">/sbin/iptables</code>), which is used to manipulate the tables and chains that constitute the <code class="command">iptables</code> functionality, and the <code class="command">iptables</code> <span class="emphasis"><em>service</em></span> (<code class="command">/sbin/service iptables</code>), which is used to enable and disable the <code class="command">iptables</code> service itself.
			</div></div></div></div><div class="section" id="sect-Security_Guide-IPTables-IPTables_Control_Scripts"><div class="titlepage"><div><div><h4 class="title">2.8.9.4.&nbsp;IPTables Control Scripts</h4></div></div></div><div class="para">
			There are two basic methods for controlling <code class="command">iptables</code> in Red&nbsp;Hat Enterprise&nbsp;Linux:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<span class="application"><strong>Firewall Configuration Tool</strong></span> (<code class="command">system-config-firewall</code>) — A graphical interface for creating, activating, and saving basic firewall rules. Refer to <a class="xref" href="#sect-Security_Guide-Firewalls-Basic_Firewall_Configuration">Section&nbsp;2.8.2, “Basic Firewall Configuration”</a> for more information.
				</div></li><li class="listitem"><div class="para">
					<code class="command">/sbin/service iptables <em class="replaceable">&lt;option&gt;</em></code> — Used to manipulate various functions of <code class="command">iptables</code> using its initscript. The following options are available:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="command">start</code> — If a firewall is configured (that is, <code class="filename">/etc/sysconfig/iptables</code> exists), all running <code class="command">iptables</code> are stopped completely and then started using the <code class="command">/sbin/iptables-restore</code> command. This option only works if the <code class="command">ipchains</code> kernel module is <span class="emphasis"><em>not</em></span> loaded. To check if this module is loaded, type the following command as root:
						</div><pre class="screen">~]# <code class="command">lsmod | grep ipchains</code></pre><div class="para">
							If this command returns no output, it means the module is not loaded. If necessary, use the <code class="command">/sbin/rmmod</code> command to remove the module.
						</div></li><li class="listitem"><div class="para">
							<code class="command">stop</code> — If a firewall is running, the firewall rules in memory are flushed, and all <code class="command">iptables</code> modules and helpers are unloaded.
						</div><div class="para">
							If the <code class="command">IPTABLES_SAVE_ON_STOP</code> directive in the <code class="filename">/etc/sysconfig/iptables-config</code> configuration file is changed from its default value to <code class="command">yes</code>, current rules are saved to <code class="filename">/etc/sysconfig/iptables</code> and any existing rules are moved to the file <code class="filename">/etc/sysconfig/iptables.save</code>.
						</div><div class="para">
							Refer to <a class="xref" href="#sect-Security_Guide-IPTables_Control_Scripts-IPTables_Control_Scripts_Configuration_File">Section&nbsp;2.8.9.4.1, “IPTables Control Scripts Configuration File”</a> for more information about the <code class="filename">iptables-config</code> file.
						</div></li><li class="listitem"><div class="para">
							<code class="command">reload</code> — If a firewall is running, the firewall rules are reloaded from the configuration file. The <code class="command">reload</code>
 command does not unload helpers that have been in use before, but will 
add new helpers that have been added to IPTABLES_MODULES (for <code class="systemitem">IPv4</code>) and IP6TABLES_MODULES (for <code class="systemitem">IPv6</code>).
 The advantage of not flushing the current firewall rules is that if the
 new rules cannot be applied, because of an error in the rules, the old 
rules are still in place.
						</div></li><li class="listitem"><div class="para">
							<code class="command">restart</code> — If a firewall is running, the firewall rules in memory are flushed, and the firewall is started again if it is configured in <code class="filename">/etc/sysconfig/iptables</code>. This option only works if the <code class="command">ipchains</code> kernel module is not loaded.
						</div><div class="para">
							If the <code class="command">IPTABLES_SAVE_ON_RESTART</code> directive in the <code class="filename">/etc/sysconfig/iptables-config</code> configuration file is changed from its default value to <code class="command">yes</code>, current rules are saved to <code class="filename">/etc/sysconfig/iptables</code> and any existing rules are moved to the file <code class="filename">/etc/sysconfig/iptables.save</code>.
						</div><div class="para">
							Refer to <a class="xref" href="#sect-Security_Guide-IPTables_Control_Scripts-IPTables_Control_Scripts_Configuration_File">Section&nbsp;2.8.9.4.1, “IPTables Control Scripts Configuration File”</a> for more information about the <code class="filename">iptables-config</code> file.
						</div></li><li class="listitem"><div class="para">
							<code class="command">status</code> — Displays the status of the firewall and lists all active rules.
						</div><div class="para">
							The default configuration for this option displays IP addresses 
in each rule. To display domain and hostname information, edit the <code class="filename">/etc/sysconfig/iptables-config</code> file and change the value of <code class="command">IPTABLES_STATUS_NUMERIC</code> to <code class="command">no</code>. Refer to <a class="xref" href="#sect-Security_Guide-IPTables_Control_Scripts-IPTables_Control_Scripts_Configuration_File">Section&nbsp;2.8.9.4.1, “IPTables Control Scripts Configuration File”</a> for more information about the <code class="filename">iptables-config</code> file.
						</div></li><li class="listitem"><div class="para">
							<code class="command">panic</code> — Flushes all firewall rules. The policy of all configured tables is set to <code class="command">DROP</code>.
						</div><div class="para">
							This option could be useful if a server is known to be 
compromised. Rather than physically disconnecting from the network or 
shutting down the system, you can use this option to stop all further 
network traffic but leave the machine in a state ready for analysis or 
other forensics.
						</div></li><li class="listitem"><div class="para">
							<code class="command">save</code> — Saves firewall rules to <code class="filename">/etc/sysconfig/iptables</code> using <code class="command">iptables-save</code>. Refer to <a class="xref" href="#sect-Security_Guide-IPTables-Saving_IPTables_Rules">Section&nbsp;2.8.9.3, “Saving IPTables Rules”</a> for more information.
						</div></li></ul></div></li></ul></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				To use the same initscript commands to control netfilter for IPv6, substitute <code class="command">ip6tables</code> for <code class="command">iptables</code> in the <code class="command">/sbin/service</code> commands listed in this section. For more information about IPv6 and netfilter, see <a class="xref" href="#sect-Security_Guide-IPTables-IPTables_and_IPv6">Section&nbsp;2.8.9.6, “IPTables and IPv6”</a>.
			</div></div></div><div class="section" id="sect-Security_Guide-IPTables_Control_Scripts-IPTables_Control_Scripts_Configuration_File"><div class="titlepage"><div><div><h5 class="title">2.8.9.4.1.&nbsp;IPTables Control Scripts Configuration File</h5></div></div></div><div class="para">
				The behavior of the <code class="command">iptables</code> initscripts is controlled by the <code class="filename">/etc/sysconfig/iptables-config</code> configuration file. The following is a list of directives contained in this file:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="command">IPTABLES_MODULES</code> — Specifies a space-separated list of additional <code class="command">iptables</code> modules to load when a firewall is activated. These can include connection tracking and NAT helpers.
					</div></li><li class="listitem"><div class="para">
						<code class="command">IPTABLES_MODULES_UNLOAD</code> — Unloads modules on restart and stop. This directive accepts the following values:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="command">yes</code> — The default value. This option must be set to achieve a correct state for a firewall restart or stop.
							</div></li><li class="listitem"><div class="para">
								<code class="command">no</code> — This option should only be set if there are problems unloading the netfilter modules.
							</div></li></ul></div></li><li class="listitem"><div class="para">
						<code class="command">IPTABLES_SAVE_ON_STOP</code> — Saves current firewall rules to <code class="filename">/etc/sysconfig/iptables</code> when the firewall is stopped. This directive accepts the following values:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="command">yes</code> — Saves existing rules to <code class="filename">/etc/sysconfig/iptables</code> when the firewall is stopped, moving the previous version to the <code class="filename">/etc/sysconfig/iptables.save</code> file.
							</div></li><li class="listitem"><div class="para">
								<code class="command">no</code> — The default value. Does not save existing rules when the firewall is stopped.
							</div></li></ul></div></li><li class="listitem"><div class="para">
						<code class="command">IPTABLES_SAVE_ON_RESTART</code> — Saves current firewall rules when the firewall is restarted. This directive accepts the following values:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="command">yes</code> — Saves existing rules to <code class="filename">/etc/sysconfig/iptables</code> when the firewall is restarted, moving the previous version to the <code class="filename">/etc/sysconfig/iptables.save</code> file.
							</div></li><li class="listitem"><div class="para">
								<code class="command">no</code> — The default value. Does not save existing rules when the firewall is restarted.
							</div></li></ul></div></li><li class="listitem"><div class="para">
						<code class="command">IPTABLES_SAVE_COUNTER</code> — Saves and restores all packet and byte counters in all chains and rules. This directive accepts the following values:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="command">yes</code> — Saves the counter values.
							</div></li><li class="listitem"><div class="para">
								<code class="command">no</code> — The default value. Does not save the counter values.
							</div></li></ul></div></li><li class="listitem"><div class="para">
						<code class="command">IPTABLES_STATUS_NUMERIC</code> — Outputs IP addresses in numeric form instead of domain or hostnames. This directive accepts the following values:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="command">yes</code> — The default value. Returns only IP addresses within a status output.
							</div></li><li class="listitem"><div class="para">
								<code class="command">no</code> — Returns domain or hostnames within a status output.
							</div></li></ul></div></li></ul></div></div></div><div class="section" id="sect-Security_Guide-IPTables-IP_Sets"><div class="titlepage"><div><div><h4 class="title">2.8.9.5.&nbsp;IPTables and IP Sets</h4></div></div></div><div class="para">
			The <span class="application"><strong>ipset</strong></span> utility is used to administer <em class="firstterm">IP sets</em>
 in the Linux kernel. An IP set is a framework for storing IP addresses,
 port numbers, IP and MAC address pairs, or IP address and port number 
pairs. The sets are indexed in such a way that very fast matching can be
 made against a set even when the sets are very large. IP sets enable 
simpler and more manageable configurations as well as providing 
performance advantages when using <span class="application"><strong>iptables</strong></span>. The <span class="application"><strong>iptables</strong></span>
 matches and targets referring to sets create references which protect 
the given sets in the kernel. A set cannot be destroyed while there is a
 single reference pointing to it.
		</div><div class="para">
			The use of <span class="application"><strong>ipset</strong></span> enables <span class="application"><strong>iptables</strong></span> commands, such as those below, to be replaced by a set: 
<pre class="screen">~]# <code class="command">iptables -A INPUT -s 10.0.0.0/8 -j DROP</code>
~]# <code class="command">iptables -A INPUT -s 172.16.0.0/12 -j DROP</code>
~]# <code class="command">iptables -A INPUT -s 192.168.0.0/16 -j DROP</code></pre>
			 The set is created as follows: 
<pre class="screen">~]# <code class="command">ipset create my-block-set hash:net</code>
~]# <code class="command">ipset add my-block-set 10.0.0.0/8</code>
~]# <code class="command">ipset add my-block-set 172.16.0.0/12</code>
~]# <code class="command">ipset add my-block-set 192.168.0.0/16</code></pre>
			 The set is then referenced in an <span class="application"><strong>iptables</strong></span> command as follows: 
<pre class="screen">~]# <code class="command">iptables -A INPUT -m set --set my-block-set src -j DROP</code></pre>
			 If the set is used more than once a saving in configuration time is 
made. If the set contains many entries a saving in processing time is 
made.
		</div><div class="section" id="sect-Security_Guide-IPTables-Installing_ipset"><div class="titlepage"><div><div><h5 class="title">2.8.9.5.1.&nbsp;Installing ipset</h5></div></div></div><div class="para">
				To install the <span class="application"><strong>ipset</strong></span> utility, issue the following command as <code class="systemitem">root</code>: 
<pre class="screen">~]# <code class="command">yum install ipset</code></pre>
				 To see the usage message: 
<pre class="screen">~]$ <code class="command">ipset -h</code>
ipset v6.11

Usage: ipset [options] COMMAND</pre>

			</div></div><div class="section" id="sect-Security_Guide-IPTables-ipset_Commands"><div class="titlepage"><div><div><h5 class="title">2.8.9.5.2.&nbsp;ipset Commands</h5></div></div></div><div class="para">
				The format of the <span class="application"><strong>ipset</strong></span> command is as follows: <pre class="synopsis">ipset <em class="replaceable">[<span class="optional">options</span>] command [<span class="optional">command-options</span>]</em></pre> Where <em class="replaceable">command</em> is one of: <pre class="synopsis">create | add | del | test | destroy | list | save | restore | flush | rename | swap | help | version | - </pre> Allowed <em class="replaceable">options</em> are: <pre class="synopsis">-exist | -output [<span class="optional"> plain | save | xml </span>] | -quiet | -resolve | -sorted | -name | -terse</pre>
			</div><div class="para">
				The <code class="command">create</code> command is used to create a new data structure to store a set of IP data. The <code class="command">add</code> command adds new data to the set, the data added is referred to as an element of the set.
			</div><div class="para">
				The <code class="option">-exist</code> option suppresses error 
message if the element already exists, and it has a special role in 
updating a time out value. To change a time out, use the <code class="command">ipset add</code> command and specify all the data for the element again, changing only the time out value as required, and using the <code class="option">-exist</code> option.
			</div><div class="para">
				The <code class="option">test</code> option is for testing if the element already exists within a set.
			</div><div class="para">
				The format of the <code class="command">create</code> command is as follows: <pre class="synopsis">ipset create <em class="replaceable">set-name type-name [<span class="optional">create-options</span>]</em></pre> The <em class="replaceable">set-name</em> is a suitable name chosen by the user, the <em class="replaceable">type-name</em> is the name of the data structure used to store the data comprising the set. The format of the <em class="replaceable">type-name</em> is as follows: <pre class="synopsis">method:datatype[<span class="optional">,datatype[<span class="optional">,datatype</span>]</span>]</pre> The allowed methods for storing data are: <pre class="synopsis"> bitmap | hash | list </pre> The allowed data types are: <pre class="synopsis">ip | net | mac | port | iface </pre>
 When adding, deleting, or testing entries in a set, the same comma 
separated data syntax must be used for the data that makes up one entry,
 or element, in the set. For example: <pre class="synopsis">ipset add <em class="replaceable">set-name</em> <em class="replaceable">ipaddr</em>,<em class="replaceable">portnum</em>,<em class="replaceable">ipaddr</em></pre>
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					A set cannot contain <code class="systemitem">IPv4</code> and <code class="systemitem">IPv6</code> addresses at the same time. When a set is created it is bound to a family, <code class="literal">inet</code> for <code class="systemitem">IPv4</code> or <code class="literal">inet6</code> for <code class="systemitem">IPv6</code>, and the default is <code class="literal">inet</code>.
				</div></div></div><div class="example" id="ex-Security_Guide-IPTables-Create_an_IP_Set"><p class="title"><strong>Example&nbsp;2.3.&nbsp;Create an IP Set</strong></p><div class="example-contents"><div class="para">
					To create an IP set consisting of a source IP address, a port, and destination IP address, issue a command as follows: 
<pre class="screen">~]# <code class="command">ipset create my-set hash:ip,port,ip</code></pre>
					 Once the set is created, entries can be added as follows: 
<pre class="screen">~]# <code class="command">ipset add my-set 192.168.1.2,80,192.168.2.2</code>
~]# <code class="command">ipset add my-set 192.168.1.2,443,192.168.2.2</code></pre>

				</div></div></div><div class="para">
				The set types have the following optional parameters in common. They
 must be specified when the set is created in order for them to be used:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="option">timeout</code> — The value given with the <code class="command">create</code> command will be the default value for the set created. If a value is given with the <code class="command">add</code> command, it will be the initial non-default value for the element.
					</div></li></ul></div><div class="example" id="ex-Secuirty_Guide-IPTables-List_an_IP_Set"><p class="title"><strong>Example&nbsp;2.4.&nbsp;List an IP Set</strong></p><div class="example-contents"><div class="para">
					To list the contents of a specific IP Set, <code class="literal">my-set</code>, issue a command as follows:
				</div><pre class="screen">~]# <code class="command">ipset list my-set</code>
Name: my-set
Type: hash:ip,port,ip
Header: family inet hashsize 1024 maxelem 65536 
Size in memory: 8360
References: 0
Members:
192.168.1.2,tcp:80,192.168.2.2
192.168.1.2,tcp:443,192.168.2.2</pre><div class="para">
					Omit the set name to list all sets.
				</div></div></div><div class="example" id="ex-Security_Guide-IPTables-Test_the_Elements_of_an_IP_Set"><p class="title"><strong>Example&nbsp;2.5.&nbsp;Test the Elements of an IP Set</strong></p><div class="example-contents"><div class="para">
					Listing the contents of large sets is time consuming. You can test for the existence of an element as follows: 
<pre class="screen">~]# <code class="command">ipset test my-set 192.168.1.2,80,192.168.2.2</code>
192.168.1.2,tcp:80,192.168.2.2 is in set my-set.</pre>

				</div></div></div></div><div class="section" id="sect-Security_Guide-IPTables-IP_Set_Types"><div class="titlepage"><div><div><h5 class="title">2.8.9.5.3.&nbsp;IP Set Types</h5></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">bitmap:ip</span></dt><dd><div class="para">
							Stores an IPv4 host address, a network range, or an IPv4 network 
addresses with the prefix-length in CIDR notation if the <code class="option">netmask</code>
 option is used when the set is created. It can optionally store a 
timeout value, a counter value, and a comment. It can store up to <code class="literal">65536</code> entries. The command to create the <code class="literal">bitmap:ip</code> set has the following format: <pre class="synopsis">ipset create <em class="replaceable">set-name</em> range <em class="replaceable">start_ipaddr-end_ipaddr</em> |<em class="replaceable">ipaddr/prefix-length</em> [<span class="optional">netmask <em class="replaceable">prefix-length</em></span>] [<span class="optional">timeout <em class="replaceable">value</em></span>] [<span class="optional">counters</span>] [<span class="optional">comment</span>]</pre>
						</div></dd></dl></div><div class="example" id="ex-Security_Guide-IPTables-Create_an_IP_Set_for_a_Range_of_Addresses_Using_a_Prefix_Length"><p class="title"><strong>Example&nbsp;2.6.&nbsp;Create an IP Set for a Range of Addresses Using a Prefix Length</strong></p><div class="example-contents"><div class="para">
					To create an IP set for a range of addresses using a prefix length, make use of the <code class="literal">bitmap:ip</code> set type as follows: 
<pre class="screen">~]# <code class="command">ipset create my-range bitmap:ip range 192.168.33.0/28</code></pre>

				</div><div class="para">
					Once the set is created, entries can be added as follows: 
<pre class="screen">~]# <code class="command">ipset add my-range 192.168.33.1</code></pre>

				</div><div class="para">
					Review the members of the list: 
<pre class="screen">~]# <code class="command">ipset list my-range</code>
Name: my-range
Type: bitmap:ip
Header: range 192.168.33.0-192.168.33.15 
Size in memory: 84
References: 0
Members:
192.168.33.1</pre>

				</div><div class="para">
					To add a range of addresses: 
<pre class="screen">~]# <code class="command">ipset add my-range 192.168.33.2-192.168.33.4</code></pre>

				</div><div class="para">
					Review the members of the list: 
<pre class="screen">~]# <code class="command">ipset list my-range</code>
Name: my-range
Type: bitmap:ip
Header: range 192.168.33.0-192.168.33.15 
Size in memory: 84
References: 0
Members:
192.168.33.1
192.168.33.2
192.168.33.3
192.168.33.4</pre>

				</div></div></div><div class="example" id="ex-Security_Guide-IPTables-Create_an_IP_Set_for_a_Range_of_Addresses_Using_a_Netmask"><p class="title"><strong>Example&nbsp;2.7.&nbsp;Create an IP Set for a Range of Addresses Using a Netmask</strong></p><div class="example-contents"><div class="para">
					To create an IP set for a range of address using a netmask, make use of the <code class="literal">bitmap:ip</code> set type as follows: 
<pre class="screen">~]# <code class="command">ipset create my-big-range bitmap:ip range 192.168.124.0-192.168.126.0 netmask 24</code></pre>
					 Once the set is created, entries can be added as follows: 
<pre class="screen">~]# <code class="command">ipset add my-big-range 192.168.124.0</code></pre>

				</div><div class="para">
					If you attempt to add an address, the range containing that address will be added: 
<pre class="screen">~]# <code class="command">ipset add my-big-range 192.168.125.150</code>
~]# <code class="command">ipset list my-big-range</code>
Name: my-big-range
Type: bitmap:ip
Header: range 192.168.124.0-192.168.126.255 netmask 24 
Size in memory: 84
References: 0
Members:
192.168.124.0
192.168.125.0</pre>

				</div><div class="para">

				</div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">bitmap:ip,mac</span></dt><dd><div class="para">
							Stores an IPv4 address and a MAC address as a pair. It can store up to <code class="literal">65536</code> entries. <pre class="synopsis">ipset create <em class="replaceable">my-range</em> bitmap:ip,mac range <em class="replaceable">start_ipaddr-end_ipaddr</em> | <em class="replaceable">ipaddr/prefix-length</em> [<span class="optional">timeout <em class="replaceable">value</em> </span>] [<span class="optional">counters</span>] [<span class="optional">comment</span>]</pre>
						</div></dd></dl></div><div class="example" id="ex-Security_Guide-IPTables-Create_an_IP_Set_for_a_Range_of_MAC_Address_Pairs"><p class="title"><strong>Example&nbsp;2.8.&nbsp;Create an IP Set for a Range of IPv4 MAC Address Pairs</strong></p><div class="example-contents"><div class="para">
					To create an IP set for a range of IPv4 MAC address pairs, make use of the <code class="literal">bitmap:ip,mac</code> set type as follows: 
<pre class="screen">~]# <code class="command">ipset create my-range bitmap:ip,mac range 192.168.1.0/24</code></pre>
					 It is not necessary to specify a MAC address when creating the set.
				</div><div class="para">
					Once the set is created, entries can be added as follows: 
<pre class="screen">~]# <code class="command">ipset add my-range 192.168.1.1,12:34:56:78:9A:BC</code></pre>

				</div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">bitmap:port</span></dt><dd><div class="para">
							Stores a range of ports. It can store up to <code class="literal">65536</code> entries. <pre class="synopsis">ipset create <em class="replaceable">my-port-range</em> bitmap:port range <em class="replaceable">start_port-end_port</em> [<span class="optional">timeout <em class="replaceable">value</em> </span>] [<span class="optional">counters</span>] [<span class="optional">comment</span>]</pre>
						</div><div class="para">
							The set match and SET target netfilter kernel modules interpret 
the stored numbers as TCP or UDP port numbers. The protocol can 
optionally be specified together with the port. The <code class="option">proto</code> only needs to be specified if a service name is used, and that name does not exist as a TCP service.
						</div></dd></dl></div><div class="example" id="ex-Security_Guide-IPTables-Create_an_IP_Set_for_a_Range_of_Ports"><p class="title"><strong>Example&nbsp;2.9.&nbsp;Create an IP Set for a Range of Ports</strong></p><div class="example-contents"><div class="para">
					To create an IP set for a range of ports, make use of the <code class="literal">bitmap:port</code> set type as follows: 
<pre class="screen">~]# <code class="command">ipset create my-permitted-port-range bitmap:port range 1024-49151</code></pre>
					 Once the set is created, entries can be added as follows: 
<pre class="screen">~]# <code class="command">ipset add my-permitted-port-range 5060-5061</code></pre>

				</div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">hash:ip</span></dt><dd><div class="para">
							Stores a host or network address in the form of a hash. By 
default, an address specified without a network prefix length is a host 
address. The all-zero IP address cannot be stored. <pre class="synopsis">ipset create <em class="replaceable">my-addresses</em> hash:ip [<span class="optional">family[<span class="optional"> inet | inet6 </span>]</span>] [<span class="optional">hashsize <em class="replaceable">value</em></span>] [<span class="optional">maxelem <em class="replaceable">value</em> </span>] [<span class="optional">netmask <em class="replaceable">prefix-length</em></span>] [<span class="optional">timeout <em class="replaceable">value</em> </span>]</pre>
						</div><div class="para">
							The <code class="option">inet</code> family is the default, if <code class="option">family</code> is omitted addresses will be interpreted as IPv4 addresses. The <code class="option">hashsize</code> value is the initial hash size to use and defaults to <code class="literal">1024</code>. The <code class="option">maxelem</code> value is the maximum number of elements which can be stored in the set, it defaults to <code class="literal">65536</code>.
						</div><div class="para">
							The <span class="application"><strong>netfilter</strong></span> tool searches for a network prefix which is the most specific, it tries to find the smallest block of addresses that match.
						</div></dd></dl></div><div class="example" id="ex-Security_Guide-IPTables-Create_an_IP_Set_for_IP_Addresses"><p class="title"><strong>Example&nbsp;2.10.&nbsp;Create an IP Set for IP Addresses</strong></p><div class="example-contents"><div class="para">
					To create an IP set for IP addresses, make use of the <code class="literal">hash:ip</code> set type as follows: 
<pre class="screen">~]# <code class="command">ipset create my-addresses hash:ip</code></pre>
					 Once the set is created, entries can be added as follows: 
<pre class="screen">~]# <code class="command">ipset add my-addresses 10.10.10.0</code></pre>

				</div><div class="para">
					If additional options such as netmask and timeout are required, 
they must be specified when the set is created. For example: 
<pre class="screen">~]# <code class="command">ipset create my-busy-addresses hash:ip maxelem 24 netmask 28 timeout 100</code></pre>
					 The maxelem option restricts to total number of elements in the set, thus conserving memory space.
				</div><div class="para">
					The timeout option means that elements will only exist in the set for the number of seconds specified. For example: 
<pre class="screen">~]# <code class="command">ipset add my-busy-addresses timeout 100</code></pre>
					 The following output shows the time counting down: 
<pre class="screen">[root@rhel6 ~]# ipset add my-busy-addresses 192.168.60.0 timeout 100
[root@rhel6 ~]# ipset list my-busy-addresses
Name: my-busy-addresses
Type: hash:ip
Header: family inet hashsize 1024 maxelem 24 netmask 28 timeout 100 
Size in memory: 8300
References: 0
Members:
192.168.60.0 timeout <span class="bold bold"><strong>90</strong></span>
[root@rhel6 ~]# ipset list my-busy-addresses
Name: my-busy-addresses
Type: hash:ip
Header: family inet hashsize 1024 maxelem 24 netmask 28 timeout 100 
Size in memory: 8300
References: 0
Members:
192.168.60.0 timeout <span class="bold bold"><strong>83</strong></span></pre>
					 The element will be removed from the set when the timeout period ends.
				</div></div></div><div class="para">
				See the <code class="filename">ipset(8)</code> manual page for more examples.
			</div></div></div><div class="section" id="sect-Security_Guide-IPTables-IPTables_and_IPv6"><div class="titlepage"><div><div><h4 class="title">2.8.9.6.&nbsp;IPTables and IPv6</h4></div></div></div><div class="para">
			If the <code class="filename">iptables-ipv6</code> package is 
installed, netfilter in Red&nbsp;Hat Enterprise&nbsp;Linux can filter 
the next-generation IPv6 Internet protocol. The command used to 
manipulate the IPv6 netfilter is <code class="command">ip6tables</code>.
		</div><div class="para">
			Most directives for this command are identical to those used for <code class="command">iptables</code>, except the <code class="command">nat</code>
 table is not yet supported. This means that it is not yet possible to 
perform IPv6 network address translation tasks, such as masquerading and
 port forwarding.
		</div><div class="para">
			Rules for <code class="command">ip6tables</code> are saved in the <code class="filename">/etc/sysconfig/ip6tables</code> file. Previous rules saved by the <code class="command">ip6tables</code> initscripts are saved in the <code class="filename">/etc/sysconfig/ip6tables.save</code> file.
		</div><div class="para">
			Configuration options for the <code class="command">ip6tables</code> init script are stored in <code class="filename">/etc/sysconfig/ip6tables-config</code>, and the names for each directive vary slightly from their <code class="command">iptables</code> counterparts.
		</div><div class="para">
			For example, for the <code class="filename">iptables-config</code> directive <code class="command">IPTABLES_MODULES</code> the equivalent in the <code class="filename">ip6tables-config</code> file is <code class="command">IP6TABLES_MODULES</code>.
		</div></div><div class="section" id="sect-Security_Guide-Firewalls-Additional_Resources"><div class="titlepage"><div><div><h4 class="title">2.8.9.7.&nbsp;Additional Resources</h4></div></div></div><div class="para">
			There are several aspects to firewalls and the Linux Netfilter 
subsystem that could not be covered in this chapter. For more 
information, see the following resources.
		</div><div class="section" id="sect-Security_Guide-Additional_Resources-Useful_Firewall_Websites"><div class="titlepage"><div><div><h5 class="title">2.8.9.7.1.&nbsp;Useful Firewall Websites</h5></div></div></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<a href="http://www.netfilter.org/">http://www.netfilter.org/</a> — The home of the netfilter/iptables project. Contains assorted information about <code class="command">iptables</code>,
 including a FAQ addressing specific problems and various helpful guides
 by Rusty Russell, the Linux IP firewall maintainer. The HOWTO documents
 on the site cover subjects such as basic networking concepts, kernel 
packet filtering, and NAT configurations.
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.tldp.org/">http://www.tldp.org/</a> — The Linux Documentation Project contains several useful guides relating to firewall creation and administration.
					</div></li><li class="listitem"><div class="para">
						<a href="http://www.iana.org/assignments/port-numbers">http://www.iana.org/assignments/port-numbers</a> — The official list of registered and common service ports as assigned by the Internet Assigned Numbers Authority.
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Additional_Resources-Related_Documentation"><div class="titlepage"><div><div><h5 class="title">2.8.9.7.2.&nbsp;Related Documentation</h5></div></div></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<em class="citetitle">Red&nbsp;Hat Linux Firewalls</em>, by Bill 
McCarty; Red&nbsp;Hat Press — a comprehensive reference to building 
network and server firewalls using open source packet filtering 
technology such as Netfilter and <code class="command">iptables</code>. 
It includes topics that cover analyzing firewall logs, developing 
firewall rules, and customizing your firewall using various graphical 
tools.
					</div></li><li class="listitem"><div class="para">
						<em class="citetitle">Linux Firewalls</em>, by Robert Ziegler; New Riders Press — contains a wealth of information on building firewalls using both 2.2 kernel <code class="command">ipchains</code> as well as Netfilter and <code class="command">iptables</code>. Additional security topics such as remote access issues and intrusion detection systems are also covered.
					</div></li></ul></div></div><div class="section" id="sect-Security_Guide-Additional_Resources-Installed_IP_Tables_Documentation"><div class="titlepage"><div><div><h5 class="title">2.8.9.7.3.&nbsp;Installed IP Tables Documentation</h5></div></div></div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="command">man iptables</code> — Contains a description of <code class="command">iptables</code> as well as a comprehensive list of targets, options, and match extensions.
					</div></li></ul></div></div></div></div></div><div class="footnotes"><br><hr align="left" width="100"><div id="ftn.idm140226849288608" class="footnote"><div class="para"><a href="#idm140226849288608" class="para"><sup class="para">[3] </sup></a>
					Since system BIOSes differ between manufacturers, some may not 
support password protection of either type, while others may support one
 type but not the other.
				</div></div><div id="ftn.idm140226849314528" class="footnote"><div class="para"><a href="#idm140226849314528" class="para"><sup class="para">[4] </sup></a>
						GRUB also accepts unencrypted passwords, but it is recommended that an MD5 hash be used for added security.
					</div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Guide-Encryption" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;3.&nbsp;Encryption</h1></div></div></div><div class="para">
		There are two main types of data that must be protected: data at rest 
and data in motion. These different types of data are protected in 
similar ways using similar technology but the implementations can be 
completely different. No single protective implementation can prevent 
all possible methods of compromise as the same information may be at 
rest and in motion at different points in time.
	</div><div class="section" id="sect-Security_Guide-Encryption-Data_at_Rest"><div class="titlepage"><div><div><h2 class="title">3.1.&nbsp;Data at Rest</h2></div></div></div><div class="para">
			Data at rest is data that is stored on a hard drive, tape, CD, DVD, 
disk, or other media. This information's biggest threat comes from being
 physically stolen. Laptops in airports, CDs going through the mail, and
 backup tapes that get left in the wrong places are all examples of 
events where data can be compromised through theft. If the data is 
encrypted on the media, it lowers the chances of the data being 
accessed.
		</div><div class="section" id="sect-Security_Guide-Encryption-Protecting_Data_at_Rest-Full_Disk_Encryption"><div class="titlepage"><div><div><h3 class="title">3.1.1.&nbsp;Full Disk Encryption</h3></div></div></div><div class="para">
				Full disk or partition encryption is one of the best ways of 
protecting your data. Not only is each file protected but also the 
temporary storage that may contain parts of these files is also 
protected. Full disk encryption will protect all of your files so you do
 not have to worry about selecting what you want to protect and possibly
 missing a file.
			</div><div class="para">
				Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 natively supports LUKS 
Encryption. LUKS bulk encrypts your hard drive partitions so that while 
your computer is off, your data is protected. This will also protect 
your computer from attackers attempting to use single-user-mode to login
 to your computer or otherwise gain access.
			</div><div class="para">
				Full disk encryption solutions like LUKS only protect the data when 
your computer is off. Once the computer is on and LUKS has decrypted the
 disk, the files on that disk are available to anyone who would normally
 have access to them. To protect your files when the computer is on, use
 full disk encryption in combination with another solution such as file 
based encryption. Also remember to lock your computer whenever you are 
away from it. A passphrase protected screen saver set to activate after a
 few minutes of inactivity is a good way to keep intruders out. For more
 information on LUKS, see <a class="xref" href="#sect-Security_Guide-LUKS_Disk_Encryption">Section&nbsp;3.1.3, “LUKS Disk Encryption”</a>.
			</div></div><div class="section" id="sect-Security_Guide-Encryption-Protecting_Data_at_Rest-File_Based_Encryption"><div class="titlepage"><div><div><h3 class="title">3.1.2.&nbsp;File-Based Encryption</h3></div></div></div><div class="para">
				File-based encryption is used to protect the contents of files on 
mobile storage devices, such as CDs, flash drives, or external hard 
drives. Some file-based encryption solutions may leave remnants of the 
encrypted files that an attacker who has physical access to your 
computer can recover under some circumstances. To protect the contents 
of these files from attackers who may have access to your computer, use 
file-based encryption combined with another solution, such as full disk 
encryption.
			</div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-LUKS_Disk_Encryption" lang="en-US"><div class="titlepage"><div><div><h3 class="title">3.1.3.&nbsp;LUKS Disk Encryption</h3></div></div></div><div class="para">
		Linux Unified Key Setup-on-disk-format (or LUKS) allows you to encrypt
 partitions on your Linux computer. This is particularly important when 
it comes to mobile computers and removable media. LUKS allows multiple 
user keys to decrypt a master key which is used for the bulk encryption 
of the partition.
	</div><h4 id="idm140226864739008">Overview of LUKS</h4><div class="variablelist"><dl class="variablelist"><dt><span class="term">What LUKS does</span></dt><dd><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							LUKS encrypts entire block devices and is therefore well-suited 
for protecting the contents of mobile devices such as removable storage 
media or laptop disk drives.
						</div></li><li class="listitem"><div class="para">
							The underlying contents of the encrypted block device are arbitrary. This makes it useful for encrypting <code class="command">swap</code> devices. This can also be useful with certain databases that use specially formatted block devices for data storage.
						</div></li><li class="listitem"><div class="para">
							LUKS uses the existing device mapper kernel subsystem.
						</div></li><li class="listitem"><div class="para">
							LUKS provides passphrase strengthening which protects against dictionary attacks.
						</div></li><li class="listitem"><div class="para">
							LUKS devices contain multiple key slots, allowing users to add backup keys/passphrases.
						</div></li></ul></div></dd><dt><span class="term">What LUKS does <span class="emphasis"><em>not</em></span> do:</span></dt><dd><div class="para">
					<div class="itemizedlist"><ul><li class="listitem"><div class="para">
								LUKS is not well-suited for applications requiring many (more 
than eight) users to have distinct access keys to the same device.
							</div></li><li class="listitem"><div class="para">
								LUKS is not well-suited for applications requiring file-level encryption.
							</div></li></ul></div>

				</div></dd></dl></div><div class="section" id="sect-Security_Guide-LUKS_Disk_Encryption-LUKS_Implementation"><div class="titlepage"><div><div><h4 class="title">3.1.3.1.&nbsp;LUKS Implementation in Red&nbsp;Hat Enterprise&nbsp;Linux</h4></div></div></div><div class="para">
			Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 utilizes LUKS to perform 
file system encryption. By default, the option to encrypt the file 
system is unchecked during the installation. If you select the option to
 encrypt your hard drive, you will be prompted for a passphrase that 
will be asked every time you boot the computer. This passphrase 
"unlocks" the bulk encryption key that is used to decrypt your 
partition. If you choose to modify the default partition table you can 
choose which partitions you want to encrypt. This is set in the 
partition table settings.
		</div><div class="para">
			The default cipher used for LUKS (refer to <code class="command">cryptsetup --help</code>)
 is aes-cbc-essiv:sha256. Note that the installation program, Anaconda, 
uses by default the AES cipher in XTS mode, aes-xts-plain64. The default
 key size for LUKS is 256 bits. The default key size for LUKS with 
Anaconda (XTS mode) is 512 bits.
		</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				Changing the default cryptographic attributes can affect your 
system's performance and expose your system to various security risks. 
You should not change the default cryptographic attributes of your 
system without good knowledge of cryptography and understanding to the 
capabilities of the used cipher combinations.
			</div></div></div><div class="para">
			Red&nbsp;Hat strongly recommends using the default ciphers. If you 
need to use any other cipher than the cipher that is configured as the 
default, you can initialize your partition with the <code class="option">--cipher</code> and <code class="option">--key-size</code> options. The syntax of the command is the following:
		</div><pre class="screen"><code class="command">cryptsetup <code class="option">--verify-passphrase</code> <code class="option">--cipher</code> <em class="replaceable">&lt;cipher&gt;</em>-<em class="replaceable">&lt;mode&gt;</em>-<em class="replaceable">&lt;iv&gt;</em> <code class="option">--key-size</code> <em class="replaceable">&lt;key-size&gt;</em> luksFormat <em class="replaceable">&lt;device&gt;</em></code></pre><div class="para">
			where <em class="replaceable">&lt;cipher&gt;</em>-<em class="replaceable">&lt;mode&gt;</em>-<em class="replaceable">&lt;iv&gt;</em>
 is a string representing the used cipher. The string consists of three 
parts: a block cipher, block cipher mode, and an initial vector (IV).
		</div><div class="para">
			A block cipher is a deterministic algorithm that operates on data 
blocks and allows encryption and decryption of bulk data. Block ciphers 
that are available on Red&nbsp;Hat Enterprise&nbsp;Linux are:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					AES — Advanced Encryption Standard, a 128-bit symmetric block 
cipher using encryption keys with lengths of 128, 192, and 256 bits; for
 more information, see the <a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">FIPS PUB 197</a>.
				</div></li><li class="listitem"><div class="para">
					Twofish — A 128-bit block cipher operating with encryption keys of the range from 128 bits to 256 bits.
				</div></li><li class="listitem"><div class="para">
					Serpent — A 128-bit block cipher operating with 128-bit, 192-bit and 256-bit encryption keys.
				</div></li><li class="listitem"><div class="para">
					cast5 — A 64-bit Feistel cipher supporting encryption keys of the range from 40 to 128 bits; for more information, see the <a href="http://www.ietf.org/rfc/rfc2144.txt">RFC 2144</a>.
				</div></li><li class="listitem"><div class="para">
					cast6 — A 128-bit Feistel cipher using 128-bit, 160-bit, 192-bit, 
224-bit, or 256-bit encryption keys; for more information, see the <a href="http://www.ietf.org/rfc/rfc2612.txt">RFC 2612</a>.
				</div></li></ul></div><div class="para">
			Block cipher mode describes a way the block cipher is repeatedly 
applied on bulk data in order to encrypt or decrypt the data securely. 
The following modes can be used:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					CBC — Cipher Block Chaining; for more information, see the <a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST SP 800-38A</a>.
				</div></li><li class="listitem"><div class="para">
					XTS — XEX Tweakable Block Cipher with Ciphertext Stealing; for more information, see the IEEE 1619, or <a href="http://csrc.nist.gov/publications/nistpubs/800-38E/nist-sp-800-38E.pdf">NIST SP 800-38E</a>.
				</div></li><li class="listitem"><div class="para">
					CTR — Counter; for more information, see the <a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST SP 800-38A</a>.
				</div></li><li class="listitem"><div class="para">
					ECB — Electronic Codebook; for more information, see the <a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST SP 800-38A</a>.
				</div></li><li class="listitem"><div class="para">
					CFB — Cipher Feedback; for more information, see the <a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST SP 800-38A</a>.
				</div></li><li class="listitem"><div class="para">
					OFB — Output Feedback; for more information, see the <a href="http://csrc.nist.gov/publications/nistpubs/800-38a/sp800-38a.pdf">NIST SP 800-38A</a>.
				</div></li></ul></div><div class="para">
			An initial vector is a block of data used for ciphertext 
randomization. IV ensures that repeated encryption of the same plain 
text provides different ciphertext output. IV must not be reused with 
the same encryption key. For ciphers in CBC mode, IV <span class="bold bold"><strong>must be unpredictable</strong></span>, otherwise the system could become vulnerable to certain watermarking attacks (see <a href="http://code.google.com/p/cryptsetup/wiki/FrequentlyAskedQuestions">LUKS/cryptsetup FAQ</a> for more information). Red&nbsp;Hat recommends using the following IV with AES:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					ESSIV — Encrypted Salt-Sector Initialization Vector - This IV 
should be used for ciphers in CBC mode. You should use the default hash:
 sha256.
				</div></li><li class="listitem"><div class="para">
					plain64 (or plain) — IV sector offset - This IV should be used for ciphers in XTS mode.
				</div></li></ul></div><div class="para">
			You may also specify the length of the used encryption key. The size 
of the key depends on the used combination of the block cipher and block
 cipher mode. If you do not specify the key length, LUKS will use the 
default value for the given combination. For example: if you decide to 
use a 128-bit key for AES in CBC mode, LUKS will encrypt your partition 
using the AES-128 implementation, while specifying a 512-bit key for AES
 in XTS mode means that the AES-256 implementation will be used. Note 
that XTS mode operates with two keys, the first is determined for 
tweakable encryption and the second for regular encryption.
		</div></div><div class="section" id="sect-Security_Guide-LUKS_Disk_Encryption-Manually_Encrypting_Directories"><div class="titlepage"><div><div><h4 class="title">3.1.3.2.&nbsp;Manually Encrypting Directories</h4></div></div></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				Following this procedure will remove all data on the partition that 
you are encrypting. You WILL lose all your information! Make sure you 
backup your data to an external source before beginning this procedure!
			</div></div></div><div class="orderedlist"><ol><li class="listitem"><div class="para">
					Enter runlevel 1 by typing the following at a shell prompt as root:
				</div><pre class="screen"><code class="command">telinit 1</code></pre></li><li class="listitem"><div class="para">
					Unmount your existing <code class="systemitem">/home</code>:
				</div><pre class="screen"><code class="command">umount /home</code></pre></li><li class="listitem"><div class="para">
					If the command in the previous step fails, use <code class="command">fuser</code> to find processes hogging <code class="systemitem">/home</code> and kill them:
				</div><pre class="screen"><code class="command">fuser -mvk /home</code></pre></li><li class="listitem"><div class="para">
					Verify <code class="systemitem">/home</code> is no longer mounted:
				</div><pre class="screen"><code class="command">grep home /proc/mounts</code></pre></li><li class="listitem"><div class="para">
					Fill your partition with random data:
				</div><pre class="screen"><code class="command">shred -v --iterations=1 /dev/VG00/LV_home</code></pre><div class="para">
					This command proceeds at the sequential write speed of your device 
and may take some time to complete. It is an important step to ensure no
 unencrypted data is left on a used device, and to obfuscate the parts 
of the device that contain encrypted data as opposed to just random 
data.
				</div></li><li class="listitem"><div class="para">
					Initialize your partition:
				</div><pre class="screen"><code class="command">cryptsetup --verbose --verify-passphrase luksFormat /dev/VG00/LV_home</code></pre></li><li class="listitem"><div class="para">
					Open the newly encrypted device:
				</div><pre class="screen"><code class="command">cryptsetup luksOpen /dev/VG00/LV_home home</code></pre></li><li class="listitem"><div class="para">
					Make sure the device is present:
				</div><pre class="screen"><code class="command">ls -l /dev/mapper | grep home</code></pre></li><li class="listitem"><div class="para">
					Create a file system:
				</div><pre class="screen"><code class="command">mkfs.ext3 /dev/mapper/home</code></pre></li><li class="listitem"><div class="para">
					Mount the file system:
				</div><pre class="screen"><code class="command">mount /dev/mapper/home /home</code></pre></li><li class="listitem"><div class="para">
					Make sure the file system is visible:
				</div><pre class="screen"><code class="command">df -h | grep home</code></pre></li><li class="listitem"><div class="para">
					Add the following to the <code class="filename">/etc/crypttab</code> file:
				</div><pre class="programlisting">home /dev/VG00/LV_home none</pre></li><li class="listitem"><div class="para">
					Edit the <code class="filename">/etc/fstab</code> file, removing the old entry for <code class="systemitem">/home</code> and adding the following line:
				</div><pre class="programlisting">/dev/mapper/home /home ext3 defaults 1 2</pre></li><li class="listitem"><div class="para">
					Restore default SELinux security contexts:
				</div><pre class="screen"><code class="command">/sbin/restorecon -v -R /home</code></pre></li><li class="listitem"><div class="para">
					Reboot the machine:
				</div><pre class="screen"><code class="command">shutdown -r now</code></pre></li><li class="listitem"><div class="para">
					The entry in the <code class="filename">/etc/crypttab</code> makes your computer ask your <code class="code">luks</code> passphrase on boot.
				</div></li><li class="listitem"><div class="para">
					Log in as root and restore your backup.
				</div></li></ol></div><div class="para">
			You now have an encrypted partition for all of your data to safely rest while the computer is off.
		</div></div><div class="section" id="sect-Security_Guide-LUKS_Disk_Encryption-Adding-New-Passphrase"><div class="titlepage"><div><div><h4 class="title">3.1.3.3.&nbsp;Adding a New Passphrase to an Existing Device</h4></div></div></div><div class="para">
			Use the following command to add a new passphrase to an existing device:
		</div><pre class="programlisting"><code class="command">cryptsetup luksAddKey &lt;device&gt;</code></pre><div class="para">
			After being prompted for any one of the existing passprases for 
authentication, you will be prompted to enter the new passphrase.
		</div></div><div class="section" id="sect-Security_Guide-LUKS_Disk_Encryption-Removing-Passphrase"><div class="titlepage"><div><div><h4 class="title">3.1.3.4.&nbsp;Removing a Passphrase from an Existing Device</h4></div></div></div><div class="para">
			Use the following command to remove a passphrase from an existing device:
		</div><pre class="programlisting"><code class="command">cryptsetup luksRemoveKey &lt;device&gt;</code></pre><div class="para">
			You will be prompted for the passphrase you want to remove and then 
for any one of the remaining passphrases for authentication.
		</div></div><div class="section" id="encrypt_during_installation_proccess"><div class="titlepage"><div><div><h4 class="title">3.1.3.5.&nbsp;Creating Encrypted Block Devices in Anaconda </h4></div></div></div><div class="para">
			You can create encrypted devices during system installation. This 
allows you to easily configure a system with encrypted partitions.
		</div><div class="para">
			To enable block device encryption, check the <span class="guilabel"><strong>Encrypt System</strong></span> check box when selecting automatic partitioning or the <span class="guilabel"><strong>Encrypt</strong></span>
 check box when creating an individual partition, software RAID array, 
or logical volume. After you finish partitioning, you will be prompted 
for an encryption passphrase. This passphrase will be required to access
 the encrypted devices. If you have pre-existing LUKS devices and 
provided correct passphrases for them earlier in the install process the
 passphrase entry dialog will also contain a check box. Checking this 
check box indicates that you would like the new passphrase to be added 
to an available slot in each of the pre-existing encrypted block 
devices.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Checking the <span class="guilabel"><strong>Encrypt System</strong></span> check box on the <span class="guilabel"><strong>Automatic Partitioning</strong></span> screen and then choosing <span class="guilabel"><strong>Create custom layout</strong></span> does not cause any block devices to be encrypted automatically.
			</div></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				You can use a <code class="command">kickstart</code> file to set a 
separate passphrase for each new encrypted block device. Also, kickstart
 allows you to specify a different type of encryption if the Anaconda 
default cipher, aes-xts-plain64, does not suit you. In dependencies on a
 device you want to encrypt, you can specify the <code class="option">--cipher=<em class="replaceable">&lt;cipher-string&gt;</em></code> along with the <code class="command">autopart</code>, <code class="command">part</code>, <code class="command">partition</code>, <code class="command">logvol</code>, and <code class="command">raid</code> directives. This option has to be used together with the <code class="option">--encrypted</code> option, otherwise it has no effect. For more information about the <em class="replaceable">&lt;cipher-string&gt;</em> format and possible cipher combinations, see <a class="xref" href="#sect-Security_Guide-LUKS_Disk_Encryption-LUKS_Implementation">Section&nbsp;3.1.3.1, “LUKS Implementation in Red&nbsp;Hat Enterprise&nbsp;Linux”</a>. For more information about kickstart configuration, see the <a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Installation_Guide/index.html">Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 Installation Guide</a>.
			</div></div></div></div><div class="section" id="sect-Security_Guide-LUKS_Disk_Encryption-Links_of_Interest"><div class="titlepage"><div><div><h4 class="title">3.1.3.6.&nbsp;Additional Resources</h4></div></div></div><div class="para">
			For additional information on LUKS or encrypting hard drives under 
Red&nbsp;Hat Enterprise&nbsp;Linux, visit one of the following links:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a href="http://code.google.com/p/cryptsetup/">LUKS home page</a>
				</div></li><li class="listitem"><div class="para">
					<a href="http://code.google.com/p/cryptsetup/wiki/FrequentlyAskedQuestions">LUKS/cryptsetup FAQ</a>
				</div></li><li class="listitem"><div class="para">
					<a href="http://en.wikipedia.org/wiki/Linux_Unified_Key_Setup">LUKS - Linux Unified Key Setup Wikipedia Article</a>
				</div></li><li class="listitem"><div class="para">
					<a href="https://bugzilla.redhat.com/attachment.cgi?id=161912">HOWTO: Creating an encrypted Physical Volume (PV) using a second hard drive and pvmove</a>
				</div></li></ul></div></div></div></div><div class="section" id="sect-Security_Guide-Encryption-Data_in_Motion"><div class="titlepage"><div><div><h2 class="title">3.2.&nbsp;Data in Motion</h2></div></div></div><div class="para">
			Data in motion is data that is being transmitted over a network. The 
biggest threats to data in motion are interception and alteration. Your 
user name and password should never be transmitted over a network 
without protection as it could be intercepted and used by someone else 
to impersonate you or gain access to sensitive information. Encrypting 
the network session ensures a higher security level for data in motion.
		</div><div class="para">
			Data in motion is particularly vulnerable to attackers because the 
attacker does not have to be near the computer in which the data is 
being stored rather they only have to be somewhere along the path. 
Encryption tunnels can protect data along the path of communications.
		</div><div class="section" id="sect-Security_Guide-Encryption-Data_in_Motion-Virtual_Private_Networks"><div class="titlepage"><div><div><h3 class="title">3.2.1.&nbsp;Virtual Private Networks</h3></div></div></div><div class="para">
				Virtual Private Networks (VPN) provide encrypted tunnels between 
computers or networks of computers across all ports. With a VPN in 
place, all network traffic from the client is forwarded to the server 
through the encrypted tunnel. This means that the client is logically on
 the same network as the server it is connected to via the VPN. VPNs are
 very common and are simple to use and setup.
			</div></div><div class="section" id="sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell"><div class="titlepage"><div><div><h3 class="title">3.2.2.&nbsp;Secure Shell</h3></div></div></div><div class="para">
				<em class="firstterm">Secure Shell</em> (<acronym class="acronym">SSH</acronym>) is a powerful network protocol used to communicate with another system over a secure channel. The transmissions over <code class="systemitem">SSH</code>
 are encrypted and protected from interception. Cryptographic login can 
also be utilized to provide a better authentication method over 
traditional user names and passwords. See <a class="xref" href="#sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell-Cryptographic_Login">Section&nbsp;3.2.2.1, “Cryptographic Login”</a>.
			</div><div class="para">
				<code class="systemitem">SSH</code> is very easy to activate. By starting the <code class="systemitem">sshd</code>
 daemon, the system begins to accept connections and will allow access 
to the system when a correct user name and password is provided during 
the connection process. The standard <code class="systemitem">TCP</code> port for the <code class="systemitem">SSH</code> service is <code class="literal">22</code>. However, this can be changed by modifying the <code class="filename">/etc/ssh/sshd_config</code> configuration file and restarting the service. This file also contains other configuration options for <code class="systemitem">SSH</code>.
			</div><div class="para">
				By default, the <code class="systemitem">sshd</code> service starts automatically at boot time. Run the following command as <code class="systemitem">root</code> to query the status of the daemon:
			</div><pre class="screen">~]#&nbsp;<code class="command">service sshd status</code></pre><div class="para">
				If you need to restart the <code class="systemitem">sshd</code> service, issue the following command as <code class="systemitem">root</code>:
			</div><pre class="screen">~]#&nbsp;<code class="command">service sshd restart</code></pre><div class="para">
				Refer to the <em class="citetitle">Services and Daemons</em> chapter of the <a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html-single/Deployment_Guide/">Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 Deployment Guide</a> for more information regarding the management of system services.
			</div><div class="para">
				Secure Shell (<acronym class="acronym">SSH</acronym>) also provides encrypted tunnels between computers but only using a single port. Port forwarding can be done over an <code class="systemitem">SSH</code> tunnel and traffic will be encrypted as it passes through that tunnel, but using port forwarding is not as fluid as a <acronym class="acronym">VPN</acronym> (<a class="xref" href="#sect-Security_Guide-Encryption-Data_in_Motion-Virtual_Private_Networks">Section&nbsp;3.2.1, “Virtual Private Networks”</a>).
			</div><div class="section" id="sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell-Cryptographic_Login"><div class="titlepage"><div><div><h4 class="title">3.2.2.1.&nbsp;Cryptographic Login</h4></div></div></div><div class="para">
					<code class="systemitem">SSH</code> supports the use of 
cryptographic keys for logging in to computers. This is much more secure
 than using only a password. If you combine this method with other 
authentication methods, it can be considered a multi-factor 
authentication. See <a class="xref" href="#sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell-Multi_Auth_Methods">Section&nbsp;3.2.2.2, “Multiple Authentication Methods”</a> for more information about using multiple authentication methods.
				</div><div class="para">
					In order to enable the use of cryptographic keys for authentication, the <code class="option">PubkeyAuthentication</code> configuration directive in the <code class="filename">/etc/ssh/sshd_config</code> file needs to be set to <code class="literal">yes</code>. Note that this is the default setting. Set the <code class="option">PasswordAuthentication</code> directive to <code class="literal">no</code> to disable the possibility of using passwords for logging in.
				</div><div class="para">
					<code class="systemitem">SSH</code> keys can be generated using the <code class="command">ssh-keygen</code> command. If invoked without additional arguments, it creates a 2048-bit <acronym class="acronym">RSA</acronym> key set. The keys are stored, by default, in the <code class="filename">~/.ssh</code> directory. You can utilize the <code class="option">-b</code> switch to modify the bit-strength of the key. Using 2048-bit keys is normally sufficient. See the <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html-single/Deployment_Guide/#s3-ssh-configuration-keypairs-generating">Generating Key Pairs</a> chapter of the Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 Deployment Guide for more detailed information about generating <code class="systemitem">SSH</code> keys.
				</div><div class="para">
					You should see the two keys in your <code class="filename">~/.ssh</code> directory. If you accepted the defaults when running the <code class="command">ssh-keygen</code> command, then the generated files are named <code class="filename">id_rsa</code> and <code class="filename">id_rsa.pub</code>
 and contain the private and public key respectively. You should always 
protect the private key from exposure by making it unreadable by anyone 
else but the file's owner. The public key, however, needs to be 
transferred to the system you are going to log in to. You can use the <code class="command">ssh-copy-id</code> command to transfer the key to the server:
				</div><pre class="screen">~]$&nbsp;ssh-copy-id -i <em class="replaceable">[<span class="optional">user@</span>]server</em></pre><div class="para">
					This command will also automatically append the public key to the <code class="filename">~/.ssh/authorized_key</code> file on the <em class="replaceable">server</em>. The <code class="systemitem">sshd</code> daemon will check this file when you attempt to log in to the server.
				</div><div class="para">
					Similarly to passwords and any other authentication mechanism, you should change your <code class="systemitem">SSH</code> keys regularly. When you do, make sure you remove any unused keys from the <code class="filename">authorized_key</code> file.
				</div></div><div class="section" id="sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell-Multi_Auth_Methods"><div class="titlepage"><div><div><h4 class="title">3.2.2.2.&nbsp;Multiple Authentication Methods</h4></div></div></div><div class="para">
					Using multiple authentication methods, or multi-factor 
authentication, increases the level of protection against unauthorized 
access, and as such should be considered when hardening a system to 
prevent it from being compromised. Users attempting to log in to a 
system that uses multi-factor authentication must successfully complete 
all specified authentication methods in order to be granted access.
				</div><div class="para">
					Use the <code class="option">AuthenticationMethods</code> configuration directive in the <code class="filename">/etc/ssh/sshd_config</code>
 file to specify which authentication methods are to be utilized. Note 
that it is possible to define more than one list of required 
authentication methods using this directive. If that is the case, the 
user must complete every method in at least one of the lists. The lists 
need to be separated by blank spaces, and the individual 
authentication-method names within the lists must be comma-separated. 
For example:
				</div><pre class="screen">AuthenticationMethods publickey,gssapi-with-mic publickey,keyboard-interactive</pre><div class="para">
					An <code class="systemitem">sshd</code> daemon configured using the above <code class="option">AuthenticationMethods</code> directive only grants access if the user attempting to log in successfully completes either <code class="literal">publickey</code> authentication followed by <code class="literal">gssapi-with-mic</code> or by <code class="literal">keyboard-interactive</code>
 authentication. Note that each of the requested authentication methods 
needs to be explicitly enabled using a corresponding configuration 
directive (such as <code class="option">PubkeyAuthentication</code>) in the <code class="filename">/etc/ssh/sshd_config</code> file. Refer to the <em class="citetitle">AUTHENTICATION</em> section of <code class="command">ssh(1)</code> for a general list of available authentication methods.
				</div></div><div class="section" id="sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell-Other_Ways"><div class="titlepage"><div><div><h4 class="title">3.2.2.3.&nbsp;Other Ways of Securing SSH</h4></div></div></div><h5 id="idm140226871442304">Protocol Version</h5><div class="para">
					Even though the implementation of the <code class="systemitem">SSH</code>
 protocol supplied with Red&nbsp;Hat Enterprise&nbsp;Linux supports both
 the SSH-1 and SSH-2 versions of the protocol, only the latter should be
 used whenever possible. The SSH-2 version contains a number of 
improvements over the older SSH-1, and the majority of advanced 
configuration options is only available when using SSH-2.
				</div><div class="para">
					Users are encouraged to make use of SSH-2 in order to maximize the extent to which the <code class="systemitem">SSH</code>
 protocol protects the authentication and communication for which it is 
used. The version or versions of the protocol supported by the <code class="systemitem">sshd</code> daemon can be specified using the <code class="option">Protocol</code> configuration directive in the <code class="filename">/etc/ssh/sshd_config</code> file. The default setting is&nbsp;<code class="literal">2</code>.
				</div><h5 id="idm140226876472688">Key Types</h5><div class="para">
					While the <code class="command">ssh-keygen</code> command generates a pair of SSH-2 <acronym class="acronym">RSA</acronym> keys by default, using the <code class="option">-t</code> option, it can be instructed to generate <acronym class="acronym">DSA</acronym> or <acronym class="acronym">ECDSA</acronym> keys as well. The <acronym class="acronym">ECDSA</acronym>
 (Elliptic Curve Digital Signature Algorithm) offers better performance 
at the same symmetric key length. It also generates shorter keys.
				</div><h5 id="idm140226865331520">Non-Default Port</h5><div class="para">
					By default, the <code class="systemitem">sshd</code> daemon listens on the <code class="literal">22</code>
 network port. Changing the port reduces the exposure of the system to 
attacks based on automated network scanning, thus increasing security 
through obscurity. The port can be specified using the <code class="option">Port</code> directive in the <code class="filename">/etc/ssh/sshd_config</code>
 configuration file. Note also that the default SELinux policy must be 
changed to allow for the use of a non-default port. You can do this by 
modifying the <code class="option">ssh_port_t</code> SELinux type by typing the following command as <code class="systemitem">root</code>:
				</div><pre class="screen">~]#&nbsp;<code class="command">semanage -a -t ssh_port_t -p tcp <em class="replaceable">port_number</em></code></pre><div class="para">
					In the above command, replace <em class="replaceable">port_number</em> with the new port number specified using the <code class="option">Port</code> directive.
				</div><h5 id="idm140226877185264">No Root Login</h5><div class="para">
					Provided that your particular use case does not require the possibility of logging in as the <code class="systemitem">root</code> user, you should consider setting the <code class="option">PermitRootLogin</code> configuration directive to <code class="literal">no</code> in the <code class="filename">/etc/ssh/sshd_config</code> file. By disabling the possibility of logging in as the <code class="systemitem">root</code> user, the administrator can audit which user runs what privileged command after they log in as regular users and then gain <code class="systemitem">root</code> rights.
				</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
						This section draws attention to the most common ways of securing an <code class="systemitem">SSH</code> setup. By no means should this list of suggested measures be considered exhaustive or definitive. Refer to <code class="command">sshd_config(5)</code> for a description of all configuration directives available for modifying the behavior of the <code class="systemitem">sshd</code> daemon and to <code class="command">ssh(1)</code> for an explanation of basic <code class="systemitem">SSH</code> concepts.
					</div></div></div></div></div></div><div class="section" id="sect-Security_Guide-Encryption-OpenSSL_Intel_AES-NI_Engine"><div class="titlepage"><div><div><h2 class="title">3.3.&nbsp;OpenSSL Intel AES-NI Engine</h2></div></div></div><div class="para">
			The Intel Advanced Encryption Standard (AES) New Instructions 
(AES-NI) engine is available for certain Intel processors, and allows 
for extremely fast hardware encryption and decryption.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				For a list of Intel processors that support the AES-NI engine, see: <a href="http://ark.intel.com/search/advanced/?s=t&amp;AESTech=true">Intel's ARK</a>.
			</div></div></div><div class="para">
			The AES-NI engine is automatically enabled if the detected processor 
is among the supported ones. To check that the processor is supported, 
follow the steps below:
		</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					Ensure that the processor has the AES instruction set:
				</div><pre class="screen">~]# <code class="command">grep -m1 -o aes /proc/cpuinfo</code>
aes
</pre></li><li class="step"><div class="para">
					As root, run the following commands and compare their outputs. 
Significantly better performance of the latter command indicates that 
AES-NI is enabled. Note that the outputs below are shortened for 
brevity:
				</div><pre class="screen">~]# <code class="command">openssl speed aes-128-cbc</code>
The 'numbers' are in 1000s of bytes per second processed.
type             16 bytes     64 bytes    256 bytes   1024 bytes   8192 bytes
aes-128 cbc      99696.17k   107792.98k   109961.22k   110559.91k   110742.19k
</pre><pre class="screen">~]# <code class="command">openssl speed -evp aes-128-cbc</code>
The 'numbers' are in 1000s of bytes per second processed.
type             16 bytes     64 bytes    256 bytes   1024 bytes   8192 bytes
aes-128-cbc     800450.23k   873269.82k   896864.85k   903446.19k   902752.94k
</pre></li></ol></div><div class="para">
			To test the speed of OpenSSH you can run a command like the following:
		</div><pre class="screen">~]# <code class="command">dd if=/dev/zero count=100 bs=1M | ssh -c aes128-cbc localhost "cat &gt;/dev/null"</code>
root@localhost's password: 
100+0 records in
100+0 records out
104857600 bytes (105 MB) copied, 4.81868 s, 21.8 MB/s
</pre><div class="para">
			See <a href="http://software.intel.com/en-us/articles/intel-advanced-encryption-standard-instructions-aes-ni/">Intel® Advanced Encryption Standard Instructions (AES-NI)</a> for details about the AES-NI engine.
		</div></div><div class="section" id="sect-Security_Guide-Encryption-Using_the_Random_Number_Generator"><div class="titlepage"><div><div><h2 class="title">3.4.&nbsp;Using the Random Number Generator</h2></div></div></div><div class="para">
			In order to be able to generate secure cryptographic keys that cannot
 be easily broken, a source of random numbers is required. Generally, 
the more random the numbers are, the better the chance of obtaining 
unique keys. <em class="firstterm">Entropy</em> for generating random numbers is usually obtained from computing environmental “noise” or using a hardware <em class="firstterm">random number generator</em>.
		</div><div class="para">
			The <code class="systemitem">rngd</code> daemon, which is a part of the <span class="package">rng-tools</span>
 package, is capable of using both environmental noise and hardware 
random number generators for extracting entropy. The daemon checks 
whether the data supplied by the source of randomness is sufficiently 
random and then stores it in the kernel's random-number entropy pool. 
The random numbers it generates are made available through the <code class="filename">/dev/random</code> and <code class="filename">/dev/urandom</code> character devices.
		</div><div class="para">
			The difference between <code class="filename">/dev/random</code> and <code class="filename">/dev/urandom</code>
 is that the former is a blocking device, which means it stops supplying
 numbers when it determines that the amount of entropy is insufficient 
for generating a properly random output. Conversely, <code class="filename">/dev/urandom</code>
 is a non-blocking source, which reuses the kernel's entropy pool and is
 thus able to provide an unlimited supply of pseudo-random numbers, 
albeit with less entropy. As such, <code class="filename">/dev/urandom</code> should not be used for creating long-term cryptographic keys.
		</div><div class="para">
			To install the <span class="package">rng-tools</span> package, issue the following command as the <code class="systemitem">root</code> user:
		</div><pre class="screen">~]# <code class="command">yum install rng-tools</code></pre><div class="para">
			To start the <code class="systemitem">rngd</code> daemon, execute the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]# <code class="command">service rngd start</code></pre><div class="para">
			To query the status of the daemon, use the following command:
		</div><pre class="screen">~]# <code class="command">service rngd status</code></pre><div class="para">
			To start the <code class="systemitem">rngd</code> daemon with 
optional parameters, execute it directly. For example, to specify an 
alternative source of random-number input (other than <code class="filename">/dev/hwrandom</code>), use the following command:
		</div><pre class="screen">~]# <code class="command">rngd --rng-device=<em class="replaceable">/dev/hwrng</em></code></pre><div class="para">
			The above command starts the <code class="systemitem">rngd</code> daemon with <code class="filename">/dev/hwrng</code> as the device from which random numbers are read. Similarly, you can use the <code class="option">-o</code> (or <code class="option">--random-device</code>) option to choose the kernel device for random-number output (other than the default <code class="filename">/dev/random</code>). See the <span class="citerefentry"><span class="refentrytitle">rngd</span>(8)</span> manual page for a list of all available options.
		</div><div class="para">
			The <span class="package">rng-tools</span> package also contains the <span class="application"><strong>rngtest</strong></span> utility, which can be used to check the randomness of data. To test the level of randomness of the output of <code class="filename">/dev/random</code>, use the <span class="application"><strong>rngtest</strong></span> tool as follows:
		</div><pre class="screen">~]$ <code class="command">cat /dev/random | rngtest -c 1000</code>
rngtest 2
Copyright (c) 2004 by Henrique de Moraes Holschuh
This is free software; see the source for copying conditions.  There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

rngtest: starting FIPS tests...
rngtest: bits received from input: 20000032
rngtest: FIPS 140-2 successes: 1000
rngtest: FIPS 140-2 failures: 0
rngtest: FIPS 140-2(2001-10-10) Monobit: 0
rngtest: FIPS 140-2(2001-10-10) Poker: 0
rngtest: FIPS 140-2(2001-10-10) Runs: 0
rngtest: FIPS 140-2(2001-10-10) Long run: 1
rngtest: FIPS 140-2(2001-10-10) Continuous run: 0
rngtest: input channel speed: (min=308.697; avg=623.670; max=730.823)Kibits/s
rngtest: FIPS tests speed: (min=51.971; avg=137.737; max=167.311)Mibits/s
rngtest: Program run time: 31461595 microseconds</pre><div class="para">
			A high number of failures shown in the output of the <span class="application"><strong>rngtest</strong></span> tool indicates that the randomness of the tested data is sub-optimal and should not be relied upon. See the <span class="citerefentry"><span class="refentrytitle">rngtest</span>(1)</span> manual page for a list of options available for the <span class="application"><strong>rngtest</strong></span> utility.
		</div></div><div xml:lang="en-US" class="section" id="sect-Security_Guide-Encryption-GPG" lang="en-US"><div class="titlepage"><div><div><h2 class="title">3.5.&nbsp;GNU Privacy Guard (GPG)</h2></div></div></div><div class="para">
		GnuPG (GPG) is an open source version of PGP that allows you to sign 
and and also encrypt a file or an email message. This is useful to 
maintain integrity of the message or file and also protects the 
confidentiality of the information contained within the file or email. 
In the case of email, GPG provides dual protection. Not only can it 
provide Data at Rest protection but also Data in Motion protection once 
the message has been sent across the network. Refer to <a class="xref" href="#sect-Security_Guide-Encryption-Data_at_Rest">Section&nbsp;3.1, “Data at Rest”</a> and <a class="xref" href="#sect-Security_Guide-Encryption-Data_in_Motion">Section&nbsp;3.2, “Data in Motion”</a> for more information about these concepts.
	</div><div class="para">
		GPG is used to identify yourself and authenticate your communications,
 including those with people you do not know. GPG allows anyone reading a
 GPG-signed email to verify its authenticity. In other words, GPG allows
 someone to be reasonably certain that communications signed by you 
actually are from you. GPG is useful because it helps prevent third 
parties from altering code or intercepting conversations and altering 
the message.
	</div><div class="section" id="sect-Security_Guide-Encryption-GPG-Keys_in_GNOME"><div class="titlepage"><div><div><h3 class="title">3.5.1.&nbsp;Creating GPG Keys in GNOME</h3></div></div></div><div class="para">
			To create a GPG Key in GNOME, follow these steps:
		</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					Install the <span class="application"><strong>Seahorse</strong></span> utility, which makes GPG key management easier:
				</div><pre class="screen">~]#&nbsp;<code class="command">yum install seahorse</code></pre></li><li class="step"><div class="para">
					To create a key, from the <span class="guimenuitem"><strong>Applications</strong></span> → <span class="guimenuitem"><strong>Accessories</strong></span> menu select <span class="guimenuitem"><strong>Passwords and Encryption Keys</strong></span>, which starts the application <span class="application"><strong>Seahorse</strong></span>.
				</div></li><li class="step"><div class="para">
					From the <span class="guimenu"><strong>File</strong></span> menu select <span class="guimenuitem"><strong>New</strong></span> and then <span class="guilabel"><strong>PGP Key</strong></span>. Then click <span class="guibutton"><strong>Continue</strong></span>.
				</div></li><li class="step"><div class="para">
					Type your full name, email address, and an optional comment 
describing who you are (for example: John C. Smith, jsmith@example.com, 
Software Engineer). Click <span class="guibutton"><strong>Create</strong></span>. A dialog is displayed asking for a passphrase for the key. Choose a strong passphrase but also easy to remember. Click <span class="guibutton"><strong>OK</strong></span> and the key is created.
				</div></li></ol></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				If you forget your passphrase, you will not be able to decrypt the data.
			</div></div></div><div class="para">
			To find your GPG key ID, look in the <span class="guilabel"><strong>Key ID</strong></span> column next to the newly created key. In most cases, if you are asked for the key ID, prepend <code class="literal">0x</code> to the key ID, as in <code class="literal">0x6789ABCD</code>. You should make a backup of your private key and store it somewhere secure.
		</div></div><div class="section" id="sect-Security_Guide-Encryption-GPG-Creating_GPG_Keys_in_KDE"><div class="titlepage"><div><div><h3 class="title">3.5.2.&nbsp;Creating GPG Keys in KDE</h3></div></div></div><div class="para">
			To create a GPG Key in KDE, follow these steps:
		</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					Start the KGpg program from the main menu by selecting <span class="guimenuitem"><strong>Applications</strong></span> → <span class="guimenuitem"><strong>Utilities</strong></span> → <span class="guimenuitem"><strong>Encryption Tool</strong></span>. If you have never used KGpg before, the program walks you through the process of creating your own GPG keypair.
				</div></li><li class="step"><div class="para">
					A dialog box appears prompting you to create a new key pair. Enter 
your name, email address, and an optional comment. You can also choose 
an expiration time for your key, as well as the key strength (number of 
bits) and algorithms.
				</div></li><li class="step"><div class="para">
					Enter your passphrase in the next dialog box. At this point, your key appears in the main <code class="code">KGpg</code> window.
				</div></li></ol></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				If you forget your passphrase, you will not be able to decrypt the data.
			</div></div></div><div class="para">
			To find your GPG key ID, look in the <span class="guilabel"><strong>Key ID</strong></span> column next to the newly created key. In most cases, if you are asked for the key ID, prepend <code class="literal">0x</code> to the key ID, as in <code class="literal">0x6789ABCD</code>. You should make a backup of your private key and store it somewhere secure.
		</div></div><div class="section" id="sect-Security_Guide-Encryption-GPG-Creating_GPG_Keys_using_the_Command_Line"><div class="titlepage"><div><div><h3 class="title">3.5.3.&nbsp;Creating GPG Keys Using the Command Line</h3></div></div></div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					Use the following shell command:
				</div><pre class="screen">~]$ <code class="command">gpg2 --gen-key</code></pre><div class="para">
					This command generates a key pair that consists of a public and a 
private key. Other people use your public key to authenticate and/or 
decrypt your communications. Distribute your public key as widely as 
possible, especially to people who you know will want to receive 
authentic communications from you, such as a mailing list.
				</div></li><li class="step"><div class="para">
					A series of prompts directs you through the process. Press the <span class="guilabel"><strong>Enter</strong></span> key to assign a default value if desired. The first prompt asks you to select what kind of key you prefer:
				</div><pre class="screen">Please select what kind of key you want:
(1) RSA and RSA (default)
(2) DSA and Elgamal
(3) DSA (sign only)
(4) RSA (sign only)
Your selection?
</pre><div class="para">
					In almost all cases, the default is the correct choice. An RSA/RSA 
key allows you not only to sign communications, but also to encrypt 
files.
				</div></li><li class="step"><div class="para">
					Choose the key size:
				</div><pre class="screen">RSA keys may be between 1024 and 4096 bits long.
What keysize do you want? (2048)
</pre><div class="para">
					Again, the default, 2048, is sufficient for almost all users and represents an extremely strong level of security.
				</div></li><li class="step"><div class="para">
					Choose when the key will expire. It is a good idea to choose an expiration date instead of using the default, which is <code class="literal">none</code>.
 If, for example, the email address on the key becomes invalid, an 
expiration date will remind others to stop using that public key.
				</div><pre class="screen">Please specify how long the key should be valid.
0 = key does not expire
d = key expires in n days
w = key expires in n weeks
m = key expires in n months
y = key expires in n years
key is valid for? (0)
</pre><div class="para">
					Entering a value of <span class="application"><strong>1y</strong></span>,
 for example, makes the key valid for one year. (You may change this 
expiration date after the key is generated, if you change your mind.)
				</div></li><li class="step"><div class="para">
					Before the <span class="application"><strong>gpg2</strong></span> application asks for signature information, the following prompt appears:
				</div><pre class="screen">Is this correct (y/N)?</pre><div class="para">
					Enter <code class="code">y</code> to finish the process.
				</div></li><li class="step"><div class="para">
					Enter your name and email address for your GPG key. Remember this 
process is about authenticating you as a real individual. For this 
reason, include your real name. If you choose a bogus email address, it 
will be more difficult for others to find your public key. This makes 
authenticating your communications difficult. If you are using this GPG 
key for self-introduction on a mailing list, for example, enter the 
email address you use on that list.
				</div><div class="para">
					Use the comment field to include aliases or other information. 
(Some people use different keys for different purposes and identify each
 key with a comment, such as "Office" or "Open Source Projects.")
				</div></li><li class="step"><div class="para">
					At the confirmation prompt, enter the letter <code class="literal">O</code>
 to continue if all entries are correct, or use the other options to fix
 any problems. Finally, enter a passphrase for your secret key. The <span class="application"><strong>gpg2</strong></span> program asks you to enter your passphrase twice to ensure you made no typing errors.
				</div></li><li class="step"><div class="para">
					Finally, <code class="code">gpg2</code> generates random data to 
make your key as unique as possible. Move your mouse, type random keys, 
or perform other tasks on the system during this step to speed up the 
process. Once this step is finished, your keys are complete and ready to
 use:
				</div><pre class="screen">	  pub  1024D/1B2AFA1C 2005-03-31 John Q. Doe &lt;jqdoe@example.com&gt;
	  Key fingerprint = 117C FE83 22EA B843 3E86  6486 4320 545E 1B2A FA1C
	  sub  1024g/CEA4B22E 2005-03-31 [expires: 2006-03-31]
</pre></li><li class="step"><div class="para">
					The key fingerprint is a shorthand "signature" for your key. It 
allows you to confirm to others that they have received your actual 
public key without any tampering. You do not need to write this 
fingerprint down. To display the fingerprint at any time, use this 
command, substituting your email address: 
<pre class="screen">~]$&nbsp;<code class="command">gpg2 --fingerprint jqdoe@example.com</code></pre>

				</div><div class="para">
					Your "GPG key ID" consists of 8 hex digits identifying the public key. In the example above, the GPG key ID is <code class="literal">1B2AFA1C</code>. In most cases, if you are asked for the key ID, prepend <code class="literal">0x</code> to the key ID, as in <code class="literal">0x6789ABCD</code>.
				</div></li></ol></div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				If you forget your passphrase, the key cannot be used and any data encrypted using that key will be lost.
			</div></div></div></div><div class="section" id="sect-Security_Guide-Encryption-GPG-About_Public_Key_Encryption"><div class="titlepage"><div><div><h3 class="title">3.5.4.&nbsp;About Public Key Encryption</h3></div></div></div><div class="orderedlist"><ol><li class="listitem"><div class="para">
					<a href="http://en.wikipedia.org/wiki/Public-key_cryptography">Wikipedia - Public Key Cryptography</a>
				</div></li><li class="listitem"><div class="para">
					<a href="http://computer.howstuffworks.com/encryption.htm">HowStuffWorks - Encryption</a>
				</div></li></ol></div></div></div><div xml:lang="en-US" class="section" id="sec-Using_stunnel" lang="en-US"><div class="titlepage"><div><div><h2 class="title">3.6.&nbsp;Using stunnel</h2></div></div></div><div class="para">
		The <span class="application"><strong>stunnel</strong></span> program 
is an encryption wrapper between a client and a server. It listens on 
the port specified in its configuration file, encrypts the communication
 with the client, and forwards the data to the original daemon listening
 on its usual port. This way, you can secure any service that itself 
does not support any type of encryption, or improve the security of a 
service that uses a type of encryption that you want to avoid for 
security reasons, such as SSL versions 2 and 3, affected by the POODLE 
SSL vulnerability (CVE-2014-3566). See <a href="https://access.redhat.com/solutions/1234843">Resolution
 for POODLE SSLv3.0 vulnerability (CVE-2014-3566) for components that do
 not allow SSLv3 to be disabled via configuration settings</a>. <span class="application"><strong>OpenLDAP</strong></span> older than 2.4.39 (before Red&nbsp;Hat Enterprise&nbsp;Linux 6.6) and <span class="application"><strong>CUPS</strong></span> are examples of components that do not provide a way to disable SSL in their own configuration.
	</div><div class="section" id="sec-Installing_stunnel"><div class="titlepage"><div><div><h3 class="title">3.6.1.&nbsp;Installing stunnel</h3></div></div></div><div class="para">
			Install the <span class="package">stunnel</span> package by running the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]#&nbsp;<code class="command">yum install stunnel</code></pre></div><div class="section" id="sec-Configuring_stunnel_wrapper"><div class="titlepage"><div><div><h3 class="title">3.6.2.&nbsp;Configuring stunnel as a TLS Wrapper</h3></div></div></div><div class="para">
			To configure <span class="application"><strong>stunnel</strong></span>, follow these steps:
		</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
					You need a valid certificate for <span class="application"><strong>stunnel</strong></span> regardless of what service you use it with. If you do not have a suitable certificate, you can apply to a <em class="firstterm">Certificate Authority</em> to obtain one, or you can create a self-signed cerfiticate. 
				</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
						Always use certificates signed by a Certificate Authority for 
servers running in a production environment. Self-signed certificates 
are only appropriate for testing purposes or private networks.
					</div></div></div><div class="para">
					To create a self-signed certificate for <span class="application"><strong>stunnel</strong></span>, enter the <code class="filename">/etc/pki/tls/certs/</code> directory and type the following command as <code class="systemitem">root</code>:
				</div><pre class="screen">certs]#&nbsp;<code class="command">make stunnel.pem</code></pre><div class="para">
					Answer all of the questions to complete the process.
				</div></li><li class="step"><div class="para">
					When you have a certificate, create a configuration file for <span class="application"><strong>stunnel</strong></span>.
 It is a text file in which every line specifies an option or the 
beginning of a service definition. You can also keep comments and empty 
lines in the file to improve its legibility, where comments start with a
 semicolon.
				</div><div class="para">
					The <span class="package">stunnel</span> RPM package contains the <code class="filename">/etc/stunnel/</code> directory, in which you can store the configuration file. Although <span class="application"><strong>stunnel</strong></span> does not require any special format of the file name or its extension, use <code class="filename">/etc/stunnel/stunnel.conf</code>. The following content configures <span class="application"><strong>stunnel</strong></span> as a TLS wrapper:
				</div><pre class="screen">cert = /etc/pki/tls/certs/stunnel.pem
; Allow only TLS, thus avoiding SSL
sslVersion = TLSv1
chroot = /var/run/stunnel
setuid = nobody
setgid = nobody
pid = /stunnel.pid
socket = l:TCP_NODELAY=1
socket = r:TCP_NODELAY=1

[<em class="replaceable">service_name</em>]
accept = <em class="replaceable">port</em>
connect = <em class="replaceable">port</em>
TIMEOUTclose = 0</pre><div class="para">
					Alternatively, you can avoid SSL by replacing the line containing <code class="literal">sslVersion = TLSv1</code> with the following lines:
				</div><pre class="screen">options = NO_SSLv2
options = NO_SSLv3</pre><div class="para">
					The purpose of the options is as follows:
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<code class="varname">cert</code> — the path to your certificate
						</div></li><li class="listitem"><div class="para">
							<code class="varname">sslVersion</code> — the version of SSL; note that you can use <code class="literal">TLS</code> here even though SSL and TLS are two independent cryptographic protocols
						</div></li><li class="listitem"><div class="para">
							<code class="varname">chroot</code> — the changed root directory in which the stunnel process runs, for greater security
						</div></li><li class="listitem"><div class="para">
							<code class="varname">setuid</code>, <code class="varname">setgid</code> — the user and group that the <span class="application"><strong>stunnel</strong></span> process runs as; <code class="literal">nobody</code> is a restricted system account
						</div></li><li class="listitem"><div class="para">
							<code class="varname">pid</code> — the file in which <span class="application"><strong>stunnel</strong></span> saves its process ID, relative to <code class="option">chroot</code>
						</div></li><li class="listitem"><div class="para">
							<code class="varname">socket</code> — local and remote socket options; in this case, disable <em class="firstterm">Nagle's algorithm</em> to improve network latency
						</div></li><li class="listitem"><div class="para">
							<code class="varname">[<em class="replaceable">service_name</em>]</code>
 — the beginning of the service definition; the options used below this 
line apply to the given service only, whereas the options above affect <span class="application"><strong>stunnel</strong></span> globally
						</div></li><li class="listitem"><div class="para">
							<code class="varname">accept</code> — the port to listen on
						</div></li><li class="listitem"><div class="para">
							<code class="varname">connect</code> — the port to connect to; this must be the port that the service you are securing uses
						</div></li><li class="listitem"><div class="para">
							<code class="varname">TIMEOUTclose</code> — how many seconds to wait for the <em class="firstterm">close_notify</em> alert from the client; <code class="literal">0</code> instructs <span class="application"><strong>stunnel</strong></span> not to wait at all
						</div></li><li class="listitem"><div class="para">
							<code class="varname">options</code> — OpenSSL library options
						</div></li></ul></div><div class="example" id="exam-stunnel_with_opendlap"><p class="title"><strong>Example&nbsp;3.1.&nbsp;Securing OpenLDAP</strong></p><div class="example-contents"><div class="para">
						To configure stunnel as a TLS wrapper for <span class="application"><strong>OpenLDAP</strong></span> older than 2.4.39, use the following values:
					</div><pre class="screen">[openldap]
accept = 636
connect = 389</pre><div class="para">
						<code class="literal">636</code> is the standard port for secure LDAP. <code class="literal">389</code> is the port that the <span class="application"><strong>OpenLDAP</strong></span> daemon listens on.
					</div></div></div><div class="example" id="exam-stunnel_with_cups"><p class="title"><strong>Example&nbsp;3.2.&nbsp;Securing CUPS</strong></p><div class="example-contents"><div class="para">
						Similarly, to configure stunnel as a TLS wrapper for <span class="application"><strong>CUPS</strong></span>, use the following values:
					</div><pre class="screen">[cups]
accept = 632
connect = 631</pre><div class="para">
						Instead of <code class="literal">632</code>, you can use any free port that you prefer. <code class="literal">631</code> is the port that <span class="application"><strong>CUPS</strong></span> normally uses.
					</div></div></div></li><li class="step"><div class="para">
					Create the <code class="option">chroot</code> directory and give the user specified by the <code class="option">setuid</code> option write access to it. To do so, run the following commands as <code class="systemitem">root</code>:
				</div><pre class="screen">~]#&nbsp;<code class="command">mkdir /var/run/stunnel</code>
~]#&nbsp;<code class="command">chown nobody:nobody /var/run/stunnel</code></pre><div class="para">
					This allows <span class="application"><strong>stunnel</strong></span> to create the PID file.
				</div></li><li class="step"><div class="para">
					If your system is using firewall settings that disallow access to the new port, change them accordingly. See <a class="xref" href="#sect-Security_Guide-Basic_Firewall_Configuration-Other_Ports">Section&nbsp;2.8.2.4, “Other Ports”</a> in <a class="xref" href="#sect-Security_Guide-Firewalls">Section&nbsp;2.8, “Firewalls”</a> for details.
				</div></li><li class="step"><div class="para">
					When you have created the configuration file and the <code class="option">chroot</code> directory, and when you are sure that the specified port is accessible, you are ready to start using <span class="application"><strong>stunnel</strong></span>.
				</div></li></ol></div></div><div class="section" id="sect-Starting_stopping_restarting_stunnel"><div class="titlepage"><div><div><h3 class="title">3.6.3.&nbsp;Starting, Stopping and Restarting stunnel</h3></div></div></div><div class="para">
			To start <span class="application"><strong>stunnel</strong></span>, run the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]#&nbsp;<code class="command">stunnel</code> <code class="option">/etc/stunnel/stunnel.conf</code></pre><div class="para">
			By default, <span class="application"><strong>stunnel</strong></span> uses <code class="filename">/var/log/secure</code> to log its output.
		</div><div class="para">
			To terminate <span class="application"><strong>stunnel</strong></span>, kill the process by running the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]#&nbsp;<code class="command">kill `cat /var/run/stunnel/stunnel.pid`</code></pre><div class="para">
			If you edit the configuration file while <span class="application"><strong>stunnel</strong></span> is running, terminate <span class="application"><strong>stunnel</strong></span> and start it again for your changes to take effect.
		</div></div></div><div xml:lang="en-US" class="section" id="sec-Hardening_TLS_Configuration" lang="en-US"><div class="titlepage"><div><div><h2 class="title">3.7.&nbsp;Hardening TLS Configuration</h2></div></div></div><div class="para">
		<code class="systemitem">TLS</code> (<code class="systemitem">Transport Layer Security</code>)
 is a cryptographic protocol used to secure network communications. When
 hardening system security settings by configuring preferred <em class="firstterm">key-exchange protocols</em>, <em class="firstterm">authentication methods</em>, and <em class="firstterm">encryption algorithms</em>,
 it is necessary to bear in mind that the broader the range of supported
 clients, the lower the resulting security. Conversely, strict security 
settings lead to a limited compatibility with clients, which can result 
in some users being locked out of the system. Be sure to target the 
strictest available configuration and only relax it when it is required 
for compatibility reasons.
	</div><div class="para">
		Note that the default settings provided by libraries included in 
Red&nbsp;Hat Enterprise&nbsp;Linux are secure enough for most 
deployments. The <code class="systemitem">TLS</code> implementations use
 secure algorithms where possible while not preventing connections from 
or to legacy clients or servers. Apply the hardened settings described 
in this section in environments with strict security requirements where 
legacy clients or servers that do not support secure algorithms or 
protocols are not expected or allowed to connect.
	</div><div class="section" id="sec-Choosing_Algorithms_to_Enable"><div class="titlepage"><div><div><h3 class="title">3.7.1.&nbsp;Choosing Algorithms to Enable</h3></div></div></div><div class="para">
			There are several components that need to be selected and configured.
 Each of the following directly influences the robustness of the 
resulting configuration (and, consequently, the level of support in 
clients) or the computational demands that the solution has on the 
system.
		</div><h3 id="brid-TLS-Protocol_Versions">Protocol Versions</h3><div class="para">
			The latest version of <code class="systemitem">TLS</code> provides the best security mechanism. Unless you have a compelling reason to include support for older versions of <code class="systemitem">TLS</code> (or even <code class="systemitem">SSL</code>), allow your systems to negotiate connections using only the latest version of <code class="systemitem">TLS</code>.
		</div><div class="para">
			Do not allow negotiation using <code class="systemitem">SSL</code> version 2 or 3. Both of those versions have serious security vulnerabilities. Only allow negotiation using <code class="systemitem">TLS</code> version 1.0 or higher. The current version of <code class="systemitem">TLS</code>, 1.2, should always be preferred.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Please note that currently, the security of all versions of <code class="systemitem">TLS</code> depends on the use of <code class="systemitem">TLS</code> extensions, specific ciphers (see below), and other workarounds. All <code class="systemitem">TLS</code> connection peers need to implement secure renegotiation indication (<a href="http://www.rfc-editor.org/info/rfc5746">RFC&nbsp;5746</a>), must not support compression, and must implement mitigating measures for timing attacks against <code class="systemitem">CBC</code>-mode ciphers (the Lucky Thirteen attack). <code class="systemitem">TLS&nbsp;v1.0</code> clients need to additionally implement record splitting (a workaround against the BEAST attack). <code class="systemitem">TLS&nbsp;v1.2</code> supports <em class="firstterm">Authenticated Encryption with Associated Data</em> (<acronym class="acronym">AEAD</acronym>) mode ciphers like <code class="systemitem">AES-GCM</code>, <code class="systemitem">AES-CCM</code>, or <code class="systemitem">Camellia-GCM</code>,
 which have no known issues. All the mentioned mitigations are 
implemented in cryptographic libraries included in Red&nbsp;Hat 
Enterprise&nbsp;Linux.
			</div></div></div><div class="para">
			See <a class="xref" href="#tab-TLS-Protocol_Versions">Table&nbsp;3.1, “Protocol Versions”</a> for a quick overview of protocol versions and recommended usage.
		</div><div class="table" id="tab-TLS-Protocol_Versions"><p class="title"><strong>Table&nbsp;3.1.&nbsp;Protocol Versions</strong></p><div class="table-contents"><a id="idm140226881085376" class="indexterm"><!--Empty--></a><table class="lt-4-cols lt-7-rows" summary="Protocol Versions"><colgroup><col class="version" width="17%"><!--Empty--><col class="recommendation" width="83%"><!--Empty--></colgroup><thead><tr><th id="idm140226869955552" scope="col">Protocol Version</th><th id="idm140226855626128" scope="col">Usage Recommendation</th></tr></thead><tbody><tr><td headers="idm140226869955552"><code class="systemitem">SSL v2</code></td><td headers="idm140226855626128"> <div class="para">
							Do not use. Has serious security vulnerabilities.
						</div>
						 </td></tr><tr><td headers="idm140226869955552"><code class="systemitem">SSL v3</code></td><td headers="idm140226855626128"> <div class="para">
							Do not use. Has serious security vulnerabilities.
						</div>
						 </td></tr><tr><td headers="idm140226869955552"><code class="systemitem">TLS v1.0</code></td><td headers="idm140226855626128"> <div class="para">
							Use for interoperability purposes where needed. Has known issues 
that cannot be mitigated in a way that guarantees interoperability, and 
thus mitigations are not enabled by default. Does not support modern 
cipher suites.
						</div>
						 </td></tr><tr><td headers="idm140226869955552"><code class="systemitem">TLS v1.1</code></td><td headers="idm140226855626128"> <div class="para">
							Use for interoperability purposes where needed. Has no known 
issues but relies on protocol fixes that are included in all the <code class="systemitem">TLS</code> implementations in Red&nbsp;Hat Enterprise&nbsp;Linux. Does not support modern cipher suites.
						</div>
						 </td></tr><tr><td headers="idm140226869955552"><code class="systemitem">TLS v1.2</code></td><td headers="idm140226855626128"> <div class="para">
							Recommended version. Supports the modern <code class="systemitem">AEAD</code> cipher suites.
						</div>
						 </td></tr></tbody></table></div></div><div class="para">
			Some components in Red&nbsp;Hat Enterprise&nbsp;Linux are configured to use <code class="systemitem">TLS&nbsp;v1.0</code> even though they provide support for <code class="systemitem">TLS&nbsp;v1.1</code> or even <code class="systemitem">v1.2</code>.
 This is motivated by an attempt to achieve the highest level of 
interoperability with external services that may not support the latest 
versions of <code class="systemitem">TLS</code>. Depending on your interoperability requirements, enable the highest available version of <code class="systemitem">TLS</code>.
		</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				<code class="systemitem">SSL&nbsp;v3</code> is not recommended for 
use. However, if, despite the fact that it is considered insecure and 
unsuitable for general use, you absolutely must leave <code class="systemitem">SSL&nbsp;v3</code> enabled, see <a class="xref" href="#sec-Using_stunnel">Section&nbsp;3.6, “Using stunnel”</a> for instructions on how to use <span class="application"><strong>stunnel</strong></span>
 to securely encrypt communications even when using services that do not
 support encryption or are only capable of using obsolete and insecure 
modes of encryption.
			</div></div></div><div class="para">
			While not immediately insecure, cipher suites that offer less than 
128 bits of security should not be considered for their short useful 
life. Algorithms that use 128 bit of security or more can be expected to
 be unbreakable for at least several years, and are thus strongly 
recommended. Note that while <code class="systemitem">3DES</code> ciphers advertise the use of 168 bits, they actually offer 112 bits of security.
		</div><div class="para">
			Always give preference to cipher suites that support <em class="firstterm">(perfect) forward secrecy</em> (<em class="firstterm">PFS</em>), which ensures the confidentiality of encrypted data even in case the server key is compromised. This rules out the fast <code class="systemitem">RSA</code> key exchange, but allows for the use of <code class="systemitem">ECDHE</code> and <code class="systemitem">DHE</code>. Of the two, <code class="systemitem">ECDHE</code> is the faster and therefore the preferred choice.
		</div><div class="para">
			Note also that when using the <code class="systemitem">ECDHE</code> key exchange with <code class="systemitem">ECDSA</code> certificates, the transaction is even faster than pure <code class="systemitem">RSA</code> key exchange. To provide support for legacy clients, you can install two pairs of certificates and keys on a server: one with <code class="systemitem">ECDSA</code> keys (for new clients) and one with <code class="systemitem">RSA</code> keys (for legacy ones).
		</div><h3 id="brid-TLS-Public_Key_Length">Public Key Length</h3><div class="para">
			When using <code class="systemitem">RSA</code> keys, always prefer 
key lengths of at least 3072 bits signed by at least SHA-256, which is 
sufficiently large for true 128 bits of security.
		</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
				Keep in mind that the security of your system is only as strong as 
the weakest link in the chain. For example, a strong cipher alone does 
not guarantee good security. The keys and the certificates are just as 
important, as well as the hash functions and keys used by the <em class="firstterm">Certification Authority</em> (<em class="firstterm">CA</em>) to sign your keys.
			</div></div></div></div><div class="section" id="sec-Using_Implementations_of_TLS"><div class="titlepage"><div><div><h3 class="title">3.7.2.&nbsp;Using Implementations of TLS</h3></div></div></div><div class="para">
			Red&nbsp;Hat Enterprise&nbsp;Linux is distributed with several full-featured implementations of <code class="systemitem">TLS</code>. In this section, the configuration of <span class="application"><strong>OpenSSL</strong></span> and <span class="application"><strong>GnuTLS</strong></span> is described. See <a class="xref" href="#sec-Configuring_Specific_Applications">Section&nbsp;3.7.3, “Configuring Specific Applications”</a> for instructions on how to configure <code class="systemitem">TLS</code> support in individual applications.
		</div><div class="para">
			The available <code class="systemitem">TLS</code> implementations offer support for various <em class="firstterm">cipher suites</em> that define all the elements that come together when establishing and using <code class="systemitem">TLS</code>-secured communications.
		</div><div class="para">
			Use the tools included with the different implementations to list and
 specify cipher suites that provide the best possible security for your 
use case while considering the recommendations outlined in <a class="xref" href="#sec-Choosing_Algorithms_to_Enable">Section&nbsp;3.7.1, “Choosing Algorithms to Enable”</a>. The resulting cipher suites can then be used to configure the way individual applications negotiate and secure connections.
		</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				Be sure to check your settings following every update or upgrade of 
the TLS implementation you use or the applications that utilize that 
implementation. New versions may introduce new cipher suites that you do
 not want to have enabled and that your current configuration does not 
disable.
			</div></div></div><div class="section" id="sec-Working_with_Cipher_Suites_in_OpenSSL"><div class="titlepage"><div><div><h4 class="title">3.7.2.1.&nbsp;Working with Cipher Suites in OpenSSL</h4></div></div></div><div class="para">
				<span class="application"><strong>OpenSSL</strong></span> is a toolkit and a cryptography library that support the <code class="systemitem">SSL</code> and <code class="systemitem">TLS</code> protocols. On Red&nbsp;Hat Enterprise&nbsp;Linux, a configuration file is provided at <code class="filename">/etc/pki/tls/openssl.cnf</code>. The format of this configuration file is described in <span class="citerefentry"><span class="refentrytitle">config</span>(1)</span>.
			</div><div class="para">
				To get a list of all cipher suites supported by your installation of <span class="application"><strong>OpenSSL</strong></span>, use the <code class="command">openssl</code> command with the <code class="command">ciphers</code> subcommand as follows:
			</div><pre class="screen">~]$ <code class="command">openssl ciphers -v 'ALL:COMPLEMENTOFALL'</code></pre><div class="para">
				Pass other parameters (referred to as <em class="firstterm">cipher strings</em> and <em class="firstterm">keywords</em> in <span class="application"><strong>OpenSSL</strong></span> documentation) to the <code class="command">ciphers</code>
 subcommand to narrow the output. Special keywords can be used to only 
list suites that satisfy a certain condition. For example, to only list 
suites that are defined as belonging to the <code class="varname">HIGH</code> group, use the following command:
			</div><pre class="screen">~]$ <code class="command">openssl ciphers -v 'HIGH'</code></pre><div class="para">
				See the <span class="citerefentry"><span class="refentrytitle">ciphers</span>(1)</span> manual page for a list of available keywords and cipher strings.
			</div><div class="para">
				To obtain a list of cipher suites that satisfy the recommendations outlined in <a class="xref" href="#sec-Choosing_Algorithms_to_Enable">Section&nbsp;3.7.1, “Choosing Algorithms to Enable”</a>, use a command similar to the following:
			</div><pre class="screen">~]$ <code class="command">openssl ciphers -v 'kEECDH+aECDSA+AES:kEECDH+AES+aRSA:kEDH+aRSA+AES' | column&nbsp;-t</code>
ECDHE-ECDSA-AES256-GCM-SHA384  TLSv1.2  Kx=ECDH  Au=ECDSA  Enc=AESGCM(256)  Mac=AEAD
ECDHE-ECDSA-AES256-SHA384      TLSv1.2  Kx=ECDH  Au=ECDSA  Enc=AES(256)     Mac=SHA384
ECDHE-ECDSA-AES256-SHA         SSLv3    Kx=ECDH  Au=ECDSA  Enc=AES(256)     Mac=SHA1
ECDHE-ECDSA-AES128-GCM-SHA256  TLSv1.2  Kx=ECDH  Au=ECDSA  Enc=AESGCM(128)  Mac=AEAD
ECDHE-ECDSA-AES128-SHA256      TLSv1.2  Kx=ECDH  Au=ECDSA  Enc=AES(128)     Mac=SHA256
ECDHE-ECDSA-AES128-SHA         SSLv3    Kx=ECDH  Au=ECDSA  Enc=AES(128)     Mac=SHA1
ECDHE-RSA-AES256-GCM-SHA384    TLSv1.2  Kx=ECDH  Au=RSA    Enc=AESGCM(256)  Mac=AEAD
ECDHE-RSA-AES256-SHA384        TLSv1.2  Kx=ECDH  Au=RSA    Enc=AES(256)     Mac=SHA384
ECDHE-RSA-AES256-SHA           SSLv3    Kx=ECDH  Au=RSA    Enc=AES(256)     Mac=SHA1
ECDHE-RSA-AES128-GCM-SHA256    TLSv1.2  Kx=ECDH  Au=RSA    Enc=AESGCM(128)  Mac=AEAD
ECDHE-RSA-AES128-SHA256        TLSv1.2  Kx=ECDH  Au=RSA    Enc=AES(128)     Mac=SHA256
ECDHE-RSA-AES128-SHA           SSLv3    Kx=ECDH  Au=RSA    Enc=AES(128)     Mac=SHA1
DHE-RSA-AES256-GCM-SHA384      TLSv1.2  Kx=DH    Au=RSA    Enc=AESGCM(256)  Mac=AEAD
DHE-RSA-AES256-SHA256          TLSv1.2  Kx=DH    Au=RSA    Enc=AES(256)     Mac=SHA256
DHE-RSA-AES256-SHA             SSLv3    Kx=DH    Au=RSA    Enc=AES(256)     Mac=SHA1
DHE-RSA-AES128-GCM-SHA256      TLSv1.2  Kx=DH    Au=RSA    Enc=AESGCM(128)  Mac=AEAD
DHE-RSA-AES128-SHA256          TLSv1.2  Kx=DH    Au=RSA    Enc=AES(128)     Mac=SHA256
DHE-RSA-AES128-SHA             SSLv3    Kx=DH    Au=RSA    Enc=AES(128)     Mac=SHA1</pre><div class="para">
				The above command omits all insecure ciphers, gives preference to <code class="systemitem">ephemeral elliptic curve Diffie-Hellman</code> key exchange and <code class="systemitem">ECDSA</code> ciphers, and omits <code class="systemitem">RSA</code> key exchange (thus ensuring <em class="firstterm">perfect forward secrecy</em>).
			</div><div class="para">
				Note that this is a rather strict configuration, and it might be 
necessary to relax the conditions in real-world scenarios to allow for a
 compatibility with a broader range of clients.
			</div></div><div class="section" id="sec-Working_with_Cipher_Suites_in_GnuTLS"><div class="titlepage"><div><div><h4 class="title">3.7.2.2.&nbsp;Working with Cipher Suites in GnuTLS</h4></div></div></div><div class="para">
				<span class="application"><strong>GnuTLS</strong></span> is a communications library that implements the <code class="systemitem">SSL</code> and <code class="systemitem">TLS</code> protocols and related technologies.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					The <span class="application"><strong>GnuTLS</strong></span> 
installation on Red&nbsp;Hat Enterprise&nbsp;Linux offers optimal 
default configuration values that provide sufficient security for the 
majority of use cases. Unless you need to satisfy special security 
requirements, it is recommended to use the supplied defaults.
				</div></div></div><div class="para">
				Use the <code class="command">gnutls-cli</code> command with the <code class="option">-l</code> (or <code class="option">--list</code>) option to list all supported cipher suites:
			</div><pre class="screen">~]$ <code class="command">gnutls-cli -l</code></pre><div class="para">
				To narrow the list of cipher suites displayed by the <code class="option">-l</code> option, pass one or more parameters (referred to as <em class="firstterm">priority strings</em> and <em class="firstterm">keywords</em> in <span class="application"><strong>GnuTLS</strong></span> documentation) to the <code class="option">--priority</code> option. See the <span class="application"><strong>GnuTLS</strong></span> documentation at <a href="http://www.gnutls.org/manual/gnutls.html#Priority-Strings">http://www.gnutls.org/manual/gnutls.html#Priority-Strings</a>
 for a list of all available priority strings. For example, issue the 
following command to get a list of cipher suites that offer at least 128
 bits of security:
			</div><pre class="screen">~]$ <code class="command">gnutls-cli --priority SECURE128 -l</code></pre><div class="para">
				To obtain a list of cipher suites that satisfy the recommendations outlined in <a class="xref" href="#sec-Choosing_Algorithms_to_Enable">Section&nbsp;3.7.1, “Choosing Algorithms to Enable”</a>, use a command similar to the following:
			</div><pre class="screen">~]$ <code class="command">gnutls-cli --priority SECURE256:+SECURE128:-VERS-TLS-ALL:+VERS-TLS1.2:-RSA:-DHE-DSS:-CAMELLIA-128-CBC:-CAMELLIA-256-CBC -l</code>
Cipher suites for SECURE256:+SECURE128:-VERS-TLS-ALL:+VERS-TLS1.2:-RSA:-DHE-DSS:-CAMELLIA-128-CBC:-CAMELLIA-256-CBC
TLS_ECDHE_ECDSA_AES_256_GCM_SHA384                      0xc0, 0x2c      TLS1.2
TLS_ECDHE_ECDSA_AES_256_CBC_SHA384                      0xc0, 0x24      TLS1.2
TLS_ECDHE_ECDSA_AES_256_CBC_SHA1                        0xc0, 0x0a      SSL3.0
TLS_ECDHE_ECDSA_AES_128_GCM_SHA256                      0xc0, 0x2b      TLS1.2
TLS_ECDHE_ECDSA_AES_128_CBC_SHA256                      0xc0, 0x23      TLS1.2
TLS_ECDHE_ECDSA_AES_128_CBC_SHA1                        0xc0, 0x09      SSL3.0
TLS_ECDHE_RSA_AES_256_GCM_SHA384                        0xc0, 0x30      TLS1.2
TLS_ECDHE_RSA_AES_256_CBC_SHA1                          0xc0, 0x14      SSL3.0
TLS_ECDHE_RSA_AES_128_GCM_SHA256                        0xc0, 0x2f      TLS1.2
TLS_ECDHE_RSA_AES_128_CBC_SHA256                        0xc0, 0x27      TLS1.2
TLS_ECDHE_RSA_AES_128_CBC_SHA1                          0xc0, 0x13      SSL3.0
TLS_DHE_RSA_AES_256_CBC_SHA256                          0x00, 0x6b      TLS1.2
TLS_DHE_RSA_AES_256_CBC_SHA1                            0x00, 0x39      SSL3.0
TLS_DHE_RSA_AES_128_GCM_SHA256                          0x00, 0x9e      TLS1.2
TLS_DHE_RSA_AES_128_CBC_SHA256                          0x00, 0x67      TLS1.2
TLS_DHE_RSA_AES_128_CBC_SHA1                            0x00, 0x33      SSL3.0

Certificate types: CTYPE-X.509
Protocols: VERS-TLS1.2
Compression: COMP-NULL
Elliptic curves: CURVE-SECP384R1, CURVE-SECP521R1, CURVE-SECP256R1
PK-signatures: SIGN-RSA-SHA384, SIGN-ECDSA-SHA384, SIGN-RSA-SHA512, SIGN-ECDSA-SHA512, SIGN-RSA-SHA256, SIGN-DSA-SHA256, SIGN-ECDSA-SHA256</pre><div class="para">
				The above command limits the output to ciphers with at least 128 
bits of security while giving preference to the stronger ones. It also 
forbids <code class="systemitem">RSA</code> key exchange and <code class="systemitem">DSS</code> authentication.
			</div><div class="para">
				Note that this is a rather strict configuration, and it might be 
necessary to relax the conditions in real-world scenarios to allow for a
 compatibility with a broader range of clients.
			</div></div></div><div class="section" id="sec-Configuring_Specific_Applications"><div class="titlepage"><div><div><h3 class="title">3.7.3.&nbsp;Configuring Specific Applications</h3></div></div></div><div class="para">
			Different applications provide their own configuration mechanisms for <code class="systemitem">TLS</code>. This section describes the <code class="systemitem">TLS</code>-related
 configuration files employed by the most commonly used server 
applications and offers examples of typical configurations.
		</div><div class="para">
			Regardless of the configuration you choose to use, always make sure to mandate that your server application enforces <em class="firstterm">server-side cipher order</em>, so that the cipher suite to be used is determined by the order you configure.
		</div><div class="section" id="sec-Configuring_the_Apache_HTTP_Server"><div class="titlepage"><div><div><h4 class="title">3.7.3.1.&nbsp;Configuring the Apache HTTP Server</h4></div></div></div><div class="para">
				The <span class="application"><strong>Apache HTTP Server</strong></span> can use both <span class="application"><strong>OpenSSL</strong></span> and <span class="application"><strong>NSS</strong></span> libraries for its <code class="systemitem">TLS</code> needs. Depending on your choice of the <code class="systemitem">TLS</code> library, you need to install either the <span class="application"><strong>mod_ssl</strong></span> or the <span class="application"><strong>mod_nss</strong></span> module (provided by eponymous packages). For example, to install the package that provides the <span class="application"><strong>OpenSSL</strong></span> <span class="application"><strong>mod_ssl</strong></span> module, issue the following command as root:
			</div><pre class="screen">~]# <code class="command">yum install mod_ssl</code></pre><div class="para">
				The <span class="package">mod_ssl</span> package installs the <code class="filename">/etc/httpd/conf.d/ssl.conf</code> configuration file, which can be used to modify the <code class="systemitem">TLS</code>-related settings of the <span class="application"><strong>Apache HTTP Server</strong></span>. Similarly, the <span class="package">mod_nss</span> package installs the <code class="filename">/etc/httpd/conf.d/nss.conf</code> configuration file.
			</div><div class="para">
				Install the <span class="package">httpd-manual</span> package to obtain a complete documentation for the <span class="application"><strong>Apache HTTP Server</strong></span>, including <code class="systemitem">TLS</code> configuration. The directives available in the <code class="filename">/etc/httpd/conf.d/ssl.conf</code> configuration file are described in detail in <a href="file:///usr/share/httpd/manual/mod/mod_ssl.html"><code class="filename">/usr/share/httpd/manual/mod/mod_ssl.html</code></a>. Examples of various settings are in <a href="file:///usr/share/httpd/manual/ssl/ssl_howto.html"><code class="filename">/usr/share/httpd/manual/ssl/ssl_howto.html</code></a>.
			</div><div class="para">
				When modifying the settings in the <code class="filename">/etc/httpd/conf.d/ssl.conf</code> configuration file, be sure to consider the following three directives at the minimum:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"> <code class="option">SSLProtocol</code> </span></dt><dd><div class="para">
							Use this directive to specify the version of <code class="systemitem">TLS</code> (or <code class="systemitem">SSL</code>) you want to allow.
						</div></dd><dt><span class="term"> <code class="option">SSLCipherSuite</code> </span></dt><dd><div class="para">
							Use this directive to specify your preferred cipher suite or disable the ones you want to disallow.
						</div></dd><dt><span class="term"> <code class="option">SSLHonorCipherOrder</code> </span></dt><dd><div class="para">
							Uncomment and set this directive to <code class="literal">on</code> to ensure that the connecting clients adhere to the order of ciphers you specified.
						</div></dd></dl></div><div class="para">
				For example:
			</div><pre class="screen">SSLProtocol all -SSLv2 -SSLv3
SSLCipherSuite HIGH:!aNULL:!MD5
SSLHonorCipherOrder on</pre><div class="para">
				Note that the above configuration is the bare minimum, and it can be
 hardened significantly by following the recommendations outlined in <a class="xref" href="#sec-Choosing_Algorithms_to_Enable">Section&nbsp;3.7.1, “Choosing Algorithms to Enable”</a>.
			</div><div class="para">
				To configure and use the <span class="application"><strong>mod_nss</strong></span> module, modify the <code class="filename">/etc/httpd/conf.d/nss.conf</code> configuration file. The <span class="application"><strong>mod_nss</strong></span> module is derived from <span class="application"><strong>mod_ssl</strong></span>,
 and as such it shares many features with it, not least the structure of
 the configuration file, and the directives that are available. Note 
that the <span class="application"><strong>mod_nss</strong></span> directives have a prefix of <code class="code">NSS</code> instead of <code class="code">SSL</code>. See <a href="https://git.fedorahosted.org/cgit/mod_nss.git/plain/docs/mod_nss.html">https://git.fedorahosted.org/cgit/mod_nss.git/plain/docs/mod_nss.html</a> for an overview of information about <span class="application"><strong>mod_nss</strong></span>, including a list of <span class="application"><strong>mod_ssl</strong></span> configuration directives that are not applicable to <span class="application"><strong>mod_nss</strong></span>.
			</div></div></div><div class="section" id="sec-Additional_Information"><div class="titlepage"><div><div><h3 class="title">3.7.4.&nbsp;Additional Information</h3></div></div></div><a id="idm140226849418960" class="indexterm"><!--Empty--></a><a id="idm140226853148208" class="indexterm"><!--Empty--></a><div class="para">
			For more information about <span class="application"><strong>TLS</strong></span> configuration and related topics, see the resources listed below.
		</div><h3 id="brid-TLS-Resources_Installed">Installed Documentation</h3><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">config</span>(1)</span> — Describes the format of the <code class="filename">/etc/ssl/openssl.conf</code> configuration file.
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">ciphers</span>(1)</span> — Includes a list of available <span class="application"><strong>OpenSSL</strong></span> keywords and cipher strings.
				</div></li><li class="listitem"><div class="para">
					<a href="file:///usr/share/httpd/manual/mod/mod_ssl.html"><code class="filename">/usr/share/httpd/manual/mod/mod_ssl.html</code></a> — Contains detailed descriptions of the directives available in the <code class="filename">/etc/httpd/conf.d/ssl.conf</code> configuration file used by the <span class="application"><strong>mod_ssl</strong></span> module for the <span class="application"><strong>Apache HTTP Server</strong></span>.
				</div></li><li class="listitem"><div class="para">
					<a href="file:///usr/share/httpd/manual/ssl/ssl_howto.html"><code class="filename">/usr/share/httpd/manual/ssl/ssl_howto.html</code></a> — Contains practical examples of real-world settings in the <code class="filename">/etc/httpd/conf.d/ssl.conf</code> configuration file used by the <span class="application"><strong>mod_ssl</strong></span> module for the <span class="application"><strong>Apache HTTP Server</strong></span>.
				</div></li></ul></div><h3 id="brid-TLS-Resources_Online">Online Documentation</h3><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Security-Enhanced_Linux/">Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 Security-Enhanced Linux</a> — The <em class="citetitle">Security-Enhanced Linux</em> guide for Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 describes the basic principles of <span class="application"><strong>SELinux</strong></span>.
				</div></li><li class="listitem"><div class="para">
					<a href="http://tools.ietf.org/html/draft-ietf-uta-tls-bcp-00">http://tools.ietf.org/html/draft-ietf-uta-tls-bcp-00</a> — Recommendations for secure use of <code class="systemitem">TLS</code> and <code class="systemitem">DTLS</code>.
				</div></li></ul></div></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Guide-General_Principles_of_Information_Security" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;4.&nbsp;General Principles of Information Security</h1></div></div></div><div class="para">
		The following general principles provide an overview of good security practices:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Encrypt all data transmitted over networks to help prevent 
man-in-the-middle attacks and eavesdropping. It is important to encrypt 
authentication information, such as passwords.
			</div></li><li class="listitem"><div class="para">
				Minimize the amount of software installed and running services.
			</div></li><li class="listitem"><div class="para">
				Use security-enhancing software and tools, for example, 
Security-Enhanced Linux (SELinux) for Mandatory Access Control (MAC), 
Netfilter iptables for packet filtering (firewall), and the GNU Privacy 
Guard (GPG) for encrypting files.
			</div></li><li class="listitem"><div class="para">
				If possible, run each network service on a separate system to 
minimize the risk of one compromised service being used to compromise 
other services.
			</div></li><li class="listitem"><div class="para">
				Maintain user accounts: create and enforce a strong password policy; delete unused user accounts.
			</div></li><li class="listitem"><div class="para">
				Routinely review system and application logs. By default, security-relevant system logs are written to <code class="filename">/var/log/secure</code> and <code class="filename">/var/log/audit/audit.log</code>. Note: sending logs to a dedicated log server helps prevent attackers from easily modifying local logs to avoid detection.
			</div></li><li class="listitem"><div class="para">
				Never log in as the root user unless absolutely necessary. It is recommended that administrators use <code class="command">sudo</code> to execute commands as root when required. Users capable of running <code class="command">sudo</code> are specified in <code class="filename">/etc/sudoers</code>. Use the <code class="command">visudo</code> utility to edit <code class="filename">/etc/sudoers</code>.
			</div></li></ul></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Guide-Secure_Installation" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;5.&nbsp;Secure Installation</h1></div></div></div><div class="para">
		Security begins with the first time you put that CD or DVD into your 
disk drive to install Red&nbsp;Hat Enterprise&nbsp;Linux. Configuring 
your system securely from the beginning makes it easier to implement 
additional security settings later.
	</div><div class="section" id="sect-Security_Guide-Secure_Installation-Disk_Partitions"><div class="titlepage"><div><div><h2 class="title">5.1.&nbsp;Disk Partitions</h2></div></div></div><div class="para">
			Red&nbsp;Hat recommends creating separate partitions for <code class="filename">/boot</code>, <code class="filename">/</code>, <code class="filename">/home</code>, <code class="filename">/tmp/</code>, and <code class="filename">/var/tmp/</code>. If the root partition (<code class="filename">/</code>)
 becomes corrupt, your data could be lost forever. By using separate 
partitions, the data is slightly more protected. You can also target 
these partition for frequent backups. The purpose for each partition is 
different and we will address each partition.
		</div><div class="para">
			<code class="filename">/boot</code> - This partition is the first 
partition that is read by the system during the boot. The boot loader 
and kernel images that are used to boot your system into Red&nbsp;Hat 
Enterprise&nbsp;Linux are stored in this partition. This partition 
should not be encrypted. If this partition is included in <code class="filename">/</code> and that partition is encrypted or otherwise becomes unavailable, your system will not be able to boot.
		</div><div class="para">
			<code class="filename">/home</code> - When user data (<code class="filename">/home</code>) is stored in <code class="filename">/</code>
 instead of a separate partition, the partition can fill up causing the 
operating system to become unstable. Also, when upgrading your system to
 the next version of Red&nbsp;Hat Enterprise&nbsp;Linux, it is a lot 
easier if you can keep your data in the <code class="filename">/home</code> partition as it will not be overwritten during installation.
		</div><div class="para">
			<code class="filename">/tmp</code> and <code class="filename">/var/tmp/</code> - Both the <code class="filename">/tmp</code> and the <code class="filename">/var/tmp/</code>
 directories are used to store data that does not need to be stored for a
 long period of time. However, if a lot of data floods one of these 
directories, it can consume all of your storage space. If this happens 
and these directories are stored within <code class="filename">/</code>,
 your system could become unstable and crash. For this reason, moving 
these directories into their own partitions is a good idea.
		</div></div><div class="section" id="sect-Security_Guide-Secure_Installation-Utilize_LUKS_Partition_Encryption"><div class="titlepage"><div><div><h2 class="title">5.2.&nbsp;Utilize LUKS Partition Encryption</h2></div></div></div><div class="para">
			During the installation process, an option to encrypt partitions is 
presented to the user. The user must supply a passphrase. This 
passphrase is used as a key to unlock the bulk encryption key, which is 
used to secure the partition's data.
		</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Guide-Software_Maintenance" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;6.&nbsp;Software Maintenance</h1></div></div></div><div class="para">
		Software maintenance is extremely important to maintaining a secure 
system. It is vital to patch software as soon as it becomes available in
 order to prevent attackers from using known holes to infiltrate your 
system.
	</div><div class="section" id="sect-Security_Guide-Software_Maintenance-Install_Minimal_Software"><div class="titlepage"><div><div><h2 class="title">6.1.&nbsp;Install Minimal Software</h2></div></div></div><div class="para">
			It is a recommended practice to install only the packages you will 
use because each piece of software on your computer could possibly 
contain a vulnerability. If you are installing from the DVD media take 
the opportunity to select exactly what packages you want to install 
during the installation. When you find you need another package, you can
 always add it to the system later.
		</div><div class="para">
			For more information on minimal installation, see the <em class="citetitle">"Package Group Selection"</em> section of the <em class="citetitle">Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 Installation Guide</em>. A minimal installation can also be performed via a kickstart file using the <code class="option">--nobase</code> option. For more information, see the <em class="citetitle">"Package Selection"</em> section of the <em class="citetitle">Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 Installation Guide</em>.
		</div></div><div class="section" id="sect-Security_Guide-Software_Maintenance-Plan_and_Configure_Security_Updates"><div class="titlepage"><div><div><h2 class="title">6.2.&nbsp;Plan and Configure Security Updates</h2></div></div></div><div class="para">
			All software contains bugs. Often, these bugs can result in a 
vulnerability that can expose your system to malicious users. Unpatched 
systems are a common cause of computer intrusions. You should have a 
plan to install security patches in a timely manner to close those 
vulnerabilities so they cannot be exploited.
		</div><div class="para">
			For home users, security updates should be installed as soon as 
possible. Configuring automatic installation of security updates is one 
way to avoid having to remember, but does carry a slight risk that 
something can cause a conflict with your configuration or with other 
software on the system.
		</div><div class="para">
			For business or advanced home users, security updates should be 
tested and scheduled for installation. Additional controls will need to 
be used to protect the system during the time between the patch release 
and its installation on the system. These controls would depend on the 
exact vulnerability, but could include additional firewall rules, the 
use of external firewalls, or changes in software settings.
		</div></div><div class="section" id="sect-Security_Guide-Software_Maintenance-Plan_and_Configure_Security_Updates-Adjusting_Automatic_Updates"><div class="titlepage"><div><div><h2 class="title">6.3.&nbsp;Adjusting Automatic Updates</h2></div></div></div><div class="para">
			Red&nbsp;Hat Enterprise&nbsp;Linux is configured to apply all updates
 on a daily schedule. If you want to change how your system installs 
updates, you must do so via <span class="guilabel"><strong>Software Update Preferences</strong></span>. You can change the schedule, the type of updates to apply, or to notify you of available updates.
		</div><div class="para">
			In GNOME, you can find controls for your updates at: <span class="guimenu"><strong>System</strong></span> → <span class="guisubmenu"><strong>Preferences</strong></span> → <span class="guimenuitem"><strong>Software Updates</strong></span>. In KDE, it is located at: <span class="guimenu"><strong>Applications</strong></span> → <span class="guisubmenu"><strong>Settings</strong></span> → <span class="guimenuitem"><strong>Software Updates</strong></span>.
		</div></div><div class="section" id="sect-Security_Guide-Software_Maintenance-Install_Signed_Packages_from_Well_Known_Repositories"><div class="titlepage"><div><div><h2 class="title">6.4.&nbsp;Install Signed Packages from Well Known Repositories</h2></div></div></div><div class="para">
			Software packages are published through repositories. All well known 
repositories support package signing. Package signing uses public key 
technology to prove that the package that was published by the 
repository has not been changed since the signature was applied. This 
provides some protection against installing software that may have been 
maliciously altered after the package was created but before you 
downloaded it.
		</div><div class="para">
			Using too many repositories, untrustworthy repositories, or 
repositories with unsigned packages has a higher risk of introducing 
malicious or vulnerable code into your system. Use caution when adding 
repositories to yum/software update.
		</div></div></div><div xml:lang="en-US" class="chapter" id="chap-system_auditing" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;7.&nbsp;System Auditing</h1></div></div></div><div class="para">
		The Linux Audit system provides a way to track security-relevant 
information on your system. Based on pre-configured rules, Audit 
generates log entries to record as much information about the events 
that are happening on your system as possible. This information is 
crucial for mission-critical environments to determine the violator of 
the security policy and the actions they performed. Audit does not 
provide additional security to your system; rather, it can be used to 
discover violations of security policies used on your system. These 
violations can further be prevented by additional security measures such
 as SELinux.
	</div><div class="para">
		The following list summarizes some of the information that Audit is capable of recording in its log files:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Date and time, type, and outcome of an event.
			</div></li><li class="listitem"><div class="para">
				Sensitivity labels of subjects and objects.
			</div></li><li class="listitem"><div class="para">
				Association of an event with the identity of the user who triggered the event.
			</div></li><li class="listitem"><div class="para">
				All modifications to Audit configuration and attempts to access Audit log files.
			</div></li><li class="listitem"><div class="para">
				All uses of authentication mechanisms, such as SSH, Kerberos, and others.
			</div></li><li class="listitem"><div class="para">
				Changes to any trusted database, such as <code class="filename">/etc/passwd</code>.
			</div></li><li class="listitem"><div class="para">
				Attempts to import or export information into or from the system.
			</div></li><li class="listitem"><div class="para">
				Include or exclude events based on user identity, subject and object labels, and other attributes.
			</div></li></ul></div><div class="para">
		The use of the Audit system is also a requirement for a number of 
security-related certifications. Audit is designed to meet or exceed the
 requirements of the following certifications or compliance guides:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Controlled Access Protection Profile (CAPP)
			</div></li><li class="listitem"><div class="para">
				Labeled Security Protection Profile (LSPP)
			</div></li><li class="listitem"><div class="para">
				Rule Set Base Access Control (RSBAC)
			</div></li><li class="listitem"><div class="para">
				National Industrial Security Program Operating Manual (NISPOM)
			</div></li><li class="listitem"><div class="para">
				Federal Information Security Management Act (FISMA)
			</div></li><li class="listitem"><div class="para">
				Payment Card Industry — Data Security Standard (PCI-DSS)
			</div></li><li class="listitem"><div class="para">
				Security Technical Implementation Guides (STIG)
			</div></li></ul></div><div class="para">
		Audit has also been:
	</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
				Evaluated by National Information Assurance Partnership (NIAP) and Best Security Industries (BSI).
			</div></li><li class="listitem"><div class="para">
				Certified to LSPP/CAPP/RSBAC/EAL4+ on Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;5.
			</div></li><li class="listitem"><div class="para">
				Certified to Operating System Protection Profile / Evaluation 
Assurance Level 4+ (OSPP/EAL4+) on Red&nbsp;Hat 
Enterprise&nbsp;Linux&nbsp;6.
			</div></li></ul></div><h3 id="bh-Use_Cases">Use Cases</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">Watching file access</span></dt><dd><div class="para">
					Audit can track whether a file or a directory has been accessed, 
modified, executed, or the file's attributes have been changed. This is 
useful, for example, to detect access to important files and have an 
Audit trail available in case one of these files is corrupted.
				</div></dd><dt><span class="term">Monitoring system calls</span></dt><dd><div class="para">
					Audit can be configured to generate a log entry every time a 
particular system call is used. This can be used, for example, to track 
changes to the system time by monitoring the <code class="systemitem">settimeofday</code>, <code class="systemitem">clock_adjtime</code>, and other time-related system calls.
				</div></dd><dt><span class="term">Recording commands run by a user</span></dt><dd><div class="para">
					Because Audit can track whether a file has been executed, a number 
of rules can be defined to record every execution of a particular 
command. For example, a rule can be defined for every executable in the <code class="filename">/bin</code> directory. The resulting log entries can then be searched by user ID to generate an audit trail of executed commands per user.
				</div></dd><dt><span class="term">Recording security events</span></dt><dd><div class="para">
					The <code class="systemitem">pam_faillock</code> authentication 
module is capable of recording failed login attempts. Audit can be set 
up to record failed login attempts as well, and provides additional 
information about the user who attempted to log in.
				</div></dd><dt><span class="term">Searching for events</span></dt><dd><div class="para">
					Audit provides the <span class="application"><strong>ausearch</strong></span> utility, which can be used to filter the log entries and provide a complete audit trail based on a number of conditions.
				</div></dd><dt><span class="term">Running summary reports</span></dt><dd><div class="para">
					The <span class="application"><strong>aureport</strong></span> 
utility can be used to generate, among other things, daily reports of 
recorded events. A system administrator can then analyze these reports 
and investigate suspicious activity furthermore.
				</div></dd><dt><span class="term">Monitoring network access</span></dt><dd><div class="para">
					The <span class="application"><strong>iptables</strong></span> and <span class="application"><strong>ebtables</strong></span> utilities can be configured to trigger Audit events, allowing system administrators to monitor network access.
				</div></dd></dl></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
			System performance may be affected depending on the amount of information that is collected by Audit.
		</div></div></div><div class="section" id="sec-audit_system_architecture"><div class="titlepage"><div><div><h2 class="title">7.1.&nbsp;Audit System Architecture</h2></div></div></div><div class="para">
			The Audit system consists of two main parts: the user-space 
applications and utilities, and the kernel-side system call processing. 
The kernel component receives system calls from user-space applications 
and filters them through one of the three filters: <span class="emphasis"><em>user</em></span>, <span class="emphasis"><em>task</em></span>, or <span class="emphasis"><em>exit</em></span>. Once a system call passes through one of these filters, it is sent through the <span class="emphasis"><em>exclude</em></span> filter, which, based on the Audit rule configuration, sends it to the Audit daemon for further processing. <a class="xref" href="#fig-audit_architecture">Figure&nbsp;7.1, “Audit system architecture”</a> illustrates this process.
		</div><div class="figure" id="fig-audit_architecture"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/audit_architecture.png" alt="Audit system architecture"></div></div><p class="title"><strong>Figure&nbsp;7.1.&nbsp;Audit system architecture</strong></p></div><div class="para">
			The user-space Audit daemon collects the information from the kernel 
and creates log file entries in a log file. Other Audit user-space 
utilities interact with the Audit daemon, the kernel Audit component, or
 the Audit log files:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<span class="application"><strong>audisp</strong></span> — the 
Audit dispatcher daemon interacts with the Audit daemon and sends events
 to other applications for further processing. The purpose of this 
daemon is to provide a plug-in mechanism so that real-time analytical 
programs can interact with Audit events.
				</div></li><li class="listitem"><div class="para">
					<span class="application"><strong>auditctl</strong></span> — the 
Audit control utility interacts with the kernel Audit component to 
control a number of settings and parameters of the event generation 
process.
				</div></li><li class="listitem"><div class="para">
					The remaining Audit utilities take the contents of the Audit log 
files as input and generate output based on user's requirements. For 
example, the <span class="application"><strong>aureport</strong></span> utility generates a report of all recorded events.
				</div></li></ul></div></div><div class="section" id="sec-installing_the_audit_packages"><div class="titlepage"><div><div><h2 class="title">7.2.&nbsp;Installing the <span class="package">audit</span> Packages</h2></div></div></div><div class="para">
			In order to use the Audit system, you must have the <span class="package">audit</span> packages installed on your system. The <span class="package">audit</span> packages (<span class="package">audit</span> and <span class="package">audit-libs</span>)
 are installed by default on Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6. 
If you do not have these packages installed, execute the following 
command as the root user to install them:
		</div><pre class="screen">~]#&nbsp;<code class="command">yum install audit</code></pre></div><div class="section" id="sec-configuring_the_audit_service"><div class="titlepage"><div><div><h2 class="title">7.3.&nbsp;Configuring the <code class="systemitem">audit</code> Service</h2></div></div></div><div class="para">
			The Audit daemon can be configured in the <code class="filename">/etc/audit/auditd.conf</code>
 configuration file. This file consists of configuration parameters that
 modify the behavior of the Audit daemon. Any empty lines or any text 
following a hash sign (<code class="literal">#</code>) is ignored. See the <span class="citerefentry"><span class="refentrytitle">auditd.conf</span>(5)</span> man page for a complete listing of all configuration parameters and their explanation.
		</div><div class="section" id="sec-configuring_auditd_for_CAPP"><div class="titlepage"><div><div><h3 class="title">7.3.1.&nbsp;Configuring <code class="systemitem">auditd</code> for a CAPP Environment</h3></div></div></div><div class="para">
				The default <code class="systemitem">auditd</code> configuration should be suitable for most environments. However, if your environment has to meet the criteria set by the <span class="emphasis"><em>Controlled Access Protection Profile</em></span> (CAPP), which is a part of the Common Criteria certification, the Audit daemon must be configured with the following settings:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						The directory that holds the Audit log files (usually <code class="filename">/var/log/audit/</code>)
 should reside on a separate partition. This prevents other processes 
from consuming space in this directory, and provides accurate detection 
of the remaining space for the Audit daemon.
					</div></li><li class="listitem"><div class="para">
						The <em class="parameter"><code>max_log_file</code></em> 
parameter, which specifies the maximum size of a single Audit log file, 
must be set to make full use of the available space on the partition 
that holds the Audit log files.
					</div></li><li class="listitem"><div class="para">
						The <em class="parameter"><code>max_log_file_action</code></em> parameter, which decides what action is taken once the limit set in <em class="parameter"><code>max_log_file</code></em> is reached, should be set to <code class="literal">keep_logs</code> to prevent Audit log files from being overwritten.
					</div></li><li class="listitem"><div class="para">
						The <em class="parameter"><code>space_left</code></em> parameter, which specifies the amount of free space left on the disk for which an action that is set in the <em class="parameter"><code>space_left_action</code></em>
 parameter is triggered, must be set to a number that gives the 
administrator enough time to respond and free up disk space. The <em class="parameter"><code>space_left</code></em> value depends on the rate at which the Audit log files are generated.
					</div></li><li class="listitem"><div class="para">
						It is recommended to set the <em class="parameter"><code>space_left_action</code></em> parameter to <code class="literal">email</code> or <code class="literal">exec</code> with an appropriate notification method.
					</div></li><li class="listitem"><div class="para">
						The <em class="parameter"><code>admin_space_left</code></em> parameter, which specifies the absolute minimum amount of free space for which an action that is set in the <em class="parameter"><code>admin_space_left_action</code></em> parameter is triggered, must be set to a value that leaves enough space to log actions performed by the administrator.
					</div></li><li class="listitem"><div class="para">
						The <em class="parameter"><code>admin_space_left_action</code></em> parameter must be set to <code class="literal">single</code> to put the system into single-user mode and allow the administrator to free up some disk space.
					</div></li><li class="listitem"><div class="para">
						The <em class="parameter"><code>disk_full_action</code></em> 
parameter, which specifies an action that is triggered when no free 
space is available on the partition that holds the Audit log files, must
 be set to <code class="literal">halt</code> or <code class="literal">single</code>. This ensures that the system is either shut down or operating in single-user mode when Audit can no longer log events.
					</div></li><li class="listitem"><div class="para">
						The <em class="parameter"><code>disk_error_action</code></em>, 
which specifies an action that is triggered in case an error is detected
 on the partition that holds the Audit log files, must be set to <code class="literal">syslog</code>, <code class="literal">single</code>, or <code class="literal">halt</code>, depending on your local security policies regarding the handling of hardware malfunctions.
					</div></li><li class="listitem"><div class="para">
						The <em class="parameter"><code>flush</code></em> configuration parameter must be set to <code class="literal">sync</code> or <code class="literal">data</code>. These parameters assure that all Audit event data is fully synchronized with the log files on the disk.
					</div></li></ul></div><div class="para">
				The remaining configuration options should be set according to your local security policy.
			</div></div></div><div class="section" id="sec-starting_the_audit_service"><div class="titlepage"><div><div><h2 class="title">7.4.&nbsp;Starting the <code class="systemitem">audit</code> Service</h2></div></div></div><div class="para">
			Once <code class="systemitem">auditd</code> is properly configured, 
start the service to collect Audit information and store it in the log 
files. Execute the following command as the root user to start <code class="systemitem">auditd</code>:
		</div><pre class="screen">~]#&nbsp;<code class="command">service auditd start</code></pre><div class="para">
			Optionally, you can configure <code class="systemitem">auditd</code> to start at boot time using the following command as the root user:
		</div><pre class="screen">~]#&nbsp;<code class="command">chkconfig auditd on</code></pre><div class="para">
			A number of other actions can be performed on <code class="systemitem">auditd</code> using the <code class="command">service auditd <em class="replaceable">action</em></code> command, where <em class="replaceable">action</em> can be one of the following:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="command">stop</code> — stops <code class="systemitem">auditd</code>.
				</div></li><li class="listitem"><div class="para">
					<code class="command">restart</code> — restarts <code class="systemitem">auditd</code>.
				</div></li><li class="listitem"><div class="para">
					<code class="command">reload</code> or <code class="command">force-reload</code> — reloads the configuration of <span class="application"><strong>auditd</strong></span> from the <code class="filename">/etc/audit/auditd.conf</code> file.
				</div></li><li class="listitem"><div class="para">
					<code class="command">rotate</code> — rotates the log files in the <code class="filename">/var/log/audit/</code> directory.
				</div></li><li class="listitem"><div class="para">
					<code class="command">resume</code> — resumes logging of Audit 
events after it has been previously suspended, for example, when there 
is not enough free space on the disk partition that holds the Audit log 
files.
				</div></li><li class="listitem"><div class="para">
					<code class="command">condrestart</code> or <code class="command">try-restart</code> — restarts <span class="application"><strong>auditd</strong></span> only if it is already running.
				</div></li><li class="listitem"><div class="para">
					<code class="command">status</code> — displays the running status of <span class="application"><strong>auditd</strong></span>.
				</div></li></ul></div></div><div class="section" id="sec-Defining_Audit_Rules_and_Controls"><div class="titlepage"><div><div><h2 class="title">7.5.&nbsp;Defining Audit Rules</h2></div></div></div><div class="para">
			The Audit system operates on a set of rules that define what is to be
 captured in the log files. There are three types of Audit rules that 
can be specified:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Control rules — allow the Audit system's behavior and some of its configuration to be modified.
				</div></li><li class="listitem"><div class="para">
					File system rules — also known as file watches, allow the auditing of access to a particular file or a directory.
				</div></li><li class="listitem"><div class="para">
					System call rules — allow logging of system calls that any specified program makes.
				</div></li></ul></div><div class="para">
			Audit rules can be specified on the command line with the <span class="application"><strong>auditctl</strong></span> utility (note that these rules are not persistent across reboots), or written in the <code class="filename">/etc/audit/audit.rules</code> file. The following two sections summarize both approaches to defining Audit rules.
		</div><div class="section" id="sec-Defining_Audit_Rules_with_the_auditctl_utility"><div class="titlepage"><div><div><h3 class="title">7.5.1.&nbsp;Defining Audit Rules with the <span class="application"><strong>auditctl</strong></span> Utility</h3></div></div></div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					All commands which interact with the Audit service and the Audit 
log files require root privileges. Ensure you execute these commands as 
the root user.
				</div></div></div><div class="para">
				The <code class="command">auditctl</code> command allows you to 
control the basic functionality of the Audit system and to define rules 
that decide which Audit events are logged.
			</div><h3 id="bh-defining_controls_with_auditctl">Defining Control Rules</h3><div class="para">
				The following are some of the control rules that allow you to modify the behavior of the Audit system:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="option">-b</code></span></dt><dd><div class="para">
							sets the maximum amount of existing Audit buffers in the kernel, for example:
						</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -b 8192</code></pre></dd><dt><span class="term"><code class="option">-f</code></span></dt><dd><div class="para">
							sets the action that is performed when a critical error is detected, for example:
						</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -f 2</code></pre><div class="para">
							The above configuration triggers a kernel panic in case of a critical error.
						</div></dd><dt><span class="term"><code class="option">-e</code></span></dt><dd><div class="para">
							enables and disables the Audit system or locks its configuration, for example:
						</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -e 2</code></pre><div class="para">
							The above command locks the Audit configuration.
						</div></dd><dt><span class="term"><code class="option">-r</code></span></dt><dd><div class="para">
							sets the rate of generated messages per second, for example:
						</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -r 0</code></pre><div class="para">
							The above configuration sets no rate limit on generated messages.
						</div></dd><dt><span class="term"><code class="option">-s</code></span></dt><dd><div class="para">
							reports the status of the Audit system, for example:
						</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -s</code>
AUDIT_STATUS: enabled=1 flag=2 pid=0 rate_limit=0 backlog_limit=8192 lost=259 backlog=0
</pre></dd><dt><span class="term"><code class="option">-l</code></span></dt><dd><div class="para">
							lists all currently loaded Audit rules, for example:
						</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -l</code>
LIST_RULES: exit,always watch=/etc/localtime perm=wa key=time-change
LIST_RULES: exit,always watch=/etc/group perm=wa key=identity
LIST_RULES: exit,always watch=/etc/passwd perm=wa key=identity
LIST_RULES: exit,always watch=/etc/gshadow perm=wa key=identity
⋮
</pre></dd><dt><span class="term"><code class="option">-D</code></span></dt><dd><div class="para">
							deletes all currently loaded Audit rules, for example:
						</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -D</code>
No rules
</pre></dd></dl></div><h3 id="bh-defining_file_rules_with_auditctl">Defining File System Rules</h3><div class="para">
				To define a file system rule, use the following syntax:
			</div><pre class="screen">auditctl -w <em class="replaceable">path_to_file</em> -p <em class="replaceable">permissions</em> -k <em class="replaceable">key_name</em></pre><div class="para">
				where:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<em class="replaceable">path_to_file</em> is the file or directory that is audited.
					</div></li><li class="listitem"><div class="para">
						<em class="replaceable">permissions</em> are the permissions that are logged:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								<code class="option">r</code> — read access to a file or a directory.
							</div></li><li class="listitem"><div class="para">
								<code class="option">w</code> — write access to a file or a directory.
							</div></li><li class="listitem"><div class="para">
								<code class="option">x</code> — execute access to a file or a directory.
							</div></li><li class="listitem"><div class="para">
								<code class="option">a</code> — change in the file's or directory's attribute.
							</div></li></ul></div></li><li class="listitem"><div class="para">
						<em class="replaceable">key_name</em> is an optional string that helps you identify which rule or a set of rules generated a particular log entry.
					</div></li></ul></div><div class="example" id="ex-file_watch_rules"><p class="title"><strong>Example&nbsp;7.1.&nbsp;File System Rules</strong></p><div class="example-contents"><div class="para">
					To define a rule that logs all write access to, and every attribute change of, the <code class="filename">/etc/passwd</code> file, execute the following command:
				</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -w /etc/passwd -p wa -k passwd_changes</code></pre><div class="para">
					Note that the string following the <code class="option">-k</code> option is arbitrary.
				</div><div class="para">
					To define a rule that logs all write access to, and every attribute change of, all the files in the <code class="filename">/etc/selinux/</code> directory, execute the following command:
				</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -w /etc/selinux/ -p wa -k selinux_changes</code></pre><div class="para">
					To define a rule that logs the execution of the <code class="command">/sbin/insmod</code> command, which inserts a module into the Linux kernel, execute the following command:
				</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -w /sbin/insmod -p x -k module_insertion</code></pre></div></div><h3 id="bh-defining_syscall_rules_with_auditctl">Defining System Call Rules</h3><div class="para">
				To define a system call rule, use the following syntax:
			</div><pre class="screen">auditctl -a <em class="replaceable">action</em>,<em class="replaceable">filter</em> -S <em class="replaceable">system_call</em> -F <em class="replaceable">field</em>=<em class="replaceable">value</em> -k <em class="replaceable">key_name</em></pre><div class="para">
				where:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<em class="replaceable">action</em> and <em class="replaceable">filter</em> specify when a certain event is logged. <em class="replaceable">action</em> can be either <code class="literal">always</code> or <code class="literal">never</code>. <em class="replaceable">filter</em> specifies which kernel rule-matching filter is applied to the event. The rule-matching filter can be one of the following: <code class="literal">task</code>, <code class="literal">exit</code>, <code class="literal">user</code>, and <code class="literal">exclude</code>. For more information about these filters, see the beginning of <a class="xref" href="#sec-audit_system_architecture">Section&nbsp;7.1, “Audit System Architecture”</a>.
					</div></li><li class="listitem"><div class="para">
						<em class="replaceable">system_call</em> specifies the system call by its name. A list of all system calls can be found in the <code class="filename">/usr/include/asm/unistd_64.h</code> file. Several system calls can be grouped into one rule, each specified after the <code class="option">-S</code> option.
					</div></li><li class="listitem"><div class="para">
						<em class="replaceable">field</em>=<em class="replaceable">value</em>
 specifies additional options that furthermore modify the rule to match 
events based on a specified architecture, group ID, process ID, and 
others. For a full listing of all available field types and their 
values, see the <span class="citerefentry"><span class="refentrytitle">auditctl</span>(8)</span> man page.
					</div></li><li class="listitem"><div class="para">
						<em class="replaceable">key_name</em> is an optional string that helps you identify which rule or a set of rules generated a particular log entry.
					</div></li></ul></div><div class="example" id="ex-system_call_rules"><p class="title"><strong>Example&nbsp;7.2.&nbsp;System Call Rules</strong></p><div class="example-contents"><div class="para">
					To define a rule that creates a log entry every time the <code class="literal">adjtimex</code> or <code class="literal">settimeofday</code> system calls are used by a program, and the system uses the 64-bit architecture, execute the following command:
				</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time_change</code></pre><div class="para">
					To define a rule that creates a log entry every time a file is 
deleted or renamed by a system user whose ID is 500 or larger (the <code class="option">-F auid!=4294967295</code> option is used to exclude users whose login UID is not set), execute the following command:
				</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -a always,exit -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=500 -F auid!=4294967295 -k delete</code></pre><div class="para">
					It is also possible to define a file system rule using the system 
call rule syntax. The following command creates a rule for system calls 
that is analogous to the <code class="literal">-w /etc/shadow -p wa</code> file system rule:
				</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -a always,exit -F path=/etc/shadow -F perm=wa</code></pre></div></div></div><div class="section" id="sec-Defining_Audit_Rules_and_Controls_in_the_audit.rules_file"><div class="titlepage"><div><div><h3 class="title">7.5.2.&nbsp;Defining Persistent Audit Rules and Controls in the <code class="filename">/etc/audit/audit.rules</code> File</h3></div></div></div><div class="para">
				To define Audit rules that are persistent across reboots, you must include them in the <code class="filename">/etc/audit/audit.rules</code> file. This file uses the same <code class="command">auditctl</code> command line syntax to specify the rules. Any empty lines or any text following a hash sign (<code class="literal">#</code>) is ignored.
			</div><div class="para">
				The <code class="command">auditctl</code> command can also be used to read rules from a specified file with the <code class="option">-R</code> option, for example:
			</div><pre class="screen">~]#&nbsp;<code class="command">auditctl -R /usr/share/doc/audit-<em class="replaceable">version</em>/stig.rules</code></pre><h3 id="bh-defining_control_rules">Defining Control Rules</h3><div class="para">
				A file can contain only the following control rules that modify the behavior of the Audit system: <code class="option">-b</code>, <code class="option">-D</code>, <code class="option">-e</code>, <code class="option">-f</code>, and <code class="option">-r</code>. For more information on these options, see <a class="xref" href="#bh-defining_controls_with_auditctl">the section called “Defining Control Rules”</a>.
			</div><div class="example" id="ex-control_rules_file"><p class="title"><strong>Example&nbsp;7.3.&nbsp;Control rules in <code class="filename">audit.rules</code></strong></p><div class="example-contents"><pre class="screen"># Delete all previous rules
-D

# Set buffer size
-b 8192

# Make the configuration immutable -- reboot is required to change audit rules
-e 2

# Panic when a failure occurs
-f 2

# Generate at most 100 audit messages per second
-r 100
</pre></div></div><h3 id="bh-defining_file_system_rules">Defining File System and System Call Rules</h3><div class="para">
				File system and system call rules are defined using the <code class="command">auditctl</code> syntax. The examples in <a class="xref" href="#sec-Defining_Audit_Rules_with_the_auditctl_utility">Section&nbsp;7.5.1, “Defining Audit Rules with the <span class="application"><strong>auditctl</strong></span> Utility”</a> can be represented with the following rules file:
			</div><div class="example" id="ex-file_system_and_syscall_rules_file"><p class="title"><strong>Example&nbsp;7.4.&nbsp;File system and system call rules in <code class="filename">audit.rules</code></strong></p><div class="example-contents"><pre class="screen">-w /etc/passwd -p wa -k passwd_changes
-w /etc/selinux/ -p wa -k selinux_changes
-w /sbin/insmod -p x -k module_insertion

-a always,exit -F arch=b64 -S adjtimex -S settimeofday -k time_change
-a always,exit -S unlink -S unlinkat -S rename -S renameat -F auid&gt;=500 -F auid!=4294967295 -k delete
</pre></div></div><h3 id="bh-preconfigured_rules_files">Preconfigured Rules Files</h3><div class="para">
				In the <code class="filename">/usr/share/doc/audit-<em class="replaceable">version</em>/</code> directory, the <span class="package">audit</span> package provides a set of pre-configured rules files according to various certification standards:
			</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
						<code class="filename">nispom.rules</code> — Audit rule 
configuration that meets the requirements specified in Chapter&nbsp;8 of
 the National Industrial Security Program Operating Manual.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">capp.rules</code> — Audit rule configuration that meets the requirements set by <a href="http://www.niap-ccevs.org/pp/pp_os_ca_v1.d.pdf">Controlled&nbsp;Access&nbsp;Protection&nbsp;Profile</a> (CAPP), which is a part of the Common Criteria certification.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">lspp.rules</code> — Audit rule configuration that meets the requirements set by <a href="http://www.commoncriteriaportal.org/files/ppfiles/lspp.pdf">Labeled&nbsp;Security&nbsp;Protection&nbsp;Profile</a> (LSPP), which is a part of the Common Criteria certification.
					</div></li><li class="listitem"><div class="para">
						<code class="filename">stig.rules</code> — Audit rule configuration that meets the requirements set by Security&nbsp;Technical&nbsp;Implementation&nbsp;Guides (STIG).
					</div></li></ul></div><div class="para">
				To use these configuration files, create a backup of your original <code class="filename">/etc/audit/audit.rules</code> file and copy the configuration file of your choice over the <code class="filename">/etc/audit/audit.rules</code> file:
			</div><pre class="screen">~]#&nbsp;<code class="command">cp /etc/audit/audit.rules /etc/audit/audit.rules_backup</code>
~]#&nbsp;<code class="command">cp /usr/share/doc/audit-<em class="replaceable">version</em>/stig.rules /etc/audit/audit.rules</code></pre></div></div><div class="section" id="sec-Understanding_Audit_Log_Files"><div class="titlepage"><div><div><h2 class="title">7.6.&nbsp;Understanding Audit Log Files</h2></div></div></div><div class="para">
			By default, the Audit system stores log entries in the <code class="filename">/var/log/audit/audit.log</code> file; if log rotation is enabled, rotated <code class="filename">audit.log</code> files are stored in the same directory.
		</div><div class="para">
			The following Audit rule logs every attempt to read or modify the <code class="filename">/etc/ssh/sshd_config</code> file:
		</div><pre class="screen">-w /etc/ssh/sshd_config -p warx -k sshd_config
</pre><div class="para">
			If the <code class="systemitem">auditd</code> daemon is running, running the following command creates a new event in the Audit log file:
		</div><pre class="screen">~]#&nbsp;<code class="command">cat /etc/ssh/sshd_config</code></pre><div class="para">
			This event in the <code class="filename">audit.log</code> file looks as follows:
		</div><pre class="screen">type=SYSCALL msg=audit(1364481363.243:24287): arch=c000003e syscall=2 success=no exit=-13 a0=7fffd19c5592 a1=0 a2=7fffd19c4b50 a3=a items=1 ppid=2686 pid=3538 auid=500 uid=500 gid=500 euid=500 suid=500 fsuid=500 egid=500 sgid=500 fsgid=500 tty=pts0 ses=1 comm="cat" exe="/bin/cat" subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 key="sshd_config"
type=CWD msg=audit(1364481363.243:24287):  cwd="/home/shadowman"
type=PATH msg=audit(1364481363.243:24287): item=0 name="/etc/ssh/sshd_config" inode=409248 dev=fd:00 mode=0100600 ouid=0 ogid=0 rdev=00:00 obj=system_u:object_r:etc_t:s0
</pre><div class="para">
			The above event consists of three records (each starting with the <code class="literal">type=</code> keyword), which share the same time stamp and serial number. Each record consists of several <code class="literal"><em class="replaceable">name</em>=<em class="replaceable">value</em></code> pairs separated by a white space or a comma. A detailed analysis of the above event follows:
		</div><h3 id="bh-first_record">First Record</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">type=SYSCALL</code></span></dt><dd><div class="para">
						The <code class="literal">type</code> field contains the type of the record. In this example, the <code class="literal">SYSCALL</code> value specifies that this record was triggered by a system call to the kernel.
					</div><div class="para">
						For a list of all possible type values and their explanations, see <a class="xref" href="#sec-Audit_Record_Types">Section&nbsp;B.2, “Audit Record Types”</a>.
					</div></dd><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287):</code></span></dt><dd><div class="para">
						The <code class="literal">msg</code> field records:
					</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
								a time stamp and a unique ID of the record in the form <code class="literal">audit(<em class="replaceable">time_stamp</em>:<em class="replaceable">ID</em>)</code>. Multiple records can share the same time stamp and ID if they were generated as part of the same Audit event.
							</div></li><li class="listitem"><div class="para">
								various event-specific <code class="literal"><em class="replaceable">name</em>=<em class="replaceable">value</em></code> pairs provided by the kernel or user space applications.
							</div></li></ul></div></dd><dt><span class="term"><code class="literal">arch=c000003e</code></span></dt><dd><div class="para">
						The <code class="literal">arch</code> field contains information about the CPU architecture of the system. The value, <code class="literal">c000003e</code>, is encoded in hexadecimal notation. When searching Audit records with the <code class="command">ausearch</code> command, use the <code class="option">-i</code> or <code class="option">--interpret</code> option to automatically convert hexadecimal values into their human-readable equivalents. The <code class="literal">c000003e</code> value is interpreted as <code class="literal">x86_64</code>.
					</div></dd><dt><span class="term"><code class="literal">syscall=2</code></span></dt><dd><div class="para">
						The <code class="literal">syscall</code> field records the type of the system call that was sent to the kernel. The value, <code class="literal">2</code>, can be matched with its human-readable equivalent in the <code class="filename">/usr/include/asm/unistd_64.h</code> file. In this case, <code class="literal">2</code> is the <code class="literal">open</code> system call. Note that the <span class="application"><strong>ausyscall</strong></span> utility allows you to convert system call numbers to their human-readable equivalents. Use the <code class="command">ausyscall --dump</code> command to display a listing of all system calls along with their numbers. For more information, see the <span class="citerefentry"><span class="refentrytitle">ausyscall</span>(8)</span> man page.
					</div></dd><dt><span class="term"><code class="literal">success=no</code></span></dt><dd><div class="para">
						The <code class="literal">success</code> field records whether the
 system call recorded in that particular event succeeded or failed. In 
this case, the call did not succeed.
					</div></dd><dt><span class="term"><code class="literal">exit=-13</code></span></dt><dd><div class="para">
						The <code class="literal">exit</code> field contains a value that 
specifies the exit code returned by the system call. This value varies 
for different system call. You can interpret the value to its 
human-readable equivalent with the following command: <code class="command">ausearch --interpret --exit -13</code> (assuming your Audit log contains an event that failed with exit code <code class="literal">-13</code>).
					</div></dd><dt><span class="term"><code class="literal">a0=7fffd19c5592</code>, <code class="literal">a1=0</code>, <code class="literal">a2=7fffd19c5592</code>, <code class="literal">a3=a</code></span></dt><dd><div class="para">
						The <code class="literal">a0</code> to <code class="literal">a3</code>
 fields record the first four arguments, encoded in hexadecimal 
notation, of the system call in this event. These arguments depend on 
the system call that is used; they can be interpreted by the <span class="application"><strong>ausearch</strong></span> utility.
					</div></dd><dt><span class="term"><code class="literal">items=1</code></span></dt><dd><div class="para">
						The <code class="literal">items</code> field contains the number of path records in the event.
					</div></dd><dt><span class="term"><code class="literal">ppid=2686</code></span></dt><dd><div class="para">
						The <code class="literal">ppid</code> field records the Parent Process ID (PPID). In this case, <code class="literal">2686</code> was the PPID of the <code class="systemitem">bash</code> process.
					</div></dd><dt><span class="term"><code class="literal">pid=3538</code></span></dt><dd><div class="para">
						The <code class="literal">pid</code> field records the Process ID (PID). In this case, <code class="literal">3538</code> was the PID of the <code class="systemitem">cat</code> process.
					</div></dd><dt><span class="term"><code class="literal">auid=500</code></span></dt><dd><div class="para">
						The <code class="literal">auid</code> field records the Audit user
 ID, that is the loginuid. This ID is assigned to a user upon login and 
is inherited by every process even when the user's identity changes (for
 example, by switching user accounts with the <code class="command">su - john</code> command).
					</div></dd><dt><span class="term"><code class="literal">uid=500</code></span></dt><dd><div class="para">
						The <code class="literal">uid</code> field records the user ID of 
the user who started the analyzed process. The user ID can be 
interpreted into user names with the following command: <code class="command">ausearch -i --uid <em class="replaceable">UID</em></code>. In this case, <code class="literal">500</code> is the user ID of user <code class="literal">shadowman</code>.
					</div></dd><dt><span class="term"><code class="literal">gid=500</code></span></dt><dd><div class="para">
						The <code class="literal">gid</code> field records the group ID of the user who started the analyzed process.
					</div></dd><dt><span class="term"><code class="literal">euid=500</code></span></dt><dd><div class="para">
						The <code class="literal">euid</code> field records the effective user ID of the user who started the analyzed process.
					</div></dd><dt><span class="term"><code class="literal">suid=500</code></span></dt><dd><div class="para">
						The <code class="literal">suid</code> field records the set user ID of the user who started the analyzed process.
					</div></dd><dt><span class="term"><code class="literal">fsuid=500</code></span></dt><dd><div class="para">
						The <code class="literal">fsuid</code> field records the file system user ID of the user who started the analyzed process.
					</div></dd><dt><span class="term"><code class="literal">egid=500</code></span></dt><dd><div class="para">
						The <code class="literal">egid</code> field records the effective group ID of the user who started the analyzed process.
					</div></dd><dt><span class="term"><code class="literal">sgid=500</code></span></dt><dd><div class="para">
						The <code class="literal">sgid</code> field records the set group ID of the user who started the analyzed process.
					</div></dd><dt><span class="term"><code class="literal">fsgid=500</code></span></dt><dd><div class="para">
						The <code class="literal">fsgid</code> field records the file system group ID of the user who started the analyzed process.
					</div></dd><dt><span class="term"><code class="literal">tty=pts0</code></span></dt><dd><div class="para">
						The <code class="literal">tty</code> field records the terminal from which the analyzed process was invoked.
					</div></dd><dt><span class="term"><code class="literal">ses=1</code></span></dt><dd><div class="para">
						The <code class="literal">ses</code> field records the session ID of the session from which the analyzed process was invoked.
					</div></dd><dt><span class="term"><code class="literal">comm="cat"</code></span></dt><dd><div class="para">
						The <code class="literal">comm</code> field records the command-line name of the command that was used to invoke the analyzed process. In this case, the <code class="command">cat</code> command was used to trigger this Audit event.
					</div></dd><dt><span class="term"><code class="literal">exe="/bin/cat"</code></span></dt><dd><div class="para">
						The <code class="literal">exe</code> field records the path to the executable that was used to invoke the analyzed process.
					</div></dd><dt><span class="term"><code class="literal">subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</code></span></dt><dd><div class="para">
						The <code class="literal">subj</code> field records the SELinux context with which the analyzed process was labeled at the time of execution.
					</div></dd><dt><span class="term"><code class="literal">key="sshd_config"</code></span></dt><dd><div class="para">
						The <code class="literal">key</code> field records the administrator-defined string associated with the rule that generated this event in the Audit log.
					</div></dd></dl></div><h3 id="bh-second_record">Second Record</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">type=CWD</code></span></dt><dd><div class="para">
						In the second record, the <code class="literal">type</code> field value is <code class="literal">CWD</code>
 — current working directory. This type is used to record the working 
directory from which the process that invoked the system call specified 
in the first record was executed.
					</div><div class="para">
						The purpose of this record is to record the current process's 
location in case a relative path is captured in the associated PATH 
record. This way the absolute path can be reconstructed.
					</div></dd><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287)</code></span></dt><dd><div class="para">
						The <code class="literal">msg</code> field holds the same time stamp and ID value as the value in the first record.
					</div></dd><dt><span class="term"><code class="literal">cwd="/home/shadowman"</code></span></dt><dd><div class="para">
						The <code class="literal">cwd</code> field contains the path to the directory in which the system call was invoked.
					</div></dd></dl></div><h3 id="bh-third_record">Third Record</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">type=PATH</code></span></dt><dd><div class="para">
						In the third record, the <code class="literal">type</code> field value is <code class="literal">PATH</code>. An Audit event contains a <code class="literal">PATH</code>-type record for every path that is passed to the system call as an argument. In this Audit event, only one path (<code class="filename">/etc/ssh/sshd_config</code>) was used as an argument.
					</div></dd><dt><span class="term"><code class="literal">msg=audit(1364481363.243:24287):</code></span></dt><dd><div class="para">
						The <code class="literal">msg</code> field holds the same time stamp and ID value as the value in the first and second record.
					</div></dd><dt><span class="term"><code class="literal">item=0</code></span></dt><dd><div class="para">
						The <code class="literal">item</code> field indicates which item, of the total number of items referenced in the <code class="literal">SYSCALL</code> type record, the current record is. This number is zero-based; a value of <code class="literal">0</code> means it is the first item.
					</div></dd><dt><span class="term"><code class="literal">name="/etc/ssh/sshd_config"</code></span></dt><dd><div class="para">
						The <code class="literal">name</code> field records the full path 
of the file or directory that was passed to the system call as an 
argument. In this case, it was the <code class="filename">/etc/ssh/sshd_config</code> file.
					</div></dd><dt><span class="term"><code class="literal">inode=409248</code></span></dt><dd><div class="para">
						The <code class="literal">inode</code> field contains the inode 
number associated with the file or directory recorded in this event. The
 following command displays the file or directory that is associated 
with the <code class="literal">409248</code> inode number:
					</div><pre class="screen">~]#&nbsp;<code class="command">find / -inum 409248 -print</code>
/etc/ssh/sshd_config
</pre></dd><dt><span class="term"><code class="literal">dev=fd:00</code></span></dt><dd><div class="para">
						The <code class="literal">dev</code> field specifies the minor and
 major ID of the device that contains the file or directory recorded in 
this event. In this case, the value represents the <code class="filename">/dev/fd/0</code> device.
					</div></dd><dt><span class="term"><code class="literal">mode=0100600</code></span></dt><dd><div class="para">
						The <code class="literal">mode</code> field records the file or directory permissions, encoded in numerical notation. In this case, <code class="literal">0100600</code> can be interpreted as <code class="literal">-rw-------</code>, meaning that only the root user has read and write permissions to the <code class="filename">/etc/ssh/sshd_config</code> file.
					</div></dd><dt><span class="term"><code class="literal">ouid=0</code></span></dt><dd><div class="para">
						The <code class="literal">ouid</code> field records the object owner's user ID.
					</div></dd><dt><span class="term"><code class="literal">ogid=0</code></span></dt><dd><div class="para">
						The <code class="literal">ogid</code> field records the object owner's group ID.
					</div></dd><dt><span class="term"><code class="literal">rdev=00:00</code></span></dt><dd><div class="para">
						The <code class="literal">rdev</code> field contains a recorded 
device identifier for special files only. In this case, it is not used 
as the recorded file is a regular file.
					</div></dd><dt><span class="term"><code class="literal">obj=system_u:object_r:etc_t:s0</code></span></dt><dd><div class="para">
						The <code class="literal">obj</code> field records the SELinux context with which the recorded file or directory was labeled at the time of execution.
					</div></dd></dl></div><div class="para">
			The Audit event analyzed above contains only a subset of all possible
 fields that an event can contain. For a list of all event fields and 
their explanation, see <a class="xref" href="#sec-Audit_Events_Fields">Section&nbsp;B.1, “Audit Event Fields”</a>. For a list of all event types and their explanation, see <a class="xref" href="#sec-Audit_Record_Types">Section&nbsp;B.2, “Audit Record Types”</a>.
		</div><div class="example" id="ex-audit_log_events"><p class="title"><strong>Example&nbsp;7.5.&nbsp;Additional <code class="filename">audit.log</code> events</strong></p><div class="example-contents"><div class="para">
				The following Audit event records a successful start of the <code class="systemitem">auditd</code> daemon. The <code class="literal">ver</code> field shows the version of the Audit daemon that was started.
			</div><pre class="screen">type=DAEMON_START msg=audit(1363713609.192:5426): auditd start, ver=2.2 format=raw kernel=2.6.32-358.2.1.el6.x86_64 auid=500 pid=4979 subj=unconfined_u:system_r:auditd_t:s0 res=success
</pre><div class="para">
				The following Audit event records a failed attempt of user with UID of 500 to log in as the root user.
			</div><pre class="screen">type=USER_AUTH msg=audit(1364475353.159:24270): user pid=3280 uid=500 auid=500 ses=1 subj=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023 msg='op=PAM:authentication acct="root" exe="/bin/su" hostname=? addr=? terminal=pts/0 res=failed'
</pre></div></div></div><div class="section" id="sec-Searching_the_Audit_Log_Files"><div class="titlepage"><div><div><h2 class="title">7.7.&nbsp;Searching the Audit Log Files</h2></div></div></div><div class="para">
			The <span class="application"><strong>ausearch</strong></span> utility allows you to search Audit log files for specific events. By default, <span class="application"><strong>ausearch</strong></span> searches the <code class="filename">/var/log/audit/audit.log</code> file. You can specify a different file using the <code class="command">ausearch <em class="replaceable">options</em> -if <em class="replaceable">file_name</em></code> command. Supplying multiple options in one <code class="command">ausearch</code> command is equivalent to using the <span class="emphasis"><em>AND</em></span> operator.
		</div><div class="example" id="ex-ausearch_examples"><p class="title"><strong>Example&nbsp;7.6.&nbsp;Using <code class="command">ausearch</code> to search Audit log files</strong></p><div class="example-contents"><div class="para">
				To search the <code class="filename">/var/log/audit/audit.log</code> file for failed login attempts, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">ausearch --message USER_LOGIN --success no --interpret</code></pre><div class="para">
				To search for all account, group, and role changes, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">ausearch -m ADD_USER -m DEL_USER -m ADD_GROUP -m USER_CHAUTHTOK -m DEL_GROUP -m CHGRP_ID -m ROLE_ASSIGN -m ROLE_REMOVE -i</code></pre><div class="para">
				To search for all logged actions performed by a certain user, using the user's login ID (<code class="literal">auid</code>), use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">ausearch -ua 500 -i</code></pre><div class="para">
				To search for all failed system calls from yesterday up until now, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">ausearch --start yesterday --end now -m SYSCALL -sv no -i</code></pre></div></div><div class="para">
			For a full listing of all <code class="command">ausearch</code> options, see the <span class="citerefentry"><span class="refentrytitle">ausearch</span>(8)</span> man page.
		</div></div><div class="section" id="sec-Creating_Audit_Reports"><div class="titlepage"><div><div><h2 class="title">7.8.&nbsp;Creating Audit Reports</h2></div></div></div><div class="para">
			The <span class="application"><strong>aureport</strong></span> utility allows you to generate summary and columnar reports on the events recorded in Audit log files. By default, all <code class="filename">audit.log</code> files in the <code class="filename">/var/log/audit/</code> directory are queried to create the report. You can specify a different file to run the report against using the <code class="command">aureport <em class="replaceable">options</em> -if <em class="replaceable">file_name</em></code> command.
		</div><div class="example" id="ex-aureport_examples"><p class="title"><strong>Example&nbsp;7.7.&nbsp;Using <code class="command">aureport</code> to generate Audit reports</strong></p><div class="example-contents"><div class="para">
				To generate a report for logged events in the past three days excluding the current example day, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">aureport --start 04/08/2013 00:00:00 --end 04/11/2013 00:00:00</code></pre><div class="para">
				To generate a report of all executable file events, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">aureport -x</code></pre><div class="para">
				To generate a summary of the executable file event report above, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">aureport -x --summary</code></pre><div class="para">
				To generate a summary report of failed events for all users, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">aureport -u --failed --summary -i</code></pre><div class="para">
				To generate a summary report of all failed login attempts per each system user, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">aureport --login --summary -i</code></pre><div class="para">
				To generate a report from an <code class="command">ausearch</code> query that searches all file access events for user <code class="literal">500</code>, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">ausearch --start today --loginuid 500 --raw | aureport -f --summary</code></pre><div class="para">
				To generate a report of all Audit files that are queried and the 
time range of events they include, use the following command:
			</div><pre class="screen">~]#&nbsp;<code class="command">aureport -t</code></pre></div></div><div class="para">
			For a full listing of all <code class="command">aureport</code> options, see the <span class="citerefentry"><span class="refentrytitle">aureport</span>(8)</span> man page.
		</div></div><div class="section" id="sec-Configuring_PAM_for_Auditing"><div class="titlepage"><div><div><h2 class="title">7.9.&nbsp;Configuring PAM for Auditing</h2></div></div></div><div class="section" id="sec-configuring_pam_tty_audit"><div class="titlepage"><div><div><h3 class="title">7.9.1.&nbsp;Configuring pam_tty_audit</h3></div></div></div><div class="para">
				The audit system in Red&nbsp;Hat Enterprise&nbsp;Linux uses the <code class="filename">pam_tty_audit</code> PAM module to enable or disable auditing of TTY input for specified users. When the audited user logs in, <code class="filename">pam_tty_audit</code> records the exact keystrokes the user makes into the <code class="filename">/var/log/audit/audit.log</code> file. The module works with the <code class="systemitem">auditd</code> daemon, so make sure it is enabled before configuring <code class="filename">pam_tty_audit</code>. See <a class="xref" href="#sec-starting_the_audit_service">Section&nbsp;7.4, “Starting the <code class="systemitem">audit</code> Service”</a> for more information.
			</div><div class="para">
				When you want to specify user names for TTY auditing, modify the <code class="filename">/etc/pam.d/system-auth</code> and <code class="filename">/etc/pam.d/password-auth</code> files using the <code class="literal">disable</code> and <code class="literal">enable</code> options in the following format:
			</div><pre class="synopsis"> session required pam_tty_audit.so disable=<em class="replaceable">username</em>,<em class="replaceable">username2</em> enable=<em class="replaceable">username</em> </pre><div class="para">
				You can specify one or more user names separated by commas in the options. Any <code class="literal">disable</code> or <code class="literal">enable</code>
 option overrides the previous opposite option which matches the same 
user name. When TTY auditing is enabled, it is inherited by all 
processes started by that user. In particular, daemons restarted by a 
user will still have TTY auditing enabled, and will audit TTY input even
 by other users, unless auditing for these users is explicitly disabled.
 Therefore, it is recommended to use <code class="literal">disable=*</code> as the first option for most daemons using PAM.
			</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
					By default, <code class="filename">pam_tty_audit</code> does <span class="bold bold"><strong>NOT</strong></span> log keystrokes when the TTY is in password entry mode. Logging can be re-enabled by adding the <code class="option">log_passwd</code> option along with the other options in the following way: <pre class="synopsis"> session required pam_tty_audit.so disable=<em class="replaceable">username</em>,<em class="replaceable">username2</em> enable=<em class="replaceable">username</em> log_passwd </pre>
				</div></div></div><div class="para">
				When you enable the module, the input is logged in the <code class="filename">/var/log/audit/audit.log</code> file, written by the <code class="systemitem">auditd</code>
 daemon. Note that the input is not logged immediately, because TTY 
auditing first stores the keystrokes in a buffer and writes the record 
periodically, or once the audited user logs out. The <code class="filename">audit.log</code> file contains <span class="emphasis"><em>all</em></span>
 keystrokes entered by the specified user, including backspaces, delete 
and return keys, the control key and others. Although the contents of <code class="filename">audit.log</code> are human-readable it might be easier to use the <span class="application"><strong>aureport</strong></span> utility, which provides a TTY report in a format which is easy to read. You can use the following command as root: 
<pre class="screen">~]#&nbsp;<code class="command">aureport --tty</code></pre>

			</div><div class="para">
				The following is an example of how to configure <code class="filename">pam_tty_audit</code> to track the actions of the <code class="systemitem">root</code> user across all terminals and then review the input.
			</div><div class="example" id="pro-configuring_pam_tty_audit"><p class="title"><strong>Example&nbsp;7.8.&nbsp;Configuring pam_tty_audit to log root actions</strong></p><div class="example-contents"><div class="para">
					Enter the following line in the <code class="literal">session</code> section of the <code class="filename">/etc/pam.d/system-auth</code> and <code class="filename">/etc/pam.d/password-auth</code> files: 
<pre class="screen">session    required     pam_tty_audit.so disable=* enable=root
</pre>

				</div><div class="para">
					Use the <code class="command">aureport --tty</code> command to view the log. If the <code class="systemitem">root</code> user has logged in a TTY console at around 11:00 o'clock and tried to issue the <code class="command">pwd</code> command, but then deleted it and issued <code class="command">ls</code> instead, the report will look like this:
				</div><pre class="programlisting">~]#&nbsp;<code class="command">aureport --tty -ts today | tail</code>			
40. 08/28/2014 11:00:27 901 0 ? 76 bash "pwd",&lt;backspace&gt;,&lt;backspace&gt;&lt;backspace&gt;,"ls",&lt;ret&gt;
41. 08/28/2014 11:00:29 903 0 ? 76 bash &lt;^D&gt;
</pre></div></div><div class="para">
				For more information, see the <code class="filename">pam_tty_audit(8)</code> manual page.
			</div></div></div><div class="section" id="sec-audit_additional_resources"><div class="titlepage"><div><div><h2 class="title">7.10.&nbsp;Additional Resources</h2></div></div></div><div class="para">
			For more information about the Audit system, see the following sources.
		</div><h3 id="idm140226869481296">Online Sources</h3><div class="para">
			<div class="itemizedlist"><ul><li class="listitem"><div class="para">
						The Linux Audit system project page: <a href="http://people.redhat.com/sgrubb/audit/">http://people.redhat.com/sgrubb/audit/</a>.
					</div></li><li class="listitem"><div class="para">
						Article <em class="citetitle">Investigating kernel Return Codes with the Linux Audit System</em> in the Hack In the Box magazine: <a href="http://magazine.hackinthebox.org/issues/HITB-Ezine-Issue-005.pdf">http://magazine.hackinthebox.org/issues/HITB-Ezine-Issue-005.pdf</a>.
					</div></li></ul></div>

		</div><h3 id="idm140226863097744">Installed Documentation</h3><div class="para">
			Documentation provided by the <span class="package">audit</span> package can be found in the <code class="filename">/usr/share/doc/audit-<em class="replaceable">version</em>/</code> directory.
		</div><h3 id="idm140226870684160">Manual Pages</h3><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">audispd.conf</span>(5)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">auditd.conf</span>(5)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">ausearch-expression</span>(5)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">audit.rules</span>(7)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">audispd</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">auditctl</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">auditd</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">aulast</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">aulastlog</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">aureport</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">ausearch</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">ausyscall</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">autrace</span>(8)</span>
				</div></li><li class="listitem"><div class="para">
					<span class="citerefentry"><span class="refentrytitle">auvirt</span>(8)</span>
				</div></li></ul></div><div class="para">

		</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Compliance_and_Vulnerability_Scanning" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;8.&nbsp;Compliance and Vulnerability Scanning with OpenSCAP</h1></div></div></div><div class="section" id="sect-Security_Compliance_in_RHEL"><div class="titlepage"><div><div><h2 class="title">8.1.&nbsp;Security Compliance in Red Hat Enterprise Linux</h2></div></div></div><div class="para">
			A <em class="firstterm">compliance audit</em> is a process of figuring out whether a given object follows all the rules written out in a compliance policy. The <em class="firstterm">compliance policy</em>
 is defined by security professionals who specify desired settings, 
often in the form of a checklist, that are to be used in the computing 
environment.
		</div><div class="para">
			The compliance policy can vary substantially across organizations and
 even across different systems within the same organization. Differences
 among these policies are based on the purpose of these systems and its 
importance for the organization. The custom software settings and 
deployment characteristics also raise a need for custom policy 
checklists.
		</div><div class="para">
			Red Hat Enterprise Linux provides tools that allow for fully 
automated compliance audit. These tools are based on the Security 
Content Automation Protocol (SCAP) standard and are designed for 
automated tailoring of compliance policies.
		</div><div class="itemizedlist"><p class="title"><strong>Security Compliance Tools Supported on Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6</strong></p><ul><li class="listitem"><div class="para">
					<span class="application"><strong>OpenSCAP</strong></span> — The <span class="application"><strong>oscap</strong></span>
 command-line utility is designed to perform configuration and 
vulnerability scans on a local system, to validate security compliance 
content, and to generate reports and guides based on these scans and 
evaluations.
				</div></li><li class="listitem"><div class="para">
					<span class="application"><strong>Script Check Engine (SCE)</strong></span>
 — SCE is an extension to SCAP protocol that allows content authors to 
write their security content using a scripting language, such as Bash, 
Python or Ruby. The SCE extension is provided with the <span class="package">openscap-engine-sce</span> package.
				</div></li><li class="listitem"><div class="para">
					<span class="strong strong"><strong>SCAP Security Guide (SSG)</strong></span> — The <span class="package">scap-security-guide</span> package provides the latest collection of security polices for Linux systems.
				</div></li></ul></div><div class="para">
			If you require performing automated compliance audits on multiple 
systems remotely, you can utilize OpenSCAP solution for Red Hat 
Satellite. For more information see <a class="xref" href="#sect-Using_OpenSCAP_with_Red_Hat_Satellite">Section&nbsp;8.5, “Using OpenSCAP with Red Hat Satellite”</a> and <a class="xref" href="#sect-Additional_Resources">Section&nbsp;8.8, “Additional Resources”</a>.
		</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				Note that Red Hat does not provide any default compliance policy 
along with the Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 distribution. 
The reasons for that are explained in <a class="xref" href="#sect-Defining_Compliance_Policy">Section&nbsp;8.2, “Defining Compliance Policy”</a>.
			</div></div></div></div><div class="section" id="sect-Defining_Compliance_Policy"><div class="titlepage"><div><div><h2 class="title">8.2.&nbsp;Defining Compliance Policy</h2></div></div></div><div class="para">
			The security or compliance policy is rarely written from scratch. <span class="strong strong"><strong>ISO 27000</strong></span>
 standard series, derivative works, and other sources provide security 
policy templates and practice recommendations that should be helpful to 
start with. However, organizations building theirs information security 
program need to amend the policy templates to align with their needs. 
The policy template should be chosen on the basis of its relevancy to 
the company environment and then the template has to be adjusted because
 either the template contains build-in assumptions which cannot be 
applied to the organization, or the template explicitly requires that 
certain decisions have to be made.
		</div><div class="para">
			Red Hat Enterprise Linux auditing capabilities are based on the 
Security Content Automation Protocol (SCAP) standard. SCAP is a 
synthesis of interoperable specifications that standardize the format 
and nomenclature by which software flaw and security configuration 
information is communicated, both to machines and humans. SCAP is a 
multi-purpose framework of specifications that supports automated 
configuration, vulnerability and patch checking, technical control 
compliance activities, and security measurement.
		</div><div class="para">
			In other words, SCAP is a vendor-neutral way of expressing security 
policy, and as such it is widely used in modern enterprises. SCAP 
specifications create an ecosystem where the format of security content 
is well known and standardized while the implementation of the scanner 
or policy editor is not mandated. Such a status enables organizations to
 build their security policy (SCAP content) once, no matter how many 
security vendors do they employ.
		</div><div class="para">
			The latest version of SCAP includes several underlying standards. 
These components are organized into groups according to their function 
within SCAP as follows:
		</div><div class="itemizedlist"><p class="title"><strong>SCAP Components</strong></p><ul><li class="listitem"><div class="para">
					<span class="emphasis"><em>Languages</em></span> — This group consists of SCAP languages that define standard vocabularies and conventions for expressing compliance policy.
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							The <em class="firstterm">eXtensible Configuration Checklist Description Format (XCCDF)</em> — A language designed to express, organize, and manage security guidance.
						</div></li><li class="listitem"><div class="para">
							<em class="firstterm">Open Vulnerability and Assessment Language (OVAL)</em> — A language developed to perform logical assertion about the state of the scanned system.
						</div></li><li class="listitem"><div class="para">
							<em class="firstterm">Open Checklist Interactive Language (OCIL)</em> — A language designed to provide a standard way to query users and interpret user responses to the given questions.
						</div></li><li class="listitem"><div class="para">
							<em class="firstterm">Asset Identification (AI)</em> — A language developed to provide a data model, methods, and guidance for identifying security assets.
						</div></li><li class="listitem"><div class="para">
							<em class="firstterm">Asset Reporting Format (ARF)</em> — A 
language designed to express the transport format of information about 
collected security assets and the relationship between assets and 
security reports.
						</div></li></ul></div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Enumerations</em></span> — This group 
includes SCAP standards that define naming format and an official list 
or dictionary of items from certain security-related areas of interest.
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<em class="firstterm">Common Configuration Enumeration (CCE)</em> — An enumeration of security-relevant configuration elements for applications and operating systems.
						</div></li><li class="listitem"><div class="para">
							<em class="firstterm">Common Platform Enumeration (CPE)</em> — A structured naming scheme used to identify information technology (IT) systems, platforms, and software packages.
						</div></li><li class="listitem"><div class="para">
							<em class="firstterm">Common Vulnerabilities and Exposures (CVE)</em> — A reference method to a collection of publicly known software vulnerabilities and exposures.
						</div></li></ul></div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Metrics</em></span> — This group comprises of frameworks to identify and evaluate security risks.
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<em class="firstterm">Common Configuration Scoring System (CCSS)</em>
 — A metric system to evaluate security-relevant configuration elements 
and assign them scores in order to help users to prioritize appropriate 
response steps.
						</div></li><li class="listitem"><div class="para">
							<em class="firstterm">Common Vulnerability Scoring System (CVSS)</em>
 — A metric system to evaluate software vulnerabilities and assign them 
scores in order to help users prioritize their security risks.
						</div></li></ul></div></li><li class="listitem"><div class="para">
					<span class="emphasis"><em>Integrity</em></span> — An SCAP specification to maintain integrity of SCAP content and scan results.
				</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
							<em class="firstterm">Trust Model for Security Automation Data (TMSAD)</em>
 — A set of recommendations explaining usage of existing specification 
to represent signatures, hashes, key information, and identity 
information in context of an XML file within a security automation 
domain.
						</div></li></ul></div></li></ul></div><div class="para">
			Each of the SCAP components has its own XML-based document format and
 its XML name space. A compliance policy expressed in SCAP can either 
take a form of a single OVAL definition XML file, data stream file, 
single zip archive, or a set of separate XML files containing an XCCDF 
file that represents a policy checklist.
		</div><div class="section" id="sect-SCAP_format-XCCDF"><div class="titlepage"><div><div><h3 class="title">8.2.1.&nbsp;The XCCDF File Format</h3></div></div></div><div class="para">
				The XCCDF language is designed to support information interchange, 
document generation, organizational and situational tailoring, automated
 compliance testing, and compliance scoring. The language is mostly 
descriptive and does not contain any commands to perform security scans.
 However, an XCCDF document can refer to other SCAP components, and as 
such it can be used to craft a compliance policy that is portable among 
all the target platforms with the exception of the related assessment 
documents (OVAL, OCIL).
			</div><div class="para">
				The common way to represent a compliance policy is a set of XML 
files where one of the files is an XCCDF checklist. This XCCDF file 
usually points to the assessment resources, multiple OVAL, OCIL and the 
Script Check Engine (SCE) files. Furthermore, the file set can contain a
 CPE dictionary file and an OVAL file defining objects for this 
dictionary.
			</div><div class="para">
				Being an XML-based language, the XCCDF defines and uses a vast 
selection of XML elements and attributes. The following list briefly 
introduces the main XCCDF elements; for more details about XCCDF, 
consult the <a href="http://csrc.nist.gov/publications/nistir/ir7275-rev4/NISTIR-7275r4.pdf">NIST Interagency Report 7275 Revision 4</a>.
			</div><div class="itemizedlist"><p class="title"><strong>Main XML Elements of the XCCDF Document</strong></p><ul><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:Benchmark&gt;</code> — This is a
 root element that encloses the whole XCCDF document. It may also 
contain checklist metadata, such as a title, description, list of 
authors, date of the latest modification, and status of the checklist 
acceptance.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:Rule&gt;</code> — This is a key
 element that represents a checklist requirement and holds its 
description. It may contain child elements that define actions verifying
 or enforcing compliance with the given rule or modify the rule itself.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:Value&gt;</code> — This key element is used for expressing properties of other XCCDF elements within the benchmark.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:Group&gt;</code> — This element
 is used to organize an XCCDF document to structures with the same 
context or requirement domains by gathering the <code class="systemitem">&lt;xccdf:Rule&gt;</code>, <code class="systemitem">&lt;xccdf:Value&gt;</code>, and <code class="systemitem">&lt;xccdf:Group&gt;</code> elements.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:Profile&gt;</code> — This 
element serves for a named tailoring of the XCCDF benchmark. It allows 
the benchmark to hold several different tailorings. <code class="systemitem">&lt;xccdf:Profile&gt;</code> utilizes several selector elements, such as <code class="systemitem">&lt;xccdf:select&gt;</code> or <code class="systemitem">&lt;xccdf:refine-rule&gt;</code>, to determine which elements are going to be modified and processed while it is in effect.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:Tailoring&gt;</code> — This 
element allows defining the benchmark profiles outside the benchmark, 
which is sometimes desirable for manual tailoring of the compliance 
policy.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:TestResult&gt;</code> — This element serves for keeping the scan results for the given benchmark on the target system. Each <code class="systemitem">&lt;xccdf:TestResult&gt;</code>
 should refer to the profile that was used to define the compliance 
policy for the particular scan and it should also contain important 
information about the target system that is relevant for the scan.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:rule-result&gt;</code> — This is a child element of <code class="systemitem">&lt;xccdf:TestResult&gt;</code> that is used to hold the result of applying a specific rule from the benchmark to the target system.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:fix&gt;</code> — This is a child element of <code class="systemitem">&lt;xccdf:Rule&gt;</code>
 that serves for remediation of the target system that is not compliant 
with the given rule. It can contain a command or script that is run on 
the target system in order to bring the system into compliance the rule.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:check&gt;</code> — This is a child element of <code class="systemitem">&lt;xccdf:Rule&gt;</code> that refers to an external source which defines how to evaluate the given rule.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:select&gt;</code> — This is a selector element that is used for including or excluding the chosen rules or groups of rules from the policy.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:set-value&gt;</code> — This is a selector element that is used for overwriting the current value of the specified <code class="systemitem">&lt;xccdf:Value&gt;</code> element without modifying any of its other properties.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:refine-value&gt;</code> — This is a selector element that is used for specifying constraints of the particular <code class="systemitem">&lt;xccdf:Value&gt;</code> element during policy tailoring.
					</div></li><li class="listitem"><div class="para">
						<code class="systemitem">&lt;xccdf:refine-rule&gt;</code> — This selector element allows overwriting properties of the selected rules.
					</div></li></ul></div><div class="example" id="exam-An_Example_of_an_"><p class="title"><strong>Example&nbsp;8.1.&nbsp;An Example of an XCCDF Document</strong></p><div class="example-contents"><pre class="programlisting  language-xml">        
<span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Benchmark</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://checklists.nist.gov/xccdf/1.2<span class="token punctuation">"</span></span>
    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_benchmark_test<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>status</span><span class="token punctuation">&gt;</span></span>incomplete<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>status</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Profile</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_profile_1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Profile title is compulsory<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">idref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_group_1<span class="token punctuation">"</span></span> 
        <span class="token attr-name">selected</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">idref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_rule_1<span class="token punctuation">"</span></span> 
        <span class="token attr-name">selected</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>refine-value</span> <span class="token attr-name">idref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_value_1<span class="token punctuation">"</span></span>
        <span class="token attr-name">selector</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>telnet service<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Profile</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Group</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_group_1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Value</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_value_1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span> <span class="token attr-name">selector</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>telnet_service<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>telnet-server<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span> <span class="token attr-name">selector</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dhcp_servide<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>dhcpd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span> <span class="token attr-name">selector</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ftp_service<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>tftpd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Value</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Rule</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_rule_1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>The telnet-server Package Shall Not Be Installed <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rationale</span><span class="token punctuation">&gt;</span></span>
        Removing the telnet-server package decreases the risk
        of the telnet service’s accidental (or intentional) activation
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rationale</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fix</span> <span class="token attr-name">platform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cpe:/o:redhat:enterprise_linux:6<span class="token punctuation">"</span></span> 
          <span class="token attr-name">reboot</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>false<span class="token punctuation">"</span></span> 
          <span class="token attr-name">disruption</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>low<span class="token punctuation">"</span></span> 
          <span class="token attr-name">system</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>urn:xccdf:fix:script:sh<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        yum -y remove 
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sub</span> <span class="token attr-name">idref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_value_1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fix</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>check</span> <span class="token attr-name">system</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-definitions-5<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>check-export</span> <span class="token attr-name">value-id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xccdf_com.example.www_value_1<span class="token punctuation">"</span></span> 
            <span class="token attr-name">export-name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:com.example.www:var:1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>check-content-ref</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>examplary.oval.xml<span class="token punctuation">"</span></span> 
            <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:com.example.www:def:1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>check</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>check</span> <span class="token attr-name">system</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://open-scap.org/page/SCE<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>check-import</span> <span class="token attr-name">import-name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stdout<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>check-content-ref</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>telnet_server.sh<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>check</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Rule</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Group</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Benchmark</span><span class="token punctuation">&gt;</span></span>        
        </pre></div></div></div><div class="section" id="sect-SCAP_format-OVAL"><div class="titlepage"><div><div><h3 class="title">8.2.2.&nbsp;The OVAL File Format</h3></div></div></div><div class="para">
				The Open Vulnerability Assessment Language (OVAL) is the essential 
and oldest component of SCAP. The main goal of the OVAL standard is to 
enable interoperability among security products. That is achieved by 
standardization of the following three domains:
			</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
						Representation of the target system configuration.
					</div></li><li class="listitem"><div class="para">
						Analysis of the target system for the presence of a particular machine state.
					</div></li><li class="listitem"><div class="para">
						Reporting the results of the comparison between the specified machine state and the observed machine state.
					</div></li></ol></div><div class="para">
				Unlike other tools or custom scripts, the OVAL language describes a 
desired state of resources in a declarative manner. The OVAL language 
code is never executed directly, but by means of an OVAL interpreter 
tool called <em class="firstterm">scanner</em>. The declarative nature 
of OVAL ensures that the state of the assessed system is not 
accidentally modified, which is important because security scanners are 
often run with the highest possible privileges.
			</div><div class="para">
				OVAL specification is open for public comments and contribution and 
various IT companies collaborate with the MITRE Corporation, federally 
funded not-for-profit organization. The OVAL specification is 
continuously evolving and different editions are distinguished by a 
version number. The current version 5.10.1 was released in January 2012.
			</div><div class="para">
				Like all other SCAP components, OVAL is based on XML. The OVAL 
standard defines several document formats. Each of them includes 
different kind of information and serves a different purpose.
			</div><div class="itemizedlist"><p class="title"><strong>The OVAL Document Formats</strong></p><ul><li class="listitem"><div class="para">
						The <em class="firstterm">OVAL Definitions</em> format is the most
 common OVAL file format that is used directly for system scans. The 
OVAL Definitions document describes the desired state of the target 
system.
					</div></li><li class="listitem"><div class="para">
						The <em class="firstterm">OVAL Variables</em> format defines 
variables used to amend the OVAL Definitions document. The OVAL 
Variables document is typically used in conjunction with the OVAL 
Definitions document to tailor the security content for the target 
system at runtime.
					</div></li><li class="listitem"><div class="para">
						The <em class="firstterm">OVAL System Characteristics</em> format 
holds information about the assessed system. The OVAL System 
Characteristics document is typically used to compare the actual state 
of the system against the expected state defined by an OVAL Definitions 
document.
					</div></li><li class="listitem"><div class="para">
						The <em class="firstterm">OVAL Results</em> is the most 
comprehensive OVAL format that is used to report results of the system 
evaluation. The OVAL Results document typically contains copy of the 
evaluated OVAL definitions, bound OVAL variables, OVAL system 
characteristics, and results of tests that are computed based on 
comparison of the system characteristics and the definitions.
					</div></li><li class="listitem"><div class="para">
						The <em class="firstterm">OVAL Directives</em> format is used to tailor verbosity of an OVAL Result document by either including or excluding certain details.
					</div></li><li class="listitem"><div class="para">
						The <em class="firstterm">OVAL Common Model</em> format contains 
definitions of constructs and enumerations used in several other OVAL 
schemes. It is used to reuse OVAL definitions in order to avoid 
duplications across multiple documents.
					</div></li></ul></div><div class="para">
				The OVAL Definitions document consists of a set of configuration 
requirements where each requirement is defined in the following five 
basic sections: <em class="firstterm">definitions</em>, <em class="firstterm">tests</em>, <em class="firstterm">objects</em>, <em class="firstterm">states</em>, and <em class="firstterm">variables</em>.
 The elements within the definitions section describe which of the tests
 shall be fulfilled to satisfy the given definition. The test elements 
link objects and states together. During the system evaluation, a test 
is considered passed when a resource of the assessed system that is 
denoted by the given object element corresponds with the given state 
element. The variables section defines external variables which may be 
used to adjust elements from the states section. Besides these sections,
 the OVAL Definitions document typically contains also the <em class="firstterm">generator</em> and <em class="firstterm">signature</em> sections. The <em class="firstterm">generator</em> section holds information about the document origin and various additional information related to its content.
			</div><div class="para">
				Each element from the OVAL document basic sections is unambiguously identified by an identifier in the following form:
			</div><pre class="synopsis">oval:<em class="replaceable">namespace</em>:<em class="replaceable">type</em>:<em class="replaceable">ID</em></pre><div class="para">
				where <em class="replaceable">namespace</em> is a name space defining the identifier, <em class="replaceable">type</em> is either <em class="firstterm">def</em> for definitions elements, <em class="firstterm">tst</em> for tests elements, <em class="firstterm">obj</em> for objects element, <em class="firstterm">ste</em> for states elements, and <em class="firstterm">var</em> for variables elements, and <em class="replaceable">ID</em> is an integer value of the identifier.
			</div><div class="example" id="exam-OVAL_document"><p class="title"><strong>Example&nbsp;8.2.&nbsp;An Example of an OVAL Definitions Document</strong></p><div class="example-contents"><pre class="programlisting  language-xml">          
<span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>oval_definitions</span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>lin-def</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-definitions-5#linux<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>oval</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-common-5<span class="token punctuation">"</span></span>
    <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-definitions-5<span class="token punctuation">"</span></span>
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>generator</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">oval:</span>product_name</span><span class="token punctuation">&gt;</span></span>vim<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">oval:</span>product_name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">oval:</span>schema_version</span><span class="token punctuation">&gt;</span></span>5.10.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">oval:</span>schema_version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">oval:</span>timestamp</span><span class="token punctuation">&gt;</span></span>2012-11-22T15:00:00+01:00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">oval:</span>timestamp</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>generator</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>definitions</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>definition</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>inventory<span class="token punctuation">"</span></span> 
        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:org.open-scap.cpe.rhel:def:6<span class="token punctuation">"</span></span> 
        <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>metadata</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Red Hat Enterprise Linux 6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>affected</span> <span class="token attr-name">family</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>unix<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>platform</span><span class="token punctuation">&gt;</span></span>Red Hat Enterprise Linux 6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>platform</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>affected</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>reference</span> <span class="token attr-name">ref_id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cpe:/o:redhat:enterprise_linux:6<span class="token punctuation">"</span></span> 
            <span class="token attr-name">source</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>CPE<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>
          The operating system installed on the system is Red Hat Enterprise Linux 6
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>metadata</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>criteria</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>criterion</span> <span class="token attr-name">comment</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Red Hat Enterprise Linux 6 is installed<span class="token punctuation">"</span></span> 
            <span class="token attr-name">test_ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:org.open-scap.cpe.rhel:tst:6<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>criteria</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>definition</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>definitions</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tests</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>rpminfo_test</span> <span class="token attr-name">check_existence</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>at_least_one_exists<span class="token punctuation">"</span></span> 
        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:org.open-scap.cpe.rhel:tst:6<span class="token punctuation">"</span></span> 
        <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> 
        <span class="token attr-name">check</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>at least one<span class="token punctuation">"</span></span> 
        <span class="token attr-name">comment</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>redhat-release is version 6<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>object</span> <span class="token attr-name">object_ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:org.open-scap.cpe.redhat-release:obj:1<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>state</span> <span class="token attr-name">state_ref</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:org.open-scap.cpe.rhel:ste:6<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lin-def:</span>rpminfo_test</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tests</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>objects</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>rpmverifyfile_object</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:org.open-scap.cpe.redhat-release:obj:1<span class="token punctuation">"</span></span> 
        <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- This object represents rpm package which owns /etc/redhat-release file --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>behaviors</span> <span class="token attr-name">nolinkto</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">nomd5</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">nosize</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">nouser</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">nogroup</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">nomtime</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">nomode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">nordev</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">noconfigfiles</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> 
          <span class="token attr-name">noghostfiles</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span> <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>name</span> <span class="token attr-name">operation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern match<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>epoch</span> <span class="token attr-name">operation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern match<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>version</span> <span class="token attr-name">operation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern match<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>release</span> <span class="token attr-name">operation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern match<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>arch</span> <span class="token attr-name">operation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern match<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>filepath</span><span class="token punctuation">&gt;</span></span>/etc/redhat-release<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lin-def:</span>filepath</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lin-def:</span>rpmverifyfile_object</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>objects</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>states</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>rpminfo_state</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>oval:org.open-scap.cpe.rhel:ste:6<span class="token punctuation">"</span></span> 
        <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>name</span> <span class="token attr-name">operation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern match<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>^redhat-release<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lin-def:</span>name</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">lin-def:</span>version</span> <span class="token attr-name">operation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern match<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>^6[^\d]<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lin-def:</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">lin-def:</span>rpminfo_state</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>states</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>oval_definitions</span><span class="token punctuation">&gt;</span></span>
          </pre></div></div></div><div class="section" id="sect-SCAP_format-data_stream"><div class="titlepage"><div><div><h3 class="title">8.2.3.&nbsp;The Data Stream Format</h3></div></div></div><div class="para">
				SCAP data stream is a file format used since SCAP version 1.2 and it
 represents a bundle of XCCDF, OVAL, and other component files which can
 be used to define a compliance policy expressed by an XCCDF checklist. 
It also contains an index and catalog that allow splitting the given 
data stream into files according to the SCAP components.
			</div><div class="para">
				The data stream uses XML format that consists of a header formed by a table of contents and a list of the <code class="systemitem">&lt;ds:component&gt;</code>
 elements. Each of these elements encompasses an SCAP component such as 
XCCDF, OVAL, CPE, and other. The data stream file may contain multiple 
components of the same type, and thus covering all security policies 
needed by your organization.
			</div><div class="example" id="exam-SCAP-ds_header"><p class="title"><strong>Example&nbsp;8.3.&nbsp;An Example of a Data Stream Header</strong></p><div class="example-contents"><pre class="programlisting  language-xml">        
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>data-stream-collection</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>ds</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://scap.nist.gov/schema/scap/source/1.2<span class="token punctuation">"</span></span> 
    <span class="token attr-name"><span class="token namespace">xmlns:</span>xlink</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/1999/xlink<span class="token punctuation">"</span></span> 
    <span class="token attr-name"><span class="token namespace">xmlns:</span>cat</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>urn:oasis:names:tc:entity:xmlns:xml:catalog<span class="token punctuation">"</span></span> 
    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scap_org.open-scap_collection_from_xccdf_ssg-rhel6-xccdf-1.2.xml<span class="token punctuation">"</span></span>
    <span class="token attr-name">schematron-version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>data-stream</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scap_org.open-scap_datastream_from_xccdf_ssg-rhel6-xccdf-1.2.xml<span class="token punctuation">"</span></span> 
      <span class="token attr-name">scap-version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.2<span class="token punctuation">"</span></span> <span class="token attr-name">use-case</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>OTHER<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>dictionaries</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>component-ref</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scap_org.open-scap_cref_output--ssg-rhel6-cpe-dictionary.xml<span class="token punctuation">"</span></span> 
        <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#scap_org.open-scap_comp_output--ssg-rhel6-cpe-dictionary.xml<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">cat:</span>catalog</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">cat:</span>uri</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ssg-rhel6-cpe-oval.xml<span class="token punctuation">"</span></span> 
            <span class="token attr-name">uri</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#scap_org.open-scap_cref_output--ssg-rhel6-cpe-oval.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">cat:</span>catalog</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">ds:</span>component-ref</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">ds:</span>dictionaries</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>checklists</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>component-ref</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scap_org.open-scap_cref_ssg-rhel6-xccdf-1.2.xml<span class="token punctuation">"</span></span> 
        <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#scap_org.open-scap_comp_ssg-rhel6-xccdf-1.2.xml<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">cat:</span>catalog</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">cat:</span>uri</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>ssg-rhel6-oval.xml<span class="token punctuation">"</span></span> 
            <span class="token attr-name">uri</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#scap_org.open-scap_cref_ssg-rhel6-oval.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">cat:</span>catalog</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">ds:</span>component-ref</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">ds:</span>checklists</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>checks</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>component-ref</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scap_org.open-scap_cref_ssg-rhel6-oval.xml<span class="token punctuation">"</span></span> 
        <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#scap_org.open-scap_comp_ssg-rhel6-oval.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>component-ref</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scap_org.open-scap_cref_output--ssg-rhel6-cpe-oval.xml<span class="token punctuation">"</span></span> 
        <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#scap_org.open-scap_comp_output--ssg-rhel6-cpe-oval.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>component-ref</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scap_org.open-scap_cref_output--ssg-rhel6-oval.xml<span class="token punctuation">"</span></span> 
        <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#scap_org.open-scap_comp_output--ssg-rhel6-oval.xml<span class="token punctuation">"</span></span><span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">ds:</span>checks</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">ds:</span>data-stream</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">ds:</span>component</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scap_org.open-scap_comp_ssg-rhel6-oval.xml<span class="token punctuation">"</span></span>
    <span class="token attr-name">timestamp</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2014-03-14T16:21:59<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>oval_definitions</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-definitions-5<span class="token punctuation">"</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>oval</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-common-5<span class="token punctuation">"</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>ind</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-definitions-5#independent<span class="token punctuation">"</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>unix</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-definitions-5#unix<span class="token punctuation">"</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>linux</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-definitions-5#linux<span class="token punctuation">"</span></span> 
      <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span> 
      <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://oval.mitre.org/XMLSchema/oval-common-5 
      oval-common-schema.xsd 
          http://oval.mitre.org/XMLSchema/oval-definitions-5 
      oval-definitions-schema.xsd
          http://oval.mitre.org/XMLSchema/oval-definitions-5#independent 
      independent-definitions-schema.xsd
          http://oval.mitre.org/XMLSchema/oval-definitions-5#unix 
      unix-definitions-schema.xsd
          http://oval.mitre.org/XMLSchema/oval-definitions-5#linux 
      linux-definitions-schema.xsd<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        </pre></div></div></div></div><div class="section" id="sect-Using_SCAP_Workbench"><div class="titlepage"><div><div><h2 class="title">8.3.&nbsp;Using SCAP Workbench</h2></div></div></div><div class="para">
			<span class="application"><strong>SCAP Workbench</strong></span> (<span class="package">scap-workbench</span>)
 is a graphical utility that allows users to perform configuration and 
vulnerability scans on a single local or a remote system, perform 
remediation of the system, and generate reports based on scan 
evaluations. Note that compared with the <span class="application"><strong>oscap</strong></span> command-line utility, <span class="application"><strong>SCAP Workbench</strong></span> has only limited functionality. <span class="application"><strong>SCAP Workbench</strong></span> can also process only security content in the form of XCCDF and data-stream files.
		</div><div class="para">
			The following sections explain how to install, start, and utilize 
SCAP Workbench in order to perform system scans, remediation, scan 
customization, and display relevant examples for these tasks.
		</div><div class="section" id="sect-Installing_SCAP_Workbench"><div class="titlepage"><div><div><h3 class="title">8.3.1.&nbsp;Installing SCAP Workbench</h3></div></div></div><div class="para">
				To install <span class="application"><strong>SCAP Workbench</strong></span> on your system, run the following command as <code class="systemitem">root</code>:
			</div><pre class="screen">~]# <code class="command">yum install scap-workbench</code></pre><div class="para">
				This command installs all packages required by SCAP Workbench to function properly, including the <span class="package">scap-workbench</span> package that provides the utility itself. Note that required dependencies, such as the <span class="package">qt</span> and <span class="package">openssh</span> packages, will be automatically updated to the newest available version if the packages are already installed on your system.
			</div><div class="para">
				Before you can start using SCAP Workbench effectively, you also need
 to install or import some security content on your system. For example,
 you can install the SCAP Security Guide (SSG) package, <span class="package">scap-security-guide</span>,
 which contains the currently most evolved and elaborate set of security
 polices for Linux systems. To install the SCAP Security Guide package 
on your system, run the following command as root:
			</div><pre class="screen"><code class="prompt">~]#</code> <code class="command">yum install scap-security-guide</code></pre><div class="para">
				After you install <span class="package">scap-security-guide</span> on your system, unless specified otherwise, the SSG security content is available under the <code class="filename">/usr/share/xml/scap/ssg/content/</code> directory, and you can proceed with other security compliance operations.
			</div><div class="para">
				To find other possible sources of existing SCAP content that might suit your needs, see <a class="xref" href="#sect-Additional_Resources">Section&nbsp;8.8, “Additional Resources”</a>.
			</div></div><div class="section" id="sect-Running_SCAP_Workbench"><div class="titlepage"><div><div><h3 class="title">8.3.2.&nbsp;Running SCAP Workbench</h3></div></div></div><div class="para">
				After a successful installation of both, the <span class="application"><strong>SCAP Workbench</strong></span> utility and SCAP content, you can start using <span class="application"><strong>SCAP Workbench</strong></span> on your systems. For running <span class="application"><strong>SCAP Workbench</strong></span> from the <span class="application"><strong>GNOME Classic</strong></span> desktop environment, press the <span class="strong strong"><strong>Super</strong></span> key to enter the <span class="guilabel"><strong>Activities Overview</strong></span>, type <code class="command">scap-workbench</code>, and then press <span class="keycap"><strong>Enter</strong></span>. The <span class="strong strong"><strong>Super</strong></span> key appears in a variety of guises, depending on the keyboard and other hardware, but often as either the <span class="keycap"><strong>Windows</strong></span> or <span class="keycap"><strong>Command</strong></span> key, and typically to the left of the <span class="keycap"><strong>Spacebar</strong></span> key.
			</div><div class="figure" id="fig-SCAP_Workbench-00"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/SCAP-Workbench-01-guide-selection.png" alt="Open SCAP Security Guide Window" width="660"></div></div><p class="title"><strong>Figure&nbsp;8.1.&nbsp;Open SCAP Security Guide Window</strong></p></div><div class="para">
				As soon as you start the utility, the <span class="guilabel"><strong>Open SCAP Security Guide</strong></span> window appears. After a selection one of the guides, the <span class="guilabel"><strong>SCAP Workbench</strong></span>
 window appears. This window consists of several interactive components,
 which you should become familiar with before you start scanning your 
system:
			</div><div class="variablelist"><dl class="variablelist"><dt><span class="term">File</span></dt><dd><div class="para">
							This menu list offers several options to load or save a SCAP-related content. To show the initial <span class="guilabel"><strong>Open SCAP Security Guide</strong></span> window, click the menu item with the same name. Alternatively, load another customization file in the XCCDF format by clicking <span class="guilabel"><strong>Open Other Content</strong></span>. To save your customization as an XCCDF XML file, use the <span class="guilabel"><strong>Save Customization Only</strong></span> item. The <span class="guilabel"><strong>Save All</strong></span> allows you to save SCAP files either to the selected directory or as an RPM package.
						</div></dd><dt><span class="term">Customization</span></dt><dd><div class="para">
							This combo box informs you about the customization used for the 
given security policy. You can select custom rules that will be applied 
for the system evaluation by clicking this combo box. The default value 
is <span class="strong strong"><strong>(no customization)</strong></span>,
 which means that there will be no changes to the used security policy. 
If you made any changes to the selected security profile, you can save 
those changes as an XML file by clicking the <span class="guilabel"><strong>Save Customization Only</strong></span> item in the File menu.
						</div></dd><dt><span class="term">Profile</span></dt><dd><div class="para">
							This combo box contains the name of the selected security 
profile. You can select the security profile from a given XCCDF or 
data-stream file by clicking this combo box. To create a new profile 
that inherits properties of the selected security profile, click the <span class="guibutton"><strong>Customize</strong></span> button.
						</div></dd><dt><span class="term">Target</span></dt><dd><div class="para">
							The two radio buttons enable you to select whether the system to be evaluated is a local or remote machine.
						</div></dd><dt><span class="term">Selected Rules</span></dt><dd><div class="para">
							This field displays a list of security rules that are subject of 
the security policy. Expanding a particular security rule provides 
detailed information about that rule.
						</div></dd><dt><span class="term">Status bar</span></dt><dd><div class="para">
							This is a graphical bar that indicates status of an operation that is being performed.
						</div></dd><dt><span class="term">Fetch remote resources</span></dt><dd><div class="para">
							This check box allows to instruct the scanner to download a remote OVAL content defined in an XML file.
						</div></dd><dt><span class="term">Remediate</span></dt><dd><div class="para">
							This check box enables the remediation feature during the system 
evaluation. If you check this box, SCAP Workbench will attempt to 
correct system settings that would fail to match the state defined by 
the policy.
						</div></dd><dt><span class="term">Scan</span></dt><dd><div class="para">
							This button allows you to start the evaluation of the specified system.
						</div></dd></dl></div><div class="figure" id="fig-SCAP_Workbench-01"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/SCAP-Workbench-04-main.png" alt="SCAP Workbench Window" width="660"></div></div><p class="title"><strong>Figure&nbsp;8.2.&nbsp;SCAP Workbench Window</strong></p></div></div><div class="section" id="sect-System_Scanning-SCAP_Workbench"><div class="titlepage"><div><div><h3 class="title">8.3.3.&nbsp;Scanning the System</h3></div></div></div><div class="para">
				The main functionality of <span class="application"><strong>SCAP Workbench</strong></span>
 is to perform security scans on a selected system in accordance with 
the given XCCDF or data stream file. To evaluate your system against the
 selected security policy, follow these steps:
			</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
						Select a security policy by using either the <span class="guilabel"><strong>Open SCAP Security Guide</strong></span> window, or <code class="option">Open Other Content</code> in the <span class="guilabel"><strong>File</strong></span> menu and search the respective XCCDF, SCAP RPM or data stream file.
					</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
							Selecting a security policy results in the loss of any previous 
customization changes that were not saved. To re-apply the lost options,
 you have to choose the available profile and customization content 
again. Note that your previous customizations may not be applicable with
 the new security policy.
						</div></div></div></li><li class="step"><div class="para">
						To use a pre-arranged a file with customized security content 
specific to your use case, you can load this file by clicking on the <span class="strong strong"><strong>Customization</strong></span> combo box. You can also create a custom tailoring file by altering an available security profile. For more information, see <a class="xref" href="#sect-Customizing_Security_Profiles-SCAP_Workbench">Section&nbsp;8.3.4, “Customizing Security Profiles”</a>.
					</div><ol class="substeps a"><li class="step"><div class="para">
								Select the <code class="option">(no customization)</code> option
 if you do not want to use any customization for the current system 
evaluation. This is the default option if no previous customization was 
selected.
							</div></li><li class="step"><div class="para">
								Select the <code class="option">(open customization file...)</code> option to search for the particular tailoring file to be used for the current system evaluation.
							</div></li><li class="step"><div class="para">
								If you have previously used some customization file, <span class="application"><strong>SCAP Workbench</strong></span> remembers this file and adds it to the list. This simplifies repetitive application of the same scan.
							</div></li></ol></li><li class="step"><div class="para">
						Select a suitable security profile by clicking the <span class="strong strong"><strong>Profile</strong></span> combo box.
					</div><ol class="substeps a"><li class="step"><div class="para">
								To modify the selected profile, click the <span class="guibutton"><strong>Customize</strong></span> button. For more information about profile customization, see <a class="xref" href="#sect-Customizing_Security_Profiles-SCAP_Workbench">Section&nbsp;8.3.4, “Customizing Security Profiles”</a>.
							</div></li></ol></li><li class="step"><div class="para">
						Select either of two <span class="guibutton"><strong>Target</strong></span> radio buttons to scan either a local or a remote machine.
					</div><ol class="substeps a"><li class="step"><div class="para">
								If you have selected a remote system, specify it by entering the
 user name, host name, and the port information as shown in the 
following example. If you have previously used the remote scan, you can 
also select a remote system from a list of recently scanned machines.
							</div><div class="figure" id="fig-SCAP_Workbench-target"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/SCAP-Workbench-05-remote-scan.png" alt="Specifying a Remote System" width="660"></div></div><p class="title"><strong>Figure&nbsp;8.3.&nbsp;Specifying a Remote System</strong></p></div></li></ol></li><li class="step"><div class="para">
						You can allow automatic correction of the system configuration by selecting the <span class="guibutton"><strong>Remediate</strong></span> check box. With this option enabled, <span class="application"><strong>SCAP Workbench</strong></span>
 attempts to change the system configuration in accordance with the 
security rules applied by the policy, should the related checks fail 
during the system scan.
					</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
							If not used carefully, running the system evaluation with the 
remediation option enabled could render the system non-functional.
						</div></div></div></li><li class="step"><div class="para">
						Click the <span class="guibutton"><strong>Scan</strong></span> button to initiate the system scan.
					</div></li></ol></div></div><div class="section" id="sect-Customizing_Security_Profiles-SCAP_Workbench"><div class="titlepage"><div><div><h3 class="title">8.3.4.&nbsp;Customizing Security Profiles</h3></div></div></div><div class="para">
				After selecting the security profile that suits your security policy, you can further adjust it by clicking the <span class="guibutton"><strong>Customize</strong></span>
 button. This will open the new Customization window that allows you to 
modify the currently selected XCCDF profile without actually changing 
the respective XCCDF file.
			</div><div class="figure" id="fig-SCAP_Workbench-Tailoring"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/SCAP-Workbench-02-customizing.png" alt="Customizing the Selected Security Profile" width="660"></div></div><p class="title"><strong>Figure&nbsp;8.4.&nbsp;Customizing the Selected Security Profile</strong></p></div><div class="para">
				The <span class="guilabel"><strong>Customization</strong></span> 
window contains a complete set of XCCDF elements relevant to the 
selected security profile with detailed information about each element 
and its functionality. You can enable or disable these elements by 
selecting or de-selecting the respective check boxes in the main field 
of this window. The <span class="guilabel"><strong>Customization</strong></span> window also supports <span class="strong strong"><strong>undo</strong></span> and <span class="strong strong"><strong>redo</strong></span> functionality; you can undo or redo your selections by clicking the respective arrow icon in the top left corner of the window.
			</div><div class="para">
				You can also change variables that will later be used for evaluation. Find the desired item in the <span class="guilabel"><strong>Customization</strong></span> window, navigate to the right part and use the <code class="option">Modify value</code> field.
			</div><div class="figure" id="fig-SCAP_Workbench-Tailoring-Value"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/SCAP-Workbench-03-customizing-value.png" alt="Setting a value for the selected item in the Customization window" width="660"></div></div><p class="title"><strong>Figure&nbsp;8.5.&nbsp;Setting a value for the selected item in the Customization window</strong></p></div><div class="para">
				After you have finished your profile customizations, confirm the changes by clicking the <span class="guibutton"><strong>Confirm Customization</strong></span> button. Your changes are now in the memory and do not persist if <span class="application"><strong>SCAP Workbench</strong></span>
 is closed or certain changes, such as selecting a new SCAP content or 
choosing another customization option, are made. To store your changes, 
click the <span class="guibutton"><strong>Save Customization</strong></span> button in the <span class="guilabel"><strong>SCAP Workbench</strong></span>
 window. This action allows you to save your changes to the security 
profile as an XCCDF customization file in the chosen directory. Note 
that this customization file can be further selected with other 
profiles.
			</div></div><div class="section" id="sect-Saving_SCAP_Content-SCAP_Workbench"><div class="titlepage"><div><div><h3 class="title">8.3.5.&nbsp;Saving SCAP Content</h3></div></div></div><div class="para">
				<span class="application"><strong>SCAP Workbench</strong></span> 
also allows you to save SCAP content that is used with your system 
evaluations. You can either save a customization file separately (see <a class="xref" href="#sect-Customizing_Security_Profiles-SCAP_Workbench">Section&nbsp;8.3.4, “Customizing Security Profiles”</a>) or you can save all security content at once by clicking the <span class="guibutton"><strong>Save content</strong></span> combo box and selecting either the <code class="option">Save into a directory</code> or <code class="option">Save as RPM</code> options.
			</div><div class="para">
				By selecting the <code class="option">Save into a directory</code> option, <span class="application"><strong>SCAP Workbench</strong></span>
 saves both the XCCDF or data-stream file and the customization file to 
the specified location. This can be useful as a backup solution.
			</div><div class="para">
				By selecting the <code class="option">Save as RPM</code> option, you can instruct <span class="application"><strong>SCAP Workbench</strong></span>
 to create an RPM package containing the XCCDF or data stream file and 
customization file. This is useful for distributing the desired security
 content to systems that cannot be scanned remotely, or just for 
delivering the content for further processing.
			</div><div class="figure" id="fig-SCAP_Workbench-Saving_RPM"><div class="figure-contents"><div class="mediaobject"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/SCAP-Workbench-06-saving.png" alt="Saving the Current SCAP Content as an RPM Package" width="660"></div></div><p class="title"><strong>Figure&nbsp;8.6.&nbsp;Saving the Current SCAP Content as an RPM Package</strong></p></div></div><div class="section" id="sect-Generating_Reports_on_Workbench"><div class="titlepage"><div><div><h3 class="title">8.3.6.&nbsp;Viewing Scan Results and Generating Scan Reports</h3></div></div></div><div class="para">
				After the system scan is finished, three new buttons, <span class="guibutton"><strong>Clear</strong></span>, <span class="guibutton"><strong>Save Results</strong></span>, and <span class="guibutton"><strong>Show Report</strong></span>, will appear instead of the <span class="guibutton"><strong>Scan</strong></span> button.
			</div><div class="warning"><div class="admonition_header"><p><strong>Warning</strong></p></div><div class="admonition"><div class="para">
					Clicking the <span class="guibutton"><strong>Clear</strong></span> button permanently removes the scan results.
				</div></div></div><div class="para">
				To store the scan results in the form of an XCCDF, ARF, or HTML file, click the <span class="guibutton"><strong>Save Results</strong></span> combo box. Choose the <code class="option">HTML Report</code>
 option to generate the scan report in human-readable form. The XCCDF 
and ARF (data stream) formats are suitable for further automatic 
processing. You can repeatedly choose all three options.
			</div><div class="para">
				If you prefer to view the scan results immediately without saving them, you can click the <span class="guibutton"><strong>Show Report</strong></span> button, which opens the scan results in the form of a temporary HTML file in your default web browser.
			</div></div></div><div class="section" id="sect-Using_oscap"><div class="titlepage"><div><div><h2 class="title">8.4.&nbsp;Using <span class="application"><strong>oscap</strong></span></h2></div></div></div><div class="para">
			The <span class="application"><strong>oscap</strong></span> 
command-line utility allows users to scan their local systems, validate 
security compliance content, and generate reports and guides based on 
these scans and evaluations. This utility serves as a front end to the 
OpenSCAP library and groups its functionalities to modules 
(sub-commands) based on a type of the SCAP content it processes.
		</div><div class="para">
			The following sections explain how to install <span class="application"><strong>oscap</strong></span>,
 perform the most common operations, and display the relevant examples 
for these tasks. To learn more about specific sub-commands, use the <code class="option">--help</code> option with an <span class="application"><strong>oscap</strong></span> command:
		</div><pre class="synopsis"><code class="command">oscap [<span class="optional">options</span>] <em class="replaceable">module</em> <em class="replaceable">module_operation</em> [<span class="optional">module_operation_options_and_arguments</span>] <code class="option">--help</code></code></pre><div class="para">
			where <em class="replaceable">module</em> represents a type of SCAP content that is being processed, and <em class="replaceable">module_operation</em> is a sub-command for the specific operation on the SCAP content.
		</div><div class="example" id="exam-SCAP-oscap-Help"><p class="title"><strong>Example&nbsp;8.4.&nbsp;Getting Help on the Specific <span class="application">oscap</span> Operation</strong></p><div class="example-contents"><pre class="screen">~]$ <code class="command">oscap ds sds-split --help</code>
oscap -&gt; ds -&gt; sds-split

Split given SourceDataStream into separate files

Usage: oscap [options] ds sds-split [options] SDS TARGET_DIRECTORY

SDS - Source data stream that will be split into multiple files.
TARGET_DIRECTORY - Directory of the resulting files.

Options:
   --datastream-id &lt;id&gt;          - ID of the datastream in the collection to use.
   --xccdf-id &lt;id&gt;               - ID of XCCDF in the datastream that should be evaluated.</pre></div></div><div class="para">
			To learn about all <span class="application"><strong>oscap</strong></span> features and the complete list of its options, see the <code class="systemitem">oscap(8)</code> manual page.
		</div><div class="section" id="sect-Installing_oscap"><div class="titlepage"><div><div><h3 class="title">8.4.1.&nbsp;Installing <span class="application"><strong>oscap</strong></span></h3></div></div></div><div class="para">
				To install <span class="application"><strong>oscap</strong></span> to your system, run the following command as <code class="systemitem">root</code>:
			</div><pre class="screen">~]# <code class="command">yum install openscap-scanner</code></pre><div class="para">
				This command allows you to install all packages required by <span class="application"><strong>oscap</strong></span> to function properly, including the <span class="package">openscap</span> package.
			</div><div class="para">
				If you want to write your own security content, you should also install the <span class="package">openscap-engine-sce</span>
 package that provides the Script Check Engine (SCE). SCE is an 
extension to SCAP protocol that allows content authors to write their 
security content using a scripting language, such as Bash, Python or 
Ruby. The <span class="package">openscap-engine-sce</span> package can be installed in the same way as the <span class="package">openscap-scanner</span>
 package, however, you need to have access to the repository or channel 
with optional packages for your Red&nbsp;Hat&nbsp;Enterprise&nbsp;Linux 
variant. If your system is registered with Red&nbsp;Hat Subscription 
Management, enable the <code class="systemitem">rhel-6-<em class="replaceable">variant</em>-optional-rpms</code> repository as described in the <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html-single/Deployment_Guide/index.html#ch-yum">Yum chapter</a> of Red&nbsp;Hat&nbsp;Enterprise&nbsp;Linux&nbsp;6 Deployment Guide, where <em class="replaceable">variant</em> is your Red&nbsp;Hat Enterprise Linux variant, such as <span class="strong strong"><strong>server</strong></span>, or <span class="strong strong"><strong>workstation</strong></span>. If your system is registered with RHN&nbsp;Classic, subscribe the system to the <code class="systemitem">rhel-<em class="replaceable">architecture</em>-<em class="replaceable">variant</em>-6-optional</code> channel as documented here: <a href="https://access.redhat.com/site/solutions/9907">https://access.redhat.com/site/solutions/9907</a>.
			</div><div class="para">
				Optionally, after installing <span class="application"><strong>oscap</strong></span>, you can check capabilities of your version of <span class="application"><strong>oscap</strong></span>, what specifications it supports, where the certain <span class="application"><strong>oscap</strong></span>
 files are stored, what kinds of SCAP objects you can use, and other 
useful information. To display this information, type the following 
command:
			</div><pre class="screen">~]$ <code class="command">oscap -V</code>
OpenSCAP command line tool (oscap) 1.0.8
Copyright 2009--2014 Red Hat Inc., Durham, North Carolina.

==== Supported specifications ====
XCCDF Version: 1.2
OVAL Version: 5.10.1
CPE Version: 2.3
CVSS Version: 2.0
CVE Version: 2.0
Asset Identification Version: 1.1
Asset Reporting Format Version: 1.1

==== Capabilities added by auto-loaded plugins ====
SCE Version: 1.0 (from libopenscap_sce.so.8)

==== Paths ====
Schema files: /usr/share/openscap/schemas
Schematron files: /usr/share/openscap/xsl
Default CPE files: /usr/share/openscap/cpe
Probes: /usr/libexec/openscap

==== Inbuilt CPE names ====
Red Hat Enterprise Linux - cpe:/o:redhat:enterprise_linux
Red Hat Enterprise Linux 5 - cpe:/o:redhat:enterprise_linux:5
Red Hat Enterprise Linux 6 - cpe:/o:redhat:enterprise_linux:6
Red Hat Enterprise Linux 7 - cpe:/o:redhat:enterprise_linux:7
Fedora 16 - cpe:/o:fedoraproject:fedora:16
Fedora 17 - cpe:/o:fedoraproject:fedora:17
Fedora 18 - cpe:/o:fedoraproject:fedora:18
Fedora 19 - cpe:/o:fedoraproject:fedora:19
Fedora 20 - cpe:/o:fedoraproject:fedora:20
Fedora 21 - cpe:/o:fedoraproject:fedora:21
Red Hat Enterprise Linux Optional Productivity Applications - cpe:/a:redhat:rhel_productivity
Red Hat Enterprise Linux Optional Productivity Applications 5 - cpe:/a:redhat:rhel_productivity:5

==== Supported OVAL objects and associated OpenSCAP probes ====
system_info                  probe_system_info           
family                       probe_family                
filehash                     probe_filehash              
environmentvariable          probe_environmentvariable   
textfilecontent54            probe_textfilecontent54     
textfilecontent              probe_textfilecontent       
variable                     probe_variable              
xmlfilecontent               probe_xmlfilecontent        
environmentvariable58        probe_environmentvariable58 
filehash58                   probe_filehash58            
inetlisteningservers         probe_inetlisteningservers  
rpminfo                      probe_rpminfo               
partition                    probe_partition             
iflisteners                  probe_iflisteners           
rpmverify                    probe_rpmverify             
rpmverifyfile                probe_rpmverifyfile         
rpmverifypackage             probe_rpmverifypackage      
selinuxboolean               probe_selinuxboolean        
selinuxsecuritycontext       probe_selinuxsecuritycontext
file                         probe_file                  
interface                    probe_interface             
password                     probe_password              
process                      probe_process               
runlevel                     probe_runlevel              
shadow                       probe_shadow                
uname                        probe_uname                 
xinetd                       probe_xinetd                
sysctl                       probe_sysctl                
process58                    probe_process58             
fileextendedattribute        probe_fileextendedattribute 
routingtable                 probe_routingtable</pre><div class="para">
				Before you can start using the <span class="application"><strong>oscap</strong></span>
 utility effectively, you also have to install or import some security 
content on your system. You can download the SCAP content from the 
respective web site, or if specified as an RPM file or package, you can 
install it from the specified location, or known repository, using the <span class="application"><strong>Yum</strong></span> package manager.
			</div><div class="para">
				For example, to install the SCAP Security Guide (SSG) package that 
contains the latest set of security polices for Linux systems, run the 
following command:
			</div><pre class="screen">~]# <code class="command">yum install scap-security-guide</code></pre><div class="para">
				After you install the <span class="package">scap-security-guide</span> package on your system, unless specified otherwise, the SSG security content is available under the <code class="filename">/usr/share/xml/scap/ssg/content/</code> directory, and you can proceed with other security compliance operations.
			</div><div class="para">
				To find out other possible sources of existing SCAP content that might suit your needs, see <a class="xref" href="#sect-Additional_Resources">Section&nbsp;8.8, “Additional Resources”</a>.
			</div><div class="para">
				After installing the SCAP content on your system, <span class="application"><strong>oscap</strong></span> can process the content by specifying the file path to the content. The <span class="application"><strong>oscap</strong></span>
 utility supports SCAP version 1.2 and is backward compatible with SCAP 
versions 1.1 and 1.0 so it can process earlier versions of the SCAP 
content without any special requirements.
			</div></div><div class="section" id="sect-Displaying_SCAP_Content_oscap"><div class="titlepage"><div><div><h3 class="title">8.4.2.&nbsp;Displaying SCAP Content</h3></div></div></div><div class="para">
				SCAP standard defines numerous file formats. The <span class="application"><strong>oscap</strong></span>
 utility can process or create files conforming to many of the formats. 
In order to further process the given file with SCAP content, you need 
to understand how to use <span class="application"><strong>oscap</strong></span>
 with the given file type. If you are unsure how to use a particular 
file, you can either open and read the file, or you can use the <code class="systemitem">info</code> module of <span class="application"><strong>oscap</strong></span> which parses the file and extracts relevant information in human-readable format.
			</div><div class="para">
				Run the following command to examine the internal structure of a 
SCAP document and display useful information such as the document type, 
specification version, a status of the document, the date the document 
was published, and the date the document was copied to a file system:
			</div><pre class="synopsis"><code class="command">oscap info</code> <em class="replaceable">file</em></pre><div class="para">
				where <em class="replaceable">file</em> is the full path to the security content file being examined. The following example better illustrates the usage of the <code class="command">oscap info</code> command:
			</div><div class="example" id="exam-SCAP-oscap-Displaying_SCAP_Content"><p class="title"><strong>Example&nbsp;8.5.&nbsp;Displaying Information About SCAP Content</strong></p><div class="example-contents"><pre class="screen">~]$ <code class="command">oscap info <code class="filename">/usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></code>
Document type: Source Data Stream
Imported: 2014-08-28T15:41:34

Stream: scap_org.open-scap_datastream_from_xccdf_ssg-rhel6-xccdf-1.2.xml
Generated: (null)
Version: 1.2
Checklists:
        Ref-Id: scap_org.open-scap_cref_ssg-rhel6-xccdf-1.2.xml
                Profiles:
                        xccdf_org.ssgproject.content_profile_test
                        xccdf_org.ssgproject.content_profile_CS2
                        xccdf_org.ssgproject.content_profile_common
                        xccdf_org.ssgproject.content_profile_server
                        xccdf_org.ssgproject.content_profile_stig-rhel6-server-upstream
                        xccdf_org.ssgproject.content_profile_usgcb-rhel6-server
                        xccdf_org.ssgproject.content_profile_rht-ccp
                        xccdf_org.ssgproject.content_profile_CSCF-RHEL6-MLS
                        xccdf_org.ssgproject.content_profile_C2S
                Referenced check files:
                        ssg-rhel6-oval.xml
                                system: http://oval.mitre.org/XMLSchema/oval-definitions-5
Checks:
        Ref-Id: scap_org.open-scap_cref_ssg-rhel6-oval.xml
        Ref-Id: scap_org.open-scap_cref_output--ssg-rhel6-cpe-oval.xml
        Ref-Id: scap_org.open-scap_cref_output--ssg-rhel6-oval.xml
Dictionaries:
        Ref-Id: scap_org.open-scap_cref_output--ssg-rhel6-cpe-dictionary.xml</pre></div></div></div><div class="section" id="sect-Scanning_the_System_in_oscap"><div class="titlepage"><div><div><h3 class="title">8.4.3.&nbsp;Scanning the System</h3></div></div></div><div class="para">
				The most important functionality of <span class="application"><strong>oscap</strong></span>
 is to perform configuration and vulnerability scans of a local system. 
The following is a general syntax of the respective command:
			</div><pre class="synopsis"><code class="command">oscap [<span class="optional">options</span>] <em class="replaceable">module</em> eval [<span class="optional">module_operation_options_and_arguments</span>]</code></pre><div class="para">
				The <span class="application"><strong>oscap</strong></span> utility can scan systems against the SCAP content represented by both, an <code class="systemitem">XCCDF</code> (The eXtensible Configuration Checklist Description Format) benchmark and <code class="systemitem">OVAL</code>
 (Open Vulnerability and Assessment Language) definitions. The security 
policy can have a form of a single OVAL or XCCDF file or multiple 
separate XML files where each file represents a different component 
(XCCDF, OVAL, CPE, CVE, and others). The result of a scan can be printed
 to both, standard output and an XML file. The result file can be then 
further processed by <span class="application"><strong>oscap</strong></span>
 in order to generate a report in a human-readable format. The following
 examples illustrate the most common usage of the command.
			</div><div class="example" id="exam-SCAP-oscap-Scanning-OVAL-1"><p class="title"><strong>Example&nbsp;8.6.&nbsp;Scanning the System Using the SSG OVAL definitions</strong></p><div class="example-contents"><div class="para">
					To scan your system against the SSG OVAL definition file while evaluating all definitions, run the following command:
				</div><pre class="screen">~]$ <code class="command">oscap oval eval <code class="option">--results</code> <code class="filename">scan-oval-results.xml</code> <code class="filename">/usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></code></pre><div class="para">
					The results of the scan will be stored as the <code class="filename">scan-oval-results.xml</code> file in the current directory.
				</div></div></div><div class="example" id="exam-SCAP-oscap-Scanning-OVAL-2"><p class="title"><strong>Example&nbsp;8.7.&nbsp;Scanning the System Using the SSG OVAL definitions</strong></p><div class="example-contents"><div class="para">
					To evaluate a particular OVAL definition from the security policy 
represented by the SSG data stream file, run the following command:
				</div><pre class="screen">~]$ <code class="command">oscap oval eval <code class="option">--id</code> <em class="replaceable">oval:ssg:def:100</em> <code class="option">--results</code> <code class="filename">scan-oval-results.xml</code> <code class="filename">/usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></code></pre><div class="para">
					The results of the scan will be stored as the <code class="filename">scan-oval-results.xml</code> file in the current directory.
				</div></div></div><div class="example" id="exam-SCAP-oscap-Scanning-XCCDF-1"><p class="title"><strong>Example&nbsp;8.8.&nbsp;Scanning the System Using the SSG XCCDF benchmark</strong></p><div class="example-contents"><div class="para">
					To perform the SSG XCCDF benchmark for the <code class="systemitem">xccdf_org.ssgproject.content_profile_rht-ccp</code> profile on your system, run the following command:
				</div><pre class="screen">~]$ <code class="command">oscap xccdf eval <code class="option">--profile</code> <em class="replaceable">xccdf_org.ssgproject.content_profile_rht-ccp</em> <code class="option">--results</code> <code class="filename">scan-xccdf-results.xml</code> <code class="filename">/usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></code></pre><div class="para">
					The results of the scan will be stored as the <code class="filename">scan-xccdf-results.xml</code> file in the current directory. 
					<div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							The <code class="option">--profile</code> command-line argument 
selects the security profile from the given XCCDF or data stream file. 
The list of available profiles can be obtained by running the <code class="command">oscap info</code> command. If the <code class="option">--profile</code>
 command-line argument is omitted the default XCCDF profile is used as 
required by SCAP standard. Note that the default XCCDF profile may or 
may not be an appropriate security policy.
						</div></div></div>

				</div></div></div></div><div class="section" id="sect-Generating_Reports_and_Guides_in_oscap"><div class="titlepage"><div><div><h3 class="title">8.4.4.&nbsp;Generating Reports and Guides</h3></div></div></div><div class="para">
				Another useful features of <span class="application"><strong>oscap</strong></span> is the ability to generate SCAP content in a human-readable format. The <span class="application"><strong>oscap</strong></span>
 utility allows you to transform an XML file into the HTML or plain-text
 format. This feature is used to generate security guides and 
checklists, which serve as a source of information, as well as guidance 
for secure system configuration. The results of system scans can also be
 transformed to well-readable result reports. The general command syntax
 is the following:
			</div><pre class="synopsis"><code class="command">oscap <em class="replaceable">module</em> generate <em class="replaceable">sub-module</em> [<span class="optional">specific_module/sub-module_options_and_arguments</span>] <em class="replaceable">file</em></code></pre><div class="para">
				where <em class="replaceable">module</em> is either <code class="literal">xccdf</code> or <code class="literal">oval</code>, <em class="replaceable">sub-module</em> is a type of the generated document, and <em class="replaceable">file</em> represents an XCCDF or OVAL file.
			</div><div class="para">
				The following are the most common examples of the command usage:
			</div><div class="example" id="exam-SCAP-oscap-Guides-and-Reports-1"><p class="title"><strong>Example&nbsp;8.9.&nbsp;Generating a Guide with a Checklist</strong></p><div class="example-contents"><div class="para">
					To produce an SSG guide with a checklist for the <code class="systemitem">xccdf_org.ssgproject.content_profile_rht-ccp</code> profile, run the following command:
				</div><pre class="screen">~]$ <code class="command">oscap xccdf generate guide <code class="option">--profile</code> <code class="systemitem">xccdf_org.ssgproject.content_profile_rht-ccp</code> <code class="filename">/usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code> &gt; <code class="filename">ssg-guide-checklist.html</code></code></pre><div class="para">
					The guide will be stored as the <code class="filename">ssg-guide-checklist.html</code> file in the current directory.
				</div></div></div><div class="example" id="exam-SCAP-oscap-Guides-and-Reports-2"><p class="title"><strong>Example&nbsp;8.10.&nbsp;Transforming an SSG OVAL Scan Result into a Report</strong></p><div class="example-contents"><div class="para">
					To transform a result of an SSG OVAL scan into a HTML file, run the following command:
				</div><pre class="screen">~]$ <code class="command">oscap oval generate report <code class="filename">scan-oval-results.xml</code></code> <code class="command">&gt; <code class="filename">ssg-scan-oval-report.html</code></code></pre><div class="para">
					The result report will be stored as the <code class="filename">ssg-scan-oval-report.html</code> file in the current directory. This example assumes that you run the command from the same location where the <code class="filename">scan-oval-results.xml</code> file is stored. Otherwise you need to specify the fully-qualified path of the file that contains the scan results.
				</div></div></div><div class="example" id="exam-SCAP-oscap-Guides-and-Reports-3"><p class="title"><strong>Example&nbsp;8.11.&nbsp;Transforming an SSG XCCDF Scan Result into a Report</strong></p><div class="example-contents"><div class="para">
					To transform a result of an SSG XCCDF scan into a HTML file, run the following command:
				</div><pre class="screen">~]$ <code class="command">oscap xccdf generate report <code class="filename">scan-xccdf-results.xml</code></code> <code class="command">&gt; <code class="filename">scan-xccdf-report.html</code></code></pre><div class="para">
					The result report will be stored as the <code class="filename">ssg-scan-xccdf-report.html</code> file in the current directory. Alternatively, you can generate this report in the time of the scan using the <code class="option">--report</code> command-line argument:
				</div><pre class="screen">~]$ <code class="command">oscap xccdf eval <code class="option">--profile</code> xccdf_org.ssgproject.content_profile_rht-ccp <code class="option">--results</code><code class="filename">scan-xccdf-results.xml</code> <code class="option">--report</code> <code class="filename">scan-xccdf-report.html</code> <code class="filename">/usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></code></pre></div></div></div><div class="section" id="sect-Validating_SCAP_Content_in_oscap"><div class="titlepage"><div><div><h3 class="title">8.4.5.&nbsp;Validating SCAP Content</h3></div></div></div><div class="para">
				Before you start using a security policy on your systems, you should
 first verify the policy in order to avoid any possible syntax or 
semantic errors in the policy. The <span class="application"><strong>oscap</strong></span>
 utility can be used to validate the security content against standard 
SCAP XML schemas. The validation results are printed to the standard 
error stream (stderr). The general syntax of such a validation command 
is the following:
			</div><pre class="synopsis"><code class="command">oscap <em class="replaceable">module</em> <code class="option">validate</code> [<span class="optional">module_options_and_arguments</span>] <em class="replaceable">file</em></code></pre><div class="para">
				Where <em class="replaceable">file</em> is the full path to the file being validated. The only exception is the data stream module (<code class="literal">ds</code>), which uses the <code class="option">sds-validate</code> operation instead of <code class="option">validate</code>.
 Note that all SCAP components within the given data stream are 
validated automatically, and none of the components is specified 
separately, as can be seen in the following example:
			</div><pre class="screen">~]$ <code class="command">oscap <code class="option">ds</code> <code class="option">sds-validate</code> <code class="filename">/usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></code></pre><div class="para">
				With certain SCAP content, such as OVAL specification, you can also 
perform a Schematron validation. The Schematron validation is slower 
than the standard validation but provides deeper analysis, and is thus 
able to detect more errors. The following SSG example shows typical 
usage of the command:
			</div><pre class="screen">~]$ <code class="command">oscap oval validate <code class="option">--schematron</code> <code class="filename">/usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></code></pre></div><div class="section" id="sect-Using_OpenSCAP_to_Remediate_the_System"><div class="titlepage"><div><div><h3 class="title">8.4.6.&nbsp;Using OpenSCAP to Remediate the System</h3></div></div></div><div class="para">
				<span class="application"><strong>OpenSCAP</strong></span> allows to
 automatically remediate systems that have been found in a non-compliant
 state. For system remediation, an XCCDF file with instructions is 
required. The <span class="package">scap-security-guide package</span> constains certain remediation instructions.
			</div><div class="para">
				System remediation consists of the following steps:
			</div><div class="procedure"><ol class="1"><li class="step"><div class="para">
						<span class="application"><strong>OpenSCAP</strong></span> performs a regular XCCDF evaluation.
					</div></li><li class="step"><div class="para">
						An assessment of the results is performed by evaluating the OVAL 
definitions. Each rule that has failed is marked as a candidate for 
remediation.
					</div></li><li class="step"><div class="para">
						<span class="application"><strong>OpenSCAP</strong></span> searches for an appropriate fix element, resolves it, prepares the environment, and executes the fix script.
					</div></li><li class="step"><div class="para">
						Any output of the fix script is captured by <span class="application"><strong>OpenSCAP</strong></span> and stored within the <code class="code">rule-result</code> element. The return value of the fix script is stored as well.
					</div></li><li class="step"><div class="para">
						Whenever <span class="application"><strong>OpenSCAP</strong></span>
 executes a fix script, it immediatelly evaluates the OVAL definition 
again (to verify that the fix script has been applied correctly). During
 this second run, if the OVAL evaluation returns success, the result of 
the rule is <code class="literal">fixed</code>, otherwise it is an <code class="literal">error</code>.
					</div></li><li class="step"><div class="para">
						Detailed results of the remediation are stored in an output XCCDF file. It contains two <code class="code">TestResult</code> elements. The first <code class="code">TestResult</code> element represents the scan prior to the remediation. The second <code class="code">TestResult</code> is derived from the first one and contains remediation results.
					</div></li></ol></div><div class="para">
				There are three modes of operation of <span class="application"><strong>OpenSCAP</strong></span> with regard to remediation: online, offline, and review.
			</div><div class="section" id="sect-Using_OpenSCAP_to_Remediate_the_System-Online_Remediation"><div class="titlepage"><div><div><h4 class="title">8.4.6.1.&nbsp;OpenSCAP Online Remediation</h4></div></div></div><div class="para">
					Online remediation executes fix elements at the time of scanning. 
Evaluation and remediation are performed as a part of a single command.
				</div><div class="para">
					To enable online remediation, use the <code class="option">--remediate</code> command-line option. For example, to execute online remediation using the <span class="package">scap-security-guide</span> package, run:
				</div><pre class="screen"><code class="prompt">~]$</code> <code class="command">oscap xccdf eval --remediate --profile xccdf_org.ssgproject.content_profile_rht-ccp --results scan-xccdf-results.xml /usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></pre><div class="para">
					The output of this command consists of two sections. The first 
section shows the result of the scan prior to the remediation, and the 
second section shows the result of the scan after applying the 
remediation. The second part can contain only <code class="literal">fixed</code> and <code class="literal">error</code> results. The <code class="literal">fixed</code> result indicates that the scan performed after the remediation passed. The <code class="literal">error</code> result indicates that even after applying the remediation, the evaluation still does not pass.
				</div></div><div class="section" id="sect-Using_OpenSCAP_to_Remediate_the_System-Offline_Remediation"><div class="titlepage"><div><div><h4 class="title">8.4.6.2.&nbsp;OpenSCAP Offline Remediation</h4></div></div></div><div class="para">
					Offline remediation allows you to postpone fix execution. In first 
step, the system is only evaluated, and the results are stored in a <code class="code">TestResult</code> element in an XCCDF file.
				</div><div class="para">
					In the second step, <code class="command">oscap</code> executes the
 fix scripts and verifies the result. It is safe to store the results 
into the input file, no data will be lost. During offline remediation, <span class="application"><strong>OpenSCAP</strong></span> creates a new <code class="code">TestResult</code> element that is based on the input one and inherits all the data. The newly created <code class="code">TestResult</code> differs only in the <code class="code">rule-result</code> elements that have failed. For those, remediation is executed.
				</div><div class="para">
					To perform offline remediation using the <span class="package">scap-security-guide</span> package, run:
				</div><pre class="screen"><code class="prompt">~]$</code> <code class="command">oscap xccdf eval --profile xccdf_org.ssgproject.content_profile_rht-ccp --results scan-xccdf-results.xml /usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></pre><pre class="screen"><code class="prompt">~]$</code> <code class="command">oscap xccdf remediate --results scan-xccdf-results.xml scan-xccdf-results.xml</code></pre></div><div class="section" id="sect-Using_OpenSCAP_to_Remediate_the_System-Remediation_Review"><div class="titlepage"><div><div><h4 class="title">8.4.6.3.&nbsp;OpenSCAP Remediation Review</h4></div></div></div><div class="para">
					The review mode allows users to store remediation instructions to a
 file for further review. The remediation content is not executed during
 this operation.
				</div><div class="para">
					To generate remediation instructions in the form of a shell script, run:
				</div><pre class="screen"><code class="prompt">~]$</code> <code class="command">oscap xccdf generate fix --template urn:xccdf:fix:script:sh --profile xccdf_org.ssgproject.content_profile_rht-ccp --output my-remediation-script.sh /usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></pre></div></div></div><div class="section" id="sect-Using_OpenSCAP_with_Red_Hat_Satellite"><div class="titlepage"><div><div><h2 class="title">8.5.&nbsp;Using OpenSCAP with Red Hat Satellite</h2></div></div></div><div class="para">
			When running multiple Red Hat Enterprise Linux systems, it is 
important to keep all your systems compliant with your security policy 
and perform security scans and evaluations remotely from one location. 
This can be achieved by using Red Hat Satellite 5.5 or later with the <span class="package">spacewalk-oscap</span> package installed on your Satellite client. The package is available from the <span class="strong strong"><strong>Red Hat Network Tools</strong></span> channel.
		</div><div class="para">
			This solution supports two methods of performing security compliance 
scans, viewing and further processing of the scan results. You can 
either use the <code class="systemitem">OpenSCAP Satellite Web Interface</code> or run commands and scripts from the <code class="systemitem">Satellite API</code>. For more information about this solution to security compliance, its requirements and capabilities, see the <a href="https://access.redhat.com/documentation/en/red-hat-satellite/">Red Hat Satellite documentation</a>.
		</div></div><div class="section" id="sect-Installing_USGCB-Compliant_System_with_Kickstart"><div class="titlepage"><div><div><h2 class="title">8.6.&nbsp;Installing USGCB-Compliant System with Kickstart</h2></div></div></div><div class="para">
			Starting with Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.7, a <a href="http://usgcb.nist.gov/usgcb_faq.html"><acronym class="acronym">USGCB</acronym> (<em class="firstterm">United States Government Configuration Baseline</em>)</a> benchmark <em class="firstterm">Kickstart</em> file is supplied for the Server variant of Red&nbsp;Hat Enterprise&nbsp;Linux. This allows administrators to install a <acronym class="acronym">USGCB</acronym>-compliant
 system with a minimum effort. Instead of installing a raw Red&nbsp;Hat 
Enterprise&nbsp;Linux system, scanning it using <acronym class="acronym">USGCB</acronym> <acronym class="acronym">SCAP</acronym> content, and then reconfiguring the system to achieve compliance, administrators can use the <acronym class="acronym">USGCB</acronym> benchmark Kickstart file to automatically obtain a <acronym class="acronym">USGCB</acronym> compliant system from the start.
		</div><div class="para">
			See the Red&nbsp;Hat Enterprise&nbsp;Linux Installation Guide for 
more information on using Kickstart files for automated installations 
(chapter <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Installation_Guide/ch-kickstart2.html">Kickstart Installations</a>), as well as instructions on how to use the provided <acronym class="acronym">USGCB</acronym> benchmark Kickstart file (section <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Installation_Guide/sect-scap-security-guide-kickstart.html">Creating a USGCB or DISA STIG-compliant Installation Image</a>). The <acronym class="acronym">USGCB</acronym> Kickstart file is included in the <span class="package">scap-security-guide</span> package, and its permanent location is:
		</div><pre class="screen">/usr/share/scap-security-guide/kickstart/ssg-rhel6-usgcb-server-with-gui-ks.cfg</pre></div><div class="section" id="sect-Practical_Examples"><div class="titlepage"><div><div><h2 class="title">8.7.&nbsp;Practical Examples</h2></div></div></div><div class="para">
			This section demonstrates practical usage of certain security content provided for Red&nbsp;Hat products.
		</div><div class="section" id="sect-Auditing_Security_Vulnerabilities_Example"><div class="titlepage"><div><div><h3 class="title">8.7.1.&nbsp;Auditing Security Vulnerabilities of Red&nbsp;Hat Products</h3></div></div></div><div class="para">
				Red&nbsp;Hat continuously provides OVAL definitions for their 
products. These definitions allow for fully automated audit of 
vulnerabilities in the installed software. To find out more information 
about this project, see <a href="http://www.redhat.com/security/data/metrics/">http://www.redhat.com/security/data/metrics/</a>. To download these definitions, run the following command:
			</div><pre class="screen">~]$ <code class="command">wget http://www.redhat.com/security/data/oval/com.redhat.rhsa-all.xml</code></pre><div class="para">
				The users of Red&nbsp;Hat&nbsp;Satellite&nbsp;5 may find useful the 
XCCDF part of the patch definitions. To download these definitions, run 
the following command:
			</div><pre class="screen">~]$ <code class="command">wget http://www.redhat.com/security/data/metrics/com.redhat.rhsa-all.xccdf.xml</code></pre><div class="para">
				To audit security vulnerabilities for the software installed on the system, run the following command:
			</div><pre class="screen">~]$ <code class="command">oscap oval eval --results rhsa-results-oval.xml --report oval-report.html com.redhat.rhsa-all.xml</code></pre><div class="para">
				The <span class="application"><strong>oscap</strong></span> utility 
maps Red&nbsp;Hat&nbsp;Security&nbsp;Advisories to CVE identifiers that 
are linked to the National Vulnerability Database and reports which 
security advisories are not applied.
			</div><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
					Note that these OVAL definitions are designed to only cover 
software and updates released by Red&nbsp;Hat. You need to provide 
additional definitions in order to detect the patch status of 
third-party software.
				</div></div></div></div><div class="section" id="sect-Auditing_System_Settings_with_SSG_Example"><div class="titlepage"><div><div><h3 class="title">8.7.2.&nbsp;Auditing System Settings with SCAP Security Guide</h3></div></div></div><div class="para">
				The SCAP Security Guide (SSG) project's package, <span class="package">scap-security-guide</span>, contains the latest set of security polices for Linux systems. Part of <span class="package">scap-security-guide</span> is also a guidance for Red&nbsp;Hat&nbsp;Enterprise&nbsp;Linux&nbsp;6 settings. To inspect the security content available with <span class="package">scap-security-guide</span>, use the <code class="command">oscap info</code> module:
			</div><pre class="screen">~]$ <code class="command">oscap info /usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></pre><div class="para">
				The output of this command is an outline of the SSG document and it 
contains available configuration profiles. To audit your system 
settings, choose a suitable profile and run the appropriate evaluation 
command. For example, the following command is used to assess the given 
system against a draft SCAP profile for Red Hat Certified Cloud 
Providers:
			</div><pre class="screen">~]$ <code class="command">oscap xccdf eval --profile xccdf_org.ssgproject.content_profile_rht-ccp --results ssg-rhel6-xccdf-result.xml --report ssg-rhel6-report.html /usr/share/xml/scap/ssg/content/ssg-rhel6-ds.xml</code></pre></div></div><div class="section" id="sect-Additional_Resources"><div class="titlepage"><div><div><h2 class="title">8.8.&nbsp;Additional Resources</h2></div></div></div><div class="para">
			For more information about various security compliance fields of interest, see the resources below.
		</div><h3 id="brid-Installed_Resources">Installed Documentation</h3><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="systemitem">oscap</code>(8) — The manual page for the <span class="application"><strong>oscap</strong></span> command-line utility provides a complete list of available options and their usage explanation.
				</div></li><li class="listitem"><div class="para">
					Guide to the Secure Configuration of Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 — An HTML document located in the <code class="filename">/usr/share/doc/scap-security-guide-0.1.18/</code> directory that provides a detailed guide for security settings of your system in form of an XCCDF checklist.
				</div></li></ul></div><h3 id="brid-Online_Resources">Online Documentation</h3><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<a href="http://www.open-scap.org/">The OpenSCAP project page</a> — The home page to the OpenSCAP project provides detailed information about the <span class="application"><strong>oscap</strong></span> utility and other components and projects related to SCAP.
				</div></li><li class="listitem"><div class="para">
					<a href="https://www.open-scap.org/tools/scap-workbench/">The SCAP Workbench project page</a> — The home page to the SCAP Workbench project provides detailed information about the <span class="application"><strong>scap-workbench</strong></span> application.
				</div></li><li class="listitem"><div class="para">
					<a href="https://www.open-scap.org/security-policies/scap-security-guide/">The SCAP Security Guide (SSG) project page</a> — The home page to the SSG project that provides the latest security content for Red&nbsp;Hat Enterprise&nbsp;Linux.
				</div></li><li class="listitem"><div class="para">
					<a href="http://scap.nist.gov/">National Institute of Standards and Technology (NIST) SCAP page</a>
 — This page represents a vast collection of SCAP related materials, 
including SCAP publications, specifications, and the SCAP Validation 
Program.
				</div></li><li class="listitem"><div class="para">
					<a href="http://nvd.nist.gov/">National Vulnerability Database (NVD)</a> — This page represents the largest repository of SCAP content and other SCAP standards based vulnerability management data.
				</div></li><li class="listitem"><div class="para">
					<a href="http://www.redhat.com/security/data/oval/">Red Hat OVAL content repository</a> — This is a repository containing OVAL definitions for Red Hat Enterprise Linux systems.
				</div></li><li class="listitem"><div class="para">
					<a href="http://www.cve.mitre.org/">MITRE CVE</a> — This is a database of publicly known security vulnerabilities provided by the MITRE corporation.
				</div></li><li class="listitem"><div class="para">
					<a href="http://oval.mitre.org/">MITRE OVAL</a> — This page 
represents an OVAL related project provided by the MITRE corporation. 
Amongst other OVAL related information, these pages contain the latest 
version of the OVAL language and a huge repository of OVAL content, 
counting over 22 thousands OVAL definitions.
				</div></li><li class="listitem"><div class="para">
					<a href="https://access.redhat.com/documentation/en/red-hat-satellite/">Red Hat Satellite documentation</a> — This set of guides describes, amongst other topics, how to maintain system security on multiple systems by using OpenSCAP.
				</div></li></ul></div></div></div><div xml:lang="en-US" class="chapter" id="sec-Checking-Integrity-with-AIDE" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;9.&nbsp;Checking Integrity with <span class="application"><strong>AIDE</strong></span></h1></div></div></div><div class="section" id="sec-Using-AIDE"><div class="titlepage"><div><div><h2 class="title">9.1.&nbsp;Introduction</h2></div></div></div><div class="para">
			Advanced Intrusion Detection Environment (<span class="application"><strong>AIDE</strong></span>)
 is a utility that creates a database of files on the system, and then 
uses that database to ensure file integrity and detect system 
intrusions.
		</div></div><div class="section" id="sec-Installing_AIDE"><div class="titlepage"><div><div><h2 class="title">9.2.&nbsp;Installing <span class="application"><strong>AIDE</strong></span></h2></div></div></div><div class="para">
			To install the <span class="package">aide</span> package, enter the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]#&nbsp;<code class="command">yum install aide</code></pre><div class="para">
			To generate an initial database, enter the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]#&nbsp;<code class="command">aide --init</code>

AIDE, version 0.14

### AIDE database at /var/lib/aide/aide.db.new.gz initialized.</pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
				In the default configuration, the <code class="command">aide --init</code> command checks just a set of directories and files defined in the <code class="filename">/etc/aide.conf</code> file. To include additional directories or files in the AIDE database, and to change their watched parameters, edit <code class="filename">/etc/aide.conf</code> accordingly.
			</div></div></div><div class="para">
			To start using the database, remove the <code class="literal">.new</code> substring from the initial database file name:
		</div><pre class="screen">~]#&nbsp;<code class="command">mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz</code></pre><div class="para">
			To change the location of the <span class="application"><strong>AIDE</strong></span> database, edit the <code class="filename">/etc/aide.conf</code> file and modify the <code class="option">DBDIR</code> value. For additional security, store the database, configuration, and the <code class="filename">/usr/sbin/aide</code> binary file in a secure location such as a read-only media.
		</div><div class="important"><div class="admonition_header"><p><strong>Important</strong></p></div><div class="admonition"><div class="para">
				To avoid SELinux denials after the AIDE database location change, update your SELinux policy accordingly. See the <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/SELinux_Users_and_Administrators_Guide/">SELinux User's and Administrator's Guide</a> for more information.
			</div></div></div></div><div class="section" id="sec-AIDE_Scan"><div class="titlepage"><div><div><h2 class="title">9.3.&nbsp;Performing Integrity Checks</h2></div></div></div><div class="para">
			To initiate a manual check, enter the following command as <code class="systemitem">root</code>:
		</div><pre class="screen">~]#&nbsp;<code class="command">aide --check</code>
AIDE found differences between database and filesystem!!
Start timestamp: 2017-04-07 17:11:33

Summary:
  Total number of files:	104892
  Added files:			7
  Removed files:		0
  Changed files:		52
...</pre><div class="para">
			At a minimum, <span class="application"><strong>AIDE</strong></span> should be configured to run a weekly scan. At most, <span class="application"><strong>AIDE</strong></span> should be run daily. For example, to schedule a daily execution of <span class="application"><strong>AIDE</strong></span> at <em class="replaceable">4:05 am</em> using <code class="command">cron</code> (see the <a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/ch-Automating_System_Tasks.html">Automating System Tasks</a> chapter in the System Administrator's Guide), add the following line to <code class="filename">/etc/crontab</code>:
		</div><pre class="screen"><em class="replaceable">05 4 * * *</em> root /usr/sbin/aide --check</pre></div><div class="section" id="sec-AIDE_Update"><div class="titlepage"><div><div><h2 class="title">9.4.&nbsp;Updating an <span class="application"><strong>AIDE</strong></span> Database</h2></div></div></div><div class="para">
			After the changes of your system such as package updates or 
configuration files adjustments are verified, update your baseline <span class="application"><strong>AIDE</strong></span> database:
		</div><pre class="screen">~]#&nbsp;<code class="command">aide --update</code></pre><div class="para">
			The <code class="command">aide --update</code> command creates the <code class="filename">/var/lib/aide/aide.db.new.gz</code> database file. To start using it for integrity checks, remove the <code class="literal">.new</code> substring from the file name.
		</div></div><div class="section" id="sec-AIDE_Additional_Resources"><div class="titlepage"><div><div><h2 class="title">9.5.&nbsp;Additional Resources</h2></div></div></div><div class="para">
			For additional information on AIDE, see the following documentation:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					<code class="filename">aide(1)</code> man page
				</div></li><li class="listitem"><div class="para">
					<code class="filename">aide.conf(5)</code> man page
				</div></li><li class="listitem"><div class="para">
					<a href="https://static.open-scap.org/ssg-guides/ssg-sl7-guide-ospp-rhel7-server.html#xccdf_org.ssgproject.content_group_aide">Guide to the Secure Configuration of Red Hat Enterprise Linux 7 (OpenSCAP Security Guide): Verify Integrity with AIDE</a>
				</div></li><li class="listitem"><div class="para">
					<a href="http://aide.sourceforge.net/stable/manual.html">The AIDE manual</a>
				</div></li></ul></div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Guide-Federal_Standards_And_Regulations" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;10.&nbsp;Federal Standards and Regulations</h1></div></div></div><div class="section" id="sect-Security_Guide-Federal_Standards_And_Regulations-Introduction"><div class="titlepage"><div><div><h2 class="title">10.1.&nbsp;Introduction</h2></div></div></div><div class="para">
			In order to maintain security levels, it is possible for your 
organization to make efforts to comply with federal and industry 
security specifications, standards and regulations. This chapter 
describes some of these standards and regulations.
		</div></div><div class="section" id="sect-Security_Guide-Federal_Standards_And_Regulations-Federal_Information_Processing_Standard"><div class="titlepage"><div><div><h2 class="title">10.2.&nbsp;Federal Information Processing Standard (FIPS)</h2></div></div></div><div class="para">
			The Federal Information Processing Standard (FIPS) Publication 140-2,
 is a computer security standard, developed by a U.S. Government and 
industry working group to validate the quality of cryptographic modules.
 FIPS publications (including 140-2) can be found at the following URL: <a href="http://csrc.nist.gov/publications/PubsFIPS.html">http://csrc.nist.gov/publications/PubsFIPS.html</a>. The FIPS standard provides four (4) security <span class="emphasis"><em>levels</em></span>,
 to ensure adequate coverage of different industries, implementations of
 cryptographic modules and organizational sizes and requirements. These 
levels are described below:
		</div><div class="itemizedlist"><ul><li class="listitem"><div class="para">
					Level 1 – Security Level 1 provides the lowest level of security. 
Basic security requirements are specified for a cryptographic module 
(e.g., at least one Approved algorithm or Approved security function 
shall be used). No specific physical security mechanisms are required in
 a Security Level 1 cryptographic module beyond the basic requirement 
for production-grade components. An example of a Security Level 1 
cryptographic module is a personal computer (PC) encryption board.
				</div></li><li class="listitem"><div class="para">
					Level 2 – Security Level 2 enhances the physical security 
mechanisms of a Security Level 1 cryptographic module by adding the 
requirement for tamper-evidence, which includes the use of 
tamper-evident coatings or seals or for pick-resistant locks on 
removable covers or doors of the module. Tamper-evident coatings or 
seals are placed on a cryptographic module so that the coating or seal 
must be broken to attain physical access to the plain text cryptographic
 keys and critical security parameters (CSPs) within the module. 
Tamper-evident seals or pick-resistant locks are placed on covers or 
doors to protect against unauthorized physical access.
				</div></li><li class="listitem"><div class="para">
					Level 3 – In addition to the tamper-evident physical security 
mechanisms required at Security Level 2, Security Level 3 attempts to 
prevent the intruder from gaining access to CSPs held within the 
cryptographic module. Physical security mechanisms required at Security 
Level 3 are intended to have a high probability of detecting and 
responding to attempts at physical access, use or modification of the 
cryptographic module. The physical security mechanisms may include the 
use of strong enclosures and tamper detection/response circuitry that 
zeroes all plain text CSPs when the removable covers/doors of the 
cryptographic module are opened.
				</div></li><li class="listitem"><div class="para">
					Level 4 – Security Level 4 provides the highest level of security 
defined in this standard. At this security level, the physical security 
mechanisms provide a complete envelope of protection around the 
cryptographic module with the intent of detecting and responding to all 
unauthorized attempts at physical access. Penetration of the 
cryptographic module enclosure from any direction has a very high 
probability of being detected, resulting in the immediate zeroization of
 all plain text CSPs. Security Level 4 cryptographic modules are useful 
for operation in physically unprotected environments.
				</div></li></ul></div><div class="para">
			Refer to the full FIPS 140-2 standard at <a href="http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf">http://csrc.nist.gov/publications/fips/fips140-2/fips1402.pdf</a> for further details on these levels and the other specifications of the FIPS standard.
		</div><div class="section" id="enabling-fips-mode"><div class="titlepage"><div><div><h3 class="title">10.2.1.&nbsp;Enabling FIPS Mode</h3></div></div></div><div class="para">
				To make Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6 compliant with the
 Federal Information Processing Standard (FIPS) Publication 140-2, you 
need to make several changes to ensure that certified cryptographic 
modules are used. To turn your system (kernel and user space) into FIPS 
mode, follow these steps:
			</div><div class="orderedlist"><ol><li class="listitem"><div class="para">
						For proper operation of the in-module integrity verification, the prelink has to be disabled. This can be done by setting <code class="option">PRELINKING=no</code> in the <code class="filename">/etc/sysconfig/prelink</code> configuration file. Existing prelinking, if any, should be undone on all system files using the <code class="command">prelink&nbsp;-u&nbsp;-a</code> command.
					</div></li><li class="listitem"><div class="para">
						Next, install the <span class="package">dracut-fips</span> package:
					</div><pre class="screen">~]#&nbsp;<code class="command">yum install dracut-fips</code></pre><div class="note"><div class="admonition_header"><p><strong>Note</strong></p></div><div class="admonition"><div class="para">
							FIPS integrity verification is performed when the <span class="package">dracut-fips</span>
 package is present on the system, regardless of whether the system 
operates in FIPS mode or not. However, the integrity verification 
results are ignored (or only logged) if the system or a shared library 
is not in FIPS mode, even when <span class="package">dracut-fips</span> is present.
						</div></div></div></li><li class="listitem"><div class="para">
						Recreate the <code class="filename">initramfs</code> file (this operation will overwrite the existing <code class="filename">initramfs</code> file):
					</div><pre class="screen">~]#&nbsp;<code class="command">dracut -f</code></pre></li><li class="listitem"><div class="para">
						Modify the kernel command line of the current kernel in the <code class="filename">/boot/grub/grub.conf</code> file by adding the following option:
					</div><pre class="screen">fips=1</pre><div class="para">
						If the <code class="filename">/boot</code> or <code class="filename">/boot/efi/</code> directories are located on a separate partition, the <em class="parameter"><code>boot=<em class="replaceable">partition</em></code></em> kernel parameter must be added to the kernel command line. Replace <em class="replaceable">partition</em> with the partition that contains the <code class="filename">/boot</code> or <code class="filename">/boot/efi/</code> directory. Partitions can be identified using the <code class="command">df</code> command. For example:
					</div><pre class="screen">~]$&nbsp;<code class="command">df /boot</code>
Filesystem           1K-blocks      Used Available Use% Mounted on
/dev/sda1               495844     53780    416464  12% /boot</pre><div class="para">
						In the example above, the <code class="filename">/boot</code> directory is located on <code class="filename">/dev/sda1</code>. Therefore, the following string needs to be appended to the kernel command line:
					</div><pre class="screen">boot=/dev/sda1</pre></li><li class="listitem"><div class="para">
						Reboot your system.
					</div></li></ol></div><div class="para">
				Note that by default, ciphers and Message Authentication Codes (MACs) are set in the <code class="filename">/etc/ssh/sshd_config</code> file in FIPS mode. If your <code class="filename">/etc/ssh/sshd_config</code>
 contains any other ciphers and MACs, modify it to only use algorithms 
supported in FIPS mode. To do that, use the following configuration or a
 subset thereof:
			</div><pre class="screen">Protocol 2
Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc
Macs hmac-sha1,hmac-sha2-256,hmac-sha2-512</pre><div class="para">
				Should you require strict FIPS compliance, the <code class="option">fips=1</code>
 kernel option needs to be added to the kernel command line during 
system installation so that key generation is done with FIPS approved 
algorithms and continuous monitoring tests in place. Users should also 
ensure that the system has plenty of entropy during the installation 
process by moving the mouse around, or if no mouse is available, 
ensuring that many keystrokes are typed. The recommended amount of 
keystrokes is 256 and more. Less than 256 keystrokes may generate a 
non-unique key.
			</div></div><div class="section" id="enabling-fips-mode-for-apps-using-nss"><div class="titlepage"><div><div><h3 class="title">10.2.2.&nbsp;Enabling FIPS Mode for Applications Using NSS</h3></div></div></div><div class="para">
				The procedure for enabling FIPS mode on Red&nbsp;Hat Enterprise&nbsp;Linux systems described in <a class="xref" href="#enabling-fips-mode">Section&nbsp;10.2.1, “Enabling FIPS Mode”</a>
 does not affect the FIPS state of Network Security Services (NSS), and 
thus does not affect applications using NSS. When required, the user can
 switch any NSS application to FIPS mode using the following command:
			</div><pre class="screen">~]# <code class="command">modutil <code class="option">-fips</code> true <code class="option">-dbdir</code> <em class="replaceable">dir</em></code></pre><div class="para">
				Replace <em class="replaceable">dir</em> with the directory 
specifying the NSS database used by the application. If more than one 
NSS application uses this database, all these applications will be 
switched into FIPS mode. The applications have to be restarted for the 
NSS FIPS mode to take effect.
			</div><div class="para">
				Provided that the <span class="package">nss-sysinit</span> package is installed, and the application whose NSS database you need to locate opens the <code class="filename">/etc/pki/nssdb</code> file, the path to the user NSS database is <code class="filename">~/.pki/nssdb</code>.
			</div><div class="para">
				To enable FIPS mode for the <span class="application"><strong>Firefox</strong></span> web browser and the <span class="application"><strong>Thunderbird</strong></span> email client, go to <span class="guimenu"><strong>Edit</strong></span> → <span class="guimenuitem"><strong>Preferences</strong></span> → <span class="guimenuitem"><strong>Advanced</strong></span> → <span class="guimenuitem"><strong>Certificates</strong></span> → <span class="guimenuitem"><strong>Security Devices</strong></span> → <span class="guimenuitem"><strong>Enable FIPS</strong></span>.
			</div></div></div><div class="section" id="sect-Security_Guide-Federal_Standards_And_Regulations-National_Industrial_Security_Program_Operating_Manual"><div class="titlepage"><div><div><h2 class="title">10.3.&nbsp;National Industrial Security Program Operating Manual (NISPOM)</h2></div></div></div><div class="para">
			The NISPOM (also called DoD 5220.22-M), as a component of the 
National Industrial Security Program (NISP), establishes a series of 
procedures and requirements for all government contractors with regard 
to classified information. The current NISPOM is dated February 28, 2006
 with incorporated major changes from March 28, 2013. The NISPOM 
document can be downloaded from the following URL: <a href="http://www.nispom.org/NISPOM-download.html">http://www.nispom.org/NISPOM-download.html</a>.
		</div></div><div class="section" id="sect-Security_Guide-Federal_Standards_And_Regulations-Payment_Card_Industry_Data_Security_Standard"><div class="titlepage"><div><div><h2 class="title">10.4.&nbsp;Payment Card Industry Data Security Standard (PCI DSS)</h2></div></div></div><div class="para">
			From <a href="https://www.pcisecuritystandards.org/about/index.shtml">https://www.pcisecuritystandards.org/about/index.shtml</a>: <span class="emphasis"><em>The
 PCI Security Standards Council is an open global forum, launched in 
2006, that is responsible for the development, management, education, 
and awareness of the PCI Security Standards, including the Data Security
 Standard (DSS).</em></span>
		</div><div class="para">
			You can download the PCI DSS standard from <a href="https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml">https://www.pcisecuritystandards.org/security_standards/pci_dss.shtml</a>.
		</div></div><div class="section" id="sect-Security_Guide-Federal_Standards_And_Regulations-Security_Technical_Implementation_Guide"><div class="titlepage"><div><div><h2 class="title">10.5.&nbsp;Security Technical Implementation Guide</h2></div></div></div><div class="para">
			A Security Technical Implementation Guide or STIG is a methodology 
for standardized secure installation and maintenance of computer 
software and hardware.
		</div><div class="para">
			See the official <a href="http://iase.disa.mil/stigs/Pages/index.aspx">IASE website</a> for more information on STIG.
		</div></div></div><div xml:lang="en-US" class="chapter" id="chap-Security_Guide-References" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Chapter&nbsp;11.&nbsp;References</h1></div></div></div><div class="para">
		The following references are pointers to additional information that 
is relevant to SELinux and Red&nbsp;Hat Enterprise&nbsp;Linux but beyond
 the scope of this guide. Note that due to the rapid development of 
SELinux, some of this material may only apply to specific releases of 
Red&nbsp;Hat Enterprise&nbsp;Linux.
	</div><div class="variablelist" id="vari-Security_Guide-References-Books"><p class="title"><strong>Books</strong></p><dl class="variablelist"><dt><span class="term">SELinux by Example</span></dt><dd><div class="para">
					Mayer, MacMillan, and Caplan
				</div><div class="para">
					Prentice Hall, 2007
				</div></dd></dl></div><div class="variablelist" id="vari-Security_Guide-References-Tutorials_and_Help"><p class="title"><strong>Tutorials and Help</strong></p><dl class="variablelist"><dt><span class="term">Tutorials and talks from Russell Coker</span></dt><dd><div class="para">
					<a href="http://www.coker.com.au/selinux/talks/ibmtu-2004/">http://www.coker.com.au/selinux/talks/ibmtu-2004/</a>
				</div></dd><dt><span class="term">Generic Writing SELinux policy HOWTO</span></dt><dd><div class="para">
					<a href="http://www.lurking-grue.org/writingselinuxpolicyHOWTO.html">http://www.lurking-grue.org/writingselinuxpolicyHOWTO.html</a>
				</div></dd><dt><span class="term">Red&nbsp;Hat Knowledgebase</span></dt><dd><div class="para">
					<a href="https://access.redhat.com/knowledgebase">https://access.redhat.com/knowledgebase</a>
				</div></dd></dl></div><div class="variablelist" id="vari-Security_Guide-References-General_Information"><p class="title"><strong>General Information</strong></p><dl class="variablelist"><dt><span class="term">NSA SELinux main website</span></dt><dd><div class="para">
					<a href="http://www.nsa.gov/research/selinux/index.shtml">http://www.nsa.gov/selinux/</a>
				</div></dd><dt><span class="term">SELinux NSA's Open Source Security Enhanced Linux</span></dt><dd><div class="para">
					<a href="http://www.oreilly.com/catalog/selinux/">http://www.oreilly.com/catalog/selinux/</a>
				</div></dd></dl></div><div class="variablelist" id="vari-Security_Guide-References-Technology"><p class="title"><strong>Technology</strong></p><dl class="variablelist"><dt><span class="term">Integrating Flexible Support for Security Policies into the Linux Operating System (a history of Flask implementation in Linux)</span></dt><dd><div class="para">
					<a href="http://www.nsa.gov/research/_files/selinux/papers/selsymp2005.pdf">http://www.nsa.gov/research/_files/selinux/papers/selsymp2005.pdf</a>
				</div></dd><dt><span class="term">A Security Policy Configuration for the Security-Enhanced Linux</span></dt><dd><div class="para">
					<a href="http://www.nsa.gov/research/_files/selinux/papers/policy/policy.shtml">http://www.nsa.gov/research/_files/selinux/papers/policy/policy.shtml</a>
				</div></dd></dl></div><div class="variablelist" id="vari-Security_Guide-References-Community"><p class="title"><strong>Community</strong></p><dl class="variablelist"><dt><span class="term">SELinux community page</span></dt><dd><div class="para">
					<a href="http://selinuxproject.org/">http://selinuxproject.org/</a>
				</div></dd><dt><span class="term">IRC</span></dt><dd><div class="para">
					irc.freenode.net, #selinux, #fedora-selinux, #security
				</div></dd></dl></div><div class="variablelist" id="vari-Security_Guide-References-History"><p class="title"><strong>History</strong></p><dl class="variablelist"><dt><span class="term">Quick history of Flask</span></dt><dd><div class="para">
					<a href="http://www.cs.utah.edu/flux/fluke/html/flask.html">http://www.cs.utah.edu/flux/fluke/html/flask.html</a>
				</div></dd><dt><span class="term">Full background on Fluke</span></dt><dd><div class="para">
					<a href="http://www.cs.utah.edu/flux/fluke/html/index.html">http://www.cs.utah.edu/flux/fluke/html/index.html</a>
				</div></dd></dl></div></div><div xml:lang="en-US" class="appendix" id="chap-Security_Guide-Encryption_Standards" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Appendix&nbsp;A.&nbsp;Encryption Standards</h1></div></div></div><div class="section" id="sect-Synchronous_Encryption"><div class="titlepage"><div><div><h2 class="title">A.1.&nbsp;Synchronous Encryption</h2></div></div></div><div class="section" id="sect-AES"><div class="titlepage"><div><div><h3 class="title">A.1.1.&nbsp;Advanced Encryption Standard - AES</h3></div></div></div><div class="para">
				In cryptography, the Advanced Encryption Standard (AES) is an 
encryption standard adopted by the U.S. Government. The standard 
comprises three block ciphers, AES-128, AES-192 and AES-256, adopted 
from a larger collection originally published as Rijndael. Each AES 
cipher has a 128-bit block size, with key sizes of 128, 192 and 256 
bits, respectively. The AES ciphers have been analyzed extensively and 
are now used worldwide, as was the case with its predecessor, the Data 
Encryption Standard (DES).<a href="#ftn.idm140226882433696" class="footnote"><sup class="footnote" id="idm140226882433696">[5]</sup></a>
			</div><div class="section" id="sect-AES_History"><div class="titlepage"><div><div><h4 class="title">A.1.1.1.&nbsp;AES History</h4></div></div></div><div class="para">
					AES was announced by National Institute of Standards and Technology
 (NIST) as U.S. FIPS PUB 197 (FIPS 197) on November 26, 2001 after a 
5-year standardization process. Fifteen competing designs were presented
 and evaluated before Rijndael was selected as the most suitable. It 
became effective as a standard May 26, 2002. It is available in many 
different encryption packages. AES is the first publicly accessible and 
open cipher approved by the NSA for top secret information.
				</div><div class="para">
					The Rijndael cipher was developed by two Belgian cryptographers, 
Joan Daemen and Vincent Rijmen, and submitted by them to the AES 
selection process. Rijndael is a portmanteau of the names of the two 
inventors.<a href="#ftn.idm140226875907552" class="footnote"><sup class="footnote" id="idm140226875907552">[6]</sup></a>
				</div></div></div><div class="section" id="sect-DES"><div class="titlepage"><div><div><h3 class="title">A.1.2.&nbsp;Data Encryption Standard - DES</h3></div></div></div><div class="para">
				The Data Encryption Standard (DES) is a block cipher (a form of 
shared secret encryption) that was selected by the National Bureau of 
Standards as an official Federal Information Processing Standard (FIPS) 
for the United States in 1976 and which has subsequently enjoyed 
widespread use internationally. It is based on a symmetric-key algorithm
 that uses a 56-bit key. The algorithm was initially controversial with 
classified design elements, a relatively short key length, and 
suspicions about a National Security Agency (NSA) backdoor. DES 
consequently came under intense academic scrutiny which motivated the 
modern understanding of block ciphers and their cryptanalysis.<a href="#ftn.idm140226878574032" class="footnote"><sup class="footnote" id="idm140226878574032">[7]</sup></a>
			</div><div class="section" id="sect-DES_History"><div class="titlepage"><div><div><h4 class="title">A.1.2.1.&nbsp;DES History</h4></div></div></div><div class="para">
					DES is now considered to be insecure for many applications. This is
 chiefly due to the 56-bit key size being too small; in January, 1999, 
distributed.net and the Electronic Frontier Foundation collaborated to 
publicly break a DES key in 22 hours and 15 minutes. There are also some
 analytical results which demonstrate theoretical weaknesses in the 
cipher, although they are unfeasible to mount in practice. The algorithm
 is believed to be practically secure in the form of Triple DES, 
although there are theoretical attacks. In recent years, the cipher has 
been superseded by the Advanced Encryption Standard (AES).<a href="#ftn.idm140226879164592" class="footnote"><sup class="footnote" id="idm140226879164592">[8]</sup></a>
				</div><div class="para">
					In some documentation, a distinction is made between DES as a 
standard and DES the algorithm which is referred to as the DEA (the Data
 Encryption Algorithm).<a href="#ftn.idm140226879161952" class="footnote"><sup class="footnote" id="idm140226879161952">[9]</sup></a>
				</div></div></div></div><div class="section" id="sect-PK_Encryption"><div class="titlepage"><div><div><h2 class="title">A.2.&nbsp;Public-key Encryption</h2></div></div></div><div class="para">
			Public-key cryptography is a cryptographic approach, employed by many
 cryptographic algorithms and cryptosystems, whose distinguishing 
characteristic is the use of asymmetric key algorithms instead of or in 
addition to symmetric key algorithms. Using the techniques of public 
key-private key cryptography, many methods of protecting communications 
or authenticating messages formerly unknown have become practical. They 
do not require a secure initial exchange of one or more secret keys as 
is required when using symmetric key algorithms. It can also be used to 
create digital signatures.<a href="#ftn.idm140226881406976" class="footnote"><sup class="footnote" id="idm140226881406976">[10]</sup></a>
		</div><div class="para">
			Public key cryptography is a fundamental and widely used technology 
around the world, and is the approach which underlies such Internet 
standards as Transport Layer Security (TLS) (successor to SSL), PGP and 
GPG.<a href="#ftn.idm140226881404272" class="footnote"><sup class="footnote" id="idm140226881404272">[11]</sup></a>
		</div><div class="para">
			The distinguishing technique used in public key cryptography is the 
use of asymmetric key algorithms, where the key used to encrypt a 
message is not the same as the key used to decrypt it. Each user has a 
pair of cryptographic keys — a public key and a private key. The private
 key is kept secret, whilst the public key may be widely distributed. 
Messages are encrypted with the recipient's public key and can only be 
decrypted with the corresponding private key. The keys are related 
mathematically, but the private key cannot be feasibly (ie, in actual or
 projected practice) derived from the public key. It was the discovery 
of such algorithms which revolutionized the practice of cryptography 
beginning in the middle 1970s.<a href="#ftn.idm140226871284736" class="footnote"><sup class="footnote" id="idm140226871284736">[12]</sup></a>
		</div><div class="para">
			In contrast, Symmetric-key algorithms, variations of which have been 
used for some thousands of years, use a single secret key shared by 
sender and receiver (which must also be kept private, thus accounting 
for the ambiguity of the common terminology) for both encryption and 
decryption. To use a symmetric encryption scheme, the sender and 
receiver must securely share a key in advance.<a href="#ftn.idm140226871282272" class="footnote"><sup class="footnote" id="idm140226871282272">[13]</sup></a>
		</div><div class="para">
			Because symmetric key algorithms are nearly always much less 
computationally intensive, it is common to exchange a key using a 
key-exchange algorithm and transmit data using that key and a symmetric 
key algorithm. PGP, and the SSL/TLS family of schemes do this, for 
instance, and are called hybrid cryptosystems in consequence.<a href="#ftn.idm140226871279808" class="footnote"><sup class="footnote" id="idm140226871279808">[14]</sup></a>
		</div><div class="section" id="sect-Diffie-Hellman"><div class="titlepage"><div><div><h3 class="title">A.2.1.&nbsp;Diffie-Hellman</h3></div></div></div><div class="para">
				Diffie–Hellman key exchange (D–H) is a cryptographic protocol that 
allows two parties that have no prior knowledge of each other to jointly
 establish a shared secret key over an insecure communications channel. 
This key can then be used to encrypt subsequent communications using a 
symmetric key cipher.<a href="#ftn.idm140226878268176" class="footnote"><sup class="footnote" id="idm140226878268176">[15]</sup></a>
			</div><div class="section" id="sect-Diffie-Hellman_History"><div class="titlepage"><div><div><h4 class="title">A.2.1.1.&nbsp;Diffie-Hellman History</h4></div></div></div><div class="para">
					The scheme was first published by Whitfield Diffie and Martin 
Hellman in 1976, although it later emerged that it had been separately 
invented a few years earlier within GCHQ, the British signals 
intelligence agency, by Malcolm J. Williamson but was kept classified. 
In 2002, Hellman suggested the algorithm be called Diffie–Hellman–Merkle
 key exchange in recognition of Ralph Merkle's contribution to the 
invention of public-key cryptography (Hellman, 2002).<a href="#ftn.idm140226878264080" class="footnote"><sup class="footnote" id="idm140226878264080">[16]</sup></a>
				</div><div class="para">
					Although Diffie–Hellman key agreement itself is an anonymous 
(non-authenticated) key-agreement protocol, it provides the basis for a 
variety of authenticated protocols, and is used to provide perfect 
forward secrecy in Transport Layer Security's ephemeral modes (referred 
to as EDH or DHE depending on the cipher suite).<a href="#ftn.idm140226864153872" class="footnote"><sup class="footnote" id="idm140226864153872">[17]</sup></a>
				</div><div class="para">
					U.S. Patent 4,200,770, now expired, describes the algorithm and credits Hellman, Diffie, and Merkle as inventors.<a href="#ftn.idm140226864151280" class="footnote"><sup class="footnote" id="idm140226864151280">[18]</sup></a>
				</div></div></div><div class="section" id="sect-RSA"><div class="titlepage"><div><div><h3 class="title">A.2.2.&nbsp;RSA</h3></div></div></div><div class="para">
				In cryptography, RSA (which stands for Rivest, Shamir and Adleman 
who first publicly described it) is an algorithm for public-key 
cryptography. It is the first algorithm known to be suitable for signing
 as well as encryption, and was one of the first great advances in 
public key cryptography. RSA is widely used in electronic commerce 
protocols, and is believed to be secure given sufficiently long keys and
 the use of up-to-date implementations.
			</div></div><div class="section" id="sect-DSA"><div class="titlepage"><div><div><h3 class="title">A.2.3.&nbsp;DSA</h3></div></div></div><div class="para">
				DSA (Digital Signature Algorithm) is a standard for digital 
signatures, a United States federal government standard for digital 
signatures. DSA is for signatures only and is not an encryption 
algorithm. <a href="#ftn.idm140226879624816" class="footnote"><sup class="footnote" id="idm140226879624816">[19]</sup></a>
			</div></div><div class="section" id="sect-SSL_TLS"><div class="titlepage"><div><div><h3 class="title">A.2.4.&nbsp;SSL/TLS</h3></div></div></div><div class="para">
				Transport Layer Security (TLS) and its predecessor, Secure Sockets 
Layer (SSL), are cryptographic protocols that provide security for 
communications over networks such as the Internet. TLS and SSL encrypt 
the segments of network connections at the Transport Layer end-to-end.
			</div><div class="para">
				Several versions of the protocols are in widespread use in 
applications like web browsing, electronic mail, Internet faxing, 
instant messaging and voice-over-IP (VoIP).<a href="#ftn.idm140226880149312" class="footnote"><sup class="footnote" id="idm140226880149312">[20]</sup></a>
			</div></div><div class="section" id="sect-Cramer-Shoup_Cryptosystem"><div class="titlepage"><div><div><h3 class="title">A.2.5.&nbsp;Cramer-Shoup Cryptosystem</h3></div></div></div><div class="para">
				The Cramer–Shoup system is an asymmetric key encryption algorithm, 
and was the first efficient scheme proven to be secure against adaptive 
chosen ciphertext attack using standard cryptographic assumptions. Its 
security is based on the computational intractability (widely assumed, 
but not proved) of the decisional Diffie–Hellman assumption. Developed 
by Ronald Cramer and Victor Shoup in 1998, it is an extension of the 
ElGamal cryptosystem. In contrast to ElGamal, which is extremely 
malleable, Cramer–Shoup adds additional elements to ensure 
non-malleability even against a resourceful attacker. This 
non-malleability is achieved through the use of a collision-resistant 
hash function and additional computations, resulting in a ciphertext 
which is twice as large as in ElGamal.<a href="#ftn.idm140226881853456" class="footnote"><sup class="footnote" id="idm140226881853456">[21]</sup></a>
			</div></div><div class="section" id="sect-ElGamal-Encryption"><div class="titlepage"><div><div><h3 class="title">A.2.6.&nbsp;ElGamal Encryption</h3></div></div></div><div class="para">
				In cryptography, the ElGamal encryption system is an asymmetric key 
encryption algorithm for public-key cryptography which is based on the 
Diffie-Hellman key agreement. It was described by Taher Elgamal in 1985.
 ElGamal encryption is used in the free GNU Privacy Guard software, 
recent versions of PGP, and other cryptosystems.<a href="#ftn.idm140226881849232" class="footnote"><sup class="footnote" id="idm140226881849232">[22]</sup></a>
			</div></div></div><div class="footnotes"><br><hr align="left" width="100"><div id="ftn.idm140226882433696" class="footnote"><div class="para"><a href="#idm140226882433696" class="para"><sup class="para">[5] </sup></a>
					"Advanced Encryption Standard." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">http://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a>
				</div></div><div id="ftn.idm140226875907552" class="footnote"><div class="para"><a href="#idm140226875907552" class="para"><sup class="para">[6] </sup></a>
						"Advanced Encryption Standard." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">http://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a>
					</div></div><div id="ftn.idm140226878574032" class="footnote"><div class="para"><a href="#idm140226878574032" class="para"><sup class="para">[7] </sup></a>
					"Data Encryption Standard." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Data_Encryption_Standard">http://en.wikipedia.org/wiki/Data_Encryption_Standard</a>
				</div></div><div id="ftn.idm140226879164592" class="footnote"><div class="para"><a href="#idm140226879164592" class="para"><sup class="para">[8] </sup></a>
						"Data Encryption Standard." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Data_Encryption_Standard">http://en.wikipedia.org/wiki/Data_Encryption_Standard</a>
					</div></div><div id="ftn.idm140226879161952" class="footnote"><div class="para"><a href="#idm140226879161952" class="para"><sup class="para">[9] </sup></a>
						"Data Encryption Standard." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Data_Encryption_Standard">http://en.wikipedia.org/wiki/Data_Encryption_Standard</a>
					</div></div><div id="ftn.idm140226881406976" class="footnote"><div class="para"><a href="#idm140226881406976" class="para"><sup class="para">[10] </sup></a>
				"Public-key Encryption." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">http://en.wikipedia.org/wiki/Public-key_cryptography</a>
			</div></div><div id="ftn.idm140226881404272" class="footnote"><div class="para"><a href="#idm140226881404272" class="para"><sup class="para">[11] </sup></a>
				"Public-key Encryption." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">http://en.wikipedia.org/wiki/Public-key_cryptography</a>
			</div></div><div id="ftn.idm140226871284736" class="footnote"><div class="para"><a href="#idm140226871284736" class="para"><sup class="para">[12] </sup></a>
				"Public-key Encryption." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">http://en.wikipedia.org/wiki/Public-key_cryptography</a>
			</div></div><div id="ftn.idm140226871282272" class="footnote"><div class="para"><a href="#idm140226871282272" class="para"><sup class="para">[13] </sup></a>
				"Public-key Encryption." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">http://en.wikipedia.org/wiki/Public-key_cryptography</a>
			</div></div><div id="ftn.idm140226871279808" class="footnote"><div class="para"><a href="#idm140226871279808" class="para"><sup class="para">[14] </sup></a>
				"Public-key Encryption." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Public-key_cryptography">http://en.wikipedia.org/wiki/Public-key_cryptography</a>
			</div></div><div id="ftn.idm140226878268176" class="footnote"><div class="para"><a href="#idm140226878268176" class="para"><sup class="para">[15] </sup></a>
					"Diffie-Hellman." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Diffie-Hellman">http://en.wikipedia.org/wiki/Diffie-Hellman</a>
				</div></div><div id="ftn.idm140226878264080" class="footnote"><div class="para"><a href="#idm140226878264080" class="para"><sup class="para">[16] </sup></a>
						"Diffie-Hellman." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Diffie-Hellman">http://en.wikipedia.org/wiki/Diffie-Hellman</a>
					</div></div><div id="ftn.idm140226864153872" class="footnote"><div class="para"><a href="#idm140226864153872" class="para"><sup class="para">[17] </sup></a>
						"Diffie-Hellman." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Diffie-Hellman">http://en.wikipedia.org/wiki/Diffie-Hellman</a>
					</div></div><div id="ftn.idm140226864151280" class="footnote"><div class="para"><a href="#idm140226864151280" class="para"><sup class="para">[18] </sup></a>
						"Diffie-Hellman." <span class="emphasis"><em>Wikipedia.</em></span> 14 November 2009 <a href="http://en.wikipedia.org/wiki/Diffie-Hellman">http://en.wikipedia.org/wiki/Diffie-Hellman</a>
					</div></div><div id="ftn.idm140226879624816" class="footnote"><div class="para"><a href="#idm140226879624816" class="para"><sup class="para">[19] </sup></a>
					"DSA." <span class="emphasis"><em>Wikipedia.</em></span> 24 February 2010 <a href="http://en.wikipedia.org/wiki/Digital_Signature_Algorithm">http://en.wikipedia.org/wiki/Digital_Signature_Algorithm</a>
				</div></div><div id="ftn.idm140226880149312" class="footnote"><div class="para"><a href="#idm140226880149312" class="para"><sup class="para">[20] </sup></a>
					"TLS/SSL." <span class="emphasis"><em>Wikipedia.</em></span> 24 February 2010 <a href="http://en.wikipedia.org/wiki/Transport_Layer_Security">http://en.wikipedia.org/wiki/Transport_Layer_Security</a>
				</div></div><div id="ftn.idm140226881853456" class="footnote"><div class="para"><a href="#idm140226881853456" class="para"><sup class="para">[21] </sup></a>
					"Cramer-Shoup cryptosystem." <span class="emphasis"><em>Wikipedia.</em></span> 24 February 2010 <a href="http://en.wikipedia.org/wiki/Cramer%E2%80%93Shoup_cryptosystem">http://en.wikipedia.org/wiki/Cramer–Shoup_cryptosystem</a>
				</div></div><div id="ftn.idm140226881849232" class="footnote"><div class="para"><a href="#idm140226881849232" class="para"><sup class="para">[22] </sup></a>
					"ElGamal encryption" <span class="emphasis"><em>Wikipedia.</em></span> 24 February 2010 <a href="http://en.wikipedia.org/wiki/ElGamal_encryption">http://en.wikipedia.org/wiki/ElGamal_encryption</a>
				</div></div></div></div><div xml:lang="en-US" class="appendix" id="app-Audit_Reference" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Appendix&nbsp;B.&nbsp;Audit System Reference</h1></div></div></div><div class="section" id="sec-Audit_Events_Fields"><div class="titlepage"><div><div><h2 class="title">B.1.&nbsp;Audit Event Fields</h2></div></div></div><div class="para">
			<a class="xref" href="#table-event_fields">Table&nbsp;B.1, “Event Fields”</a> lists all currently-supported Audit event fields. An event field is the value preceding the equal sign in the Audit log files.
		</div><div class="table" id="table-event_fields"><p class="title"><strong>Table&nbsp;B.1.&nbsp;Event Fields</strong></p><div class="table-contents"><table class="lt-4-cols gt-14-rows" summary="Event Fields"><colgroup><col class="Event_Field" width="29%"><!--Empty--><col class="Explanation" width="71%"><!--Empty--></colgroup><thead><tr><th id="idm140226862763536" scope="col"> Event Field </th><th id="idm140226880367296" scope="col"> Explanation </th></tr></thead><tbody><tr><td headers="idm140226862763536"><code class="literal">a0</code>, <code class="literal">a1</code>, <code class="literal">a2</code>, <code class="literal">a3</code></td><td headers="idm140226880367296">Records the first four arguments of the system call, encoded in hexadecimal notation.</td></tr><tr><td headers="idm140226862763536"><code class="literal">acct</code></td><td headers="idm140226880367296">Records a user's account name.</td></tr><tr><td headers="idm140226862763536"><code class="literal">addr</code></td><td headers="idm140226880367296">Records the IPv4 or IPv6 address. This field usually follows a <code class="varname">hostname</code> field and contains the address the host name resolves to. </td></tr><tr><td headers="idm140226862763536"><code class="literal">arch</code></td><td headers="idm140226880367296">Records information about the CPU architecture of the system, encoded in hexadecimal notation.</td></tr><tr><td headers="idm140226862763536"><code class="literal">auid</code></td><td headers="idm140226880367296">Records
 the Audit user ID. This ID is assigned to a user upon login and is 
inherited by every process even when the user's identity changes (for 
example, by switching user accounts with <code class="command">su - john</code>).</td></tr><tr><td headers="idm140226862763536"><code class="literal">capability</code></td><td headers="idm140226880367296">Records
 the number of bits that were used to set a particular Linux capability.
 For more information on Linux capabilities, see the <span class="citerefentry"><span class="refentrytitle">capabilities</span>(7)</span> man page.</td></tr><tr><td headers="idm140226862763536"><code class="literal">cap_fi</code></td><td headers="idm140226880367296">Records data related to the setting of an inherited file system-based capability.</td></tr><tr><td headers="idm140226862763536"><code class="literal">cap_fp</code></td><td headers="idm140226880367296">Records data related to the setting of a permitted file system-based capability.</td></tr><tr><td headers="idm140226862763536"><code class="literal">cap_pe</code></td><td headers="idm140226880367296">Records data related to the setting of an effective process-based capability.</td></tr><tr><td headers="idm140226862763536"><code class="literal">cap_pi</code></td><td headers="idm140226880367296">Records data related to the setting of an inherited process-based capability.</td></tr><tr><td headers="idm140226862763536"><code class="literal">cap_pp</code></td><td headers="idm140226880367296">Records data related to the setting of a permitted process-based capability.</td></tr><tr><td headers="idm140226862763536"><code class="literal">cgroup</code></td><td headers="idm140226880367296">Records the path to the <code class="command">cgroup</code> that contains the process at the time the Audit event was generated.</td></tr><tr><td headers="idm140226862763536"><code class="literal">cmd</code></td><td headers="idm140226880367296">Records the entire command line that is executed. This is useful in case of shell interpreters where the <code class="literal">exe</code> field records, for example, <code class="literal">/bin/bash</code> as the shell interpreter and the <code class="literal">cmd</code> field records the rest of the command line that is executed, for example <code class="literal">helloworld.sh --help</code>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">comm</code></td><td headers="idm140226880367296">Records the command that is executed. This is useful in case of shell interpreters where the <code class="literal">exe</code> field records, for example, <code class="literal">/bin/bash</code> as the shell interpreter and the <code class="literal">comm</code> field records the name of the script that is executed, for example <code class="literal">helloworld.sh</code>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">cwd</code></td><td headers="idm140226880367296">Records the path to the directory in which a system call was invoked.</td></tr><tr><td headers="idm140226862763536"><code class="literal">data</code></td><td headers="idm140226880367296">Records data associated with TTY records.</td></tr><tr><td headers="idm140226862763536"><code class="literal">dev</code></td><td headers="idm140226880367296">Records the minor and major ID of the device that contains the file or directory recorded in an event.</td></tr><tr><td headers="idm140226862763536"><code class="literal">devmajor</code></td><td headers="idm140226880367296">Records the major device ID.</td></tr><tr><td headers="idm140226862763536"><code class="literal">devminor</code></td><td headers="idm140226880367296">Records the minor device ID.</td></tr><tr><td headers="idm140226862763536"><code class="literal">egid</code></td><td headers="idm140226880367296">Records the effective group ID of the user who started the analyzed process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">euid</code></td><td headers="idm140226880367296">Records the effective user ID of the user who started the analyzed process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">exe</code></td><td headers="idm140226880367296">Records the path to the executable that was used to invoke the analyzed process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">exit</code></td><td headers="idm140226880367296">Records
 the exit code returned by a system call. This value varies by system 
call. You can interpret the value to its human-readable equivalent with 
the following command: <code class="command">ausearch --interpret --exit <em class="replaceable">exit_code</em></code></td></tr><tr><td headers="idm140226862763536"><code class="literal">family</code></td><td headers="idm140226880367296">Records the type of address protocol that was used, either IPv4 or IPv6.</td></tr><tr><td headers="idm140226862763536"><code class="literal">filetype</code></td><td headers="idm140226880367296">Records the type of the file.</td></tr><tr><td headers="idm140226862763536"><code class="literal">flags</code></td><td headers="idm140226880367296">Records the file system name flags.</td></tr><tr><td headers="idm140226862763536"><code class="literal">fsgid</code></td><td headers="idm140226880367296">Records the file system group ID of the user who started the analyzed process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">fsuid</code></td><td headers="idm140226880367296">Records the file system user ID of the user who started the analyzed process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">gid</code></td><td headers="idm140226880367296">Records the group ID.</td></tr><tr><td headers="idm140226862763536"><code class="literal">hostname</code></td><td headers="idm140226880367296">Records the host name.</td></tr><tr><td headers="idm140226862763536"><code class="literal">icmptype</code></td><td headers="idm140226880367296">
 Records the type of a Internet Control Message Protocol (ICMP) package 
that is received. Audit messages containing this field are usually 
generated by <span class="application"><strong>iptables</strong></span>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">id</code></td><td headers="idm140226880367296">Records the user ID of an account that was changed.</td></tr><tr><td headers="idm140226862763536"><code class="literal">inode</code></td><td headers="idm140226880367296">Records the inode number associated with the file or directory recorded in an Audit event.</td></tr><tr><td headers="idm140226862763536"><code class="literal">inode_gid</code></td><td headers="idm140226880367296">Records the group ID of the inode's owner.</td></tr><tr><td headers="idm140226862763536"><code class="literal">inode_uid</code></td><td headers="idm140226880367296">Records the user ID of the inode's owner.</td></tr><tr><td headers="idm140226862763536"><code class="literal">items</code></td><td headers="idm140226880367296">Records the number of path records that are attached to this record.</td></tr><tr><td headers="idm140226862763536"><code class="literal">key</code></td><td headers="idm140226880367296">Records the user defined string associated with a rule that generated a particular event in the Audit log.</td></tr><tr><td headers="idm140226862763536"><code class="literal">list</code></td><td headers="idm140226880367296">Records the Audit rule list ID. The following is a list of known IDs: 
						<div class="itemizedlist"><ul><li class="listitem"><div class="para">
									0 — <code class="literal">user</code>
								</div></li><li class="listitem"><div class="para">
									1 — <code class="literal">task</code>
								</div></li><li class="listitem"><div class="para">
									4 — <code class="literal">exit</code>
								</div></li><li class="listitem"><div class="para">
									5 — <code class="literal">exclude</code>
								</div></li></ul></div>
						 </td></tr><tr><td headers="idm140226862763536"><code class="literal">mode</code></td><td headers="idm140226880367296">Records the file or directory permissions, encoded in numerical notation.</td></tr><tr><td headers="idm140226862763536"><code class="literal">msg</code></td><td headers="idm140226880367296">Records a time stamp and a unique ID of a record, or various event-specific <code class="literal"><em class="replaceable">&lt;name&gt;</em>=<em class="replaceable">&lt;value&gt;</em></code> pairs provided by the kernel or user space applications.</td></tr><tr><td headers="idm140226862763536"><code class="literal">msgtype</code></td><td headers="idm140226880367296">Records the message type that is returned in case of a user-based AVC denial. The message type is determined by D-Bus.</td></tr><tr><td headers="idm140226862763536"><code class="literal">name</code></td><td headers="idm140226880367296">Records the full path of the file or directory that was passed to the system call as an argument.</td></tr><tr><td headers="idm140226862763536"><code class="literal">new-disk</code></td><td headers="idm140226880367296">Records the name of a new disk resource that is assigned to a virtual machine.</td></tr><tr><td headers="idm140226862763536"><code class="literal">new-mem</code></td><td headers="idm140226880367296">Records the amount of a new memory resource that is assigned to a virtual machine.</td></tr><tr><td headers="idm140226862763536"><code class="literal">new-vcpu</code></td><td headers="idm140226880367296">Records the number of a new virtual CPU resource that is assigned to a virtual machine.</td></tr><tr><td headers="idm140226862763536"><code class="literal">new-net</code></td><td headers="idm140226880367296">Records the MAC address of a new network interface resource that is assigned to a virtual machine.</td></tr><tr><td headers="idm140226862763536"><code class="literal">new_gid</code></td><td headers="idm140226880367296">Records a group ID that is assigned to a user.</td></tr><tr><td headers="idm140226862763536"><code class="literal">oauid</code></td><td headers="idm140226880367296"> Records the user ID of the user that has logged in to access the system (as opposed to, for example, using <code class="command">su</code>) and has started the target process. This field is exclusive to the record of type <code class="constant">OBJ_PID</code>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">ocomm</code></td><td headers="idm140226880367296">Records the command that was used to start the target process.This field is exclusive to the record of type <code class="constant">OBJ_PID</code>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">opid</code></td><td headers="idm140226880367296">Records the process ID of the target process. This field is exclusive to the record of type <code class="constant">OBJ_PID</code>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">oses</code></td><td headers="idm140226880367296">Records the session ID of the target process. This field is exclusive to the record of type <code class="constant">OBJ_PID</code>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">ouid</code></td><td headers="idm140226880367296">Records the real user ID of the target process</td></tr><tr><td headers="idm140226862763536"><code class="literal">obj</code></td><td headers="idm140226880367296">Records
 the SELinux context of an object. An object can be a file, a directory,
 a socket, or anything that is receiving the action of a subject.</td></tr><tr><td headers="idm140226862763536"><code class="literal">obj_gid</code></td><td headers="idm140226880367296">Records the group ID of an object.</td></tr><tr><td headers="idm140226862763536"><code class="literal">obj_lev_high</code></td><td headers="idm140226880367296">Records the high SELinux level of an object.</td></tr><tr><td headers="idm140226862763536"><code class="literal">obj_lev_low</code></td><td headers="idm140226880367296">Records the low SELinux level of an object.</td></tr><tr><td headers="idm140226862763536"><code class="literal">obj_role</code></td><td headers="idm140226880367296">Records the SELinux role of an object.</td></tr><tr><td headers="idm140226862763536"><code class="literal">obj_uid</code></td><td headers="idm140226880367296">Records the UID of an object</td></tr><tr><td headers="idm140226862763536"><code class="literal">obj_user</code></td><td headers="idm140226880367296">Records the user that is associated with an object.</td></tr><tr><td headers="idm140226862763536"><code class="literal">ogid</code></td><td headers="idm140226880367296">Records the object owner's group ID.</td></tr><tr><td headers="idm140226862763536"><code class="literal">old-disk</code></td><td headers="idm140226880367296">Records the name of an old disk resource when a new disk resource is assigned to a virtual machine.</td></tr><tr><td headers="idm140226862763536"><code class="literal">old-mem</code></td><td headers="idm140226880367296">Records the amount of an old memory resource when a new amount of memory is assigned to a virtual machine.</td></tr><tr><td headers="idm140226862763536"><code class="literal">old-vcpu</code></td><td headers="idm140226880367296">Records the number of an old virtual CPU resource when a new virtual CPU is assigned to a virtual machine.</td></tr><tr><td headers="idm140226862763536"><code class="literal">old-net</code></td><td headers="idm140226880367296">Records the MAC address of an old network interface resource when a new network interface is assigned to a virtual machine.</td></tr><tr><td headers="idm140226862763536"><code class="literal">old_prom</code></td><td headers="idm140226880367296">Records the previous value of the network promiscuity flag.</td></tr><tr><td headers="idm140226862763536"><code class="literal">ouid</code></td><td headers="idm140226880367296">Records the real user ID of the user who started the target process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">path</code></td><td headers="idm140226880367296">Records
 the full path of the file or directory that was passed to the system 
call as an argument in case of AVC-related Audit events</td></tr><tr><td headers="idm140226862763536"><code class="literal">perm</code></td><td headers="idm140226880367296">Records the file permission that was used to generate an event (that is, read, write, execute, or attribute change)</td></tr><tr><td headers="idm140226862763536"><code class="literal">pid</code></td><td headers="idm140226880367296"> <div class="para">
							The <code class="varname">pid</code> field semantics depend on the origin of the value in this field.
						</div>
						 <div class="para">
							In fields generated from user-space, this field holds a process ID.
						</div>
						 <div class="para">
							In fields generated by the kernel, this field holds a thread ID. 
The thread ID is equal to process ID for single-threaded processes. Note
 that the value of this thread ID is different from the values of <span class="type">pthread_t</span> IDs used in user-space. For more information, see the <span class="citerefentry"><span class="refentrytitle">gettid</span>(2)</span> man page.
						</div>
						 </td></tr><tr><td headers="idm140226862763536"><code class="literal">ppid</code></td><td headers="idm140226880367296">Records the Parent Process ID (PID).</td></tr><tr><td headers="idm140226862763536"><code class="literal">prom</code></td><td headers="idm140226880367296">Records the network promiscuity flag.</td></tr><tr><td headers="idm140226862763536"><code class="literal">proto</code></td><td headers="idm140226880367296">Records the networking protocol that was used. This field is specific to Audit events generated by <span class="application"><strong>iptables</strong></span>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">res</code></td><td headers="idm140226880367296">Records the result of the operation that triggered the Audit event.</td></tr><tr><td headers="idm140226862763536"><code class="literal">result</code></td><td headers="idm140226880367296">Records the result of the operation that triggered the Audit event.</td></tr><tr><td headers="idm140226862763536"><code class="literal">saddr</code></td><td headers="idm140226880367296">Records the socket address.</td></tr><tr><td headers="idm140226862763536"><code class="literal">sauid</code></td><td headers="idm140226880367296">Records
 the sender Audit login user ID. This ID is provided by D-Bus as the 
kernel is unable to see which user is sending the original <code class="command">auid</code>.</td></tr><tr><td headers="idm140226862763536"><code class="literal">ses</code></td><td headers="idm140226880367296">Records the session ID of the session from which the analyzed process was invoked.</td></tr><tr><td headers="idm140226862763536"><code class="literal">sgid</code></td><td headers="idm140226880367296">Records the set group ID of the user who started the analyzed process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">sig</code></td><td headers="idm140226880367296">Records the number of a signal that causes a program to end abnormally. Usually, this is a sign of a system intrusion.</td></tr><tr><td headers="idm140226862763536"><code class="literal">subj</code></td><td headers="idm140226880367296">Records the SELinux context of a subject. A subject can be a process, a user, or anything that is acting upon an object.</td></tr><tr><td headers="idm140226862763536"><code class="literal">subj_clr</code></td><td headers="idm140226880367296">Records the SELinux clearance of a subject.</td></tr><tr><td headers="idm140226862763536"><code class="literal">subj_role</code></td><td headers="idm140226880367296">Records the SELinux role of a subject.</td></tr><tr><td headers="idm140226862763536"><code class="literal">subj_sen</code></td><td headers="idm140226880367296">Records the SELinux sensitivity of a subject.</td></tr><tr><td headers="idm140226862763536"><code class="literal">subj_user</code></td><td headers="idm140226880367296">Records the user that is associated with a subject.</td></tr><tr><td headers="idm140226862763536"><code class="literal">success</code></td><td headers="idm140226880367296">Records whether a system call was successful or failed.</td></tr><tr><td headers="idm140226862763536"><code class="literal">suid</code></td><td headers="idm140226880367296">Records the set user ID of the user who started the analyzed process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">syscall</code></td><td headers="idm140226880367296">Records the type of the system call that was sent to the kernel.</td></tr><tr><td headers="idm140226862763536"><code class="literal">terminal</code></td><td headers="idm140226880367296">Records the terminal name (without <code class="filename">/dev/</code>).</td></tr><tr><td headers="idm140226862763536"><code class="literal">tty</code></td><td headers="idm140226880367296">Records the name of the controlling terminal. The value <code class="literal">(none)</code> is used if the process has no controlling terminal.</td></tr><tr><td headers="idm140226862763536"><code class="literal">uid</code></td><td headers="idm140226880367296">Records the real user ID of the user who started the analyzed process.</td></tr><tr><td headers="idm140226862763536"><code class="literal">vm</code></td><td headers="idm140226880367296">Records the name of a virtual machine from which the Audit event originated.</td></tr></tbody></table></div></div></div><div class="section" id="sec-Audit_Record_Types"><div class="titlepage"><div><div><h2 class="title">B.2.&nbsp;Audit Record Types</h2></div></div></div><div class="para">
			<a class="xref" href="#table-record_types">Table&nbsp;B.2, “Record Types”</a> lists all currently-supported types of Audit records. The event type is specified in the <code class="literal">type=</code> field at the beginning of every Audit record.
		</div><div class="table" id="table-record_types"><p class="title"><strong>Table&nbsp;B.2.&nbsp;Record Types</strong></p><div class="table-contents"><table class="lt-4-cols gt-14-rows" summary="Record Types"><colgroup><col class="Event_Type" width="29%"><!--Empty--><col class="Explanation" width="71%"><!--Empty--></colgroup><thead><tr><th id="idm140226862669280" scope="col"> Event Type </th><th id="idm140226862668800" scope="col"> Explanation </th></tr></thead><tbody><tr><td headers="idm140226862669280"><code class="literal">ADD_GROUP</code></td><td headers="idm140226862668800">Triggered when a user-space group is added.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ADD_USER</code></td><td headers="idm140226862668800">Triggered when a user-space user account is added.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_ABEND</code><a href="#ftn.footnote-ANOM" class="footnote"><sup class="footnote" id="footnote-ANOM">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a processes ends abnormally (with a signal that could cause a core dump, if enabled).</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_ACCESS_FS</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a file or a directory access ends abnormally.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_ADD_ACCT</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a user-space account addition ends abnormally.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_AMTU_FAIL</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a failure of the Abstract Machine Test Utility (AMTU) is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_CRYPTO_FAIL</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a failure in the cryptographic system is detected. </td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_DEL_ACCT</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a user-space account deletion ends abnormally.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_EXEC</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when an execution of a file ends abnormally.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_LOGIN_ACCT</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when an account login attempt ends abnormally.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_LOGIN_FAILURES</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when the limit of failed login attempts is reached.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_LOGIN_LOCATION</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a login attempt is made from a forbidden location.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_LOGIN_SESSIONS</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a login attempt reaches the maximum amount of concurrent sessions.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_LOGIN_TIME</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a login attempt is made at a time when it is prevented by, for example, <code class="systemitem">pam_time</code>.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_MAX_DAC</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when the maximum amount of Discretionary Access Control (DAC) failures is reached.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_MAX_MAC</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when the maximum amount of Mandatory Access Control (MAC) failures is reached.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_MK_EXEC</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a file is made executable.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_MOD_ACCT</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a user-space account modification ends abnormally.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_PROMISCUOUS</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a device enables or disables promiscuous mode.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_RBAC_FAIL</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a Role-Based Access Control (RBAC) self-test failure is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_RBAC_INTEGRITY_FAIL</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a Role-Based Access Control (RBAC) file integrity test failure is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ANOM_ROOT_TRANS</code><a href="#ftn.footnote-ANOM" class="footnoteref"><sup class="footnoteref">[a]</sup></a></td><td headers="idm140226862668800">Triggered when a user becomes root.</td></tr><tr><td headers="idm140226862669280"><code class="literal">AVC</code></td><td headers="idm140226862668800">Triggered to record an SELinux permission check.</td></tr><tr><td headers="idm140226862669280"><code class="literal">AVC_PATH</code></td><td headers="idm140226862668800">Triggered to record the <code class="systemitem">dentry</code> and <code class="systemitem">vfsmount</code> pair when an SELinux permission check occurs.</td></tr><tr><td headers="idm140226862669280"><code class="literal">BPRM_FCAPS</code></td><td headers="idm140226862668800">Triggered when a user executes a program with a file system capability.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CAPSET</code></td><td headers="idm140226862668800">Triggered to record any changes in process-based capabilities.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CHGRP_ID</code></td><td headers="idm140226862668800">Triggered when a user-space group ID is changed.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CHUSER_ID</code></td><td headers="idm140226862668800">Triggered when a user-space user ID is changed.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CONFIG_CHANGE</code></td><td headers="idm140226862668800">Triggered when the Audit system configuration is modified.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRED_ACQ</code></td><td headers="idm140226862668800">Triggered when a user acquires user-space credentials.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRED_DISP</code></td><td headers="idm140226862668800">Triggered when a user disposes of user-space credentials.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRED_REFR</code></td><td headers="idm140226862668800">Triggered when a user refreshes their user-space credentials.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRYPTO_FAILURE_USER</code></td><td headers="idm140226862668800">Triggered when a decrypt, encrypt, or randomize cryptographic operation fails.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRYPTO_KEY_USER</code></td><td headers="idm140226862668800">Triggered to record the cryptographic key identifier used for cryptographic purposes.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRYPTO_LOGIN</code></td><td headers="idm140226862668800">Triggered when a cryptographic officer login attempt is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRYPTO_LOGOUT</code></td><td headers="idm140226862668800">Triggered when a crypto officer logout attempt is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRYPTO_PARAM_CHANGE_USER</code></td><td headers="idm140226862668800">Triggered when a change in a cryptographic parameter is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRYPTO_REPLAY_USER</code></td><td headers="idm140226862668800">Triggered when a replay attack is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRYPTO_SESSION</code></td><td headers="idm140226862668800">Triggered to record parameters set during a TLS session establishment.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CRYPTO_TEST_USER</code></td><td headers="idm140226862668800">Triggered to record cryptographic test results as required by the FIPS-140 standard.</td></tr><tr><td headers="idm140226862669280"><code class="literal">CWD</code></td><td headers="idm140226862668800">Triggered to record the current working directory.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAC_CHECK</code></td><td headers="idm140226862668800">Triggered to record DAC check results.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAEMON_ABORT</code></td><td headers="idm140226862668800">Triggered when a daemon is stopped due to an error.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAEMON_ACCEPT</code></td><td headers="idm140226862668800">Triggered when the <code class="systemitem">auditd</code> daemon accepts a remote connection.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAEMON_CLOSE</code></td><td headers="idm140226862668800">Triggered when the <code class="systemitem">auditd</code> daemon closes a remote connection.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAEMON_CONFIG</code></td><td headers="idm140226862668800">Triggered when a daemon configuration change is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAEMON_END</code></td><td headers="idm140226862668800">Triggered when a daemon is successfully stopped.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAEMON_RESUME</code></td><td headers="idm140226862668800">Triggered when the <code class="systemitem">auditd</code> daemon resumes logging.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAEMON_ROTATE</code></td><td headers="idm140226862668800">Triggered when the <code class="systemitem">auditd</code> daemon rotates the Audit log files.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DAEMON_START</code></td><td headers="idm140226862668800">Triggered when the <code class="systemitem">auditd</code> daemon is started.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DEL_GROUP</code></td><td headers="idm140226862668800">Triggered when a user-space group is deleted</td></tr><tr><td headers="idm140226862669280"><code class="literal">DEL_USER</code></td><td headers="idm140226862668800">Triggered when a user-space user is deleted</td></tr><tr><td headers="idm140226862669280"><code class="literal">DEV_ALLOC</code></td><td headers="idm140226862668800">Triggered when a device is allocated.</td></tr><tr><td headers="idm140226862669280"><code class="literal">DEV_DEALLOC</code></td><td headers="idm140226862668800">Triggered when a device is deallocated.</td></tr><tr><td headers="idm140226862669280"><code class="literal">EOE</code></td><td headers="idm140226862668800">Triggered to record the end of a multi-record event.</td></tr><tr><td headers="idm140226862669280"><code class="literal">EXECVE</code></td><td headers="idm140226862668800">Triggered to record arguments of the <code class="systemitem">execve(2)</code> system call.</td></tr><tr><td headers="idm140226862669280"><code class="literal">FD_PAIR</code></td><td headers="idm140226862668800">Triggered to record the use of the <code class="systemitem">pipe</code> and <code class="systemitem">socketpair</code> system calls.</td></tr><tr><td headers="idm140226862669280"><code class="literal">FS_RELABEL</code></td><td headers="idm140226862668800">Triggered when a file system relabel operation is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">GRP_AUTH</code></td><td headers="idm140226862668800">Triggered when a group password is used to authenticate against a user-space group.</td></tr><tr><td headers="idm140226862669280"><code class="literal">INTEGRITY_DATA</code><a href="#ftn.footnote-INTEGRITY" class="footnote"><sup class="footnote" id="footnote-INTEGRITY">[b]</sup></a></td><td headers="idm140226862668800">Triggered to record a data integrity verification event run by the kernel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">INTEGRITY_HASH</code><a href="#ftn.footnote-INTEGRITY" class="footnoteref"><sup class="footnoteref">[b]</sup></a></td><td headers="idm140226862668800">Triggered to record a hash type integrity verification event run by the kernel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">INTEGRITY_METADATA</code><a href="#ftn.footnote-INTEGRITY" class="footnoteref"><sup class="footnoteref">[b]</sup></a></td><td headers="idm140226862668800">Triggered to record a metadata integrity verification event run by the kernel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">INTEGRITY_PCR</code><a href="#ftn.footnote-INTEGRITY" class="footnoteref"><sup class="footnoteref">[b]</sup></a></td><td headers="idm140226862668800">Triggered to record Platform Configuration Register (PCR) invalidation messages.</td></tr><tr><td headers="idm140226862669280"><code class="literal">INTEGRITY_RULE</code><a href="#ftn.footnote-INTEGRITY" class="footnoteref"><sup class="footnoteref">[b]</sup></a></td><td headers="idm140226862668800">Triggered to record a policy rule.</td></tr><tr><td headers="idm140226862669280"><code class="literal">INTEGRITY_STATUS</code><a href="#ftn.footnote-INTEGRITY" class="footnoteref"><sup class="footnoteref">[b]</sup></a></td><td headers="idm140226862668800">Triggered to record the status of integrity verification.</td></tr><tr><td headers="idm140226862669280"><code class="literal">IPC</code></td><td headers="idm140226862668800">Triggered to record information about a Inter-Process Communication object referenced by a system call.</td></tr><tr><td headers="idm140226862669280"><code class="literal">IPC_SET_PERM</code></td><td headers="idm140226862668800">Triggered to record information about new values set by an <code class="constant">IPC_SET</code> control operation on an IPC object.</td></tr><tr><td headers="idm140226862669280"><code class="literal">KERNEL</code></td><td headers="idm140226862668800">Triggered to record the initialization of the Audit system.</td></tr><tr><td headers="idm140226862669280"><code class="literal">KERNEL_OTHER</code></td><td headers="idm140226862668800">Triggered to record information from third-party kernel modules.</td></tr><tr><td headers="idm140226862669280"><code class="literal">LABEL_LEVEL_CHANGE</code></td><td headers="idm140226862668800">Triggered when an object's level label is modified.</td></tr><tr><td headers="idm140226862669280"><code class="literal">LABEL_OVERRIDE</code></td><td headers="idm140226862668800">Triggered when an administrator overrides an object's level label.</td></tr><tr><td headers="idm140226862669280"><code class="literal">LOGIN</code></td><td headers="idm140226862668800">Triggered to record relevant login information when a user log in to access the system.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_CIPSOV4_ADD</code></td><td headers="idm140226862668800">Triggered
 when a Commercial Internet Protocol Security Option (CIPSO) user adds a
 new Domain of Interpretation (DOI). Adding DOIs is a part of the packet
 labeling capabilities of the kernel provided by NetLabel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_CIPSOV4_DEL</code></td><td headers="idm140226862668800">Triggered
 when a CIPSO user deletes an existing DOI. Adding DOIs is a part of the
 packet labeling capabilities of the kernel provided by NetLabel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_CONFIG_CHANGE</code></td><td headers="idm140226862668800">Triggered when an SELinux Boolean value is changed.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_IPSEC_EVENT</code></td><td headers="idm140226862668800">Triggered to record information about an IPSec event, when one is detected, or when the IPSec configuration changes.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_MAP_ADD</code></td><td headers="idm140226862668800">Triggered
 when a new Linux Security Module (LSM) domain mapping is added. LSM 
domain mapping is a part of the packet labeling capabilities of the 
kernel provided by NetLabel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_MAP_DEL</code></td><td headers="idm140226862668800">Triggered
 when an existing LSM domain mapping is added. LSM domain mapping is a 
part of the packet labeling capabilities of the kernel provided by 
NetLabel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_POLICY_LOAD</code></td><td headers="idm140226862668800">Triggered when a SELinux policy file is loaded.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_STATUS</code></td><td headers="idm140226862668800">Triggered when the SELinux mode (enforcing, permissive, off) is changed.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_UNLBL_ALLOW</code></td><td headers="idm140226862668800">Triggered when unlabeled traffic is allowed when using the packet labeling capabilities of the kernel provided by NetLabel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_UNLBL_STCADD</code></td><td headers="idm140226862668800">Triggered when a static label is added when using the packet labeling capabilities of the kernel provided by NetLabel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MAC_UNLBL_STCDEL</code></td><td headers="idm140226862668800">Triggered when a static label is deleted when using the packet labeling capabilities of the kernel provided by NetLabel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MMAP</code></td><td headers="idm140226862668800">Triggered to record a file descriptor and flags of the <code class="systemitem">mmap(2)</code> system call.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MQ_GETSETATTR</code></td><td headers="idm140226862668800">Triggered to record the <code class="systemitem">mq_getattr(3)</code> and <code class="systemitem">mq_setattr(3)</code> message queue attributes.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MQ_NOTIFY</code></td><td headers="idm140226862668800">Triggered to record arguments of the <code class="systemitem">mq_notify(3)</code> system call.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MQ_OPEN</code></td><td headers="idm140226862668800">Triggered to record arguments of the <code class="systemitem">mq_open(3)</code> system call.</td></tr><tr><td headers="idm140226862669280"><code class="literal">MQ_SENDRECV</code></td><td headers="idm140226862668800">Triggered to record arguments of the <code class="systemitem">mq_send(3)</code> and <code class="systemitem">mq_receive(3)</code> system calls.</td></tr><tr><td headers="idm140226862669280"><code class="literal">NETFILTER_CFG</code></td><td headers="idm140226862668800">Triggered when Netfilter chain modifications are detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">NETFILTER_PKT</code></td><td headers="idm140226862668800">Triggered to record packets traversing Netfilter chains.</td></tr><tr><td headers="idm140226862669280"><code class="literal">OBJ_PID</code></td><td headers="idm140226862668800">Triggered to record information about a process to which a signal is sent.</td></tr><tr><td headers="idm140226862669280"><code class="literal">PATH</code></td><td headers="idm140226862668800">Triggered to record file name path information.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_ACCT_LOCK</code><a href="#ftn.footnote-RESP" class="footnote"><sup class="footnote" id="footnote-RESP">[c]</sup></a></td><td headers="idm140226862668800">Triggered when a user account is locked.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_ACCT_LOCK_TIMED</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when a user account is locked for a specified period of time.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_ACCT_REMOTE</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when a user account is locked from a remote session.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_ACCT_UNLOCK_TIMED</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when a user account is unlocked after a configured period of time.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_ALERT</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when an alert email is sent.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_ANOMALY</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when an anomaly was not acted upon.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_EXEC</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when an intrusion detection program responds to a threat originating from the execution of a program.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_HALT</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when the system is shut down.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_KILL_PROC</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when a process is terminated.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_SEBOOL</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when an SELinux Boolean value is set.   </td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_SINGLE</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when the system is put into single-user mode.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_TERM_ACCESS</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when a session is terminated.</td></tr><tr><td headers="idm140226862669280"><code class="literal">RESP_TERM_LOCK</code><a href="#ftn.footnote-RESP" class="footnoteref"><sup class="footnoteref">[c]</sup></a></td><td headers="idm140226862668800">Triggered when a terminal is locked.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ROLE_ASSIGN</code></td><td headers="idm140226862668800">Triggered when an administrator assigns a user to an SELinux role.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ROLE_MODIFY</code></td><td headers="idm140226862668800">Triggered when an administrator modifies an SELinux role.</td></tr><tr><td headers="idm140226862669280"><code class="literal">ROLE_REMOVE</code></td><td headers="idm140226862668800">Triggered when an administrator removes a user from an SELinux role.</td></tr><tr><td headers="idm140226862669280"><code class="literal">SELINUX_ERR</code></td><td headers="idm140226862668800">Triggered when an internal SELinux error is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">SERVICE_START</code></td><td headers="idm140226862668800">Triggered when a service is started.</td></tr><tr><td headers="idm140226862669280"><code class="literal">SERVICE_STOP</code></td><td headers="idm140226862668800">Triggered when a service is stopped.</td></tr><tr><td headers="idm140226862669280"><code class="literal">SOCKADDR</code></td><td headers="idm140226862668800">Triggered to record a socket address.</td></tr><tr><td headers="idm140226862669280"><code class="literal">SOCKETCALL</code></td><td headers="idm140226862668800">Triggered to record arguments of the <code class="systemitem">sys_socketcall</code> system call (used to multiplex many socket-related system calls).</td></tr><tr><td headers="idm140226862669280"><code class="literal">SYSCALL</code></td><td headers="idm140226862668800">Triggered to record a system call to the kernel.</td></tr><tr><td headers="idm140226862669280"><code class="literal">SYSTEM_BOOT</code></td><td headers="idm140226862668800">Triggered when the system is booted up.</td></tr><tr><td headers="idm140226862669280"><code class="literal">SYSTEM_RUNLEVEL</code></td><td headers="idm140226862668800">Triggered when the system's run level is changed.</td></tr><tr><td headers="idm140226862669280"><code class="literal">SYSTEM_SHUTDOWN</code></td><td headers="idm140226862668800">Triggered when the system is shut down.</td></tr><tr><td headers="idm140226862669280"><code class="literal">TEST</code></td><td headers="idm140226862668800">Triggered to record the success value of a test message.</td></tr><tr><td headers="idm140226862669280"><code class="literal">TRUSTED_APP</code></td><td headers="idm140226862668800">The record of this type can be used by third party application that require auditing.</td></tr><tr><td headers="idm140226862669280"><code class="literal">TTY</code></td><td headers="idm140226862668800">Triggered when TTY input was sent to an administrative process.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_ACCT</code></td><td headers="idm140226862668800">Triggered when a user-space user account is modified.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_AUTH</code></td><td headers="idm140226862668800">Triggered when a user-space authentication attempt is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_AVC</code></td><td headers="idm140226862668800">Triggered when a user-space AVC message is generated.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_CHAUTHTOK</code></td><td headers="idm140226862668800">Triggered when a user account attribute is modified.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_CMD</code></td><td headers="idm140226862668800">Triggered when a user-space shell command is executed.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_END</code></td><td headers="idm140226862668800">Triggered when a user-space session is terminated.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_ERR</code></td><td headers="idm140226862668800">Triggered when a user account state error is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_LABELED_EXPORT</code></td><td headers="idm140226862668800">Triggered when an object is exported with an SELinux label.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_LOGIN</code></td><td headers="idm140226862668800">Triggered when a user logs in.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_LOGOUT</code></td><td headers="idm140226862668800">Triggered when a user logs out.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_MAC_POLICY_LOAD</code></td><td headers="idm140226862668800">Triggered when a user-space daemon loads an SELinux policy.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_MGMT</code></td><td headers="idm140226862668800">Triggered to record user-space management data.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_ROLE_CHANGE</code></td><td headers="idm140226862668800">Triggered when a user's SELinux role is changed.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_SELINUX_ERR</code></td><td headers="idm140226862668800">Triggered when a user-space SELinux error is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_START</code></td><td headers="idm140226862668800">Triggered when a user-space session is started.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_TTY</code></td><td headers="idm140226862668800">Triggered when an explanatory message about TTY input to an administrative process is sent from user-space.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USER_UNLABELED_EXPORT</code></td><td headers="idm140226862668800">Triggered when an object is exported without SELinux label.</td></tr><tr><td headers="idm140226862669280"><code class="literal">USYS_CONFIG</code></td><td headers="idm140226862668800">Triggered when a user-space system configuration change is detected.</td></tr><tr><td headers="idm140226862669280"><code class="literal">VIRT_CONTROL</code></td><td headers="idm140226862668800">Triggered when a virtual machine is started, paused, or stopped.</td></tr><tr><td headers="idm140226862669280"><code class="literal">VIRT_MACHINE_ID</code></td><td headers="idm140226862668800">Triggered to record the binding of a label to a virtual machine.</td></tr><tr><td headers="idm140226862669280"><code class="literal">VIRT_RESOURCE</code></td><td headers="idm140226862668800">Triggered to record resource assignment of a virtual machine.</td></tr></tbody><tbody class="footnotes"><tr><td colspan="2"><div id="ftn.footnote-ANOM" class="footnote"><div class="para"><a href="#footnote-ANOM" class="para"><sup class="para">[a] </sup></a>
							All Audit event types prepended with <code class="literal">ANOM</code> are intended to be processed by an intrusion detection program.
						</div></div><div id="ftn.footnote-INTEGRITY" class="footnote"><div class="para"><a href="#footnote-INTEGRITY" class="para"><sup class="para">[b] </sup></a>
							This event type is related to the Integrity Measurement 
Architecture (IMA), which functions best with a Trusted Platform Module 
(TPM) chip.
						</div></div><div id="ftn.footnote-RESP" class="footnote"><div class="para"><a href="#footnote-RESP" class="para"><sup class="para">[c] </sup></a>
							All Audit event types prepended with <code class="literal">RESP</code> are intended responses of an intrusion detection system in case it detects malicious activity on the system.
						</div></div></td></tr></tbody></table></div></div></div></div><div xml:lang="en-US" class="appendix" id="appe-Security_Guide-Revision_History" lang="en-US"><div class="titlepage"><div><div><h1 class="title">Appendix&nbsp;C.&nbsp;Revision History</h1></div></div></div><div class="para"><p><!--Empty--></p>
		<div class="revhistory"><table summary="Revision History"><tbody><tr><th colspan="3" align="left" valign="top"><strong>Revision History</strong></th></tr><tr><td align="left">Revision 1-18</td><td align="left">Tue 14 Mar 2017</td><td align="left"><span class="author"><span class="firstname">Mirek</span> <span class="surname">Jahoda</span></span></td></tr><tr><td colspan="3" align="left">
					<table summary="Simple list" class="simplelist" border="0"><tbody><tr><td>Version for 6.9 GA publication.</td></tr></tbody></table>

				</td></tr><tr><td align="left">Revision 1-14</td><td align="left">Wed 4 May 2016</td><td align="left"><span class="author"><span class="firstname">Robert</span> <span class="surname">Krátký</span></span></td></tr><tr><td colspan="3" align="left">
					<table summary="Simple list" class="simplelist" border="0"><tbody><tr><td>Release of the Security Guide for Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.8</td></tr></tbody></table>

				</td></tr><tr><td align="left">Revision 1-12.4</td><td align="left">Tue Dec 16 2014</td><td align="left"><span class="author"><span class="firstname">Robert</span> <span class="surname">Krátký</span></span></td></tr><tr><td colspan="3" align="left">
					<table summary="Simple list" class="simplelist" border="0"><tbody><tr><td>Update to sort order on the Red Hat Customer Portal.</td></tr></tbody></table>

				</td></tr><tr><td align="left">Revision 1-12.3</td><td align="left">Mon Dec 01 2014</td><td align="left"><span class="author"><span class="firstname">Robert</span> <span class="surname">Krátký</span></span></td></tr><tr><td colspan="3" align="left">
					<table summary="Simple list" class="simplelist" border="0"><tbody><tr><td>Updates reflecting the POODLE vuln.</td></tr></tbody></table>

				</td></tr><tr><td align="left">Revision 1-12.0</td><td align="left">Mon Oct 13 2014</td><td align="left"><span class="author"><span class="firstname">Miroslav</span> <span class="surname">Svoboda</span></span></td></tr><tr><td colspan="3" align="left">
					<table summary="Simple list" class="simplelist" border="0"><tbody><tr><td>Release of the Security Guide for Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.6</td></tr></tbody></table>

				</td></tr><tr><td align="left">Revision 1-9.9</td><td align="left">Feb 21 2013</td><td align="left"><span class="author"><span class="firstname">Martin</span> <span class="surname">Prpič</span></span></td></tr><tr><td colspan="3" align="left">
					<table summary="Simple list" class="simplelist" border="0"><tbody><tr><td>Release of the Security Guide for Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.4</td></tr></tbody></table>

				</td></tr><tr><td align="left">Revision 1-8.25</td><td align="left">Jun 20 2012</td><td align="left"><span class="author"><span class="firstname">Martin</span> <span class="surname">Prpič</span></span></td></tr><tr><td colspan="3" align="left">
					<table summary="Simple list" class="simplelist" border="0"><tbody><tr><td>Release of the Security Guide for Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.3</td></tr></tbody></table>

				</td></tr><tr><td align="left">Revision 1-7</td><td align="left">Dec 6 2011</td><td align="left"><span class="author"><span class="firstname">Martin</span> <span class="surname">Prpič</span></span></td></tr><tr><td colspan="3" align="left">
					<table summary="Simple list" class="simplelist" border="0"><tbody><tr><td>Release of the Security Guide for Red&nbsp;Hat Enterprise&nbsp;Linux&nbsp;6.2</td></tr></tbody></table>

				</td></tr></tbody></table></div>

	</div></div><div><div class="legalnotice"><a id="idm140226881085568"><!--Empty--></a><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"><!--Empty--></span>© 2017 Red&nbsp;Hat,&nbsp;Inc.
	</div><div class="para">
		Based on the Fedora Security Guide (current version at <a href="http://docs.fedoraproject.org/en-US/Fedora/16/html/Security_Guide/index.html">http://docs.fedoraproject.org/en-US/Fedora/16/html/Security_Guide/index.html</a>), written by Johnray Fuller, Eric Christensen, Adam Ligas, and other Fedora Project contributors.
	</div><div class="para">
		The text of and illustrations in this document are licensed by 
Red&nbsp;Hat under a Creative Commons Attribution–Share Alike 3.0 
Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available 
at <a href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>.
 In accordance with CC-BY-SA, if you distribute this document or an 
adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red&nbsp;Hat, as the licensor of this document, waives the right to 
enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest
 extent permitted by applicable law.
	</div><div class="para">
		Red&nbsp;Hat, Red&nbsp;Hat Enterprise&nbsp;Linux, the Shadowman logo, 
JBoss, MetaMatrix, Fedora, the Infinity Logo, and RHCE are trademarks of
 Red&nbsp;Hat, Inc., registered in the United States and other 
countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div><div class="para">
		
<div class="address"><p><br>
			<span class="street">1801&nbsp;Varsity&nbsp;Drive</span><br>
			&nbsp;<span class="city">Raleigh</span>,&nbsp;<span class="state">NC</span>&nbsp;<span class="postcode">27606-2072</span>&nbsp;<span class="country">USA</span><br>
			&nbsp;<span class="phone">Phone:&nbsp;+1&nbsp;919&nbsp;754&nbsp;3700</span><br>
			&nbsp;<span class="phone">Phone:&nbsp;888&nbsp;733&nbsp;4281</span><br>
			&nbsp;<span class="fax">Fax:&nbsp;+1&nbsp;919&nbsp;754&nbsp;3701</span><br>
<br>
</p></div>

	</div></div></div></div></div>
  
  </div>
  </div>
</div>
<div id="comments-footer" class="book-comments">
  </div>
<meta itemscope="" itemref="md1">
<meta itemscope="" itemref="md1 md2">
    <!-- Display: Next/Previous Nav -->
          
      </div>
</article>


  

            </div>
        </main>
    </div>
    <!--googleoff: all-->
    <div id="to-top"><a class="btn_slideto affix-top" href="#masthead" aria-label="Back to Top"><span class="web-icon-upload"></span></a></div>
    <footer class="footer-main">
        <div class="container footer-top">
            <div class="row">

                <div class="col-sm-2 brand">
                    <img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/l_redhat-reverse.png" alt="Red Hat">

                </div>

            <div role="navigation" class="col-sm-2">
                <h3>Quick Links</h3>
                <ul>
                    <li><a class="download-software" href="https://access.redhat.com/downloads/">Downloads</a></li>
                    <li><a class="manage-subscriptions" href="https://access.redhat.com/management/subscriptions/#active">Subscriptions</a></li>
                    <li><a class="support-cases" href="https://access.redhat.com/support">Support Cases</a></li>
                    <li><a class="customer-service" href="https://access.redhat.com/support/customer-service">Customer Service</a></li>
                    <li><a class="quick-docs" href="https://access.redhat.com/documentation">Product Documentation</a></li>
                </ul>
            </div>

            <div role="navigation" class="col-sm-2">
                <h3>Help</h3>
                <ul>
                    <li><a class="contact-us" href="https://access.redhat.com/support/contact/">Contact Us</a></li>
                    <li><a class="cp-faqs" href="https://access.redhat.com/articles/33844">Customer Portal FAQ</a></li>
                    <li><a class="login-problems" href="https://access.redhat.com/help/login_assistance">Log-in Assistance</a></li>
                </ul>
            </div>

            <div role="navigation" class="col-sm-2">
                <h3>Site Info</h3>
                <ul>
                  <li><a class="trust-red-hat" href="https://access.redhat.com/trust">Trust Red Hat</a></li>
                  <li><a class="browser-support-policy" href="https://access.redhat.com/help/browsers/">Browser Support Policy</a></li>
                  <li><a class="accessibility" href="https://access.redhat.com/help/accessibility/">Accessibility</a></li>
                  <li><a class="recognition" href="https://access.redhat.com/recognition/">Awards and Recognition</a></li>
                  <li><a class="colophon" href="https://access.redhat.com/help/colophon/">Colophon</a></li>
                </ul>
            </div>

            <div role="navigation" class="col-sm-2">
                <h3>About</h3>
                <ul>
                    <li><a href="https://access.redhat.com/subscription-value" class="subscription-value">Red Hat Subscription Value</a></li>
                    <li><a href="https://www.redhat.com/about/" class="about-red-hat">About Red Hat</a></li>
                    <li><a href="http://jobs.redhat.com/" class="about-jobs">Red Hat Jobs</a></li>
                </ul>
            </div>

            <div role="navigation" class="col-sm-2">
                <h3>Related Sites</h3>
                <ul>
                    <li><a href="https://www.redhat.com/" class="red-hat-com">RedHat.com</a></li>
                    <li><a href="https://www.jboss.org/" class="jboss-org">JBoss.org</a></li>
                    <li><a href="https://www.openshift.com/" class="openshift-com">OpenShift.com</a></li>
                    <li><a href="http://developers.redhat.com/" class="red-hat-developers">Developers.RedHat.com</a></li>
                    <li><a href="https://partnercenter.force.com/" class="partner-connect">Red Hat Partner Connect</a></li>
                </ul>
            </div>

            </div>
        </div>

        <div class="anchor">
            <div class="container">
                <div class="row">
                    <div class="col-sm-4 col-lg-3 social">
                        <a href="http://www.redhat.com/summit/" class="summit"><img src="Security%20Guide%20-%20Red%20Hat%20Customer%20Portal_files/l_summit.png" alt="Red Hat Summit"></a>
                        <a href="https://twitter.com/RedHatSupport" class="sm-icon twitter"><span class="nicon-twitter"></span><span class="offscreen">Twitter</span></a>
                        <a href="https://www.facebook.com/RedHatSupport" class="sm-icon facebook"><span class="nicon-facebook"></span><span class="offscreen">Facebook</span></a>
                        <a href="https://plus.google.com/100456039940694908045/posts" class="sm-icon googleplus"><span class="nicon-googleplus"></span><span class="offscreen">Google+</span></a>
                    </div>
                    <div class="col-sm-8 col-lg-9 legal">
                      <a href="https://status.redhat.com/" class="status-page-widget">
                          <span class="status-dot shape-circle shape-dash-lime"></span>
                          <span class="status-description">All Systems Operational</span>
                      </a>
                        <div role="navigation" class="legal-nav">
                            <ul>
                                <li><a href="http://www.redhat.com/en/about/privacy-policy" class="privacy-policy">Privacy Policy</a></li>
                                <li><a href="https://access.redhat.com/help/terms/" class="terms-of-use">Customer Portal Terms of Use</a></li>
                                <li><a href="http://www.redhat.com/en/about/all-policies-guidelines" class="all-policies">All Policies and Guidelines</a></li>
                            </ul>
                        </div>
                        <small class="copyright">Copyright © 2018 Red Hat, Inc.</small>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--googleon: all-->
</div>
  
  <div id="formatHelp" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="formatTitle" aria-hidden="true"><div class="modal-dialog"><div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
      <h3 id="formatTitle">Formatting Tips</h3>
    </div>
    <div class="modal-body">
      <p>Here are the common uses of Markdown.</p><dl class="formatting-help">
        <dt class="codeblock">Code blocks</dt><dd class="codeblock"><pre><code>~~~
Code surrounded in tildes is easier to read
~~~</code></pre></dd>
        <dt class="urls">Links/URLs</dt><dd class="urls"><code>[Red Hat Customer Portal](https://access.redhat.com)</code></dd>
       </dl>
    </div>
    <div class="modal-footer">
      <a target="_blank" href="https://access.redhat.com/help/markdown" class="btn btn-primary" rel=" noopener noreferrer">Learn more</a>
      <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    </div>
  </div></div></div>

    <ol class="menu" style="height: 957px;"><li class=" leaf"><a href="">Security Guide</a></li><li class=" leaf"><a href="#chap-Security_Guide-Security_Overview">1. Security Overview</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Introduction_to_Security">1.1. Introduction to Security</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Introduction_to_Security-What_is_Computer_Security">1.1.1. What is Computer Security?</a></li><li class=" leaf"><a href="#sect-Security_Guide-Introduction_to_Security-SELinux">1.1.2. SELinux</a></li><li class=" leaf"><a href="#sect-Security_Guide-Introduction_to_Security-Security_Controls">1.1.3. Security Controls</a></li><li class=" leaf"><a href="#sect-Security_Guide-Introduction_to_Security-Conclusion">1.1.4. Conclusion</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Vulnerability_Assessment">1.2. Vulnerability Assessment</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Vulnerability_Assessment-Thinking_Like_the_Enemy">1.2.1. Thinking Like the Enemy</a></li><li class=" leaf"><a href="#sect-Security_Guide-Vulnerability_Assessment-Defining_Assessment_and_Testing">1.2.2. Defining Assessment and Testing</a></li><li class=" leaf"><a href="#sect-Security_Guide-Vulnerability_Assessment-Evaluating_the_Tools">1.2.3. Evaluating the Tools</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Security_Threats">1.3. Security Threats</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Attackers_and_Vulnerabilities-Threats_to_Network_Security">1.3.1. Threats to Network Security</a></li><li class=" leaf"><a href="#sect-Security_Guide-Attackers_and_Vulnerabilities-Threats_to_Server_Security">1.3.2. Threats to Server Security</a></li><li class=" leaf"><a href="#sect-Security_Guide-Attackers_and_Vulnerabilities-Threats_to_Workstation_and_Home_PC_Security">1.3.3. Threats to Workstation and Home PC Security</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Common_Exploits_and_Attacks">1.4. Common Exploits and Attacks</a></li><li class=" leaf"><a href="#sect-Security_Guide-Security_Updates">1.5. Security Updates</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Security_Updates-Updating_Packages">1.5.1. Updating Packages</a></li><li class=" leaf"><a href="#sect-Security_Guide-Updating_Packages-Verifying_Signed_Packages">1.5.2. Verifying Signed Packages</a></li><li class=" leaf"><a href="#sect-Security_Guide-Updating_Packages-Installing_Signed_Packages">1.5.3. Installing Signed Packages</a></li><li class=" leaf"><a href="#sect-Security_Guide-Updating_Packages-Applying_the_Changes">1.5.4. Applying the Changes</a></li></ol></li></ol></li><li class=" leaf"><a href="#chap-Security_Guide-Securing_Your_Network">2. Securing Your Network</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security">2.1. Workstation Security</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Evaluating_Workstation_Security">2.1.1. Evaluating Workstation Security</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-BIOS_and_Boot_Loader_Security">2.1.2. BIOS and Boot Loader Security</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Password_Security">2.1.3. Password Security</a></li><li class=" leaf"><a href="#sect-Security_Guide-Password_Security-Creating_User_Passwords_Within_an_Organization">2.1.4. Creating User Passwords Within an Organization</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Locking_Inactive_Accounts">2.1.5. Locking Inactive Accounts</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Customizing_Access_Control">2.1.6. Customizing Access Control</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Time-based_Restriction_of_Access">2.1.7. Time-based Restriction of Access</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Applying_Account_Limits">2.1.8. Applying Account Limits</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Administrative_Controls">2.1.9. Administrative Controls</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Session_Locking">2.1.10. Session Locking</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Available_Network_Services">2.1.11. Available Network Services</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Personal_Firewalls">2.1.12. Personal Firewalls</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Security_Enhanced_Communication_Tools">2.1.13. Security Enhanced Communication Tools</a></li><li class=" leaf"><a href="#sect-Security_Guide-Workstation_Security-Enforcing_Read-Only_Mounting_of_Removable_Media">2.1.14. Enforcing Read-Only Mounting of Removable Media</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security">2.2. Server Security</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Securing_Services_With_TCP_Wrappers_and_xinetd">2.2.1. Securing Services With TCP Wrappers and xinetd</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Securing_Portmap">2.2.2. Securing Portmap</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Securing_NIS">2.2.3. Securing NIS</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Securing_NFS">2.2.4. Securing NFS</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Securing_the_Apache_HTTP_Server">2.2.5. Securing the Apache HTTP Server</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Securing_FTP">2.2.6. Securing FTP</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Securing_Postfix">2.2.7. Securing Postfix</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Securing_Sendmail">2.2.8. Securing Sendmail</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Verifying_Which_Ports_Are_Listening">2.2.9. Verifying Which Ports Are Listening</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Disable-Source-Routing">2.2.10. Disable Source Routing</a></li><li class=" leaf"><a href="#sect-Security_Guide-Server_Security-Reverse_Path_Forwarding">2.2.11. Reverse Path Forwarding</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Single_Sign_on_SSO">2.3. Single Sign-on (SSO)</a></li><li class=" leaf"><a href="#sect-Security_Guide-Pluggable_Authentication_Modules_PAM">2.4. Pluggable Authentication Modules (PAM)</a></li><li class=" leaf"><a href="#sect-Security_Guide-Kerberos">2.5. Kerberos</a></li><li class=" leaf"><a href="#sect-Security_Guide-TCP_Wrappers_and_xinetd">2.6. TCP Wrappers and xinetd</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-TCP_Wrappers_and_xinetd-TCP_Wrappers">2.6.1. TCP Wrappers</a></li><li class=" leaf"><a href="#sect-Security_Guide-TCP_Wrappers_and_xinetd-TCP_Wrappers_Configuration_Files">2.6.2. TCP Wrappers Configuration Files</a></li><li class=" leaf"><a href="#sect-Security_Guide-TCP_Wrappers_and_xinetd-xinetd">2.6.3. xinetd</a></li><li class=" leaf"><a href="#sect-Security_Guide-TCP_Wrappers_and_xinetd-xinetd_Configuration_Files">2.6.4. xinetd Configuration Files</a></li><li class=" leaf"><a href="#sect-Security_Guide-TCP_Wrappers_and_xinetd-Additional_Resources">2.6.5. Additional Resources</a></li></ol></li><li class=" leaf"><a href="#sec-Securing_Virtual_Private_Networks">2.7. Securing Virtual Private Networks (VPNs)</a><ol class="menu"><li class=" leaf"><a href="#sec-IPsec_VPN_Using_Libreswan">2.7.1. IPsec VPN Using Libreswan</a></li><li class=" leaf"><a href="#VPN_Configurations_Using_Libreswan">2.7.2. VPN Configurations Using Libreswan</a></li><li class=" leaf"><a href="#sec-Host-To-Host_VPN_Using_Libreswan">2.7.3. Host-To-Host VPN Using Libreswan</a></li><li class=" leaf"><a href="#Site-To-Site_VPN_Using_Libreswan">2.7.4. Site-to-Site VPN Using Libreswan</a></li><li class=" leaf"><a href="#Site-To-Site_Single_Tunnel_VPN_Using_Libreswan">2.7.5. Site-to-Site Single Tunnel VPN Using Libreswan</a></li><li class=" leaf"><a href="#Subnet_Extrusion_Using_Libreswan">2.7.6. Subnet Extrusion Using Libreswan</a></li><li class=" leaf"><a href="#Road_Warrior_Application_Using_Libreswan">2.7.7. Road Warrior Access VPN Using Libreswan</a></li><li class=" leaf"><a href="#Road_Warrior_Application_Using_Libreswan_and_XAUTH_with_X.509">2.7.8. Road Warrior Access VPN Using Libreswan and XAUTH with X.509</a></li><li class=" leaf"><a href="#sec-Libreswan-additional_resources">2.7.9. Additional Resources</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Firewalls">2.8. Firewalls</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Firewalls-Netfilter_and_IPTables">2.8.1. Netfilter and IPTables</a></li><li class=" leaf"><a href="#sect-Security_Guide-Firewalls-Basic_Firewall_Configuration">2.8.2. Basic Firewall Configuration</a></li><li class=" leaf"><a href="#sect-Security_Guide-Firewalls-Using_IPTables">2.8.3. Using IPTables</a></li><li class=" leaf"><a href="#sect-Security_Guide-Firewalls-Common_IPTables_Filtering">2.8.4. Common IPTables Filtering</a></li><li class=" leaf"><a href="#sect-Security_Guide-Firewalls-FORWARD_and_NAT_Rules">2.8.5. FORWARD and NAT Rules</a></li><li class=" leaf"><a href="#sect-Security_Guide-Firewalls-Malicious_Software_and_Spoofed_IP_Addresses">2.8.6. Malicious Software and Spoofed IP Addresses</a></li><li class=" leaf"><a href="#sect-Security_Guide-Firewalls-IPTables_and_Connection_Tracking">2.8.7. IPTables and Connection Tracking</a></li><li class=" leaf"><a href="#sect-Security_Guide-Firewalls-IPv6">2.8.8. IPv6</a></li><li class=" leaf"><a href="#sect-Security_Guide-IPTables">2.8.9. IPTables</a></li></ol></li></ol></li><li class=" leaf"><a href="#chap-Security_Guide-Encryption">3. Encryption</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Encryption-Data_at_Rest">3.1. Data at Rest</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Encryption-Protecting_Data_at_Rest-Full_Disk_Encryption">3.1.1. Full Disk Encryption</a></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-Protecting_Data_at_Rest-File_Based_Encryption">3.1.2. File-Based Encryption</a></li><li class=" leaf"><a href="#sect-Security_Guide-LUKS_Disk_Encryption">3.1.3. LUKS Disk Encryption</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-Data_in_Motion">3.2. Data in Motion</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Encryption-Data_in_Motion-Virtual_Private_Networks">3.2.1. Virtual Private Networks</a></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-Data_in_Motion-Secure_Shell">3.2.2. Secure Shell</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-OpenSSL_Intel_AES-NI_Engine">3.3. OpenSSL Intel AES-NI Engine</a></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-Using_the_Random_Number_Generator">3.4. Using the Random Number Generator</a></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-GPG">3.5. GNU Privacy Guard (GPG)</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Encryption-GPG-Keys_in_GNOME">3.5.1. Creating GPG Keys in GNOME</a></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-GPG-Creating_GPG_Keys_in_KDE">3.5.2. Creating GPG Keys in KDE</a></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-GPG-Creating_GPG_Keys_using_the_Command_Line">3.5.3. Creating GPG Keys Using the Command Line</a></li><li class=" leaf"><a href="#sect-Security_Guide-Encryption-GPG-About_Public_Key_Encryption">3.5.4. About Public Key Encryption</a></li></ol></li><li class=" leaf"><a href="#sec-Using_stunnel">3.6. Using stunnel</a><ol class="menu"><li class=" leaf"><a href="#sec-Installing_stunnel">3.6.1. Installing stunnel</a></li><li class=" leaf"><a href="#sec-Configuring_stunnel_wrapper">3.6.2. Configuring stunnel as a TLS Wrapper</a></li><li class=" leaf"><a href="#sect-Starting_stopping_restarting_stunnel">3.6.3. Starting, Stopping and Restarting stunnel</a></li></ol></li><li class=" leaf"><a href="#sec-Hardening_TLS_Configuration">3.7. Hardening TLS Configuration</a><ol class="menu"><li class=" leaf"><a href="#sec-Choosing_Algorithms_to_Enable">3.7.1. Choosing Algorithms to Enable</a></li><li class=" leaf"><a href="#sec-Using_Implementations_of_TLS">3.7.2. Using Implementations of TLS</a></li><li class=" leaf"><a href="#sec-Configuring_Specific_Applications">3.7.3. Configuring Specific Applications</a></li><li class=" leaf"><a href="#sec-Additional_Information">3.7.4. Additional Information</a></li></ol></li></ol></li><li class=" leaf"><a href="#chap-Security_Guide-General_Principles_of_Information_Security">4. General Principles of Information Security</a></li><li class=" leaf"><a href="#chap-Security_Guide-Secure_Installation">5. Secure Installation</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Secure_Installation-Disk_Partitions">5.1. Disk Partitions</a></li><li class=" leaf"><a href="#sect-Security_Guide-Secure_Installation-Utilize_LUKS_Partition_Encryption">5.2. Utilize LUKS Partition Encryption</a></li></ol></li><li class=" leaf"><a href="#chap-Security_Guide-Software_Maintenance">6. Software Maintenance</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Software_Maintenance-Install_Minimal_Software">6.1. Install Minimal Software</a></li><li class=" leaf"><a href="#sect-Security_Guide-Software_Maintenance-Plan_and_Configure_Security_Updates">6.2. Plan and Configure Security Updates</a></li><li class=" leaf"><a href="#sect-Security_Guide-Software_Maintenance-Plan_and_Configure_Security_Updates-Adjusting_Automatic_Updates">6.3. Adjusting Automatic Updates</a></li><li class=" leaf"><a href="#sect-Security_Guide-Software_Maintenance-Install_Signed_Packages_from_Well_Known_Repositories">6.4. Install Signed Packages from Well Known Repositories</a></li></ol></li><li class=" leaf"><a href="#chap-system_auditing">7. System Auditing</a><ol class="menu"><li class=" leaf"><a href="#sec-audit_system_architecture">7.1. Audit System Architecture</a></li><li class=" leaf"><a href="#sec-installing_the_audit_packages">7.2. Installing the audit Packages</a></li><li class=" leaf"><a href="#sec-configuring_the_audit_service">7.3. Configuring the audit Service</a><ol class="menu"><li class=" leaf"><a href="#sec-configuring_auditd_for_CAPP">7.3.1. Configuring auditd for a CAPP Environment</a></li></ol></li><li class=" leaf"><a href="#sec-starting_the_audit_service">7.4. Starting the audit Service</a></li><li class=" leaf"><a href="#sec-Defining_Audit_Rules_and_Controls">7.5. Defining Audit Rules</a><ol class="menu"><li class=" leaf"><a href="#sec-Defining_Audit_Rules_with_the_auditctl_utility">7.5.1. Defining Audit Rules with the auditctl Utility</a></li><li class=" leaf"><a href="#sec-Defining_Audit_Rules_and_Controls_in_the_audit.rules_file">7.5.2. Defining Persistent Audit Rules and Controls in the /etc/audit/audit.rules File</a></li></ol></li><li class=" leaf"><a href="#sec-Understanding_Audit_Log_Files">7.6. Understanding Audit Log Files</a></li><li class=" leaf"><a href="#sec-Searching_the_Audit_Log_Files">7.7. Searching the Audit Log Files</a></li><li class=" leaf"><a href="#sec-Creating_Audit_Reports">7.8. Creating Audit Reports</a></li><li class=" leaf"><a href="#sec-Configuring_PAM_for_Auditing">7.9. Configuring PAM for Auditing</a><ol class="menu"><li class=" leaf"><a href="#sec-configuring_pam_tty_audit">7.9.1. Configuring pam_tty_audit</a></li></ol></li><li class=" leaf"><a href="#sec-audit_additional_resources">7.10. Additional Resources</a></li></ol></li><li class=" leaf"><a href="#chap-Compliance_and_Vulnerability_Scanning">8. Compliance and Vulnerability Scanning with OpenSCAP</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Compliance_in_RHEL">8.1. Security Compliance in Red Hat Enterprise Linux</a></li><li class=" leaf"><a href="#sect-Defining_Compliance_Policy">8.2. Defining Compliance Policy</a><ol class="menu"><li class=" leaf"><a href="#sect-SCAP_format-XCCDF">8.2.1. The XCCDF File Format</a></li><li class=" leaf"><a href="#sect-SCAP_format-OVAL">8.2.2. The OVAL File Format</a></li><li class=" leaf"><a href="#sect-SCAP_format-data_stream">8.2.3. The Data Stream Format</a></li></ol></li><li class=" leaf"><a href="#sect-Using_SCAP_Workbench">8.3. Using SCAP Workbench</a><ol class="menu"><li class=" leaf"><a href="#sect-Installing_SCAP_Workbench">8.3.1. Installing SCAP Workbench</a></li><li class=" leaf"><a href="#sect-Running_SCAP_Workbench">8.3.2. Running SCAP Workbench</a></li><li class=" leaf"><a href="#sect-System_Scanning-SCAP_Workbench">8.3.3. Scanning the System</a></li><li class=" leaf"><a href="#sect-Customizing_Security_Profiles-SCAP_Workbench">8.3.4. Customizing Security Profiles</a></li><li class=" leaf"><a href="#sect-Saving_SCAP_Content-SCAP_Workbench">8.3.5. Saving SCAP Content</a></li><li class=" leaf"><a href="#sect-Generating_Reports_on_Workbench">8.3.6. Viewing Scan Results and Generating Scan Reports</a></li></ol></li><li class=" leaf"><a href="#sect-Using_oscap">8.4. Using oscap</a><ol class="menu"><li class=" leaf"><a href="#sect-Installing_oscap">8.4.1. Installing oscap</a></li><li class=" leaf"><a href="#sect-Displaying_SCAP_Content_oscap">8.4.2. Displaying SCAP Content</a></li><li class=" leaf"><a href="#sect-Scanning_the_System_in_oscap">8.4.3. Scanning the System</a></li><li class=" leaf"><a href="#sect-Generating_Reports_and_Guides_in_oscap">8.4.4. Generating Reports and Guides</a></li><li class=" leaf"><a href="#sect-Validating_SCAP_Content_in_oscap">8.4.5. Validating SCAP Content</a></li><li class=" leaf"><a href="#sect-Using_OpenSCAP_to_Remediate_the_System">8.4.6. Using OpenSCAP to Remediate the System</a></li></ol></li><li class=" leaf"><a href="#sect-Using_OpenSCAP_with_Red_Hat_Satellite">8.5. Using OpenSCAP with Red Hat Satellite</a></li><li class=" leaf"><a href="#sect-Installing_USGCB-Compliant_System_with_Kickstart">8.6. Installing USGCB-Compliant System with Kickstart</a></li><li class=" leaf"><a href="#sect-Practical_Examples">8.7. Practical Examples</a><ol class="menu"><li class=" leaf"><a href="#sect-Auditing_Security_Vulnerabilities_Example">8.7.1. Auditing Security Vulnerabilities of Red&nbsp;Hat Products</a></li><li class=" leaf"><a href="#sect-Auditing_System_Settings_with_SSG_Example">8.7.2. Auditing System Settings with SCAP Security Guide</a></li></ol></li><li class=" leaf"><a href="#sect-Additional_Resources">8.8. Additional Resources</a></li></ol></li><li class=" leaf"><a href="#sec-Checking-Integrity-with-AIDE">9. Checking Integrity with AIDE</a><ol class="menu"><li class=" leaf"><a href="#sec-Using-AIDE">9.1. Introduction</a></li><li class=" leaf"><a href="#sec-Installing_AIDE">9.2. Installing AIDE</a></li><li class=" leaf"><a href="#sec-AIDE_Scan">9.3. Performing Integrity Checks</a></li><li class=" leaf"><a href="#sec-AIDE_Update">9.4. Updating an AIDE Database</a></li><li class=" leaf"><a href="#sec-AIDE_Additional_Resources">9.5. Additional Resources</a></li></ol></li><li class=" leaf"><a href="#chap-Security_Guide-Federal_Standards_And_Regulations">10. Federal Standards and Regulations</a><ol class="menu"><li class=" leaf"><a href="#sect-Security_Guide-Federal_Standards_And_Regulations-Introduction">10.1. Introduction</a></li><li class=" leaf"><a href="#sect-Security_Guide-Federal_Standards_And_Regulations-Federal_Information_Processing_Standard">10.2. Federal Information Processing Standard (FIPS)</a><ol class="menu"><li class=" leaf"><a href="#enabling-fips-mode">10.2.1. Enabling FIPS Mode</a></li><li class=" leaf"><a href="#enabling-fips-mode-for-apps-using-nss">10.2.2. Enabling FIPS Mode for Applications Using NSS</a></li></ol></li><li class=" leaf"><a href="#sect-Security_Guide-Federal_Standards_And_Regulations-National_Industrial_Security_Program_Operating_Manual">10.3. National Industrial Security Program Operating Manual (NISPOM)</a></li><li class=" leaf"><a href="#sect-Security_Guide-Federal_Standards_And_Regulations-Payment_Card_Industry_Data_Security_Standard">10.4. Payment Card Industry Data Security Standard (PCI DSS)</a></li><li class=" leaf"><a href="#sect-Security_Guide-Federal_Standards_And_Regulations-Security_Technical_Implementation_Guide">10.5. Security Technical Implementation Guide</a></li></ol></li><li class=" leaf"><a href="#chap-Security_Guide-References">11. References</a></li><li class=" leaf"><a href="#chap-Security_Guide-Encryption_Standards">A. Encryption Standards</a><ol class="menu"><li class=" leaf"><a href="#sect-Synchronous_Encryption">A.1. Synchronous Encryption</a><ol class="menu"><li class=" leaf"><a href="#sect-AES">A.1.1. Advanced Encryption Standard - AES</a></li><li class=" leaf"><a href="#sect-DES">A.1.2. Data Encryption Standard - DES</a></li></ol></li><li class=" leaf"><a href="#sect-PK_Encryption">A.2. Public-key Encryption</a><ol class="menu"><li class=" leaf"><a href="#sect-Diffie-Hellman">A.2.1. Diffie-Hellman</a></li><li class=" leaf"><a href="#sect-RSA">A.2.2. RSA</a></li><li class=" leaf"><a href="#sect-DSA">A.2.3. DSA</a></li><li class=" leaf"><a href="#sect-SSL_TLS">A.2.4. SSL/TLS</a></li><li class=" leaf"><a href="#sect-Cramer-Shoup_Cryptosystem">A.2.5. Cramer-Shoup Cryptosystem</a></li><li class=" leaf"><a href="#sect-ElGamal-Encryption">A.2.6. ElGamal Encryption</a></li></ol></li></ol></li><li class=" leaf"><a href="#app-Audit_Reference">B. Audit System Reference</a><ol class="menu"><li class=" leaf"><a href="#sec-Audit_Events_Fields">B.1. Audit Event Fields</a></li><li class=" leaf"><a href="#sec-Audit_Record_Types">B.2. Audit Record Types</a></li></ol></li><li class=" leaf"><a href="#appe-Security_Guide-Revision_History">C. Revision History</a></li><li class=" leaf"><a href="#idm140226881085568">Legal Notice</a></li></ol>  </div>
</body></html>
